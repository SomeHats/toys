parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vkvk":[function(require,module,exports) {
"use strict";function r(r,e){if(!r)throw new Error(e||"Assertion Error")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=void 0,exports.assert=r;
},{}],"qKnW":[function(require,module,exports) {
"use strict";var t=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../assert"),r=1,n=1,i=1,s=function(){function s(t,i,s){var a=this;void 0===s&&(s=1),this._children=[],this._isPlaying=!1,this.frameHandle=null,this.lastElapsedTime=null,this.systemsByClass=new Map,this._tick=function(t){t*=r;var e=a.lastElapsedTime;if(null!==e){var n=t-e;a.isPlaying&&(a.update(n),a.draw(t))}a.lastElapsedTime=t,a.frameHandle=window.requestAnimationFrame(a._tick)},this.canvas=document.createElement("canvas"),this.canvas.width=t*s,this.canvas.height=i*s,this.canvas.style.width=t+"px",this.canvas.style.height=i+"px";var o=this.canvas.getContext("2d");e.assert(o,"ctx"),this.ctx=o,this._scaleFactor=s*n,this._setupVisiblityChange()}return Object.defineProperty(s.prototype,"width",{get:function(){return this.canvas.width/this._scaleFactor},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.canvas.height/this._scaleFactor},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isPlaying",{get:function(){return null!==this.frameHandle&&this._isPlaying},set:function(t){e.assert(null!==this.frameHandle,"cannot set isPlaying without calling start"),this._isPlaying=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),s.prototype.appendTo=function(t){t.appendChild(this.canvas)},s.prototype.hasSystem=function(t){return this.systemsByClass.has(t)},s.prototype.getSystem=function(t){var r=this.systemsByClass.get(t);return e.assert(r,"system, "+t.systemName+" not found"),e.assert(r instanceof t,"system is wrong instance type"),r},s.prototype.addSystem=function(t){e.assert(!this.hasSystem(t.constructor),"only one system of each type allowed"),this.systemsByClass.set(t.constructor,t),t.afterAddToScene(this)},s.prototype.removeSystem=function(t){this.getSystem(t).beforeRemoveFromScene(this),this.systemsByClass.delete(t)},s.prototype.addChild=function(t){this._children.push(t),t.onAddedToScene(this)},s.prototype.addChildBefore=function(t,r){var n=this._children.indexOf(t);e.assert(-1!==n,"target child must be present"),this.addChildAtIndex(n,r)},s.prototype.addChildAfter=function(t,r){var n=this._children.indexOf(t);e.assert(-1!==n,"target child must be present"),this.addChildAtIndex(n+1,r)},s.prototype.addChildAtIndex=function(t,e){this._children.splice(t,0,e),e.onAddedToScene(this)},s.prototype.removeChild=function(t){var e=this._children.indexOf(t);return-1!==e&&(this.removeChildAtIndex(e),!0)},s.prototype.removeChildAtIndex=function(t){var e=this._children[t];return this._children.splice(t,1),e.onRemovedFromScene(),e},s.prototype.update=function(e){for(var r,n,s,a,o=0;o<i;o++){try{for(var l=(r=void 0,t(this.systemsByClass.values())),h=l.next();!h.done;h=l.next()){h.value.beforeUpdate(e)}}catch(u){r={error:u}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}this._children.forEach(function(t){return t.update(e)});try{for(var c=(s=void 0,t(this.systemsByClass.values())),d=c.next();!d.done;d=c.next()){d.value.afterUpdate(e)}}catch(y){s={error:y}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(s)throw s.error}}}},s.prototype.draw=function(e){var r,n,i,s,a=this;this.ctx.save(),this.ctx.scale(this._scaleFactor,this._scaleFactor),this.ctx.clearRect(0,0,this.width,this.height);try{for(var o=t(this.systemsByClass.values()),l=o.next();!l.done;l=o.next()){l.value.beforeDraw(this.ctx,e)}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this._children.sort(function(t,e){return t.getSortOrder()-e.getSortOrder()}).forEach(function(t){return t.draw(a.ctx,e)});try{for(var h=t(this.systemsByClass.values()),c=h.next();!c.done;c=h.next()){c.value.afterDraw(this.ctx,e)}}catch(u){i={error:u}}finally{try{c&&!c.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}this.ctx.restore()},s.prototype.start=function(){this._isPlaying=!0,this.frameHandle=window.requestAnimationFrame(this._tick)},s.prototype.stop=function(){null!==this.frameHandle&&(window.cancelAnimationFrame(this.frameHandle),this.frameHandle=null),this._isPlaying=!1,this.lastElapsedTime=null},s.prototype._setupVisiblityChange=function(){var t=this,e=!1;document.addEventListener("visibilitychange",function(){document.hidden&&t.isPlaying&&(e=!0,t.stop()),e&&!document.hidden&&(e=!1,t.start())})},s}();exports.default=s;
},{"../assert":"vkvk"}],"N6d1":[function(require,module,exports) {
"use strict";var r=this&&this.__awaiter||function(r,t,e,n){return new(e||(e=Promise))(function(o,a){function i(r){try{s(n.next(r))}catch(t){a(t)}}function u(r){try{s(n.throw(r))}catch(t){a(t)}}function s(r){var t;r.done?o(r.value):(t=r.value,t instanceof e?t:new e(function(r){r(t)})).then(i,u)}s((n=n.apply(r,t||[])).next())})},t=this&&this.__generator||function(r,t){var e,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(r,i)}catch(u){a=[6,u],n=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},e=this&&this.__values||function(r){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},n=this&&this.__read||function(r,t){var e="function"==typeof Symbol&&r[Symbol.iterator];if(!e)return r;var n,o,a=e.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return i},o=this&&this.__spread||function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(n(arguments[t]));return r};function a(r,t){for(var e=[],n=0;n<r;n++)e.push(t(n));return e}function i(r,t,e){return(t-r)*e+r}function u(r,t,e){return(e-r)/(t-r)}function s(r,t,e){return Math.min(t,Math.max(r,e))}function l(r,t,e){var n=t-r;for(e-=r;e<0;)e+=n;return r+(e%=n)}function c(r,t,e,n,o){return i(e,n,u(r,t,o))}function f(r,t){return"number"==typeof t?i(r,t,Math.random()):i(0,r,Math.random())}function p(r,t){return Math.floor(f(r,t))}function x(r,t){return f(r-t,r+t)}function h(r,t){return x(r,r*t)}function m(r){return r[Math.floor(f(r.length))]}function v(r){return r.reduce(function(r,t){return r.concat(t)},[])}function y(r){return Array.from(new Set(r))}function d(r,t){var n,o,a=new Set(r),i=new Set;try{for(var u=e(t),s=u.next();!s.done;s=u.next()){var l=s.value;a.has(l)&&i.add(l)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return Array.from(i)}function w(r,t){var n,o,a=new Map;try{for(var i=e(r),u=i.next();!u.done;u=i.next()){var s=u.value,l=t(s),c=a.get(l);c?c.push(s):a.set(l,[s])}}catch(f){n={error:f}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return a}function g(r,t){return r.slice().sort(function(r,e){return t(r)<t(e)?-1:1})}function b(r,t){var n,o,a=[],i=[];try{for(var u=e(r),s=u.next();!s.done;s=u.next()){var l=s.value;t(l)?a.push(l):i.push(l)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return[a,i]}function S(){return"rgb("+Math.floor(f(256))+","+Math.floor(f(256))+","+Math.floor(f(256))+")"}function M(r,t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}function I(){return new Promise(function(r){window.requestAnimationFrame(function(t){return r(t)})})}function _(r){return new Promise(function(t){return setTimeout(function(){return t()},r)})}function A(e){return r(this,void 0,void 0,function(){var r,n,o;return t(this,function(t){switch(t.label){case 0:r=!1,n=function(){r=!0},t.label=1;case 1:return o=e,[4,I()];case 2:return o.apply(void 0,[t.sent(),n]),r?[2]:[3,1];case 3:return[2]}})})}function L(r){var t,o,a={};try{for(var i=e(r),u=i.next();!u.done;u=i.next()){var s=n(u.value,2),l=s[0],c=s[1];a[l]=c}}catch(f){t={error:f}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}return a}function P(r){return r.filter(function(r){return null!=r})}function O(r){return l(-Math.PI,Math.PI,r)}function T(r,t,e){return Math.max(r,Math.min(t,e))}function k(r){for(var t,e=r.slice(),o=e.length-1;o>0;o--){var a=Math.floor(Math.random()*(o+1));t=n([e[a],e[o]],2),e[o]=t[0],e[a]=t[1]}return e}function B(r){return void 0===r&&(r=""),""+r+Math.random().toString(36).slice(1)}function E(r,t){void 0===t&&(t=null);try{var e=window.localStorage.getItem(r);return e?JSON.parse(e):t}catch(n){return console.log(n),t}}function R(r,t){window.localStorage.setItem(r,JSON.stringify(t))}function q(r,t){var e;return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];clearTimeout(e),e=setTimeout(function(){return t.apply(void 0,o(n))},r)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounce=exports.setLocalStorageItem=exports.getLocalStorageItem=exports.getId=exports.shuffle=exports.clamp=exports.normalizeAngle=exports.compact=exports.fromEntries=exports.frameLoop=exports.wait=exports.frame=exports.removeFromArray=exports.randomColor=exports.partition=exports.sortBy=exports.groupBy=exports.intersection=exports.uniq=exports.flatten=exports.sample=exports.varyRelative=exports.varyAbsolute=exports.randomInt=exports.random=exports.mapRange=exports.constrainWrapped=exports.constrain=exports.invLerp=exports.lerp=exports.times=void 0,exports.times=a,exports.lerp=i,exports.invLerp=u,exports.constrain=s,exports.constrainWrapped=l,exports.mapRange=c,exports.random=f,exports.randomInt=p,exports.varyAbsolute=x,exports.varyRelative=h,exports.sample=m,exports.flatten=v,exports.uniq=y,exports.intersection=d,exports.groupBy=w,exports.sortBy=g,exports.partition=b,exports.randomColor=S,exports.removeFromArray=M,exports.frame=I,exports.wait=_,exports.frameLoop=A,exports.fromEntries=L,exports.compact=P,exports.normalizeAngle=O,exports.clamp=T,exports.shuffle=k,exports.getId=B,exports.getLocalStorageItem=E,exports.setLocalStorageItem=R,exports.debounce=q;
},{}],"qFdD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../utils"),e=function(){function e(t,e){this.x=t,this.y=e}return e.fromPolar=function(t,n){return new e(n*Math.cos(t),n*Math.sin(t))},e.average=function(t){return t.reduce(function(t,e){return t.add(e)},e.ZERO).div(t.length)},e.prototype.toString=function(){return"Vector2("+this.x+", "+this.y+")"},Object.defineProperty(e.prototype,"magnitudeSquared",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"magnitude",{get:function(){return Math.sqrt(this.magnitudeSquared)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return Math.atan2(this.y,this.x)},enumerable:!1,configurable:!0}),e.prototype.isInPolygon=function(t){for(var e=this.x,n=this.y,r=!1,o=0,i=t.length-1;o<t.length;i=o++){var u=t[o],h=u.x,s=u.y,a=t[i],y=a.x,p=a.y;s>n!=p>n&&e<(y-h)*(n-s)/(p-s)+h&&(r=!r)}return r},e.prototype.equals=function(t){return this===t||this.x===t.x&&this.y===t.y},e.prototype.distanceTo=function(t){var e=t.x,n=t.y,r=e-this.x,o=n-this.y;return Math.sqrt(r*r+o*o)},e.prototype.angleTo=function(t){return t.sub(this).angle},e.prototype.angleBetween=function(e){return t.normalizeAngle(Math.atan2(e.y,e.x)-Math.atan2(this.y,this.x))},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.div=function(t){return new e(this.x/t,this.y/t)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.negate=function(){return this.scale(-1)},e.prototype.add=function(t){var n=t.x,r=t.y;return new e(this.x+n,this.y+r)},e.prototype.sub=function(t){var n=t.x,r=t.y;return new e(this.x-n,this.y-r)},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e.prototype.ceil=function(){return new e(Math.ceil(this.x),Math.ceil(this.y))},e.prototype.round=function(){return new e(Math.round(this.x),Math.round(this.y))},e.prototype.withMagnitude=function(t){return e.fromPolar(this.angle,t)},e.prototype.withAngle=function(t){return e.fromPolar(t,this.magnitude)},e.prototype.rotate=function(t){return this.withAngle(this.angle+t)},e.prototype.lerp=function(n,r){return new e(t.lerp(this.x,n.x,r),t.lerp(this.y,n.y,r))},e.ZERO=new e(0,0),e}();exports.default=e;
},{"../utils":"N6d1"}],"yxwp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../assert"),t={},n=function(e){return t[e]||(t[e]=0),e+"@"+t[e]++},o=function(){function t(){this.id=n(this.constructor.name),this.scene=null}return t.prototype.hasScene=function(){return null!==this.scene},t.prototype.getScene=function(){return e.assert(this.scene,"scene must be present"),this.scene},t.prototype.draw=function(e,t){},t.prototype.update=function(e){},t.prototype.addTo=function(e){return e.addChild(this),this},t.prototype.onAddedToScene=function(e){this.scene=e},t.prototype.onRemovedFromScene=function(){this.scene=null},t.prototype.getSortOrder=function(){return 0},t}();exports.default=o;
},{"../assert":"vkvk"}],"MEE4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t){this.entity=t}return t.prototype.onRemove=function(){},t.prototype.onAddedToScene=function(t){},t.prototype.onRemovedFromScene=function(t){},t.prototype.beforeUpdate=function(t){},t.prototype.update=function(t){},t.prototype.afterUpdate=function(t){},t.prototype.beforeDraw=function(t,o){},t.prototype.draw=function(t,o){},t.prototype.afterDraw=function(t,o){},t}();exports.default=t;
},{}],"OWWa":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=r(require("./Component")),n=function(r){function e(t,e){var n=r.call(this,t)||this;return n.getSortOrderFn=e,n}return t(e,r),e.prototype.getSortOrder=function(){return this.getSortOrderFn(this.entity)},e}(e.default);exports.default=n;
},{"./Component":"MEE4"}],"HqU4":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),t=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=n(require("./SceneObject")),o=require("../assert"),a=n(require("./SortOrderProvider")),s=function(n){function r(){var e=null!==n&&n.apply(this,arguments)||this;return e.componentInstances=new Map,e}return e(r,n),r.prototype.addComponent=function(e,t){o.assert(!this.componentInstances.has(e),"component instance "+e.name+" already exists");var n=new e(this,t);return this.componentInstances.set(e,n),n},r.prototype.hasComponent=function(e){return this.componentInstances.has(e)},r.prototype.getComponent=function(e){var t=this.componentInstances.get(e);return o.assert(t,"no instance for "+e.name+" exists"),o.assert(t instanceof e,"wrong instance type"),t},r.prototype.removeComponent=function(e){var t=this.getComponent(e);return this.componentInstances.delete(e),t.onRemove(),t},r.prototype.draw=function(e,n){var r,o,a,s,c,i;try{for(var l=t(this.componentInstances.values()),u=l.next();!u.done;u=l.next()){u.value.beforeDraw(e,n)}}catch(h){r={error:h}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}try{for(var f=t(this.componentInstances.values()),p=f.next();!p.done;p=f.next()){p.value.draw(e,n)}}catch(v){a={error:v}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}try{for(var y=t(this.componentInstances.values()),d=y.next();!d.done;d=y.next()){d.value.afterDraw(e,n)}}catch(m){c={error:m}}finally{try{d&&!d.done&&(i=y.return)&&i.call(y)}finally{if(c)throw c.error}}},r.prototype.update=function(e){var n,r,o,a,s,c;try{for(var i=t(this.componentInstances.values()),l=i.next();!l.done;l=i.next()){l.value.beforeUpdate(e)}}catch(d){n={error:d}}finally{try{l&&!l.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}try{for(var u=t(this.componentInstances.values()),f=u.next();!f.done;f=u.next()){f.value.update(e)}}catch(h){o={error:h}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}try{for(var p=t(this.componentInstances.values()),y=p.next();!y.done;y=p.next()){y.value.afterUpdate(e)}}catch(v){s={error:v}}finally{try{y&&!y.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}},r.prototype.onAddedToScene=function(e){var r,o;n.prototype.onAddedToScene.call(this,e);try{for(var a=t(this.componentInstances.values()),s=a.next();!s.done;s=a.next()){s.value.onAddedToScene(e)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}},r.prototype.onRemovedFromScene=function(){var e,r,o=this.getScene();n.prototype.onRemovedFromScene.call(this);try{for(var a=t(this.componentInstances.values()),s=a.next();!s.done;s=a.next()){s.value.onRemovedFromScene(o)}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}},r.prototype.getSortOrder=function(){return this.hasComponent(a.default)?this.getComponent(a.default).getSortOrder():n.prototype.getSortOrder.call(this)},r}(r.default);exports.default=s;
},{"./SceneObject":"yxwp","../assert":"vkvk","./SortOrderProvider":"OWWa"}],"wwY5":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,a){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(e,a)};return function(e,a){function i(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.PalAbsoluteController=exports.PalTargetController=exports.PalControlData=void 0;var a=e(require("../lib/scene/Component")),i=require("../lib/utils"),o=e(require("../lib/geom/Vector2")),n=80,r=200,s=200,d=function(e){function a(t,a){var i=e.call(this,t)||this;return i.speed=0,i.heading=0,i.headingVelocity=0,i.position=a,i}return t(a,e),a.prototype.getVelocity=function(){return this.getHeadingVec().scale(this.speed)},a.prototype.getHeadingVec=function(){return o.default.fromPolar(this.heading,1)},a}(a.default);exports.PalControlData=d;var l=function(e){function a(t,a){var i=e.call(this,t)||this;return i.target=a,i.data=t.addComponent(d,a),i}return t(a,e),a.prototype.setTarget=function(t){this.target=t},a.prototype.update=function(t){var e=t/1e3,a=this.data.position.angleTo(this.target),o=this.target.distanceTo(this.data.position);if(o>15?this.accelerate(r,e):this.accelerate(-s,e),o>10){var n=i.normalizeAngle(a-this.data.heading),d=this.data.heading;this.data.heading+=n/10,this.data.headingVelocity=i.normalizeAngle(this.data.heading-d)/e}else this.data.headingVelocity=0},a.prototype.accelerate=function(t,e){var a=this.data.speed;this.data.speed=i.constrain(0,n,this.data.speed+t*e);var r=(a+this.data.speed)/2;this.data.position=this.data.position.add(o.default.fromPolar(this.data.heading,r*e))},a}(a.default);exports.PalTargetController=l;var h=function(e){function a(t,a){var i=e.call(this,t)||this;return i.data=t.addComponent(d,a),i}return t(a,e),a.prototype.setPosition=function(t,e,a){var o=this.data.position,n=this.data.heading;this.data.heading=e,this.data.headingVelocity=i.normalizeAngle(this.data.heading-n)/a,this.data.speed=o.distanceTo(t)/a,this.data.position=t},a}(a.default);exports.PalAbsoluteController=h;
},{"../lib/scene/Component":"MEE4","../lib/utils":"N6d1","../lib/geom/Vector2":"qFdD"}],"ngoU":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("./Vector2")),r=function(){function t(t,e){this.origin=t,this.size=e,Object.freeze(this)}return t.fromLeftTopRightBottom=function(r,i,o,n){return new t(new e.default(r,i),new e.default(o-r,n-i))},t.prototype.contains=function(t){var e=t.x,r=t.y;return this.left<=e&&e<=this.right&&this.top<=r&&r<=this.bottom},t.prototype.intersects=function(t){return!(this.right<t.left||this.left>t.right||this.bottom<t.top||this.top>t.bottom)},t.prototype.getCenter=function(){return this.origin.add(this.size.scale(.5))},Object.defineProperty(t.prototype,"left",{get:function(){return this.origin.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.origin.x+this.size.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.origin.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.origin.y+this.size.y},enumerable:!1,configurable:!0}),t}();exports.default=r;
},{"./Vector2":"qFdD"}],"dAUU":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("./Vector2")),r=t(require("./AABB")),n=function(){function t(t,r,n){this.center=new e.default(t,r),this.radius=n,Object.freeze(this)}return Object.defineProperty(t.prototype,"circumference",{get:function(){return 2*Math.PI*this.radius},enumerable:!1,configurable:!0}),t.prototype.getBoundingBox=function(){return new r.default(new e.default(this.center.x,this.center.y),new e.default(2*this.radius,2*this.radius))},t.prototype.pointOnCircumference=function(t){return new e.default(this.center.x+Math.cos(t)*this.radius,this.center.y+Math.sin(t)*this.radius)},t.prototype.containsPoint=function(t){return t.distanceTo(this.center)<this.radius},t.prototype.intersectsCircle=function(t){return this.center.distanceTo(t.center)<this.radius+t.radius},t.prototype.withRadius=function(e){return new t(this.center.x,this.center.y,e)},t}();exports.default=n;
},{"./Vector2":"qFdD","./AABB":"ngoU"}],"Pdt4":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=t(require("../lib/geom/Vector2")),o=require("../lib/utils"),e=function(t){var i=t.radius,o=t.hipHeight,e=t.legWidth;return Math.sqrt(i*i-(i-o)*(i-o))-e},n=function(){function t(t,i,o,n){this.palData=t,this.palGeom=i,this.config=o,this.angleOffset=n,this.liftAmount=0,this.hipRadius=e(o),this.kneeRadius=e(o)*o.kneeScale,this.floorRadius=e(o),this.footXY=this.getIdealFootRestingXY(),this.footOrigin=this.getIdealFootRestingXY()}return t.prototype.update=function(t){this.footXY=t.footXY,this.footOrigin=t.footProjectionOrigin,this.liftAmount=t.liftAmount},t.prototype.getIdealFootRestingXY=function(){return i.default.fromPolar(this.palData.heading+this.angleOffset,this.floorRadius).add(this.palData.position)},t.prototype.getFootXY=function(){return this.footXY},t.prototype.getFootZ=function(){return o.lerp(0,this.getHipZ()*this.config.legMaxLift,this.liftAmount)},t.prototype.getFootOrigin=function(){return this.footOrigin},t.prototype.getKneeXY=function(){return this.palData.position.add(i.default.fromPolar(this.palData.heading+this.angleOffset,this.kneeRadius)).add(i.default.fromPolar(this.palData.heading,this.liftAmount*this.config.kneeMaxOut))},t.prototype.getKneeZ=function(){return(this.getFootZ()+this.getHipZ())/2},t.prototype.getKneeOrigin=function(){return this.getHipOrigin().lerp(this.getFootOrigin(),.5)},t.prototype.getHipXY=function(){return this.palData.position.add(i.default.fromPolar(this.palData.heading+this.angleOffset,this.hipRadius))},t.prototype.getHipZ=function(){var t=this.palGeom.getBod();return this.palData.position.y-t.center.y-(t.radius-this.config.hipHeight)},t.prototype.getHipOrigin=function(){return this.palData.position},t}();exports.default=n;
},{"../lib/geom/Vector2":"qFdD","../lib/utils":"N6d1"}],"VYsl":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=o(require("../lib/scene/Component")),n=o(require("../lib/geom/Circle")),r=require("./PalController"),i=require("../lib/utils"),a=o(require("./PalLegGeom")),l=require("../lib/assert"),s=Math.PI/2,u=function(o){function e(t,e){var n=o.call(this,t)||this;return n.config=e,n.animationController=null,n.bobAmount=0,n.controlData=t.getComponent(r.PalControlData),n.legs=i.shuffle(i.flatten(i.times(e.legPairs,function(t){var o=(t+1)/(e.legPairs+1);return[new a.default(n.controlData,n,e,i.lerp(s-1,s+1,o)),new a.default(n.controlData,n,e,i.lerp(1-s,-s-1,o))]}))),n}return t(e,o),e.prototype.setAnimationController=function(t){this.animationController=t},e.prototype.update=function(t){if(this.animationController){var o=this.animationController.update(t,this.controlData,this.legs);this.bobAmount=o.bobAmount,l.assert(o.legs.length===this.legs.length),this.legs.forEach(function(t,e){return t.update(o.legs[e])})}},e.prototype.getBod=function(){var t=this.config.bodBob*this.bobAmount;return new n.default(this.controlData.position.x,this.controlData.position.y-this.config.bodHeight-t,this.config.radius)},e}(e.default);exports.default=u;
},{"../lib/scene/Component":"MEE4","../lib/geom/Circle":"dAUU","./PalController":"wwY5","../lib/utils":"N6d1","./PalLegGeom":"Pdt4","../lib/assert":"vkvk"}],"zgax":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../assert"),r=e(require("./Vector2")),i=function(e){return e===1/0||e===-1/0},n=function(){function e(e,t){this.start=e,this.end=t}return e.fromSlopeAndDisplacement=function(n,o){return t.assert(!i(n),"cannot create vertical line from displacement"),new e(new r.default(0,o),new r.default(1,n+o))},e.fromSlopeAndPoint=function(t,n){if(i(t))return new e(n,new r.default(n.x,n.y+1));var o=n.y-n.x*t;return e.fromSlopeAndDisplacement(t,o)},e.prototype.getDelta=function(){return this.end.sub(this.start)},Object.defineProperty(e.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displacement",{get:function(){return this.start.y-this.start.x*this.slope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){return i(this.slope)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalX",{get:function(){return t.assert(this.isVertical,"verticalX is not defined on non vertical lines"),this.start.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perpendicularSlope",{get:function(){return this.isVertical?0:-1/this.slope},enumerable:!1,configurable:!0}),e.prototype.isParallelTo=function(e){return this.isVertical&&e.isVertical||this.slope===e.slope},e.prototype.perpendicularLineThroughPoint=function(t){return e.fromSlopeAndPoint(this.perpendicularSlope,t)},e.prototype.pointAtIntersectionWith=function(e){var i;t.assert(!this.isParallelTo(e),"parallel lines do not intersect"),i=this.isVertical?this.verticalX:e.isVertical?e.verticalX:(this.displacement-e.displacement)/(e.slope-this.slope);var n=this.isVertical?e.slope*i+e.displacement:this.slope*i+this.displacement;return new r.default(i,n)},e}();exports.default=n;
},{"../assert":"vkvk","./Vector2":"qFdD"}],"BaBy":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../utils"),n=t(require("./Line2")),i=function(){function t(t,e){this.line=new n.default(t,e),this.delta=this.line.getDelta(),Object.freeze(this)}return t.prototype.getStart=function(){return this.line.start},t.prototype.getEnd=function(){return this.line.end},t.prototype.getDelta=function(){return this.delta},t.prototype.getLength=function(){return this.delta.magnitude},Object.defineProperty(t.prototype,"angle",{get:function(){return this.delta.angle},enumerable:!1,configurable:!0}),t.prototype.getPointAtPosition=function(t){var n=e.constrain(0,this.getLength(),t);return this.delta.withMagnitude(n).add(this.line.start)},t.prototype.getAngleAtPosition=function(){return this.delta.angle},t}();exports.default=i;
},{"../utils":"N6d1","./Line2":"zgax"}],"aO1u":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../utils"),n=t(require("./Circle")),i=function(){function t(t,e,i,r){this.circle=new n.default(t.x,t.y,e),this.startAngle=i,this.endAngle=r,Object.freeze(this)}return t.prototype.getStart=function(){return this.circle.pointOnCircumference(this.startAngle)},t.prototype.getEnd=function(){return this.circle.pointOnCircumference(this.endAngle)},Object.defineProperty(t.prototype,"angleDifference",{get:function(){return Math.atan2(Math.sin(this.endAngle-this.startAngle),Math.cos(this.endAngle-this.startAngle))},enumerable:!1,configurable:!0}),t.prototype.getLength=function(){var t=Math.abs(this.angleDifference)/(2*Math.PI);return this.circle.circumference*t},Object.defineProperty(t.prototype,"isAnticlockwise",{get:function(){return this.angleDifference<0},enumerable:!1,configurable:!0}),t.prototype.getPointAtPosition=function(t){var n=e.mapRange(0,this.getLength(),this.startAngle,this.startAngle+this.angleDifference,e.constrain(0,this.getLength(),t));return this.circle.pointOnCircumference(n)},t.prototype.getAngleAtPosition=function(t){return this.isAnticlockwise?e.mapRange(0,this.getLength(),this.startAngle,this.startAngle+this.angleDifference,e.constrain(0,this.getLength(),t))-Math.PI/2:e.mapRange(0,this.getLength(),this.startAngle,this.startAngle+this.angleDifference,e.constrain(0,this.getLength(),t))+Math.PI/2},t}();exports.default=i;
},{"../utils":"N6d1","./Circle":"dAUU"}],"CwlA":[function(require,module,exports) {
"use strict";var e=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.path=exports.circle=void 0;var r=t(require("./geom/StraightPathSegment")),n=t(require("./geom/CirclePathSegment"));function o(e,t,r,n){e.arc(t,r,n,0,2*Math.PI,!1)}function i(t,o){var i,a;o.segments.length&&t.moveTo(o.segments[0].getStart().x,o.segments[0].getStart().y);try{for(var l=e(o.segments),c=l.next();!c.done;c=l.next()){var s=c.value;if(s instanceof r.default)t.lineTo(s.getEnd().x,s.getEnd().y);else{if(!(s instanceof n.default))throw new Error("Unknown path segment type: "+s.toString());t.arc(s.circle.center.x,s.circle.center.y,s.circle.radius,s.startAngle,s.endAngle,s.isAnticlockwise)}}}catch(u){i={error:u}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}exports.circle=o,exports.path=i;
},{"./geom/StraightPathSegment":"BaBy","./geom/CirclePathSegment":"aO1u"}],"FxAv":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),e=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var o in t)"default"!==o&&Object.hasOwnProperty.call(t,o)&&e(n,t,o);return i(n,t),n},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var r=o(require("../lib/scene/Component")),c=require("./PalController"),a=o(require("./PalGeom")),s=n(require("../lib/canvasShapeHelpers")),u=require("../lib/utils"),l=o(require("../lib/geom/Vector2")),h=.3,f=Math.PI/2,g=function(e){function i(t,i){var n=e.call(this,t)||this;return n.config=i,n.data=t.getComponent(c.PalControlData),n.geom=t.getComponent(a.default),n}return t(i,e),i.prototype.draw=function(t){var e=this,i=u.normalizeAngle(this.data.heading);t.setLineDash([]),t.beginPath();var n=this.geom.getBod();t.ellipse(this.data.position.x,this.data.position.y,.8*n.radius,.8*n.radius*.3,0,0,2*Math.PI),t.fillStyle="rgba(0, 0, 0, 0.2)",t.fill(),this.geom.legs.filter(function(t){return u.normalizeAngle(t.angleOffset+i)<0}).forEach(function(i){return e.drawLeg(t,i)}),this.geom.legs.filter(function(t){return u.normalizeAngle(t.angleOffset+i)>=0}).forEach(function(i){return e.drawLeg(t,i)}),this.drawBod(t,n)},i.prototype.drawLeg=function(t,e){t.beginPath();var i=this.data.heading+e.angleOffset,n=u.constrain(0,1,Math.abs(u.normalizeAngle(-f-i)/f)),o=this.config.color.darken(.2*(1-n*n)),r=this.projectZ(e.getHipXY(),e.getHipZ(),e.getHipOrigin()),c=this.projectZ(e.getKneeXY(),e.getKneeZ(),e.getKneeOrigin()),a=this.projectZ(e.getFootXY(),e.getFootZ(),e.getFootOrigin());t.moveTo(r.x,r.y),t.quadraticCurveTo(c.x,c.y,a.x,a.y),t.lineCap="round",t.strokeStyle=o.toString(),t.lineWidth=this.config.legWidth,t.stroke()},i.prototype.drawBod=function(t,e){t.save(),t.beginPath(),s.circle(t,e.center.x,e.center.y,this.config.radius),t.fillStyle=this.config.color.toString(),t.fill(),t.clip();var i=u.normalizeAngle(f-this.data.heading)/f*this.config.radius;t.beginPath(),s.circle(t,i+e.center.x+this.config.eyeX,e.center.y-this.config.eyeY,this.config.eyeRadius),s.circle(t,i+e.center.x-this.config.eyeX,e.center.y-this.config.eyeY,this.config.eyeRadius),t.fillStyle=this.config.color.darken(.5).toString(),t.fill(),t.beginPath(),t.moveTo(i+e.center.x-this.config.mouthWidth,e.center.y-this.config.mouthY),t.quadraticCurveTo(i+e.center.x,e.center.y-this.config.mouthY+this.config.mouthSmile,i+e.center.x+this.config.mouthWidth,e.center.y-this.config.mouthY),t.lineWidth=this.config.mouthThickness,t.strokeStyle=this.config.color.darken(.5).toString(),t.stroke(),t.beginPath(),this.makeButtLine(t,e,i+2*this.config.radius),this.makeButtLine(t,e,i-2*this.config.radius),t.lineWidth=this.config.buttThickness,t.strokeStyle=this.config.color.darken(.3).toString(),t.stroke(),t.restore()},i.prototype.makeButtLine=function(t,e,i){t.moveTo(1.6*i+e.center.x,e.center.y+this.config.buttTop),t.quadraticCurveTo(1.7*i+e.center.x,e.center.y+.65*(this.config.buttTop+this.config.buttBottom),i+e.center.x,e.center.y+this.config.buttBottom)},i.prototype.projectZ=function(t,e,i){return new l.default(t.x,i.y-e+(t.y-i.y)*h)},i}(r.default);exports.default=g;
},{"../lib/scene/Component":"MEE4","./PalController":"wwY5","./PalGeom":"VYsl","../lib/canvasShapeHelpers":"CwlA","../lib/utils":"N6d1","../lib/geom/Vector2":"qFdD"}],"Kntx":[function(require,module,exports) {
"use strict";var t=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,o=e&&t[e],r=0;if(o)return o.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var o=e(require("../lib/geom/Vector2")),r=require("../lib/utils"),n=require("../lib/assert");function i(t){return t.stepProgress>0}function s(t){return t.restTimer>0}var a=function(){function e(t){this.config=t,this.legStates=new Map}return e.prototype.update=function(e,o,r){var n,i,s=this,a=e/1e3;try{for(var g=t(r),l=g.next();!l.done;l=g.next()){var u=l.value;this.updateLegState(a,o,r,u)}}catch(p){n={error:p}}finally{try{l&&!l.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}var f=r.map(function(t){return s.getLegUpdate(o,t)});return{bobAmount:f.reduce(function(t,e){return t+e.liftAmount},0)/r.length,legs:f}},e.prototype.canLiftLeg=function(t,e,o){var r=this;n.assert(e.includes(o),"whos leg even is this");var s=e.filter(function(e){return e!==o&&!i(r.getLegState(t,o))}).length>Math.floor(Math.log(e.length)),a=e.some(function(o){var n=r.getLegState(t,o);return n.stepProgress>0&&n.stepProgress<1/(e.length/2)});return s&&!a},e.prototype.updateLegState=function(t,e,o,n){var a=this.getLegState(e,n);if(a.restTimer=r.constrain(0,this.config.stepRestDuration,a.restTimer-t),!s(a))if(i(a))a.stepProgress=r.constrain(0,1,a.stepProgress+t/this.config.stepDuration),1===a.stepProgress&&(a.lastFootOnFloorXY=this.getFootXY(e,n,a),a.lastFootOnFloorPalPosition=e.position,a.stepProgress=0,a.restTimer=this.config.stepDuration);else{var g=n.getFootXY().distanceTo(n.getIdealFootRestingXY());g>this.config.stepThreshold&&this.canLiftLeg(e,o,n)&&(a.currentStepMaxLift=r.constrain(0,1,r.mapRange(this.config.stepThreshold,this.config.fullStepDistance,.1,1,g)),a.stepProgress=r.constrain(0,1,a.stepProgress+t/this.config.stepDuration))}},e.prototype.getInitialLegState=function(t,e){return{lastFootOnFloorXY:e.getIdealFootRestingXY(),lastFootOnFloorPalPosition:t.position,stepProgress:0,restTimer:0,currentStepMaxLift:1}},e.prototype.getLegState=function(t,e){var o=this.legStates.get(e);if(o)return o;var r=this.getInitialLegState(t,e);return this.legStates.set(e,r),r},e.prototype.getLegUpdate=function(t,e){var o=this.getLegState(t,e);return{footXY:this.getFootXY(t,e,o),footProjectionOrigin:this.getFootOrigin(t,e,o),liftAmount:this.getLegLiftAmount(o)}},e.prototype.getFootXY=function(t,e,o){if(i(o)){var r=o.lastFootOnFloorXY,n=this.getPredictedIdealFootXYAtEndOfOfStep(t,e,o);return r.lerp(n,o.stepProgress)}return o.lastFootOnFloorXY},e.prototype.getFootOrigin=function(t,e,o){return i(o)?o.lastFootOnFloorPalPosition.lerp(t.position,o.stepProgress):o.lastFootOnFloorPalPosition},e.prototype.getPredictedIdealFootXYAtEndOfOfStep=function(t,e,r){var n=(1.4-r.stepProgress)*this.config.stepDuration,i=t.getVelocity().scale(n).add(t.position),s=t.heading+t.headingVelocity*n;return o.default.fromPolar(s+e.angleOffset,e.floorRadius).add(i)},e.prototype.getLegLiftAmount=function(t){var e=t.stepProgress,o=t.currentStepMaxLift;return Math.sin(e*Math.PI)*o},e}();exports.default=a;
},{"../lib/geom/Vector2":"qFdD","../lib/utils":"N6d1","../lib/assert":"vkvk"}],"Wleo":[function(require,module,exports) {
"use strict";module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};
},{}],"kB4W":[function(require,module,exports) {
module.exports=function(r){return!(!r||"string"==typeof r)&&(r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&"String"!==r.constructor.name))};
},{}],"zufu":[function(require,module,exports) {
"use strict";var r=require("is-arrayish"),t=Array.prototype.concat,e=Array.prototype.slice,a=module.exports=function(a){for(var n=[],o=0,u=a.length;o<u;o++){var c=a[o];r(c)?n=t.call(n,e.call(c)):n.push(c)}return n};a.wrap=function(r){return function(){return r(a(arguments))}};
},{"is-arrayish":"kB4W"}],"bWbw":[function(require,module,exports) {
var r=require("color-name"),t=require("simple-swizzle"),a={};for(var e in r)r.hasOwnProperty(e)&&(a[r[e]]=e);var n=module.exports={to:{},get:{}};function s(r,t,a){return Math.min(Math.max(t,r),a)}function o(r){var t=r.toString(16).toUpperCase();return t.length<2?"0"+t:t}n.get=function(r){var t,a;switch(r.substring(0,3).toLowerCase()){case"hsl":t=n.get.hsl(r),a="hsl";break;case"hwb":t=n.get.hwb(r),a="hwb";break;default:t=n.get.rgb(r),a="rgb"}return t?{model:a,value:t}:null},n.get.rgb=function(t){if(!t)return null;var a,e,n,o=[0,0,0,1];if(a=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(n=a[2],a=a[1],e=0;e<3;e++){var u=2*e;o[e]=parseInt(a.slice(u,u+2),16)}n&&(o[3]=Math.round(parseInt(n,16)/255*100)/100)}else if(a=t.match(/^#([a-f0-9]{3,4})$/i)){for(n=(a=a[1])[3],e=0;e<3;e++)o[e]=parseInt(a[e]+a[e],16);n&&(o[3]=Math.round(parseInt(n+n,16)/255*100)/100)}else if(a=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(e=0;e<3;e++)o[e]=parseInt(a[e+1],0);a[4]&&(o[3]=parseFloat(a[4]))}else{if(!(a=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(a=t.match(/(\D+)/))?"transparent"===a[1]?[0,0,0,0]:(o=r[a[1]])?(o[3]=1,o):null:null;for(e=0;e<3;e++)o[e]=Math.round(2.55*parseFloat(a[e+1]));a[4]&&(o[3]=parseFloat(a[4]))}for(e=0;e<3;e++)o[e]=s(o[e],0,255);return o[3]=s(o[3],0,1),o},n.get.hsl=function(r){if(!r)return null;var t=r.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var a=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(a)?1:a,0,1)]}return null},n.get.hwb=function(r){if(!r)return null;var t=r.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var a=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(a)?1:a,0,1)]}return null},n.to.hex=function(){var r=t(arguments);return"#"+o(r[0])+o(r[1])+o(r[2])+(r[3]<1?o(Math.round(255*r[3])):"")},n.to.rgb=function(){var r=t(arguments);return r.length<4||1===r[3]?"rgb("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+")":"rgba("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+", "+r[3]+")"},n.to.rgb.percent=function(){var r=t(arguments),a=Math.round(r[0]/255*100),e=Math.round(r[1]/255*100),n=Math.round(r[2]/255*100);return r.length<4||1===r[3]?"rgb("+a+"%, "+e+"%, "+n+"%)":"rgba("+a+"%, "+e+"%, "+n+"%, "+r[3]+")"},n.to.hsl=function(){var r=t(arguments);return r.length<4||1===r[3]?"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)":"hsla("+r[0]+", "+r[1]+"%, "+r[2]+"%, "+r[3]+")"},n.to.hwb=function(){var r=t(arguments),a="";return r.length>=4&&1!==r[3]&&(a=", "+r[3]),"hwb("+r[0]+", "+r[1]+"%, "+r[2]+"%"+a+")"},n.to.keyword=function(r){return a[r.slice(0,3)]};
},{"color-name":"Wleo","simple-swizzle":"zufu"}],"v4cc":[function(require,module,exports) {
var r=require("color-name"),n={};for(var a in r)r.hasOwnProperty(a)&&(n[r[a]]=a);var t=module.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var e in t)if(t.hasOwnProperty(e)){if(!("channels"in t[e]))throw new Error("missing channels property: "+e);if(!("labels"in t[e]))throw new Error("missing channel labels property: "+e);if(t[e].labels.length!==t[e].channels)throw new Error("channel and label counts mismatch: "+e);var h=t[e].channels,u=t[e].labels;delete t[e].channels,delete t[e].labels,Object.defineProperty(t[e],"channels",{value:h}),Object.defineProperty(t[e],"labels",{value:u})}function o(r,n){return Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2)}t.rgb.hsl=function(r){var n,a,t=r[0]/255,e=r[1]/255,h=r[2]/255,u=Math.min(t,e,h),o=Math.max(t,e,h),c=o-u;return o===u?n=0:t===o?n=(e-h)/c:e===o?n=2+(h-t)/c:h===o&&(n=4+(t-e)/c),(n=Math.min(60*n,360))<0&&(n+=360),a=(u+o)/2,[n,100*(o===u?0:a<=.5?c/(o+u):c/(2-o-u)),100*a]},t.rgb.hsv=function(r){var n,a,t,e,h,u=r[0]/255,o=r[1]/255,c=r[2]/255,s=Math.max(u,o,c),l=s-Math.min(u,o,c),i=function(r){return(s-r)/6/l+.5};return 0===l?e=h=0:(h=l/s,n=i(u),a=i(o),t=i(c),u===s?e=t-a:o===s?e=1/3+n-t:c===s&&(e=2/3+a-n),e<0?e+=1:e>1&&(e-=1)),[360*e,100*h,100*s]},t.rgb.hwb=function(r){var n=r[0],a=r[1],e=r[2];return[t.rgb.hsl(r)[0],100*(1/255*Math.min(n,Math.min(a,e))),100*(e=1-1/255*Math.max(n,Math.max(a,e)))]},t.rgb.cmyk=function(r){var n,a=r[0]/255,t=r[1]/255,e=r[2]/255;return[100*((1-a-(n=Math.min(1-a,1-t,1-e)))/(1-n)||0),100*((1-t-n)/(1-n)||0),100*((1-e-n)/(1-n)||0),100*n]},t.rgb.keyword=function(a){var t=n[a];if(t)return t;var e,h=1/0;for(var u in r)if(r.hasOwnProperty(u)){var c=o(a,r[u]);c<h&&(h=c,e=u)}return e},t.keyword.rgb=function(n){return r[n]},t.rgb.xyz=function(r){var n=r[0]/255,a=r[1]/255,t=r[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92)+.1805*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)),100*(.2126*n+.7152*a+.0722*t),100*(.0193*n+.1192*a+.9505*t)]},t.rgb.lab=function(r){var n=t.rgb.xyz(r),a=n[0],e=n[1],h=n[2];return e/=100,h/=108.883,a=(a/=95.047)>.008856?Math.pow(a,1/3):7.787*a+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(a-e),200*(e-(h=h>.008856?Math.pow(h,1/3):7.787*h+16/116))]},t.hsl.rgb=function(r){var n,a,t,e,h,u=r[0]/360,o=r[1]/100,c=r[2]/100;if(0===o)return[h=255*c,h,h];n=2*c-(a=c<.5?c*(1+o):c+o-c*o),e=[0,0,0];for(var s=0;s<3;s++)(t=u+1/3*-(s-1))<0&&t++,t>1&&t--,h=6*t<1?n+6*(a-n)*t:2*t<1?a:3*t<2?n+(a-n)*(2/3-t)*6:n,e[s]=255*h;return e},t.hsl.hsv=function(r){var n=r[0],a=r[1]/100,t=r[2]/100,e=a,h=Math.max(t,.01);return a*=(t*=2)<=1?t:2-t,e*=h<=1?h:2-h,[n,100*(0===t?2*e/(h+e):2*a/(t+a)),100*((t+a)/2)]},t.hsv.rgb=function(r){var n=r[0]/60,a=r[1]/100,t=r[2]/100,e=Math.floor(n)%6,h=n-Math.floor(n),u=255*t*(1-a),o=255*t*(1-a*h),c=255*t*(1-a*(1-h));switch(t*=255,e){case 0:return[t,c,u];case 1:return[o,t,u];case 2:return[u,t,c];case 3:return[u,o,t];case 4:return[c,u,t];case 5:return[t,u,o]}},t.hsv.hsl=function(r){var n,a,t,e=r[0],h=r[1]/100,u=r[2]/100,o=Math.max(u,.01);return t=(2-h)*u,a=h*o,[e,100*(a=(a/=(n=(2-h)*o)<=1?n:2-n)||0),100*(t/=2)]},t.hwb.rgb=function(r){var n,a,t,e,h,u,o,c=r[0]/360,s=r[1]/100,l=r[2]/100,i=s+l;switch(i>1&&(s/=i,l/=i),t=6*c-(n=Math.floor(6*c)),0!=(1&n)&&(t=1-t),e=s+t*((a=1-l)-s),n){default:case 6:case 0:h=a,u=e,o=s;break;case 1:h=e,u=a,o=s;break;case 2:h=s,u=a,o=e;break;case 3:h=s,u=e,o=a;break;case 4:h=e,u=s,o=a;break;case 5:h=a,u=s,o=e}return[255*h,255*u,255*o]},t.cmyk.rgb=function(r){var n=r[0]/100,a=r[1]/100,t=r[2]/100,e=r[3]/100;return[255*(1-Math.min(1,n*(1-e)+e)),255*(1-Math.min(1,a*(1-e)+e)),255*(1-Math.min(1,t*(1-e)+e))]},t.xyz.rgb=function(r){var n,a,t,e=r[0]/100,h=r[1]/100,u=r[2]/100;return a=-.9689*e+1.8758*h+.0415*u,t=.0557*e+-.204*h+1.057*u,n=(n=3.2406*e+-1.5372*h+-.4986*u)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:12.92*a,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,[255*(n=Math.min(Math.max(0,n),1)),255*(a=Math.min(Math.max(0,a),1)),255*(t=Math.min(Math.max(0,t),1))]},t.xyz.lab=function(r){var n=r[0],a=r[1],t=r[2];return a/=100,t/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116)-16,500*(n-a),200*(a-(t=t>.008856?Math.pow(t,1/3):7.787*t+16/116))]},t.lab.xyz=function(r){var n,a,t,e=r[0];n=r[1]/500+(a=(e+16)/116),t=a-r[2]/200;var h=Math.pow(a,3),u=Math.pow(n,3),o=Math.pow(t,3);return a=h>.008856?h:(a-16/116)/7.787,n=u>.008856?u:(n-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,[n*=95.047,a*=100,t*=108.883]},t.lab.lch=function(r){var n,a=r[0],t=r[1],e=r[2];return(n=360*Math.atan2(e,t)/2/Math.PI)<0&&(n+=360),[a,Math.sqrt(t*t+e*e),n]},t.lch.lab=function(r){var n,a=r[0],t=r[1];return n=r[2]/360*2*Math.PI,[a,t*Math.cos(n),t*Math.sin(n)]},t.rgb.ansi16=function(r){var n=r[0],a=r[1],e=r[2],h=1 in arguments?arguments[1]:t.rgb.hsv(r)[2];if(0===(h=Math.round(h/50)))return 30;var u=30+(Math.round(e/255)<<2|Math.round(a/255)<<1|Math.round(n/255));return 2===h&&(u+=60),u},t.hsv.ansi16=function(r){return t.rgb.ansi16(t.hsv.rgb(r),r[2])},t.rgb.ansi256=function(r){var n=r[0],a=r[1],t=r[2];return n===a&&a===t?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(a/255*5)+Math.round(t/255*5)},t.ansi16.rgb=function(r){var n=r%10;if(0===n||7===n)return r>50&&(n+=3.5),[n=n/10.5*255,n,n];var a=.5*(1+~~(r>50));return[(1&n)*a*255,(n>>1&1)*a*255,(n>>2&1)*a*255]},t.ansi256.rgb=function(r){if(r>=232){var n=10*(r-232)+8;return[n,n,n]}var a;return r-=16,[Math.floor(r/36)/5*255,Math.floor((a=r%36)/6)/5*255,a%6/5*255]},t.rgb.hex=function(r){var n=(((255&Math.round(r[0]))<<16)+((255&Math.round(r[1]))<<8)+(255&Math.round(r[2]))).toString(16).toUpperCase();return"000000".substring(n.length)+n},t.hex.rgb=function(r){var n=r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var a=n[0];3===n[0].length&&(a=a.split("").map(function(r){return r+r}).join(""));var t=parseInt(a,16);return[t>>16&255,t>>8&255,255&t]},t.rgb.hcg=function(r){var n,a=r[0]/255,t=r[1]/255,e=r[2]/255,h=Math.max(Math.max(a,t),e),u=Math.min(Math.min(a,t),e),o=h-u;return n=o<=0?0:h===a?(t-e)/o%6:h===t?2+(e-a)/o:4+(a-t)/o+4,n/=6,[360*(n%=1),100*o,100*(o<1?u/(1-o):0)]},t.hsl.hcg=function(r){var n=r[1]/100,a=r[2]/100,t=1,e=0;return(t=a<.5?2*n*a:2*n*(1-a))<1&&(e=(a-.5*t)/(1-t)),[r[0],100*t,100*e]},t.hsv.hcg=function(r){var n=r[1]/100,a=r[2]/100,t=n*a,e=0;return t<1&&(e=(a-t)/(1-t)),[r[0],100*t,100*e]},t.hcg.rgb=function(r){var n=r[0]/360,a=r[1]/100,t=r[2]/100;if(0===a)return[255*t,255*t,255*t];var e,h=[0,0,0],u=n%1*6,o=u%1,c=1-o;switch(Math.floor(u)){case 0:h[0]=1,h[1]=o,h[2]=0;break;case 1:h[0]=c,h[1]=1,h[2]=0;break;case 2:h[0]=0,h[1]=1,h[2]=o;break;case 3:h[0]=0,h[1]=c,h[2]=1;break;case 4:h[0]=o,h[1]=0,h[2]=1;break;default:h[0]=1,h[1]=0,h[2]=c}return e=(1-a)*t,[255*(a*h[0]+e),255*(a*h[1]+e),255*(a*h[2]+e)]},t.hcg.hsv=function(r){var n=r[1]/100,a=n+r[2]/100*(1-n),t=0;return a>0&&(t=n/a),[r[0],100*t,100*a]},t.hcg.hsl=function(r){var n=r[1]/100,a=r[2]/100*(1-n)+.5*n,t=0;return a>0&&a<.5?t=n/(2*a):a>=.5&&a<1&&(t=n/(2*(1-a))),[r[0],100*t,100*a]},t.hcg.hwb=function(r){var n=r[1]/100,a=n+r[2]/100*(1-n);return[r[0],100*(a-n),100*(1-a)]},t.hwb.hcg=function(r){var n=r[1]/100,a=1-r[2]/100,t=a-n,e=0;return t<1&&(e=(a-t)/(1-t)),[r[0],100*t,100*e]},t.apple.rgb=function(r){return[r[0]/65535*255,r[1]/65535*255,r[2]/65535*255]},t.rgb.apple=function(r){return[r[0]/255*65535,r[1]/255*65535,r[2]/255*65535]},t.gray.rgb=function(r){return[r[0]/100*255,r[0]/100*255,r[0]/100*255]},t.gray.hsl=t.gray.hsv=function(r){return[0,0,r[0]]},t.gray.hwb=function(r){return[0,100,r[0]]},t.gray.cmyk=function(r){return[0,0,0,r[0]]},t.gray.lab=function(r){return[r[0],0,0]},t.gray.hex=function(r){var n=255&Math.round(r[0]/100*255),a=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return"000000".substring(a.length)+a},t.rgb.gray=function(r){return[(r[0]+r[1]+r[2])/3/255*100]};
},{"color-name":"Wleo"}],"ZMFB":[function(require,module,exports) {
var n=require("./conversions");function r(){for(var r={},e=Object.keys(n),t=e.length,a=0;a<t;a++)r[e[a]]={distance:-1,parent:null};return r}function e(e){var t=r(),a=[e];for(t[e].distance=0;a.length;)for(var o=a.pop(),u=Object.keys(n[o]),c=u.length,i=0;i<c;i++){var s=u[i],f=t[s];-1===f.distance&&(f.distance=t[o].distance+1,f.parent=o,a.unshift(s))}return t}function t(n,r){return function(e){return r(n(e))}}function a(r,e){for(var a=[e[r].parent,r],o=n[e[r].parent][r],u=e[r].parent;e[u].parent;)a.unshift(e[u].parent),o=t(n[e[u].parent][u],o),u=e[u].parent;return o.conversion=a,o}module.exports=function(n){for(var r=e(n),t={},o=Object.keys(r),u=o.length,c=0;c<u;c++){var i=o[c];null!==r[i].parent&&(t[i]=a(i,r))}return t};
},{"./conversions":"v4cc"}],"rLkC":[function(require,module,exports) {
var e=require("./conversions"),n=require("./route"),r={},o=Object.keys(e);function t(e){var n=function(n){return null==n?n:(arguments.length>1&&(n=Array.prototype.slice.call(arguments)),e(n))};return"conversion"in e&&(n.conversion=e.conversion),n}function c(e){var n=function(n){if(null==n)return n;arguments.length>1&&(n=Array.prototype.slice.call(arguments));var r=e(n);if("object"==typeof r)for(var o=r.length,t=0;t<o;t++)r[t]=Math.round(r[t]);return r};return"conversion"in e&&(n.conversion=e.conversion),n}o.forEach(function(o){r[o]={},Object.defineProperty(r[o],"channels",{value:e[o].channels}),Object.defineProperty(r[o],"labels",{value:e[o].labels});var i=n(o);Object.keys(i).forEach(function(e){var n=i[e];r[o][e]=c(n),r[o][e].raw=t(n)})}),module.exports=r;
},{"./conversions":"v4cc","./route":"ZMFB"}],"oOZe":[function(require,module,exports) {
"use strict";var r=require("color-string"),t=require("color-convert"),o=[].slice,n=["keyword","gray","hex"],e={};Object.keys(t).forEach(function(r){e[o.call(t[r].labels).sort().join("")]=r});var i={};function a(h,l){if(!(this instanceof a))return new a(h,l);if(l&&l in n&&(l=null),l&&!(l in t))throw new Error("Unknown model: "+l);var s,c;if(null==h)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(h instanceof a)this.model=h.model,this.color=h.color.slice(),this.valpha=h.valpha;else if("string"==typeof h){var u=r.get(h);if(null===u)throw new Error("Unable to parse color from string: "+h);this.model=u.model,c=t[this.model].channels,this.color=u.value.slice(0,c),this.valpha="number"==typeof u.value[c]?u.value[c]:1}else if(h.length){this.model=l||"rgb",c=t[this.model].channels;var v=o.call(h,0,c);this.color=f(v,c),this.valpha="number"==typeof h[c]?h[c]:1}else if("number"==typeof h)h&=16777215,this.model="rgb",this.color=[h>>16&255,h>>8&255,255&h],this.valpha=1;else{this.valpha=1;var p=Object.keys(h);"alpha"in h&&(p.splice(p.indexOf("alpha"),1),this.valpha="number"==typeof h.alpha?h.alpha:0);var b=p.sort().join("");if(!(b in e))throw new Error("Unable to parse color from object: "+JSON.stringify(h));this.model=e[b];var m=t[this.model].labels,g=[];for(s=0;s<m.length;s++)g.push(h[m[s]]);this.color=f(g)}if(i[this.model])for(c=t[this.model].channels,s=0;s<c;s++){var d=i[this.model][s];d&&(this.color[s]=d(this.color[s]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function h(r,t){return Number(r.toFixed(t))}function l(r){return function(t){return h(t,r)}}function s(r,t,o){return(r=Array.isArray(r)?r:[r]).forEach(function(r){(i[r]||(i[r]=[]))[t]=o}),r=r[0],function(n){var e;return arguments.length?(o&&(n=o(n)),(e=this[r]()).color[t]=n,e):(e=this[r]().color[t],o&&(e=o(e)),e)}}function c(r){return function(t){return Math.max(0,Math.min(r,t))}}function u(r){return Array.isArray(r)?r:[r]}function f(r,t){for(var o=0;o<t;o++)"number"!=typeof r[o]&&(r[o]=0);return r}a.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var o=this.model in r.to?this:this.rgb(),n=1===(o=o.round("number"==typeof t?t:1)).valpha?o.color:o.color.concat(this.valpha);return r.to[o.model](n)},percentString:function(t){var o=this.rgb().round("number"==typeof t?t:1),n=1===o.valpha?o.color:o.color.concat(this.valpha);return r.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var r={},o=t[this.model].channels,n=t[this.model].labels,e=0;e<o;e++)r[n[e]]=this.color[e];return 1!==this.valpha&&(r.alpha=this.valpha),r},unitArray:function(){var r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,1!==this.valpha&&r.push(this.valpha),r},unitObject:function(){var r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,1!==this.valpha&&(r.alpha=this.valpha),r},round:function(r){return r=Math.max(r||0,0),new a(this.color.map(l(r)).concat(this.valpha),this.model)},alpha:function(r){return arguments.length?new a(this.color.concat(Math.max(0,Math.min(1,r))),this.model):this.valpha},red:s("rgb",0,c(255)),green:s("rgb",1,c(255)),blue:s("rgb",2,c(255)),hue:s(["hsl","hsv","hsl","hwb","hcg"],0,function(r){return(r%360+360)%360}),saturationl:s("hsl",1,c(100)),lightness:s("hsl",2,c(100)),saturationv:s("hsv",1,c(100)),value:s("hsv",2,c(100)),chroma:s("hcg",1,c(100)),gray:s("hcg",2,c(100)),white:s("hwb",1,c(100)),wblack:s("hwb",2,c(100)),cyan:s("cmyk",0,c(100)),magenta:s("cmyk",1,c(100)),yellow:s("cmyk",2,c(100)),black:s("cmyk",3,c(100)),x:s("xyz",0,c(100)),y:s("xyz",1,c(100)),z:s("xyz",2,c(100)),l:s("lab",0,c(100)),a:s("lab",1),b:s("lab",2),keyword:function(r){return arguments.length?new a(r):t[this.model].keyword(this.color)},hex:function(t){return arguments.length?new a(t):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var r=this.rgb().color;return(255&r[0])<<16|(255&r[1])<<8|255&r[2]},luminosity:function(){for(var r=this.rgb().color,t=[],o=0;o<r.length;o++){var n=r[o]/255;t[o]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(r){var t=this.luminosity(),o=r.luminosity();return t>o?(t+.05)/(o+.05):(o+.05)/(t+.05)},level:function(r){var t=this.contrast(r);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var r=this.rgb().color;return(299*r[0]+587*r[1]+114*r[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var r=this.rgb(),t=0;t<3;t++)r.color[t]=255-r.color[t];return r},lighten:function(r){var t=this.hsl();return t.color[2]+=t.color[2]*r,t},darken:function(r){var t=this.hsl();return t.color[2]-=t.color[2]*r,t},saturate:function(r){var t=this.hsl();return t.color[1]+=t.color[1]*r,t},desaturate:function(r){var t=this.hsl();return t.color[1]-=t.color[1]*r,t},whiten:function(r){var t=this.hwb();return t.color[1]+=t.color[1]*r,t},blacken:function(r){var t=this.hwb();return t.color[2]+=t.color[2]*r,t},grayscale:function(){var r=this.rgb().color,t=.3*r[0]+.59*r[1]+.11*r[2];return a.rgb(t,t,t)},fade:function(r){return this.alpha(this.valpha-this.valpha*r)},opaquer:function(r){return this.alpha(this.valpha+this.valpha*r)},rotate:function(r){var t=this.hsl(),o=t.color[0];return o=(o=(o+r)%360)<0?360+o:o,t.color[0]=o,t},mix:function(r,t){if(!r||!r.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof r);var o=r.rgb(),n=this.rgb(),e=void 0===t?.5:t,i=2*e-1,h=o.alpha()-n.alpha(),l=((i*h==-1?i:(i+h)/(1+i*h))+1)/2,s=1-l;return a.rgb(l*o.red()+s*n.red(),l*o.green()+s*n.green(),l*o.blue()+s*n.blue(),o.alpha()*e+n.alpha()*(1-e))}},Object.keys(t).forEach(function(r){if(-1===n.indexOf(r)){var e=t[r].channels;a.prototype[r]=function(){if(this.model===r)return new a(this);if(arguments.length)return new a(arguments,r);var o="number"==typeof arguments[e]?e:this.valpha;return new a(u(t[this.model][r].raw(this.color)).concat(o),r)},a[r]=function(t){return"number"==typeof t&&(t=f(o.call(arguments),e)),new a(t,r)}}}),module.exports=a;
},{"color-string":"bWbw","color-convert":"rLkC"}],"Gkif":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.YELLOW=exports.RED=exports.BLUE=exports.TEAL=exports.LIGHT_BG=void 0;var t=e(require("color"));exports.LIGHT_BG=new t.default("#F8FFE5"),exports.TEAL=new t.default("#06D6A0"),exports.BLUE=new t.default("#1B9AAA"),exports.RED=new t.default("#EF476F"),exports.YELLOW=new t.default("#FFC43D");
},{"color":"oOZe"}],"menO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateRandomPalConfig=exports.classicPalConfig=void 0;var e=require("../lib/utils"),t=require("./colors");exports.classicPalConfig={radius:14,bodHeight:25,bodBob:15,eyeY:6,eyeX:5,eyeRadius:2,mouthThickness:2,mouthY:2,mouthWidth:8,mouthSmile:4,buttTop:6,buttBottom:12,buttThickness:1.4,color:t.BLUE.lighten(.2),hipHeight:10,kneeScale:1.3,legMaxLift:.3,kneeMaxOut:14,stepDuration:.2,stepRestDuration:.2,stepThreshold:.2,fullStepDistance:20,legWidth:4,legPairs:1},exports.generateRandomPalConfig=function(){var a=e.varyRelative(14,.2),i=e.varyRelative(.7*a,.3),r=e.varyRelative(2*a,.3),o=r-(a-i);return{radius:a,bodHeight:r,bodBob:e.varyRelative(a,.2),eyeY:e.varyRelative(.5*a,.2),eyeX:e.varyRelative(.4*a,.3),eyeRadius:e.varyRelative(.15*a,.4),mouthThickness:e.varyRelative(.15*a,.4),mouthY:e.varyAbsolute(0,.2*a),mouthWidth:e.varyRelative(.5*a,.3),mouthSmile:e.varyRelative(.3*a,.3),buttTop:e.varyRelative(.4*a,.2),buttBottom:e.varyRelative(.85*a,.15),buttThickness:e.varyRelative(.1*a,.5),color:t.BLUE.lighten(e.random(-.2,.2)).saturate(e.random(-.2,.2)).rotate(e.random(-10,10)),hipHeight:i,kneeScale:e.varyAbsolute(1.3,.3),legMaxLift:e.random(.2,.5),kneeMaxOut:e.varyRelative(.6*o,.4),stepDuration:e.varyRelative(.01*o,.4),stepRestDuration:e.varyRelative(.0083*o,.4),stepThreshold:e.varyRelative(.01*o,.4),fullStepDistance:e.varyRelative(.7*o,.4),legWidth:e.varyRelative(.3*a,.4),legPairs:e.randomInt(1,4)}};
},{"../lib/utils":"N6d1","./colors":"Gkif"}],"N7vE":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../lib/scene/Scene")),r=require("../lib/assert"),n=e(require("../lib/geom/Vector2")),a=e(require("../lib/scene/Entity")),o=require("./PalController"),l=e(require("./PalGeom")),i=e(require("./PalRenderer")),d=e(require("./PalWalkAnimationController")),u=require("./PalConfig"),s=document.getElementById("root");r.assert(s);var f=new t.default(800,600,window.devicePixelRatio);f.appendTo(s);var c=new a.default;c.addComponent(o.PalTargetController,new n.default(100,50));var m=u.generateRandomPalConfig(),v=c.addComponent(l.default,m);v.setAnimationController(new d.default(m)),c.addComponent(i.default,m),f.addChild(c),s.addEventListener("mousemove",function(e){var t=e.clientX-f.canvas.offsetLeft,r=e.clientY-f.canvas.offsetTop;c.getComponent(o.PalTargetController).setTarget(new n.default(t-50,r))}),f.start();
},{"../lib/scene/Scene":"qKnW","../lib/assert":"vkvk","../lib/geom/Vector2":"qFdD","../lib/scene/Entity":"HqU4","./PalController":"wwY5","./PalGeom":"VYsl","./PalRenderer":"FxAv","./PalWalkAnimationController":"Kntx","./PalConfig":"menO"}]},{},["N7vE"], null)
//# sourceMappingURL=https://alex.dytry.ch/toys/pals-main.c2da6336.js.map