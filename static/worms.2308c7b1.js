import{b as y,j as P,s as b,r as S,a as w,t as A,F as I,A as N}from"./chunk_assert.17fe3ff6.js";import{D as G}from"./chunk_DebugDraw.b4e864cf.js";import{V as k}from"./chunk_Vector2.d8fb1f00.js";import{c as L}from"./chunk_createTriangleGrid.8879663b.js";import{C as c}from"./chunk_index.dc2a5aeb.js";const g=document.createElement("canvas"),v=y(g.getContext("2d"),'Assertion Error: canvasEl.getContext("2d")'),m=document.body.clientWidth,p=document.body.clientHeight,d=window.devicePixelRatio;g.width=m*d;g.height=p*d;g.style.width=`${m}px`;g.style.height=`${p}px`;v.scale(d,d);const i=new G(v);document.body.appendChild(g);const W=new c("#E2ECC9"),B=[new c("#C33C54"),new c("#bfb915"),new c("#96ba3b"),new c("#39847f"),new c("#12416b")],h=50,l=Math.PI*h/6,H=L(h,m,p),x=()=>{const e=A(I(2,6),()=>b(B).string());if(N(e).length===1)return x();let s=0;return{palette:e,current:()=>e[s%e.length],next:()=>(s++,e[s%e.length]),reset:(n=0)=>{s=n}}};function C(e,s){const n=e.neighbours.find(t=>t.triangle===s);return w(n,"must be a neighbour"),n.sharedPoints}const f=new Set,D=()=>{const e=[],s=x();let n=[...H.values()];for(let t=0;t<2;t++){const a=n.filter(r=>!f.has(r));if(!a.length)break;const o=b(a);e.push(o),f.add(o),n=o.neighbours.map(r=>r.triangle)}return{triangles:e,palette:s,speed:S(.06,.12),offset:0,base:0,length:e.length,isDead:!1}},u=[];for(let e=0;e<10;e++)u.push(D());P(()=>{i.clear(W.string());for(const e of u){if(e.offset+=e.speed,e.offset>1){if(e.offset--,e.base++,!e.isDead){const o=e.triangles[0].neighbours.filter(r=>!f.has(r.triangle));if(o.length){const r=b(o).triangle;f.add(r),e.triangles.unshift(r),e.base--,e.length++}else e.isDead=!0,u.push(D())}const t=e.triangles[e.triangles.length-e.base];t&&(f.delete(t),e.length--)}const{triangles:s,palette:n}=e;n.reset(e.base);for(let t=0;t<e.length;t++){const a=s[t],o=s[t-1],r=s[t+1],E=n.current(),T=n.next();if(i.beginPath(),o)r?(i.moveTo(k.average(C(a,o))),i.arcTo(a.center,r.center,h/2-.5)):(w(o,"Assertion Error: last"),i.moveTo(k.average(C(a,o))),i.lineTo(a.center));else continue;t===1&&!e.isDead||i.stroke({strokeWidth:h/2,stroke:E,strokeCap:"round",strokeDash:[l,l],strokeDashOffset:e.offset*l}),t===e.length-1&&e.isDead||i.stroke({strokeWidth:h/2,stroke:T,strokeCap:"round",strokeDash:[l,l],strokeDashOffset:e.offset*l-l})}}});
