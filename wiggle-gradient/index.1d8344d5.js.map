{"mappings":"8gBAEaA,EAAWC,SAASC,cAAc,UAClCC,EAAMH,EAASI,WAAW,MAC1BC,EAAQJ,SAASK,KAAKC,YACtBC,EAASP,SAASK,KAAKG,aACvBC,EAAQC,OAAOC,iBAE5BZ,EAASa,MAAQR,EAAQK,EACzBV,EAASc,OAASN,EAASE,EAC3BV,EAASe,MAAMF,MAAS,GAAQG,OAANX,EAAM,MAChCL,EAASe,MAAMD,OAAU,GAASE,OAAPR,EAAO,MAClCL,EAAIc,MAAMP,EAAOA,GACV,IAAMQ,EAAS,IAAIC,EAAAC,UAAUjB,GACpCF,SAASK,KAAKe,YAAYrB,0CCVVsB,EAAOC,EAAgBC,GAChCD,YALcC,GACnB,MAAM,IAAIC,MAAMD,GAKdE,CAAKF,GAAW,mBCSpB,IAAMG,EAAY,GAGZC,GAFcC,KAAKC,GAEHC,EAAAC,QAAmBL,EAAWtB,EAAOG,IAErDyB,EAAW,IAAIC,IAKfC,EAAY,WAgBhB,IAfA,IAAMC,EAA6B,GAC/BC,EAAWC,EAAAC,OAAMC,EAAAC,kBACfb,EAAcc,UAAUC,QAAO,SAAAC,GAAK,OAACX,EAASY,IAAID,OAa/CE,GADKN,EAAAC,kBAAOb,EAAcc,UACtB,GAAGI,EAFK,GAEaA,IAAK,CACrCV,EAAUW,KAAKV,GACfJ,EAASe,IAAIX,GAGb,IAAMY,EAFOZ,EAASa,WAAWC,KAAI,SAAAC,GAAK,OAAAA,EAAEf,YAELM,QACrC,SAAAU,GAAa,OAACpB,EAASY,IAAIQ,MAE7B,IAAKJ,EAAoBK,OAAQ,MACjCjB,EAAWC,EAAAC,OAAOU,GAIpB,MAAO,CACLb,UAAAA,IAGEmB,EAAkB,GAElBC,EAAcnD,EAAQsB,GAAcnB,EAASmB,GAAa,IAChE8B,QAAQC,IAAI,CAAEC,WAAAH,IACd,IAAK,IAAII,EAAK,EAAGA,EAAKJ,EAAYI,IAChCL,EAAOR,KAAKZ,KAGdjB,EAAO2C,MAAM,aAERC,GAAmB,EAAnBC,GAAmB,EAAnBC,OAAmBC,MAAxB,IAAG,IAAEC,EAAAC,EAAuBZ,EAAMa,OAAAC,cAA7BP,GAAAI,EAAAC,EAAmBG,QAAAC,MAAnBT,GAAmB,EAAY,CAA/B,IAAQU,EAARN,EAAmB3C,MAAXa,UACXlB,EAAOuD,YACP,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAUlB,OAAQoB,IAAK,CACzC,IAAMC,EAAWH,EAAUE,GACrBE,EAA6BJ,EAAUE,EAAI,GAC3CJ,EAA6BE,EAAUE,EAAI,GAE5CE,EAEON,EAMVpD,EAAO2D,MAAMF,EAASG,OAAQR,EAAKQ,OAAQnD,IAL3CL,EAAOsD,GAEP1D,EAAO6D,OAAOJ,EAASG,SAJvB5D,EAAO8D,OAAOL,EAASG,QAU3B5D,EAAO+D,OAAO,CACZC,YAAavD,IACbsD,OAAQ,QACRE,UAAW,oBArBVpB,GAAmB,EAAnBC,EAAmBoB,cAAnBtB,GAAmB,MAAnBK,EAAmBkB,QAAnBlB,EAAmBkB,oBAAnBtB,QAAAC","sources":["src/wiggle-gradient/canvas.ts","src/lib/assert.ts","src/wiggle-gradient/wiggle-gradient-main.ts"],"sourcesContent":["import { DebugDraw } from '../lib/DebugDraw';\n\nexport const canvasEl = document.createElement('canvas');\nexport const ctx = canvasEl.getContext('2d')!;\nexport const width = document.body.clientWidth;\nexport const height = document.body.clientHeight;\nexport const scale = window.devicePixelRatio;\n\ncanvasEl.width = width * scale;\ncanvasEl.height = height * scale;\ncanvasEl.style.width = `${width}px`;\ncanvasEl.style.height = `${height}px`;\nctx.scale(scale, scale);\nexport const canvas = new DebugDraw(ctx);\ndocument.body.appendChild(canvasEl);\n","export function fail(message: string): never {\n  throw new Error(message);\n}\n\nexport function assert(value: unknown, message?: string): asserts value {\n  if (!value) {\n    fail(message || 'Assertion Error');\n  }\n}\n","import { canvas, width, height } from './canvas';\nimport Vector2 from '../lib/geom/Vector2';\nimport {\n  sample,\n  times,\n  randomInt,\n  frameLoop,\n  uniq,\n  random,\n  lerp,\n  mapRange,\n} from '../lib/utils';\nimport createTriangleGrid, { Triangle } from '../lib/createTriangleGrid';\nimport { assert } from '../lib/assert';\n\nconst TILE_SIZE = 15;\nconst ARC_LENGTH = (Math.PI * TILE_SIZE) / 6;\n\nconst trianglesById = createTriangleGrid(TILE_SIZE, width, height);\n\nconst occupied = new Set<Triangle>();\ntype Snake = {\n  triangles: Array<Triangle>;\n};\n\nconst makeSnake = () => {\n  const triangles: Array<Triangle> = [];\n  let triangle = sample(\n    [...trianglesById.values()].filter(t => !occupied.has(t)),\n  );\n  // if (!triangle) return;\n\n  // const targetLength = mapRange(\n  //   Math.min(width, height) * 0.4,\n  //   0,\n  //   2,\n  //   35,\n  //   triangle.center.distanceTo(new Vector2(width / 2, height / 2)),\n  // );\n  const targetLength = 40;\n  let neighbours = [...trianglesById.values()];\n  for (let i = 0; i < targetLength; i++) {\n    triangles.push(triangle);\n    occupied.add(triangle);\n    neighbours = triangle.neighbours.map(n => n.triangle);\n\n    const availableNeighbours = neighbours.filter(\n      neighbour => !occupied.has(neighbour),\n    );\n    if (!availableNeighbours.length) break;\n    triangle = sample(availableNeighbours);\n  }\n\n  // if (triangles.length < 2) continue;\n  return {\n    triangles,\n  };\n};\nconst snakes: Snake[] = [];\n\nconst snakeCount = (width / TILE_SIZE) * (height / TILE_SIZE) * 0.01;\nconsole.log({ snakeCount });\nfor (let si = 0; si < snakeCount; si++) {\n  snakes.push(makeSnake());\n}\n\ncanvas.clear('black');\n\nfor (const { triangles } of snakes) {\n  canvas.beginPath();\n  for (let i = 0; i < triangles.length; i++) {\n    const triangle = triangles[i];\n    const last: Triangle | undefined = triangles[i - 1];\n    const next: Triangle | undefined = triangles[i + 1];\n\n    if (!last) {\n      canvas.moveTo(triangle.center);\n    } else if (!next) {\n      assert(last);\n      // canvas.moveTo(Vector2.average(getSharedPoints(triangle, last)));\n      canvas.lineTo(triangle.center);\n    } else {\n      // canvas.moveTo(Vector2.average(getSharedPoints(triangle, last)));\n      canvas.arcTo(triangle.center, next.center, TILE_SIZE / 2 - 0.5);\n    }\n  }\n  canvas.stroke({\n    strokeWidth: TILE_SIZE / 3 - 0.5,\n    stroke: 'white',\n    strokeCap: 'round',\n  });\n}\n"],"names":["$59b415c1c38c8df4$export$38c8a1558598a89e","document","createElement","$59b415c1c38c8df4$export$39f92e86d1722f3a","getContext","$59b415c1c38c8df4$export$7e3df82ee760448c","body","clientWidth","$59b415c1c38c8df4$export$ac607276a8fe9f0a","clientHeight","$59b415c1c38c8df4$export$dcdf75081b88279d","window","devicePixelRatio","width","height","style","concat","scale","$59b415c1c38c8df4$export$67ea982130081db","$aCcLp","DebugDraw","appendChild","$641a9c3625d3ec2b$export$a7a9523472993e97","value","message","Error","$641a9c3625d3ec2b$export$2b62a06a9fee979c","$e0ab833c3d1da741$var$TILE_SIZE","$e0ab833c3d1da741$var$trianglesById","Math","PI","$jRPAB","default","$e0ab833c3d1da741$var$occupied","Set","$e0ab833c3d1da741$var$makeSnake","triangles","triangle","$8qLe2","sample","$8TSCy","toConsumableArray","values","filter","t","has","i","push","add","availableNeighbours","neighbours","map","n","neighbour","length","$e0ab833c3d1da741$var$snakes","$e0ab833c3d1da741$var$snakeCount","console","log","snakeCount","si","clear","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","triangles1","beginPath","i1","triangle1","last","arcTo","center","lineTo","moveTo","stroke","strokeWidth","strokeCap","err","return"],"version":3,"file":"index.1d8344d5.js.map"}