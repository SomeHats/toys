import{r as o,a as R}from"./chunk_index.9ef61b8f.js";import{a as $}from"./chunk_theme.5443e31e.js";import{u as I,a as G,b as F}from"./chunk_client.5da2eee4.js";import{a as f,b as v,q as A,y,g as H,c as h}from"./chunk_assert.17fe3ff6.js";import{E}from"./chunk_EventEmitter.18fc68ab.js";import{R as C,V as L}from"./chunk_Vector2.d8fb1f00.js";import{c as P}from"./chunk_index.9d627959.js";import{a as _,j as m}from"./chunk_jsx-runtime.faf32752.js";function x(i,e){!i||(typeof i=="function"?i(e):i.current=e)}function O(i,e){return o.exports.useCallback(t=>{x(i,t),x(e,t)},[i,e])}let d=null,p=null;function q(){if(!p)return;const i=p;p=null,R.exports.unstable_batchedUpdates(()=>{for(const e of i)e.emit()})}function j(){f(d===null,"Assertion Error: pendingSyncInvalidations === null"),d=new Set}function S(){f(d,"Assertion Error: pendingSyncInvalidations");const i=d;d=null;for(const e of i)e.emit();d&&S()}function Q(){return!!d}let z=0;function W(i){return`unknown ${i} ${z++}`}class T{constructor(e,t){this.eagerInvalidation=new E,this.batchedInvalidation=new E,this.debugName=e!=null?e:W(t)}getDebugName(){return this.debugName}addEagerListener(e){return this.eagerInvalidation.listen(e)}addBatchListener(e){return this.batchedInvalidation.listen(e)}invalidate(){d?d.add(this.eagerInvalidation):this.eagerInvalidation.emit(),p||(p=new Set,queueMicrotask(q)),p.add(this.batchedInvalidation)}listenerCount(){return this.eagerInvalidation.listenerCount()+this.batchedInvalidation.listenerCount()}hasListeners(){return this.eagerInvalidation.hasListeners()||this.batchedInvalidation.hasListeners()}}let g=0;function Z(){g++}let r=null;function X(i,e,t){return r||j(),r={shouldTrack:!0,previousDependencies:i,nextDependencies:new Map,previous:r,invalidateListener:e,shouldListen:t},r}function J(i){if(f(r===i,"Assertion Error: computationContext === context"),r=r.previous,i.shouldTrack&&i.previousDependencies)for(const[e,{unsubscribe:t}]of i.previousDependencies)i.nextDependencies.has(e)||t==null||t();return i.nextDependencies}function w(){Q()&&!r&&S()}function V(i){var e,t,n;if(f(r,"cannot call .live() outside of a live context"),r.shouldTrack&&!r.nextDependencies.has(i)){const s=r.shouldListen?(n=(t=(e=r.previousDependencies)==null?void 0:e.get(i))==null?void 0:t.unsubscribe)!=null?n:i.addEagerInvalidateListener(r.invalidateListener):null,a=i.getOnce();r.nextDependencies.set(i,{value:a,unsubscribe:s})}}function K(i,e){for(const[t,{value:n}]of i)if(!Object.is(t.getOnce(),n))return!0;return!1}function Le(i){const e={shouldTrack:!1,previous:r};r=e;const t=i();return f(r===e,"Assertion Error: computationContext === nonTracking"),r=e.previous,t}class B{constructor(e,t,n){this.compute=e,this._isValid=!1,this.validForGlobalVersion=-1,this.dependencies=null,this.isComputing=!1,this.completion=null,this.invalidate=()=>{f(!this.isComputing,"cannot write whilst computing dependant live computation"),this._isValid&&(this._isValid=!1,this.invalidation.invalidate())},this.invalidation=new T(t,n)}getDebugName(){return this.invalidation.getDebugName()}computeIfNeeded(){if(this.isValid())return v(this.completion,"Assertion Error: this.completion");if(this.dependencies&&!K(this.dependencies,this.getDebugName()))return this.makeValidAt(g),v(this.completion,"Assertion Error: this.completion");const e=g,t=X(this.dependencies,this.invalidate,this.invalidation.hasListeners());this.isComputing=!0;let n;try{this.completion=C.ok(this.compute()),n=!0}catch(s){this.completion=C.error(s),n=!1}return this.isComputing=!1,this.dependencies=J(t),n?(this.makeValidAt(e),w(),this.computeIfNeeded()):w(),this.completion}isValid(){return this.invalidation.hasListeners()?this._isValid:this.validForGlobalVersion===g}makeValidAt(e){this._isValid=g===e,this.validForGlobalVersion=e}addEagerInvalidateListener(e){const t=this.invalidation.hasListeners(),n=this.invalidation.addEagerListener(e);return t||this.subscribeToDependencies(),()=>{n(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}addBatchInvalidateListener(e){const t=this.invalidation.hasListeners(),n=this.invalidation.addBatchListener(e);return t||this.subscribeToDependencies(),()=>{n(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}subscribeToDependencies(){if(this.isValid()&&this.dependencies)for(const[e,t]of this.dependencies)t.unsubscribe=e.addEagerInvalidateListener(this.invalidate);else this.computeIfNeeded()}unsubscribeFromDependencies(){var e;if(this.dependencies)for(const t of this.dependencies.values())(e=t.unsubscribe)==null||e.call(t),t.unsubscribe=null}}var k;const Y=(k=globalThis.requestIdleCallback)!=null?k:globalThis.requestAnimationFrame;var D;const ee=(D=globalThis.cancelIdleCallback)!=null?D:globalThis.cancelAnimationFrame;class b{constructor(e,t,n){this.schedule=t,this.cancelScheduledCallback=null,this.unsubscribe=null,this.invalidate=()=>{this.cancelScheduledCallback=this.schedule(this.recompute)},this.recompute=()=>{this.cancelScheduledCallback=null,this.computation.computeIfNeeded()},this.computation=new B(e,n,"LiveEffect"),this.cancelScheduledCallback=t(()=>{this.cancelScheduledCallback=null,this.unsubscribe=this.computation.addEagerInvalidateListener(this.invalidate)})}cancel(){var e,t;(e=this.cancelScheduledCallback)==null||e.call(this),(t=this.unsubscribe)==null||t.call(this)}}b.eager=i=>(i(),A);b.frame=i=>{const e=requestAnimationFrame(i);return()=>cancelAnimationFrame(e)};b.idle=i=>{const e=Y(i);return()=>ee(e)};class U{constructor(e,t,n="LiveMemo"){this.completion=null,this.computation=new B(e,t,n)}getDebugName(){return this.computation.getDebugName()}getOnce(){return this.completion=this.computation.computeIfNeeded(),this.completion.unwrap()}live(){return this.completion=this.computation.computeIfNeeded(),V(this),this.completion.unwrap()}addEagerInvalidateListener(e){return this.computation.addEagerInvalidateListener(e)}addBatchInvalidateListener(e){return this.computation.addBatchInvalidateListener(e)}}class ye extends U{constructor(e,t,n){super(e,n,"LiveMemoWritable"),this.write=t}update(e,...t){this.write(e,...t)}}class te{constructor(e,t){this.pendingUpdates=null,this.isUpdating=!1,this.wasRead=!0,this.value=e,this.invalidation=new T(t,"LiveValue")}getDebugName(){return this.invalidation.getDebugName()}markRead(){this.wasRead=!0}getOnce(){return this.markRead(),this.value}live(){return this.markRead(),V(this),this.value}update(e){if(this.isUpdating){this.pendingUpdates||(this.pendingUpdates=[]),this.pendingUpdates.push(e);return}this.isUpdating=!0;try{if(this.value=y(this.value,e),this.invalidate(),this.pendingUpdates)for(let t=0;t<this.pendingUpdates.length;t++)this.value=y(this.value,e),this.invalidate()}finally{this.pendingUpdates=null,this.isUpdating=!1}}invalidate(){this.wasRead&&(this.wasRead=!1,this.invalidation.invalidate(),Z())}addEagerInvalidateListener(e){return this.invalidation.addEagerListener(e)}addBatchInvalidateListener(e){return this.invalidation.addBatchListener(e)}getInvalidateListenerCount(){return this.invalidation.listenerCount()}}function ie(i){const e=o.exports.useRef(!0);e.current=!0;try{const t=o.exports.useSyncExternalStore(o.exports.useCallback(n=>i.addBatchInvalidateListener(n),[i]),()=>{if(e.current)return i.getOnce();try{return i.getOnce()}catch(n){return console.groupCollapsed("[useLiveValue caught error]"),console.log(n),console.groupEnd(),{}}});return o.exports.useDebugValue(t),t}finally{e.current=!1}}function ne(i,e){const n=o.exports.useMemo(()=>new U(i,void 0),e),s=ie(n);return o.exports.useDebugValue(s),s}function Ee(i,e){const t=new b(e,i);return()=>t.cancel}let se=1;class Ce{constructor(){this.activeAnimations=new te({},"vfx.activeAnimations")}triggerAnimation(e){this.activeAnimations.update(t=>({...t,[e]:se++}))}getActiveAnimationIdLive(e){var t;return(t=H(this.activeAnimations.live(),e))!=null?t:null}acknowledgeAnimation(e,t){this.activeAnimations.update(n=>{const{[e]:s,...a}=n;return s!==t?n:a})}}function ae(i,e,t){const n=o.exports.useRef(null),s=ne(()=>i.getActiveAnimationIdLive(e),[e,i]),a=I(t);return o.exports.useEffect(()=>{const c=n.current;if(!c||!s)return;const u=a(),l=c.animate(u.keyFrames,u);return l.addEventListener("finish",()=>{i.acknowledgeAnimation(e,s)}),l.play(),()=>{l.cancel()}},[s,a,e,i]),n}function re(i,e=1/0){var n;const t=(n=G(i,F))!=null?n:L.ZERO;return o.exports.useMemo(()=>{if(!t)return"none";const s=Math.min(t.x*.5,t.y*.5,e);return`path('${[`M 0,${s}`,`Q 0,0 ${s},0`,`T ${t.x-s},0`,`Q ${t.x},0 ${t.x},${s}`,`T ${t.x},${t.y-s}`,`Q ${t.x},${t.y} ${t.x-s},${t.y}`,`T ${s},${t.y}`,`Q 0,${t.y} 0,${t.y-s}`,"Z"].join(" ")}')`},[t,e])}const oe=o.exports.forwardRef(function({children:e,className:t,iconLeft:n,iconRight:s,...a},c){return _(ce,{className:P(t,"justify-center gap-2 px-4 py-1"),ref:c,...a,children:[n,m(le,{children:e}),s]})});function le({children:i}){return m("span",{className:"inline-block transition-transform duration-200 ease-out-back-md group-hover:scale-110 group-active:scale-95",children:i})}const ce=o.exports.forwardRef(function({className:e,style:t,...n},s){const[a,c]=o.exports.useState(null),u=re(a);return m("button",{ref:O(c,s),className:P("group inline-flex items-center rounded text-center font-bold tracking-wide text-stone-400 hover:bg-stone-300/25 hover:text-stone-500 focus:outline-none focus-visible:text-stone-600",e),style:{...t,clipPath:u},...n})});function xe({children:i,actionName:e,vfx:t,...n}){const s=ae(t,e,()=>({keyFrames:{transform:["scale(1)","scale(0.8)","scale(1)"]},duration:300,easing:$.outBackMd}));return m(oe,{...n,children:m("span",{className:"inline-block",ref:s,children:i})})}const de=10,M=A,N=()=>null;class ue{constructor({onTap:e=M,onDragStart:t=N}){this.state={type:"idle"},this.lastEvent=null,this.onTap=e,this.onDragStart=t}isGestureInProgress(){return this.state.type!=="idle"}onPointerDown(e,...t){var n,s;switch(this.lastEvent=e,this.state.type){case"idle":{const a=this.onDragStart(e,...t);if(!a)return;(n=a.couldBeTap)==null||n?this.state={type:"dragUnconfirmed",pointerId:e.pointerId,startPosition:L.fromEvent(e),dragHandler:a,args:t}:(this.state={type:"dragConfirmed",pointerId:e.pointerId,dragHandler:a},(s=a.onConfirm)==null||s.call(a,e));return}case"dragUnconfirmed":case"dragConfirmed":return;default:h(this.state)}}onPointerMove(e){var t,n;switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onMove(e),this.state.startPosition.distanceTo(L.fromEvent(e))>=de&&((n=(t=this.state.dragHandler).onConfirm)==null||n.call(t,e),this.state={type:"dragConfirmed",pointerId:this.state.pointerId,dragHandler:this.state.dragHandler});return;case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onMove(e);return;default:h(this.state)}}onPointerUp(e){switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onCancel(e),this.onTap(e,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onEnd(e),this.state={type:"idle"};return;default:h(this.state)}}onPointerCancel(e){switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onCancel(e),this.state={type:"idle"};return;default:h(this.state)}}cancel(){switch(this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":this.state.dragHandler.onCancel(v(this.lastEvent,"Assertion Error: this.lastEvent")),this.state={type:"idle"};return;default:h(this.state)}}end(){const e=v(this.lastEvent,"Assertion Error: this.lastEvent");switch(this.state.type){case"idle":return;case"dragUnconfirmed":this.state.dragHandler.onCancel(e),this.onTap(e,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":this.state.dragHandler.onEnd(e),this.state={type:"idle"};return;default:h(this.state)}}}function we(i){var c,u;const e=I((c=i.onTap)!=null?c:M),t=I((u=i.onDragStart)!=null?u:N),[n]=o.exports.useState(()=>new ue({onTap:e,onDragStart:t})),[s,a]=o.exports.useState(!1);return{isGestureInProgress:s,events:o.exports.useMemo(()=>({onPointerDown:l=>{n.onPointerDown(l),a(n.isGestureInProgress())},onPointerMove:l=>{n.onPointerMove(l),a(n.isGestureInProgress())},onPointerUp:l=>{n.onPointerUp(l),a(n.isGestureInProgress())},onPointerCancel:l=>{n.onPointerCancel(l),a(n.isGestureInProgress())}}),[n])}}export{xe as A,oe as B,ue as G,ye as L,ce as P,Ce as V,ne as a,te as b,Ee as c,b as d,ie as e,re as f,N as g,U as h,ae as i,Le as r,we as u};
