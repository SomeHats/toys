{"id":"DoRh","dependencies":[{"name":"/home/runner/work/toys/toys/tsconfig.json","includedInParent":true,"mtime":1594853935979},{"name":"/home/runner/work/toys/toys/package.json","includedInParent":true,"mtime":1594853935975},{"name":"../../lib/assert","loc":{"line":7,"column":23},"parent":"/home/runner/work/toys/toys/src/network/networkNodes/Intersection.ts","resolved":"/home/runner/work/toys/toys/src/lib/assert.ts"},{"name":"../../lib/geom/Vector2","loc":{"line":8,"column":40},"parent":"/home/runner/work/toys/toys/src/network/networkNodes/Intersection.ts","resolved":"/home/runner/work/toys/toys/src/lib/geom/Vector2.ts"},{"name":"../../lib/utils","loc":{"line":9,"column":22},"parent":"/home/runner/work/toys/toys/src/network/networkNodes/Intersection.ts","resolved":"/home/runner/work/toys/toys/src/lib/utils.ts"},{"name":"../ConnectionSet","loc":{"line":10,"column":46},"parent":"/home/runner/work/toys/toys/src/network/networkNodes/Intersection.ts","resolved":"/home/runner/work/toys/toys/src/network/ConnectionSet.ts"},{"name":"../PathFinder","loc":{"line":11,"column":43},"parent":"/home/runner/work/toys/toys/src/network/networkNodes/Intersection.ts","resolved":"/home/runner/work/toys/toys/src/network/PathFinder.ts"}],"generated":{"js":"\"use strict\";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,\"__esModule\",{value:!0});var t=require(\"../../lib/assert\"),n=e(require(\"../../lib/geom/Vector2\")),o=require(\"../../lib/utils\"),r=e(require(\"../ConnectionSet\")),i=e(require(\"../PathFinder\")),u=function(){function e(e,t){this.isDestination=!1,this._connectionSet=new r.default,this.position=new n.default(e,t)}return Object.defineProperty(e.prototype,\"incomingConnections\",{get:function(){return this._connectionSet.incoming},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"outgoingConnections\",{get:function(){return this._connectionSet.outgoing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"canConsumeTraveller\",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.consumeTraveller=function(e){var n=e.destination;t.assert(n,\"traveller must have destination\");var o=i.default.getNextRoad(this,n);t.assert(this.outgoingConnections.includes(o),\"nextRoad must be from this intersection\"),e.removeFromCurrentRoad(),o.addTravellerAtStart(e)},e.prototype.getAllReachableNodes=function(e){return void 0===e&&(e=new Set),e.add(this),o.uniq(o.flatten(this._connectionSet.outgoing.map(function(t){return t.getAllReachableNodes(e)})))},e.prototype.getVisualConnectionPointAtAngle=function(){return this.position},e.prototype.getClosestOutgoingTraveller=function(){var e=null,t=1/0;return this.outgoingConnections.forEach(function(n){var o=n.getTravellerAfterPosition(-1);o&&o.positionOnCurrentRoad<t&&(e=o,t=o.positionOnCurrentRoad)}),e},e.prototype.getClosestIncomingTraveller=function(){var e=null,t=1/0;return this.incomingConnections.forEach(function(n){var o=n.getTravellerBeforePosition(n.length);o&&o.distanceToEndOfCurrentRoad<t&&(e=o,t=o.distanceToEndOfCurrentRoad)}),e},e.prototype.connectTo=function(e,t){this._connectionSet.add(e,t)},e}();exports.default=u;"},"sourceMaps":{"js":{"mappings":[{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":0}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":13}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":17}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":19}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":25}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":30}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":47}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":56}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":59}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":66}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":69}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":71}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":82}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":84}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":85}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":93}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":97}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":104}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":119}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":127}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":140}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":141}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":148}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":152}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":156}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":158}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":166}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":186}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":188}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":190}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":198}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":225}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":227}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":235}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":1,"column":254}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":1,"column":256}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":1,"column":258}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":1,"column":266}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":1,"column":287}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":1,"column":289}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":1,"column":291}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":1,"column":299}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":317}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":319}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":17,"column":2},"generated":{"line":1,"column":330}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":17,"column":2},"generated":{"line":1,"column":339}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":17,"column":14},"generated":{"line":1,"column":341}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":1,"column":343}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":13,"column":2},"generated":{"line":1,"column":346}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":13,"column":2},"generated":{"line":1,"column":351}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":13,"column":18},"generated":{"line":1,"column":366}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":15,"column":2},"generated":{"line":1,"column":368}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":15,"column":2},"generated":{"line":1,"column":373}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":15,"column":34},"generated":{"line":1,"column":388}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":15,"column":38},"generated":{"line":1,"column":392}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":15,"column":38},"generated":{"line":1,"column":394}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":9},"generated":{"line":1,"column":402}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":9},"generated":{"line":1,"column":407}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":20},"generated":{"line":1,"column":416}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":24},"generated":{"line":1,"column":420}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":24},"generated":{"line":1,"column":422}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":32},"generated":{"line":1,"column":430}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":18,"column":35},"generated":{"line":1,"column":432}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":96,"column":0},"generated":{"line":1,"column":435}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":2},"generated":{"line":1,"column":442}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":2},"generated":{"line":1,"column":449}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":6},"generated":{"line":1,"column":464}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":6},"generated":{"line":1,"column":466}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":6},"generated":{"line":1,"column":476}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":25},"generated":{"line":1,"column":498}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":2},"generated":{"line":1,"column":499}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":2},"generated":{"line":1,"column":503}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":22,"column":11},"generated":{"line":1,"column":514}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":22,"column":11},"generated":{"line":1,"column":521}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":1,"column":526}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":22,"column":31},"generated":{"line":1,"column":541}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":25},"generated":{"line":1,"column":551}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":21,"column":25},"generated":{"line":1,"column":563}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":565}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":579}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":2},"generated":{"line":1,"column":583}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":2},"generated":{"line":1,"column":590}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":6},"generated":{"line":1,"column":605}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":6},"generated":{"line":1,"column":607}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":6},"generated":{"line":1,"column":617}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":25},"generated":{"line":1,"column":639}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":2},"generated":{"line":1,"column":640}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":2},"generated":{"line":1,"column":644}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":26,"column":11},"generated":{"line":1,"column":655}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":26,"column":11},"generated":{"line":1,"column":662}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":26,"column":16},"generated":{"line":1,"column":667}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":26,"column":31},"generated":{"line":1,"column":682}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":25},"generated":{"line":1,"column":692}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":25,"column":25},"generated":{"line":1,"column":704}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":706}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":720}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":2},"generated":{"line":1,"column":724}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":2},"generated":{"line":1,"column":731}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":6},"generated":{"line":1,"column":746}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":6},"generated":{"line":1,"column":748}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":6},"generated":{"line":1,"column":758}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":25},"generated":{"line":1,"column":780}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":2},"generated":{"line":1,"column":781}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":2},"generated":{"line":1,"column":785}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":30,"column":11},"generated":{"line":1,"column":796}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":30,"column":11},"generated":{"line":1,"column":803}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":25},"generated":{"line":1,"column":806}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":29,"column":25},"generated":{"line":1,"column":818}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":820}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":834}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":33,"column":2},"generated":{"line":1,"column":838}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":33,"column":2},"generated":{"line":1,"column":840}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":33,"column":2},"generated":{"line":1,"column":850}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":33,"column":2},"generated":{"line":1,"column":867}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":33,"column":19},"generated":{"line":1,"column":876}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":34,"column":10},"generated":{"line":1,"column":879}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":34,"column":10},"generated":{"line":1,"column":883}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":34,"column":24},"generated":{"line":1,"column":885}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":34,"column":34},"generated":{"line":1,"column":887}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":35,"column":4},"generated":{"line":1,"column":899}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":35,"column":4},"generated":{"line":1,"column":901}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":35,"column":11},"generated":{"line":1,"column":908}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":35,"column":24},"generated":{"line":1,"column":910}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":10},"generated":{"line":1,"column":945}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":10},"generated":{"line":1,"column":949}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":1,"column":951}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":1,"column":953}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":32},"generated":{"line":1,"column":961}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":44},"generated":{"line":1,"column":973}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":37,"column":50},"generated":{"line":1,"column":978}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":38,"column":4},"generated":{"line":1,"column":981}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":38,"column":4},"generated":{"line":1,"column":983}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":39,"column":6},"generated":{"line":1,"column":990}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":39,"column":11},"generated":{"line":1,"column":995}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":39,"column":31},"generated":{"line":1,"column":1015}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":39,"column":40},"generated":{"line":1,"column":1024}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":40,"column":6},"generated":{"line":1,"column":1027}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":43,"column":4},"generated":{"line":1,"column":1070}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":43,"column":14},"generated":{"line":1,"column":1072}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":44,"column":4},"generated":{"line":1,"column":1096}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":44,"column":13},"generated":{"line":1,"column":1098}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":44,"column":33},"generated":{"line":1,"column":1118}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":1122}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":1124}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":1134}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":1155}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":23},"generated":{"line":1,"column":1164}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":49,"column":11},"generated":{"line":1,"column":1167}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":23},"generated":{"line":1,"column":1179}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":23},"generated":{"line":1,"column":1183}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":23},"generated":{"line":1,"column":1187}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":23},"generated":{"line":1,"column":1189}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":47,"column":55},"generated":{"line":1,"column":1193}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":48,"column":4},"generated":{"line":1,"column":1198}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":48,"column":12},"generated":{"line":1,"column":1200}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":48,"column":16},"generated":{"line":1,"column":1204}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":49,"column":11},"generated":{"line":1,"column":1210}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":49,"column":11},"generated":{"line":1,"column":1212}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":1,"column":1217}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":1,"column":1219}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":51,"column":8},"generated":{"line":1,"column":1227}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":51,"column":13},"generated":{"line":1,"column":1232}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":51,"column":28},"generated":{"line":1,"column":1247}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":51,"column":37},"generated":{"line":1,"column":1256}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":51,"column":41},"generated":{"line":1,"column":1260}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":51,"column":41},"generated":{"line":1,"column":1269}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":52,"column":10},"generated":{"line":1,"column":1272}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":52,"column":10},"generated":{"line":1,"column":1279}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":52,"column":15},"generated":{"line":1,"column":1281}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":52,"column":36},"generated":{"line":1,"column":1302}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":58,"column":2},"generated":{"line":1,"column":1310}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":58,"column":2},"generated":{"line":1,"column":1312}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":58,"column":2},"generated":{"line":1,"column":1322}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":58,"column":2},"generated":{"line":1,"column":1354}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":59,"column":11},"generated":{"line":1,"column":1365}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":59,"column":11},"generated":{"line":1,"column":1372}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":59,"column":16},"generated":{"line":1,"column":1377}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":62,"column":2},"generated":{"line":1,"column":1387}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":62,"column":2},"generated":{"line":1,"column":1389}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":62,"column":2},"generated":{"line":1,"column":1399}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":62,"column":2},"generated":{"line":1,"column":1427}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":63,"column":8},"generated":{"line":1,"column":1438}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":63,"column":8},"generated":{"line":1,"column":1442}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":63,"column":24},"generated":{"line":1,"column":1444}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":64,"column":8},"generated":{"line":1,"column":1449}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":64,"column":27},"generated":{"line":1,"column":1451}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":64,"column":27},"generated":{"line":1,"column":1453}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":73,"column":11},"generated":{"line":1,"column":1455}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":65,"column":9},"generated":{"line":1,"column":1462}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":65,"column":9},"generated":{"line":1,"column":1467}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":65,"column":29},"generated":{"line":1,"column":1487}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":65,"column":37},"generated":{"line":1,"column":1495}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":65,"column":37},"generated":{"line":1,"column":1504}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":66,"column":12},"generated":{"line":1,"column":1507}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":66,"column":12},"generated":{"line":1,"column":1511}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":66,"column":24},"generated":{"line":1,"column":1513}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":66,"column":29},"generated":{"line":1,"column":1515}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":66,"column":56},"generated":{"line":1,"column":1542}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":67,"column":10},"generated":{"line":1,"column":1545}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":67,"column":23},"generated":{"line":1,"column":1548}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":67,"column":33},"generated":{"line":1,"column":1550}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":67,"column":57},"generated":{"line":1,"column":1572}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":68,"column":8},"generated":{"line":1,"column":1576}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":68,"column":24},"generated":{"line":1,"column":1578}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":69,"column":8},"generated":{"line":1,"column":1580}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":69,"column":27},"generated":{"line":1,"column":1582}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":69,"column":37},"generated":{"line":1,"column":1584}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":73,"column":11},"generated":{"line":1,"column":1609}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":76,"column":2},"generated":{"line":1,"column":1612}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":76,"column":2},"generated":{"line":1,"column":1614}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":76,"column":2},"generated":{"line":1,"column":1624}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":76,"column":2},"generated":{"line":1,"column":1652}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":77,"column":8},"generated":{"line":1,"column":1663}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":77,"column":8},"generated":{"line":1,"column":1667}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":77,"column":24},"generated":{"line":1,"column":1669}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":78,"column":8},"generated":{"line":1,"column":1674}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":78,"column":27},"generated":{"line":1,"column":1676}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":78,"column":27},"generated":{"line":1,"column":1678}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":90,"column":11},"generated":{"line":1,"column":1680}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":79,"column":9},"generated":{"line":1,"column":1687}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":79,"column":9},"generated":{"line":1,"column":1692}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":79,"column":29},"generated":{"line":1,"column":1712}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":79,"column":37},"generated":{"line":1,"column":1720}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":79,"column":37},"generated":{"line":1,"column":1729}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":80,"column":12},"generated":{"line":1,"column":1732}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":80,"column":12},"generated":{"line":1,"column":1736}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":80,"column":24},"generated":{"line":1,"column":1738}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":80,"column":29},"generated":{"line":1,"column":1740}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":80,"column":56},"generated":{"line":1,"column":1767}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":80,"column":61},"generated":{"line":1,"column":1769}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":82,"column":8},"generated":{"line":1,"column":1777}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":83,"column":8},"generated":{"line":1,"column":1780}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":83,"column":18},"generated":{"line":1,"column":1782}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":83,"column":47},"generated":{"line":1,"column":1809}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":85,"column":8},"generated":{"line":1,"column":1813}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":85,"column":24},"generated":{"line":1,"column":1815}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":86,"column":8},"generated":{"line":1,"column":1817}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":86,"column":27},"generated":{"line":1,"column":1819}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":86,"column":37},"generated":{"line":1,"column":1821}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":90,"column":11},"generated":{"line":1,"column":1851}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":93,"column":2},"generated":{"line":1,"column":1854}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":93,"column":2},"generated":{"line":1,"column":1856}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":93,"column":2},"generated":{"line":1,"column":1866}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":93,"column":2},"generated":{"line":1,"column":1876}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":93,"column":12},"generated":{"line":1,"column":1885}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":93,"column":24},"generated":{"line":1,"column":1887}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":94,"column":9},"generated":{"line":1,"column":1890}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":94,"column":9},"generated":{"line":1,"column":1895}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":94,"column":24},"generated":{"line":1,"column":1910}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":94,"column":28},"generated":{"line":1,"column":1914}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":94,"column":34},"generated":{"line":1,"column":1916}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":96,"column":0},"generated":{"line":1,"column":1920}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":1922}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":1925}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":1933}},{"source":"network/networkNodes/Intersection.ts","name":null,"original":{"line":12,"column":0},"generated":{"line":1,"column":1941}}],"sources":{"network/networkNodes/Intersection.ts":"// @flow\nimport { assert } from '../../lib/assert';\nimport Vector2 from '../../lib/geom/Vector2';\nimport { uniq, flatten } from '../../lib/utils';\nimport ConnectionSet from '../ConnectionSet';\nimport ConnectionDirection from '../ConnectionDirection';\nimport PathFinder from '../PathFinder';\nimport Road from '../Road';\nimport Traveller from '../Traveller';\nimport { NetworkNode } from './NetworkNode';\n\nexport default class Intersection implements NetworkNode {\n  isDestination = false;\n  position: Vector2;\n  _connectionSet: ConnectionSet = new ConnectionSet();\n\n  constructor(x: number, y: number) {\n    this.position = new Vector2(x, y);\n  }\n\n  get incomingConnections(): ReadonlyArray<Road> {\n    return this._connectionSet.incoming;\n  }\n\n  get outgoingConnections(): ReadonlyArray<Road> {\n    return this._connectionSet.outgoing;\n  }\n\n  get canConsumeTraveller(): boolean {\n    return true;\n  }\n\n  consumeTraveller(traveller: Traveller) {\n    const destination = traveller.destination;\n    assert(destination, 'traveller must have destination');\n\n    const nextRoad = PathFinder.getNextRoad(this, destination);\n    assert(\n      this.outgoingConnections.includes(nextRoad),\n      'nextRoad must be from this intersection',\n    );\n\n    traveller.removeFromCurrentRoad();\n    nextRoad.addTravellerAtStart(traveller);\n  }\n\n  getAllReachableNodes(visited: Set<NetworkNode> = new Set()): NetworkNode[] {\n    visited.add(this);\n    return uniq(\n      flatten(\n        this._connectionSet.outgoing.map(road =>\n          road.getAllReachableNodes(visited),\n        ),\n      ),\n    );\n  }\n\n  getVisualConnectionPointAtAngle(): Vector2 {\n    return this.position;\n  }\n\n  getClosestOutgoingTraveller(): Traveller | null {\n    let bestTraveller = null;\n    let shortestDistance = Infinity;\n    this.outgoingConnections.forEach(road => {\n      const traveller = road.getTravellerAfterPosition(-1);\n      if (traveller && traveller.positionOnCurrentRoad < shortestDistance) {\n        bestTraveller = traveller;\n        shortestDistance = traveller.positionOnCurrentRoad;\n      }\n    });\n\n    return bestTraveller;\n  }\n\n  getClosestIncomingTraveller(): Traveller | null {\n    let bestTraveller = null;\n    let shortestDistance = Infinity;\n    this.incomingConnections.forEach(road => {\n      const traveller = road.getTravellerBeforePosition(road.length);\n      if (\n        traveller &&\n        traveller.distanceToEndOfCurrentRoad < shortestDistance\n      ) {\n        bestTraveller = traveller;\n        shortestDistance = traveller.distanceToEndOfCurrentRoad;\n      }\n    });\n\n    return bestTraveller;\n  }\n\n  connectTo(node: Road, direction: ConnectionDirection) {\n    this._connectionSet.add(node, direction);\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"7cdd13659dfd52f1381eca184a022507","cacheData":{"env":{}}}