var En=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var R=(t,e,n)=>(En(t,e,"read from private field"),n?n.call(t):e.get(t)),ye=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},we=(t,e,n,r)=>(En(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);import{i as _t,t as be,s as Vr,P as Xt,k as Br,h as Sn,g as jn,a as O,Q as Se,b as X,l as Hn,f as Ye,q as Qt,R as _e,G as Ur,J as Kn,F as Ft,c as U,z as Wn,m as jr,e as Hr,S as Kr,T as Wr}from"./chunk_assert.773cf08f.js";/* empty css                       */import{a as Gr,r as d,R as L,b as it}from"./chunk_index.2e60a4fd.js";import{e as Rt,u as qr,a as Gn,b as Jr,f as zt,d as Ue,g as Ae,m as Yr,s as Zr,c as Xr}from"./chunk_theme.27c7fb9c.js";import{S as j,R as je,a as Qr,V as D}from"./chunk_Vector2.59035c21.js";import{A as ei}from"./chunk_AABB.e7b0a882.js";import{E as In}from"./chunk_EventEmitter.a49c476b.js";import{a as F,c as K,j as f,F as Q}from"./chunk_jsx-runtime.d8530191.js";import"./chunk__commonjsHelpers.e5e952e9.js";const en=300,ti=30,ni=500,Ze={size:16,streamline:.5,smoothing:.5,thinning:.5,simulatePressure:!0,easing:t=>t,start:{},end:{},last:!1},ri="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split("");class gt{constructor(e,n=16){this.randomLength=n,this.debugIdCounter=0,this.prefix=e,this.Id=`${e}.SAMPLE`;const r=new RegExp(`^${this.prefix}\\.([a-zA-Z0-9_]+)$`);this.schema=j.string.transform(i=>r.test(i)?je.ok(i):je.error(new Qr(`Expected ${this.prefix}.*, got ${i}`,[])),_t)}generate(){const e=be(this.randomLength,()=>Vr(ri)).join("");return`${this.prefix}.${e}`}}const We=new gt("key"),ii=j.object({id:We.schema,position:D.schema.nullable()}),Ge=new gt("shp"),oi=j.object({id:Ge.schema}),tn=new gt("shv"),si=j.object({id:tn.schema,keyPointId:We.schema,shapeId:Ge.schema,rawPoints:j.arrayOf(D.schema)}),qn=new gt("doc"),ai=j.object({id:qn.schema,keyPoints:j.objectMap(We.schema,ii),shapes:j.objectMap(Ge.schema,oi),shapeVersions:j.objectMap(tn.schema,si)});function li(){return{id:qn.generate(),keyPoints:{},shapes:{},shapeVersions:{}}}class ne{static fromArray(e){return new ne(Xt(e.map(n=>[n.id,n])))}constructor(e){this.data=e}count(){return Br(this.data).length}has(e){return Sn(this.data,e)}getIfExists(e){return jn(this.data,e)}get(e){const n=this.getIfExists(e);return O(n!=null,`Item with id ${e} not found`),n}insert(e){return new ne({...this.data,[e.id]:e})}update(e,n){const r=this.get(e),i=Se(r,n);return O(r.id===i.id,"Assertion Error: before.id === after.id"),this.insert(i)}delete(e){const{[e]:n,...r}=this.data;return new ne(r)}*[Symbol.iterator](){for(const e in this.data)Sn(this.data,e)&&(yield X(this.data[e]))}toJSON(){return this.data}}var pe,Le,Ve;const vt=class{constructor(e,n,r,i){ye(this,pe,void 0);ye(this,Le,void 0);ye(this,Ve,void 0);this.index=e,we(this,pe,n),we(this,Le,r),we(this,Ve,i)}static build(e,n,r,i){const o=new Map;for(const s of e){const a=n(s);O(!o.has(a),"Assertion Error: !index.has(key)"),o.set(a,r(s))}return new vt(o,n,r,i)}withIndex(e){return new vt(e,R(this,pe),R(this,Le),R(this,Ve))}lookup(e){return this.index.get(R(this,Ve).call(this,e))}insert(e){const n=R(this,pe).call(this,e);O(!this.index.has(n),`key ${n} already exists in index`);const r=new Map(this.index);return r.set(n,R(this,Le).call(this,e)),this.withIndex(r)}remove(e){const n=R(this,pe).call(this,e);O(this.index.has(n),`key ${n} does not exist in index`);const r=new Map(this.index);return r.delete(n),this.withIndex(r)}update(e){const n=R(this,pe).call(this,e);O(this.index.has(n),`key ${n} does not exist in index`);const r=new Map(this.index);return r.set(n,R(this,Le).call(this,e)),this.withIndex(r)}toJSON(){return Xt(this.index)}};let Vt=vt;pe=new WeakMap,Le=new WeakMap,Ve=new WeakMap;const ci=new Set;var Te,De,Be;const mt=class{constructor(e,n,r,i){ye(this,Te,void 0);ye(this,De,void 0);ye(this,Be,void 0);this.index=e,we(this,Te,n),we(this,De,r),we(this,Be,i)}static build(e,n,r,i){const o=new Map;for(const s of e){const a=n(s);let l=o.get(a);l||(l=new Set,o.set(a,l)),l.add(r(s))}return new mt(o,n,r,i)}withIndex(e){return new mt(e,R(this,Te),R(this,De),R(this,Be))}lookup(e){var n;return(n=this.index.get(R(this,Be).call(this,e)))!=null?n:ci}insert(e){const n=R(this,Te).call(this,e),r=R(this,De).call(this,e),i=this.index.get(n);let o;i?(O(!i.has(r),"already exists"),o=new Set(i)):o=new Set,o.add(r);const s=new Map(this.index);return s.set(n,o),this.withIndex(s)}remove(e){const n=R(this,Te).call(this,e),r=R(this,De).call(this,e),i=this.index.get(n);O(i&&i.has(r),"value does not exist"),new Set(i).delete(r);const s=new Map(this.index);return s.delete(n),this.withIndex(s)}update(e,n){return this.remove(e).insert(n)}toJSON(){return Xt(this.index)}};let at=mt;Te=new WeakMap,De=new WeakMap,Be=new WeakMap;const{min:Me,PI:fa}=Math,kn=.275;function Jn(t,e={}){const{size:n=16,smoothing:r=.5,thinning:i=.5,simulatePressure:o=!0,easing:s=g=>g,start:a={},end:l={}}=e,{easing:c=g=>g*(2-g)}=a,{easing:u=g=>--g*g*g+1}=l;if(t.length===0||n<=0)return[];const p=t[t.length-1].runningLength,v=a.taper===!1?0:a.taper===!0?Math.max(n,p):a.taper,y=l.taper===!1?0:l.taper===!0?Math.max(n,p):l.taper,h=Math.pow(n*r,2),m=[];let w=t.slice(0,10).reduce((g,E)=>{let I=E.pressure;if(o){const T=Me(1,E.distance/n),k=Me(1,1-T);I=Me(1,g+(k-g)*(T*kn))}return(g+I)/2},t[0].pressure),b=Cn(n,i,t[t.length-1].pressure,s),P=t[0].point,S=P;for(let g=0;g<t.length;g++){let{pressure:E}=t[g];const{point:I,distance:T,runningLength:k}=t[g];if(g<t.length-1&&p-k<3)continue;if(i){if(o){const N=Me(1,T/n),V=Me(1,1-N);E=Me(1,w+(V-w)*(N*kn))}b=Cn(n,i,E,s)}else b=n/2;const x=k<v?c(k/v):1,C=p-k<y?u((p-k)/y):1;if(b=Math.max(.01,b*Math.min(x,C)),g===t.length-1){m.push({center:I,radius:b});continue}S=I,(g<=1||P.distanceToSq(S)>h)&&(m.push({center:I,radius:b}),P=S),w=E}return m}function Yn(t,e={}){var v,y;const{streamline:n=.5,size:r=16,last:i=!1}=e;if(t.length===0)return[];const o=.15+(1-n)*.85;let s=t.map(h=>({point:D.fromVectorLike(h),pressure:h.pressure}));if(s.length===2){const h=s[1];s=s.slice(0,-1);for(let m=1;m<5;m++)s.push({point:s[0].point.lerp(h.point,m/4),pressure:h.pressure})}s.length===1&&s.push({point:s[0].point.add(D.UNIT),pressure:s[0].pressure});const a=[{point:s[0].point,pressure:s[0].pressure!=null&&s[0].pressure>=0?s[0].pressure:.25,vector:D.UNIT,distance:0,runningLength:0}];let l=!1,c=0,u=a[0];const p=s.length-1;for(let h=1;h<s.length;h++){const m=s[h],w=i&&h===p?m.point:u.point.lerp(m.point,o);if(u.point.equals(w))continue;const b=w.distanceTo(u.point);if(c+=b,h<p&&!l){if(c<r)continue;l=!0}u={point:w,pressure:m.pressure!=null&&m.pressure>=0?m.pressure:.5,vector:u.point.sub(w).normalize(),distance:b,runningLength:c},a.push(u)}return a[0].vector=(y=(v=a[1])==null?void 0:v.vector)!=null?y:D.ZERO,a}function Cn(t,e,n,r=i=>i){return t*r(.5-e*(.5-n))}function lt(t){if(!t.length)return"";const e=["M",t[0].x,t[0].y,"Q"];for(let n=0;n<t.length;n++){const r=t[n],i=t[(n+1)%t.length],o=r.add(i).scale(.5);e.push(r.x,r.y,o.x,o.y)}return e.push("Z"),e.join(" ")}function Zn(t,e){const n=[t[0]];if(t.length===0)return[];let r=e,i=t[0],o=t[0].center;for(let s=1;s<t.length;s++){const a=t[s],l=t[Math.min(s+1,t.length-1)],c=a.center.add(l.center).scale(.5),u=a.center.distanceTo(i.center),p=o,v=a.center,y=c;let h=0;for(;u-h>=r;){const m=(r+h)/u;n.push({center:p.lerp(v,m).lerp(v.lerp(y,m),m),radius:Hn(i.radius,a.radius,m)}),h+=r,r=e}r-=u-h,i=a,o=c}return n.push(t[t.length-1]),n}function It(t){var o,s;const e=Array.from(t);if(e.length===0)return{versions:new ne({})};const n=[];let r=0;for(const a of e){const l=Yn(a.rawPoints),c=(s=(o=l[l.length-1])==null?void 0:o.runningLength)!=null?s:0;n.push({id:a.id,strokePoints:l,length:c}),c>r&&(r=c)}const i=Math.floor(r/Ze.size);return{versions:ne.fromArray(n.map(({strokePoints:a,length:l,id:c})=>({id:c,length:l,normalizedCenterPoints:Zn(Jn(a,Ze),l/i)})))}}function ge(){}ge.prototype={diff:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.callback;typeof r=="function"&&(i=r,r={}),this.options=r;var o=this;function s(m){return i?(setTimeout(function(){i(void 0,m)},0),!0):m}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var a=n.length,l=e.length,c=1,u=a+l;r.maxEditLength&&(u=Math.min(u,r.maxEditLength));var p=[{newPos:-1,components:[]}],v=this.extractCommon(p[0],n,e,0);if(p[0].newPos+1>=a&&v+1>=l)return s([{value:this.join(n),count:n.length}]);function y(){for(var m=-1*c;m<=c;m+=2){var w=void 0,b=p[m-1],P=p[m+1],S=(P?P.newPos:0)-m;b&&(p[m-1]=void 0);var g=b&&b.newPos+1<a,E=P&&0<=S&&S<l;if(!g&&!E){p[m]=void 0;continue}if(!g||E&&b.newPos<P.newPos?(w=di(P),o.pushComponent(w.components,void 0,!0)):(w=b,w.newPos++,o.pushComponent(w.components,!0,void 0)),S=o.extractCommon(w,n,e,m),w.newPos+1>=a&&S+1>=l)return s(ui(o,w.components,n,e,o.useLongestToken));p[m]=w}c++}if(i)(function m(){setTimeout(function(){if(c>u)return i();y()||m()},0)})();else for(;c<=u;){var h=y();if(h)return h}},pushComponent:function(e,n,r){var i=e[e.length-1];i&&i.added===n&&i.removed===r?e[e.length-1]={count:i.count+1,added:n,removed:r}:e.push({count:1,added:n,removed:r})},extractCommon:function(e,n,r,i){for(var o=n.length,s=r.length,a=e.newPos,l=a-i,c=0;a+1<o&&l+1<s&&this.equals(n[a+1],r[l+1]);)a++,l++,c++;return c&&e.components.push({count:c}),e.newPos=a,l},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function ui(t,e,n,r,i){for(var o=0,s=e.length,a=0,l=0;o<s;o++){var c=e[o];if(c.removed){if(c.value=t.join(r.slice(l,l+c.count)),l+=c.count,o&&e[o-1].added){var p=e[o-1];e[o-1]=e[o],e[o]=p}}else{if(!c.added&&i){var u=n.slice(a,a+c.count);u=u.map(function(y,h){var m=r[l+h];return m.length>y.length?m:y}),c.value=t.join(u)}else c.value=t.join(n.slice(a,a+c.count));a+=c.count,c.added||(l+=c.count)}}var v=e[s-1];return s>1&&typeof v.value=="string"&&(v.added||v.removed)&&t.equals("",v.value)&&(e[s-2].value+=v.value,e.pop()),e}function di(t){return{newPos:t.newPos,components:t.components.slice(0)}}var Ln=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Tn=/\S/,Xn=new ge;Xn.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Tn.test(t)&&!Tn.test(e)};Xn.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<e.length-1;n++)!e[n+1]&&e[n+2]&&Ln.test(e[n])&&Ln.test(e[n+2])&&(e[n]+=e[n+2],e.splice(n+1,2),n--);return e};var Qn=new ge;Qn.tokenize=function(t){var e=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};var pi=new ge;pi.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var hi=new ge;hi.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function st(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?st=function(e){return typeof e}:st=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},st(t)}var fi=Object.prototype.toString,He=new ge;He.useLongestToken=!0;He.tokenize=Qn.tokenize;He.castInput=function(t){var e=this.options,n=e.undefinedReplacement,r=e.stringifyReplacer,i=r===void 0?function(o,s){return typeof s>"u"?n:s}:r;return typeof t=="string"?t:JSON.stringify(Bt(t,null,null,i),i,"  ")};He.equals=function(t,e){return ge.prototype.equals.call(He,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function vi(t,e,n){return He.diff(t,e,n)}function Bt(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(fi.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=Bt(t[o],e,n,r,i);return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),st(t)==="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)t.hasOwnProperty(l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=Bt(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var Ut=new ge;Ut.tokenize=function(t){return t.slice()};Ut.join=Ut.removeEmpty=function(t){return t};const Fe=class{constructor(t,e=0,n=!0){if(this.data=t,this.version=e,!n)return;const r=this.serialize(),i=Fe.deserialize(r,this.version);if(!Rt(this,i)){console.log({actual:this,expected:i});const o=JSON.stringify(this,null,2),s=JSON.stringify(i,null,2);for(const a of vi(o,s))console.log("CHANGE",a);Ye(`Mismatch after update:
Actual:
${JSON.stringify(this,null,2)}

Expected:
${JSON.stringify(i,null,2)}`)}}static create(){return Fe.deserialize(li())}static deserialize(t,e=0){const n=new ne(t.shapeVersions);return new Fe({id:t.id,keyPoints:new ne(t.keyPoints),shapes:new ne(t.shapes),shapeVersions:n,shapeVersionLookup:Vt.build(n,r=>`${r.shapeId}/${r.keyPointId}`,r=>r.id,([r,i])=>`${r}/${i}`),shapeVersionIdsByShape:at.build(n,r=>r.shapeId,r=>r.id,_t),shapeVersionIdsByKeyPoint:at.build(n,r=>r.keyPointId,r=>r.id,_t),normalizedShapeVersions:It(Array.from(n)).versions},e,!1)}with(t){return new Fe({...this.data,...t},this.version+1)}serialize(){return{id:this.data.id,keyPoints:this.data.keyPoints.data,shapes:this.data.shapes.data,shapeVersions:this.data.shapeVersions.data}}get shapes(){return this.data.shapes}get keyPoints(){return this.data.keyPoints}get shapeVersions(){return this.data.shapeVersions}getShapeVersion(t,e){const n=this.data.shapeVersionLookup.lookup([e,t]);return n?this.shapeVersions.get(n):null}getNormalizedCenterPointsForShapeVersion(t){return this.data.normalizedShapeVersions.get(t).normalizedCenterPoints}*iterateShapeVersionsForShape(t){for(const e of this.data.shapeVersionIdsByShape.lookup(t))yield this.shapeVersions.get(e)}addShape(t){console.log("doc.addShape",t);const e=this.shapes.insert({id:t});return this.with({shapes:e})}addKeyPoint(t,e){console.log("doc.addKeyPoint",t);const n=this.keyPoints.insert({id:t,position:e});return this.with({keyPoints:n})}updateKeyPoint(t,e){return this.with({keyPoints:this.keyPoints.update(t,e)})}replacePointsForVersion(t,e,n){const r=this.getShapeVersion(t,e);if(r){const s=this.shapeVersions.insert({...r,rawPoints:n});return this.with({shapeVersions:s,normalizedShapeVersions:It(s).versions})}const i={id:tn.generate(),keyPointId:t,shapeId:e,rawPoints:n},o=this.shapeVersions.insert(i);return this.with({shapeVersions:o,normalizedShapeVersions:It(o).versions,shapeVersionLookup:this.data.shapeVersionLookup.insert(i),shapeVersionIdsByShape:this.data.shapeVersionIdsByShape.insert(i),shapeVersionIdsByKeyPoint:this.data.shapeVersionIdsByKeyPoint.insert(i)})}};let nn=Fe;nn.schema=ai.transform(t=>je.ok(Fe.deserialize(t)),t=>t.serialize());var A=(t=>(t.Draw="draw",t.Rig="rig",t.Play="play",t))(A||{});const mi=j.enum(A);let ee=null,ze=null;function gi(){if(!ze)return;const t=ze;ze=null,Gr.exports.unstable_batchedUpdates(()=>{for(const e of t)e.emit()})}function yi(){O(ee===null,"Assertion Error: pendingSyncInvalidations === null"),ee=new Set}function er(){O(ee,"Assertion Error: pendingSyncInvalidations");const t=ee;ee=null;for(const e of t)e.emit();ee&&er()}function wi(){return!!ee}let xi=0;function bi(t){return`unknown ${t} ${xi++}`}class tr{constructor(e,n){this.eagerInvalidation=new In,this.batchedInvalidation=new In,this.debugName=e!=null?e:bi(n)}getDebugName(){return this.debugName}addEagerListener(e){return this.eagerInvalidation.listen(e)}addBatchListener(e){return this.batchedInvalidation.listen(e)}invalidate(){ee?ee.add(this.eagerInvalidation):this.eagerInvalidation.emit(),ze||(ze=new Set,queueMicrotask(gi)),ze.add(this.batchedInvalidation)}listenerCount(){return this.eagerInvalidation.listenerCount()+this.batchedInvalidation.listenerCount()}hasListeners(){return this.eagerInvalidation.hasListeners()||this.batchedInvalidation.hasListeners()}}let qe=0;function Pi(){qe++}let $=null;function Ei(t,e,n){return $||yi(),$={shouldTrack:!0,previousDependencies:t,nextDependencies:new Map,previous:$,invalidateListener:e,shouldListen:n},$}function Si(t){if(O($===t,"Assertion Error: computationContext === context"),$=$.previous,t.shouldTrack&&t.previousDependencies)for(const[e,{unsubscribe:n}]of t.previousDependencies)t.nextDependencies.has(e)||n==null||n();return t.nextDependencies}function Dn(){wi()&&!$&&er()}function nr(t){var e,n,r;if(O($,"cannot call .live() outside of a live context"),$.shouldTrack&&!$.nextDependencies.has(t)){const i=$.shouldListen?(r=(n=(e=$.previousDependencies)==null?void 0:e.get(t))==null?void 0:n.unsubscribe)!=null?r:t.addEagerInvalidateListener($.invalidateListener):null,o=t.getOnce();$.nextDependencies.set(t,{value:o,unsubscribe:i})}}function Ii(t,e){for(const[n,{value:r}]of t)if(!Object.is(n.getOnce(),r))return!0;return!1}function Qe(t){const e={shouldTrack:!1,previous:$};$=e;const n=t();return O($===e,"Assertion Error: computationContext === nonTracking"),$=e.previous,n}class rr{constructor(e,n,r){this.compute=e,this._isValid=!1,this.validForGlobalVersion=-1,this.dependencies=null,this.isComputing=!1,this.completion=null,this.invalidate=()=>{O(!this.isComputing,"cannot write whilst computing dependant live computation"),this._isValid&&(this._isValid=!1,this.invalidation.invalidate())},this.invalidation=new tr(n,r)}getDebugName(){return this.invalidation.getDebugName()}computeIfNeeded(){if(this.isValid())return X(this.completion);if(this.dependencies&&!Ii(this.dependencies,this.getDebugName()))return this.makeValidAt(qe),X(this.completion);const e=qe,n=Ei(this.dependencies,this.invalidate,this.invalidation.hasListeners());this.isComputing=!0;let r;try{this.completion=je.ok(this.compute()),r=!0}catch(i){this.completion=je.error(i),r=!1}return this.isComputing=!1,this.dependencies=Si(n),r?(this.makeValidAt(e),Dn(),this.computeIfNeeded()):Dn(),this.completion}isValid(){return this.invalidation.hasListeners()?this._isValid:this.validForGlobalVersion===qe}makeValidAt(e){this._isValid=qe===e,this.validForGlobalVersion=e}addEagerInvalidateListener(e){const n=this.invalidation.hasListeners(),r=this.invalidation.addEagerListener(e);return n||this.subscribeToDependencies(),()=>{r(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}addBatchInvalidateListener(e){const n=this.invalidation.hasListeners(),r=this.invalidation.addBatchListener(e);return n||this.subscribeToDependencies(),()=>{r(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}subscribeToDependencies(){if(this.isValid()&&this.dependencies)for(const[e,n]of this.dependencies)n.unsubscribe=e.addEagerInvalidateListener(this.invalidate);else this.computeIfNeeded()}unsubscribeFromDependencies(){var e;if(this.dependencies)for(const n of this.dependencies.values())(e=n.unsubscribe)==null||e.call(n),n.unsubscribe=null}}var Bn;const ki=(Bn=globalThis.requestIdleCallback)!=null?Bn:globalThis.requestAnimationFrame;var Un;const Ci=(Un=globalThis.cancelIdleCallback)!=null?Un:globalThis.cancelAnimationFrame;class me{constructor(e,n,r){this.schedule=n,this.cancelScheduledCallback=null,this.unsubscribe=null,this.invalidate=()=>{this.cancelScheduledCallback=this.schedule(this.recompute)},this.recompute=()=>{this.cancelScheduledCallback=null,this.computation.computeIfNeeded()},this.computation=new rr(e,r,"LiveEffect"),this.cancelScheduledCallback=n(()=>{this.cancelScheduledCallback=null,this.unsubscribe=this.computation.addEagerInvalidateListener(this.invalidate)})}cancel(){var e,n;(e=this.cancelScheduledCallback)==null||e.call(this),(n=this.unsubscribe)==null||n.call(this)}}me.eager=t=>(t(),Qt);me.frame=t=>{const e=requestAnimationFrame(t);return()=>cancelAnimationFrame(e)};me.idle=t=>{const e=ki(t);return()=>Ci(e)};class ct{constructor(e,n,r="LiveMemo"){this.completion=null,this.computation=new rr(e,n,r)}getDebugName(){return this.computation.getDebugName()}getOnce(){return this.completion=this.computation.computeIfNeeded(),this.completion.unwrap()}live(){return this.completion=this.computation.computeIfNeeded(),nr(this),this.completion.unwrap()}addEagerInvalidateListener(e){return this.computation.addEagerInvalidateListener(e)}addBatchInvalidateListener(e){return this.computation.addBatchInvalidateListener(e)}}class he extends ct{constructor(e,n,r){super(e,r,"LiveMemoWritable"),this.write=n}update(e,...n){this.write(e,...n)}}class W{constructor(e,n){this.pendingUpdates=null,this.isUpdating=!1,this.wasRead=!0,this.value=e,this.invalidation=new tr(n,"LiveValue")}getDebugName(){return this.invalidation.getDebugName()}markRead(){this.wasRead=!0}getOnce(){return this.markRead(),this.value}live(){return this.markRead(),nr(this),this.value}update(e){if(this.isUpdating){this.pendingUpdates||(this.pendingUpdates=[]),this.pendingUpdates.push(e);return}this.isUpdating=!0;try{if(this.value=Se(this.value,e),this.invalidate(),this.pendingUpdates)for(let n=0;n<this.pendingUpdates.length;n++)this.value=Se(this.value,e),this.invalidate()}finally{this.pendingUpdates=null,this.isUpdating=!1}}invalidate(){this.wasRead&&(this.wasRead=!1,this.invalidation.invalidate(),Pi())}addEagerInvalidateListener(e){return this.invalidation.addEagerListener(e)}addBatchInvalidateListener(e){return this.invalidation.addBatchListener(e)}getInvalidateListenerCount(){return this.invalidation.listenerCount()}}function ie(t){const e=d.exports.useRef(!0);e.current=!0;try{const n=d.exports.useSyncExternalStore(d.exports.useCallback(r=>t.addBatchInvalidateListener(r),[t]),()=>{if(e.current)return t.getOnce();try{return t.getOnce()}catch(r){return console.groupCollapsed("[useLiveValue caught error]"),console.log(r),console.groupEnd(),{}}});return d.exports.useDebugValue(n),n}finally{e.current=!1}}function H(t,e){const r=d.exports.useMemo(()=>new ct(t,void 0),e),i=ie(r);return d.exports.useDebugValue(i),i}function ut(t,e){const n=new me(e,t);return()=>n.cancel}const Li=j.object({pan:D.schema,zoom:j.number}),ir={initialize:()=>({pan:D.ZERO,zoom:1}),schema:Li};class Ti{constructor(e,n,r){this.screenSize=e,this.isSidebarOpen=n,this.state=r,this.pan=new he(()=>this.state.live().pan,i=>this.state.update(o=>_e(o,"pan",i))),this.zoom=new he(()=>this.state.live().zoom,i=>this.state.update(o=>_e(o,"zoom",i))),this.screenSize=e,this.isSidebarOpen=n}screenSizeWithSidebarOpenLive(){return this.screenSize.live().sub(new D(en,0))}canvasScreenSizeLive(){return this.isSidebarOpen.live()?this.screenSizeWithSidebarOpenLive():this.screenSize.live()}handleWheelEvent(e){e.preventDefault(),e.stopImmediatePropagation();const{deltaX:n,deltaY:r,ctrlKey:i}=e;this.state.update(({pan:o,zoom:s})=>{if(i){const a=D.fromEvent(e),l=Math.exp(-r/100)*s;return{pan:a.add(o).scale(l/s).sub(a),zoom:l}}else return{pan:o.add(new D(n,r)),zoom:s}})}originLive(){const{pan:e,zoom:n}=this.state.live();return e.sub(this.canvasScreenSizeLive().scale(.5*n))}visibleSceneBoundsLive(){return new ei(this.originLive(),this.canvasScreenSizeLive())}screenToSceneLive(e){return e.add(this.originLive()).scale(1/this.state.live().zoom)}sceneToScreenLive(e){return e.scale(this.state.live().zoom).sub(this.originLive())}eventSceneCoords(e){return Qe(()=>this.screenToSceneLive(D.fromEvent(e)))}getSceneTransformLive(){const e=this.originLive(),n=this.state.live().zoom;return`translate(${-e.x}px, ${-e.y}px) scale(${n}) `}}const Di=j.object({keyPointId:We.schema,shapeId:Ge.schema,viewport:ir.schema,mode:mi}),or={initialize:(t,e)=>({keyPointId:t,shapeId:e,mode:A.Draw,viewport:ir.initialize()}),schema:Di};class Ni{constructor(e){this.state=e,this.keyPointId=new he(()=>this.state.live().keyPointId,n=>this.state.update(r=>_e(r,"keyPointId",n))),this.shapeId=new he(()=>this.state.live().shapeId,n=>this.state.update(r=>_e(r,"shapeId",n))),this.mode=new he(()=>this.state.live().mode,n=>this.state.update(r=>_e(r,"mode",n))),this.viewportState=new he(()=>this.state.live().viewport,n=>this.state.update(r=>_e(r,"viewport",n)))}}const tt=j.object({document:nn.schema,location:or.schema});function Mi(t){return Ft(`splatapus.${t}`)?tt.parse(Ft(`splatapus.${t}`)).mapErr(n=>n.toString()):je.error("No saved data found")}function Oi(t,e){window.splatSerializedDoc=e,Kn(`splatapus.${t}`,tt.serialize(e))}const Ai=Ur(ni,Oi);function $i(t,e){const n=[...t.keyPoints][0].id,r=[...t.shapes][0].id;return or.initialize(n,r)}function sr(t){const e=We.generate(),n=Ge.generate(),r=nn.create().addKeyPoint(e,D.ZERO).addShape(n).replacePointsForVersion(e,n,[]);return{document:r,location:$i(r)}}const ar={[A.Draw]:{gradient500:"from-fuchsia-500 to-violet-500",border500:"border-purple-500",ring500:"ring-purple-500"},[A.Rig]:{gradient500:"from-cyan-500 to-blue-500",border500:"border-sky-500",ring500:"ring-sky-500"},[A.Play]:{gradient500:"from-lime-500 to-emerald-500",border500:"border-green-500",ring500:"ring-green-500"}};function _i(t){const e=H(()=>t.interaction.activeMode.live().type,[t]);return ar[e]}function Nn(t,e){!t||(typeof t=="function"?t(e):t.current=e)}function Fi(t,e){return d.exports.useCallback(n=>{Nn(t,n),Nn(e,n)},[t,e])}let Ri=1;class zi{constructor(){this.activeAnimations=new W({},"vfx.activeAnimations")}triggerAnimation(e){this.activeAnimations.update(n=>({...n,[e]:Ri++}))}getActiveAnimationIdLive(e){var n;return(n=jn(this.activeAnimations.live(),e))!=null?n:null}acknowledgeAnimation(e,n){this.activeAnimations.update(r=>{const{[e]:i,...o}=r;return i!==n?r:o})}}function jt(t,e,n){const r=d.exports.useRef(null),i=H(()=>t.getActiveAnimationIdLive(e),[e,t]),o=qr(n);return d.exports.useEffect(()=>{const s=r.current;if(!s||!i)return;const a=o(),l=s.animate(a.keyFrames,a);return l.addEventListener("finish",()=>{t.acknowledgeAnimation(e,i)}),l.play(),()=>{l.cancel()}},[i,o,e,t]),r}function lr(t,e=1/0){var r;const n=(r=Gn(t,Jr))!=null?r:D.ZERO;return d.exports.useMemo(()=>{if(!n)return"none";const i=Math.min(n.x*.5,n.y*.5,e);return`path('${[`M 0,${i}`,`Q 0,0 ${i},0`,`T ${n.x-i},0`,`Q ${n.x},0 ${n.x},${i}`,`T ${n.x},${n.y-i}`,`Q ${n.x},${n.y} ${n.x-i},${n.y}`,`T ${i},${n.y}`,`Q 0,${n.y} 0,${n.y-i}`,"Z"].join(" ")}')`},[n,e])}const oe=d.exports.forwardRef(function({children:e,className:n,iconLeft:r,iconRight:i,...o},s){return F(cr,{className:K(n,"justify-center gap-2 px-4 py-1"),ref:s,...o,children:[r,f(Vi,{children:e}),i]})});function Vi({children:t}){return f("span",{className:"inline-block transition-transform duration-200 ease-out-back-md group-hover:scale-110 group-active:scale-95",children:t})}const cr=d.exports.forwardRef(function({className:e,style:n,...r},i){const[o,s]=d.exports.useState(null),a=lr(o);return f("button",{ref:Fi(s,i),className:K("group inline-flex items-center rounded text-center font-bold tracking-wide text-stone-400 hover:bg-stone-300/25 hover:text-stone-500 focus:outline-none focus-visible:text-stone-600",e),style:{...n,clipPath:a},...r})});function Bi({children:t,actionName:e,vfx:n,...r}){const i=jt(n,e,()=>({keyFrames:{transform:["scale(1)","scale(0.8)","scale(1)"]},duration:300,easing:zt.outBackMd}));return f(oe,{...r,children:f("span",{className:"inline-block",ref:i,children:t})})}const Ui=L.memo(function({splatapus:e}){return F(Q,{children:[f(kt,{modeType:A.Draw,splatapus:e,children:"draw"}),f(kt,{modeType:A.Rig,splatapus:e,children:"rig"}),f(kt,{modeType:A.Play,splatapus:e,children:"play"})]})}),kt=function({modeType:e,splatapus:n,children:r}){const o=H(()=>n.interaction.activeMode.live().type,[n.interaction])===e;return f(Bi,{actionName:e,vfx:n.vfx,onClick:()=>{n.vfx.triggerAnimation(e),n.interaction.requestSetActiveMode(e)},className:K(o&&`pointer-events-none bg-gradient-to-br ${ar[e].gradient500} !text-white`),disabled:o,children:r})};class Xe{static distance(e,n){let r=0;for(let i=0;i<e.length;i++)r+=Math.pow(e[i]-n[i],2);return Math.sqrt(r)}static kernel(e,n){const r=Xe.distance(e,n);return r===0?0:Math.pow(r,2)*Math.log(r)}constructor(e,n){e.length===0&&Ye("bad centers array :/"),e.every(c=>c.length===e[0].length)||Ye("centers must have same dimensions :/"),this.centers=e;const r=n.slice(),i=[],o=[];for(let c=0;c<e.length;c++){const u=[],p=[1];for(let v=0;v<e[c].length;v++)p.push(e[c][v]);for(let v=0;v<e.length;v++)u.push(Xe.kernel(e[c],e[v]));o.push(p),i.push(u.concat(p))}const a=z.transpose(o).map(c=>{for(let u=c.length;u<i[0].length;u++)c.push(0);return c});for(let c=0;c<a.length;c++)i.push(a[c]),r.push(0);const l=this.solve(r,i);l||Ye("rbf failed to compile with given centers./nCenters must be unique :/"),this.ws=l}solve(e,n){const r=z.inverse(n);return r?z.multiplyVector(r,e):null}getValue(e){O(this.ws,"Assertion Error: this.ws");let n=0,r=0;for(r=0;r<this.centers.length;r++)n+=Number(this.ws[r])*Xe.kernel(e,this.centers[r]);for(n+=Number(this.ws[this.centers.length]),r=0;r<e.length;r++)n+=e[r]*Number(this.ws[this.centers.length+(r+1)]);return n}}const z={create(t){return t.map(e=>e.slice())},fromVector(t){return t.map(e=>[e])},identity(t){return be(t,e=>be(t,n=>e===n?1:0))},col(t,e){return t.map(n=>n[e-1])},clone(t){return t.slice()},canMultiplyFromLeft(t,e){return t[0].length===e.length},multiplyMatrix(t,e){if(!z.canMultiplyFromLeft(t,e))return null;const n=t[0].length;return be(t.length,r=>be(e[0].length,i=>{let o=0;for(let s=0;s<n;s++)o+=t[r][s]*e[s][i];return o}))},multiplyVector(t,e){return z.multiplyMatrix(t,z.fromVector(e))},transpose(t){return be(t[0].length,e=>be(t.length,n=>t[n][e]))},isSquare(t){return t.length===t[0].length},toRightTriangular(t){const e=z.clone(t),n=t.length,r=t[0].length;for(let i=0;i<n;i++){if(e[i][i]===0){for(let o=i+1;o<n;o++)if(e[o][i]!==0){const s=[];for(let a=0;a<r;a++)s.push(e[i][a]+e[o][a]);e[i]=s;break}}if(e[i][i]!==0)for(let o=i+1;o<n;o++){const s=e[o][i]/e[i][i],a=[];for(let l=0;l<r;l++)a.push(l<=i?0:e[o][l]-e[i][l]*s);e[o]=a}}return e},determinant(t){if(!z.isSquare(t))return null;const e=z.toRightTriangular(t);let n=e[0][0];for(let r=1;r<e.length;r++)n=n*e[r][r];return n},isSingular(t){return z.isSquare(t)&&z.determinant(t)===0},augment(t,e){const n=z.clone(t),r=n[0].length;O(n.length===e.length,"Assertion Error: result.length === other.length");for(let i=0;i<n.length;i++)for(let o=0;o<e[0].length;o++)n[i][r+o]=e[i][o];return n},inverse(t){if(!z.isSquare(t)||z.isSingular(t))return null;const e=t.length,n=[],r=z.toRightTriangular(z.augment(t,z.identity(e))),i=r[0].length;let o=t.length;for(;o--;){const s=[];n[o]=[];const a=r[o][o];for(let c=0;c<i;c++){const u=r[o][c]/a;s.push(u),c>=e&&n[o].push(u)}r[o]=s;let l=o;for(;l--;){const c=[];for(let u=0;u<i;u++)c.push(r[l][u]-r[o][u]*r[l][o]);r[l]=c}}return n}};class ji{interpolate(e){Ye("cannot interpolate none")}}class Hi{constructor(e){this.value=e}interpolate(e){return this.value}}class Ki{constructor(e,n,r,i){this.centerA=e,this.centerB=n,this.valueA=r,this.valueB=i}interpolate(e){const n=this.centerB.sub(this.centerA),i=e.sub(this.centerA).dot(n)/n.dot(n);return Hn(this.valueA,this.valueB,i)}}class Wi extends Xe{constructor(e,n){super(e.map(({x:r,y:i})=>[r,i]),n)}interpolate(e){return this.getValue([e.x,e.y])}}class Ct{constructor(e,n){switch(O(e.length===n.length,"Assertion Error: centers.length === values.length"),e.length){case 0:this.interpolator=new ji;break;case 1:this.interpolator=new Hi(n[0]);break;case 2:this.interpolator=new Ki(e[0],e[1],n[0],n[1]);break;default:this.interpolator=new Wi(e,n)}}interpolate(e){return this.interpolator.interpolate(e)}}class Gi{constructor(){this.cache=new Map}getCenterPointsAtPosition(e,n,r){switch(r.type){case"keyPointId":{const i=e.getShapeVersion(r.keyPointId,n);if(!i){const o=e.keyPoints.get(r.keyPointId);return o.position?this.getCenterPointsAtInterpolatedPosition(e,n,o.position):null}return e.getNormalizedCenterPointsForShapeVersion(i.id)}case"interpolated":return this.getCenterPointsAtInterpolatedPosition(e,n,r.scenePosition);default:U(r)}}getCenterPointsAtInterpolatedPosition(e,n,r){var c;const i=e.shapes.get(n),o=new Set(e.iterateShapeVersionsForShape(n));if(!o.size)return null;const s=new Set;for(const u of o)s.add(e.keyPoints.get(u.keyPointId));const a=this.getCacheEntry(i,o,s);let l;return a?l=a.interpolators:(l=this.calculateInterpolators(e,o),this.cache.set(i,{versions:o,keyPoints:s,interpolators:l})),(c=l==null?void 0:l.map(({x:u,y:p,r:v})=>({center:new D(u.interpolate(r),p.interpolate(r)),radius:v.interpolate(r)})))!=null?c:null}calculateInterpolators(e,n){console.time("calculatInterpolators");const r=Wn(Array.from(n,a=>{const l=e.keyPoints.get(a.keyPointId);return l.position?{normalizedCenterPoints:e.getNormalizedCenterPointsForShapeVersion(a.id),version:a,keyPointPosition:l.position}:null}));if(!r.length)return null;const i=r.map(({keyPointPosition:a})=>a),o=Math.min(...r.map(({normalizedCenterPoints:a})=>a.length));console.log({minLength:o,allNormalizedPoints:r});const s=[];for(let a=0;a<o;a++){const l=r.map(({normalizedCenterPoints:p})=>p[a].center.x),c=r.map(({normalizedCenterPoints:p})=>p[a].center.y),u=r.map(({normalizedCenterPoints:p})=>p[a].radius);s.push({x:new Ct(i,l),y:new Ct(i,c),r:new Ct(i,u)})}return console.timeEnd("calculatInterpolators"),s}getCacheEntry(e,n,r){const i=this.cache.get(e);if(!i||n.size!==i.versions.size||r.size!==i.keyPoints.size)return null;for(const o of n)if(!i.versions.has(o))return null;for(const o of r)if(!i.keyPoints.has(o))return null;return i}}const ur=new Gi;function dt(t){const e=[],n=[];if(t.length===0)return[];if(t.length===1){const p=[];for(let v=0;v<12;v++)p.push(t[0].center.add(D.fromPolar(v*Math.PI/6,t[0].radius)));return p}const r=t[0],o=t[1].center.sub(r.center).normalize(),s=o.perpendicular().scale(r.radius);e.push(r.center.sub(o.scale(r.radius))),e.push(r.center.sub(s)),n.push(r.center.add(s));for(let p=1;p<t.length-1;p++){const v=t[p-1],y=t[p],w=t[p+1].center.sub(v.center).normalize().perpendicular().scale(y.radius);e.push(y.center.sub(w)),n.push(y.center.add(w))}const a=t[t.length-2],l=t[t.length-1],c=l.center.sub(a.center).normalize(),u=c.perpendicular().scale(l.radius);return e.push(l.center.sub(u)),e.push(l.center.add(c.scale(l.radius))),n.push(l.center.add(u)),e.concat(n.reverse())}function qi(t){return lt(dt(t))}const dr=typeof window>"u"||typeof document>"u";let se=dr?d.exports.useEffect:d.exports.useLayoutEffect;function re(t){let e=d.exports.useRef(t);return se(()=>{e.current=t},[t]),e}function Ji(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function yt(){let t=[],e=[],n={enqueue(r){e.push(r)},addEventListener(r,i,o,s){return r.addEventListener(i,o,s),n.add(()=>r.removeEventListener(i,o,s))},requestAnimationFrame(...r){let i=requestAnimationFrame(...r);return n.add(()=>cancelAnimationFrame(i))},nextFrame(...r){return n.requestAnimationFrame(()=>n.requestAnimationFrame(...r))},setTimeout(...r){let i=setTimeout(...r);return n.add(()=>clearTimeout(i))},microTask(...r){let i={current:!0};return Ji(()=>{i.current&&r[0]()}),n.add(()=>{i.current=!1})},add(r){return t.push(r),()=>{let i=t.indexOf(r);if(i>=0){let[o]=t.splice(i,1);o()}}},dispose(){for(let r of t.splice(0))r()},async workQueue(){for(let r of e.splice(0))await r()}};return n}function pr(){let[t]=d.exports.useState(yt);return d.exports.useEffect(()=>()=>t.dispose(),[t]),t}let M=function(t){let e=re(t);return L.useCallback((...n)=>e.current(...n),[e])},Lt={serverHandoffComplete:!1};function rn(){let[t,e]=d.exports.useState(Lt.serverHandoffComplete);return d.exports.useEffect(()=>{t!==!0&&e(!0)},[t]),d.exports.useEffect(()=>{Lt.serverHandoffComplete===!1&&(Lt.serverHandoffComplete=!0)},[]),t}var Mn;let Yi=0;function On(){return++Yi}let ae=(Mn=L.useId)!=null?Mn:function(){let t=rn(),[e,n]=L.useState(t?On:null);return se(()=>{e===null&&n(On())},[e]),e!=null?""+e:void 0};function _(t,e,...n){if(t in e){let i=e[t];return typeof i=="function"?i(...n):i}let r=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,_),r}function on(t){return dr?null:t instanceof Node?t.ownerDocument:t!=null&&t.hasOwnProperty("current")&&t.current instanceof Node?t.current.ownerDocument:document}let Ht=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var Ie=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t))(Ie||{}),Zi=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(Zi||{}),Xi=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(Xi||{});function hr(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Ht))}var sn=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(sn||{});function fr(t,e=0){var n;return t===((n=on(t))==null?void 0:n.body)?!1:_(e,{[0](){return t.matches(Ht)},[1](){let r=t;for(;r!==null;){if(r.matches(Ht))return!0;r=r.parentElement}return!1}})}let Qi=["textarea","input"].join(",");function eo(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,Qi))!=null?n:!1}function to(t,e=n=>n){return t.slice().sort((n,r)=>{let i=e(n),o=e(r);if(i===null||o===null)return 0;let s=i.compareDocumentPosition(o);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Re(t,e,n=!0,r=null){let i=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,o=Array.isArray(t)?n?to(t):t:hr(t);r=r!=null?r:i.activeElement;let s=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),a=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(r))-1;if(e&4)return Math.max(0,o.indexOf(r))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=e&32?{preventScroll:!0}:{},c=0,u=o.length,p;do{if(c>=u||c+u<=0)return 0;let v=a+c;if(e&16)v=(v+u)%u;else{if(v<0)return 3;if(v>=u)return 1}p=o[v],p==null||p.focus(l),c+=s}while(p!==i.activeElement);return e&6&&eo(p)&&p.select(),p.hasAttribute("tabindex")||p.setAttribute("tabindex","0"),2}function Tt(t,e,n){let r=re(e);d.exports.useEffect(()=>{function i(o){r.current(o)}return document.addEventListener(t,i,n),()=>document.removeEventListener(t,i,n)},[t,n])}function no(t,e,n=!0){let r=d.exports.useRef(!1);d.exports.useEffect(()=>{requestAnimationFrame(()=>{r.current=n})},[n]);function i(s,a){if(!r.current||s.defaultPrevented)return;let l=function u(p){return typeof p=="function"?u(p()):Array.isArray(p)||p instanceof Set?p:[p]}(t),c=a(s);if(c!==null&&!!c.ownerDocument.documentElement.contains(c)){for(let u of l){if(u===null)continue;let p=u instanceof HTMLElement?u:u.current;if(p!=null&&p.contains(c))return}return!fr(c,sn.Loose)&&c.tabIndex!==-1&&s.preventDefault(),e(s,c)}}let o=d.exports.useRef(null);Tt("mousedown",s=>{r.current&&(o.current=s.target)},!0),Tt("click",s=>{!o.current||(i(s,()=>o.current),o.current=null)},!0),Tt("blur",s=>i(s,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function An(t){var e;if(t.type)return t.type;let n=(e=t.as)!=null?e:"button";if(typeof n=="string"&&n.toLowerCase()==="button")return"button"}function vr(t,e){let[n,r]=d.exports.useState(()=>An(t));return se(()=>{r(An(t))},[t.type,t.as]),se(()=>{n||!e.current||e.current instanceof HTMLButtonElement&&!e.current.hasAttribute("type")&&r("button")},[n,e]),n}let mr=Symbol();function ro(t,e=!0){return Object.assign(t,{[mr]:e})}function Y(...t){let e=d.exports.useRef(t);d.exports.useEffect(()=>{e.current=t},[t]);let n=M(r=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(r):i.current=r)});return t.every(r=>r==null||(r==null?void 0:r[mr]))?void 0:n}var Ke=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Ke||{}),te=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(te||{});function q({ourProps:t,theirProps:e,slot:n,defaultTag:r,features:i,visible:o=!0,name:s}){let a=gr(e,t);if(o)return ot(a,n,r,s);let l=i!=null?i:0;if(l&2){let{static:c=!1,...u}=a;if(c)return ot(u,n,r,s)}if(l&1){let{unmount:c=!0,...u}=a;return _(c?0:1,{[0](){return null},[1](){return ot({...u,hidden:!0,style:{display:"none"}},n,r,s)}})}return ot(a,n,r,s)}function ot(t,e={},n,r){let{as:i=n,children:o,refName:s="ref",...a}=Dt(t,["unmount","static"]),l=t.ref!==void 0?{[s]:t.ref}:{},c=typeof o=="function"?o(e):o;a.className&&typeof a.className=="function"&&(a.className=a.className(e));let u={};if(e){let p=!1,v=[];for(let[y,h]of Object.entries(e))typeof h=="boolean"&&(p=!0),h===!0&&v.push(y);p&&(u["data-headlessui-state"]=v.join(" "))}if(i===d.exports.Fragment&&Object.keys(Kt(a)).length>0){if(!d.exports.isValidElement(c)||Array.isArray(c)&&c.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(a).map(p=>`  - ${p}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(p=>`  - ${p}`).join(`
`)].join(`
`));return d.exports.cloneElement(c,Object.assign({},gr(c.props,Kt(Dt(a,["ref"]))),u,l,io(c.ref,l.ref)))}return d.exports.createElement(i,Object.assign({},Dt(a,["ref"]),i!==d.exports.Fragment&&l,i!==d.exports.Fragment&&u),c)}function io(...t){return{ref:t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}}function gr(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(n[i]!=null||(n[i]=[]),n[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(n).map(r=>[r,void 0])));for(let r in n)Object.assign(e,{[r](i,...o){let s=n[r];for(let a of s){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;a(i,...o)}}});return e}function J(t){var e;return Object.assign(d.exports.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Kt(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Dt(t,e=[]){let n=Object.assign({},t);for(let r of e)r in n&&delete n[r];return n}function an(t){let e=t.parentElement,n=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(n=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&oo(n)?!1:r}function oo(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}function so(t){var e;let n=(e=t==null?void 0:t.form)!=null?e:t.closest("form");if(n){for(let r of n.elements)if(r.tagName==="INPUT"&&r.type==="submit"||r.tagName==="BUTTON"&&r.type==="submit"||r.nodeName==="INPUT"&&r.type==="image"){r.click();return}}}let ao="div";var et=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(et||{});let pt=J(function(t,e){let{features:n=1,...r}=t,i={ref:e,"aria-hidden":(n&2)===2?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return q({ourProps:i,theirProps:r,slot:{},defaultTag:ao,name:"Hidden"})}),ln=d.exports.createContext(null);ln.displayName="OpenClosedContext";var le=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(le||{});function wt(){return d.exports.useContext(ln)}function yr({value:t,children:e}){return L.createElement(ln.Provider,{value:t},e)}var Z=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Z||{});function lo(t,e,n){let[r,i]=d.exports.useState(n),o=t!==void 0;return[o?t:r,M(s=>(o||i(s),e==null?void 0:e(s)))]}function co(t,e,n){let r=re(e);d.exports.useEffect(()=>{function i(o){r.current(o)}return window.addEventListener(t,i,n),()=>window.removeEventListener(t,i,n)},[t,n])}var ke=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(ke||{});function wr(){let t=d.exports.useRef(0);return co("keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function xr(){let t=d.exports.useRef(!1);return se(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function cn(...t){return d.exports.useMemo(()=>on(...t),[...t])}function uo(t,e,n,r){let i=re(n);d.exports.useEffect(()=>{t=t!=null?t:window;function o(s){i.current(s)}return t.addEventListener(e,o,r),()=>t.removeEventListener(e,o,r)},[t,e,r])}let br=d.exports.createContext(null);function Pr(){let t=d.exports.useContext(br);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Pr),e}return t}function po(){let[t,e]=d.exports.useState([]);return[t.length>0?t.join(" "):void 0,d.exports.useMemo(()=>function(n){let r=M(o=>(e(s=>[...s,o]),()=>e(s=>{let a=s.slice(),l=a.indexOf(o);return l!==-1&&a.splice(l,1),a}))),i=d.exports.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props}),[r,n.slot,n.name,n.props]);return L.createElement(br.Provider,{value:i},n.children)},[e])]}let ho="p",fo=J(function(t,e){let n=Pr(),r=`headlessui-description-${ae()}`,i=Y(e);se(()=>n.register(r),[r,n.register]);let o=t,s={ref:i,...n.props,id:r};return q({ourProps:s,theirProps:o,slot:n.slot||{},defaultTag:ho,name:n.name||"Description"})});var vo=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(vo||{}),mo=(t=>(t[t.TogglePopover=0]="TogglePopover",t[t.ClosePopover=1]="ClosePopover",t[t.SetButton=2]="SetButton",t[t.SetButtonId=3]="SetButtonId",t[t.SetPanel=4]="SetPanel",t[t.SetPanelId=5]="SetPanelId",t))(mo||{});let go={[0]:t=>({...t,popoverState:_(t.popoverState,{[0]:1,[1]:0})}),[1](t){return t.popoverState===1?t:{...t,popoverState:1}},[2](t,e){return t.button===e.button?t:{...t,button:e.button}},[3](t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},[4](t,e){return t.panel===e.panel?t:{...t,panel:e.panel}},[5](t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}}},un=d.exports.createContext(null);un.displayName="PopoverContext";function xt(t){let e=d.exports.useContext(un);if(e===null){let n=new Error(`<${t} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,xt),n}return e}let dn=d.exports.createContext(null);dn.displayName="PopoverAPIContext";function pn(t){let e=d.exports.useContext(dn);if(e===null){let n=new Error(`<${t} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,pn),n}return e}let hn=d.exports.createContext(null);hn.displayName="PopoverGroupContext";function Er(){return d.exports.useContext(hn)}let fn=d.exports.createContext(null);fn.displayName="PopoverPanelContext";function yo(){return d.exports.useContext(fn)}function wo(t,e){return _(e.type,go,t,e)}let xo="div",bo=J(function(t,e){var n;let r=`headlessui-popover-button-${ae()}`,i=`headlessui-popover-panel-${ae()}`,o=d.exports.useRef(null),s=Y(e,ro(x=>{o.current=x})),a=d.exports.useReducer(wo,{popoverState:1,button:null,buttonId:r,panel:null,panelId:i,beforePanelSentinel:d.exports.createRef(),afterPanelSentinel:d.exports.createRef()}),[{popoverState:l,button:c,panel:u,beforePanelSentinel:p,afterPanelSentinel:v},y]=a,h=cn((n=o.current)!=null?n:c);d.exports.useEffect(()=>y({type:3,buttonId:r}),[r,y]),d.exports.useEffect(()=>y({type:5,panelId:i}),[i,y]);let m=d.exports.useMemo(()=>{if(!c||!u)return!1;for(let x of document.querySelectorAll("body > *"))if(Number(x==null?void 0:x.contains(c))^Number(x==null?void 0:x.contains(u)))return!0;return!1},[c,u]),w=d.exports.useMemo(()=>({buttonId:r,panelId:i,close:()=>y({type:1})}),[r,i,y]),b=Er(),P=b==null?void 0:b.registerPopover,S=M(()=>{var x;return(x=b==null?void 0:b.isFocusWithinPopoverGroup())!=null?x:(h==null?void 0:h.activeElement)&&((c==null?void 0:c.contains(h.activeElement))||(u==null?void 0:u.contains(h.activeElement)))});d.exports.useEffect(()=>P==null?void 0:P(w),[P,w]),uo(h==null?void 0:h.defaultView,"focus",x=>{var C,N,V,B;l===0&&(S()||!c||!u||(N=(C=p.current)==null?void 0:C.contains)!=null&&N.call(C,x.target)||(B=(V=v.current)==null?void 0:V.contains)!=null&&B.call(V,x.target)||y({type:1}))},!0),no([c,u],(x,C)=>{y({type:1}),fr(C,sn.Loose)||(x.preventDefault(),c==null||c.focus())},l===0);let g=M(x=>{y({type:1});let C=(()=>x?x instanceof HTMLElement?x:"current"in x&&x.current instanceof HTMLElement?x.current:c:c)();C==null||C.focus()}),E=d.exports.useMemo(()=>({close:g,isPortalled:m}),[g,m]),I=d.exports.useMemo(()=>({open:l===0,close:g}),[l,g]),T=t,k={ref:s};return L.createElement(un.Provider,{value:a},L.createElement(dn.Provider,{value:E},L.createElement(yr,{value:_(l,{[0]:le.Open,[1]:le.Closed})},q({ourProps:k,theirProps:T,slot:I,defaultTag:xo,name:"Popover"}))))}),Po="button",Eo=J(function(t,e){let[n,r]=xt("Popover.Button"),{isPortalled:i}=pn("Popover.Button"),o=d.exports.useRef(null),s=`headlessui-focus-sentinel-${ae()}`,a=Er(),l=a==null?void 0:a.closeOthers,c=yo(),u=c===null?!1:c===n.panelId,p=Y(o,e,u?null:x=>r({type:2,button:x})),v=Y(o,e),y=cn(o),h=M(x=>{var C,N,V;if(u){if(n.popoverState===1)return;switch(x.key){case Z.Space:case Z.Enter:x.preventDefault(),(N=(C=x.target).click)==null||N.call(C),r({type:1}),(V=n.button)==null||V.focus();break}}else switch(x.key){case Z.Space:case Z.Enter:x.preventDefault(),x.stopPropagation(),n.popoverState===1&&(l==null||l(n.buttonId)),r({type:0});break;case Z.Escape:if(n.popoverState!==0)return l==null?void 0:l(n.buttonId);if(!o.current||(y==null?void 0:y.activeElement)&&!o.current.contains(y.activeElement))return;x.preventDefault(),x.stopPropagation(),r({type:1});break}}),m=M(x=>{u||x.key===Z.Space&&x.preventDefault()}),w=M(x=>{var C,N;an(x.currentTarget)||t.disabled||(u?(r({type:1}),(C=n.button)==null||C.focus()):(x.preventDefault(),x.stopPropagation(),n.popoverState===1&&(l==null||l(n.buttonId)),r({type:0}),(N=n.button)==null||N.focus()))}),b=M(x=>{x.preventDefault(),x.stopPropagation()}),P=n.popoverState===0,S=d.exports.useMemo(()=>({open:P}),[P]),g=vr(t,o),E=t,I=u?{ref:v,type:g,onKeyDown:h,onClick:w}:{ref:p,id:n.buttonId,type:g,"aria-expanded":t.disabled?void 0:n.popoverState===0,"aria-controls":n.panel?n.panelId:void 0,onKeyDown:h,onKeyUp:m,onClick:w,onMouseDown:b},T=wr(),k=M(()=>{let x=n.panel;if(!x)return;function C(){_(T.current,{[ke.Forwards]:()=>Re(x,Ie.First),[ke.Backwards]:()=>Re(x,Ie.Last)})}C()});return F(Q,{children:[q({ourProps:I,theirProps:E,slot:S,defaultTag:Po,name:"Popover.Button"}),P&&!u&&i&&f(pt,{id:s,features:et.Focusable,as:"button",type:"button",onFocus:k})]})}),So="div",Io=Ke.RenderStrategy|Ke.Static,ko=J(function(t,e){let[{popoverState:n},r]=xt("Popover.Overlay"),i=Y(e),o=`headlessui-popover-overlay-${ae()}`,s=wt(),a=(()=>s!==null?s===le.Open:n===0)(),l=M(u=>{if(an(u.currentTarget))return u.preventDefault();r({type:1})}),c=d.exports.useMemo(()=>({open:n===0}),[n]);return q({ourProps:{ref:i,id:o,"aria-hidden":!0,onClick:l},theirProps:t,slot:c,defaultTag:So,features:Io,visible:a,name:"Popover.Overlay"})}),Co="div",Lo=Ke.RenderStrategy|Ke.Static,To=J(function(t,e){let{focus:n=!1,...r}=t,[i,o]=xt("Popover.Panel"),{close:s,isPortalled:a}=pn("Popover.Panel"),l=`headlessui-focus-sentinel-before-${ae()}`,c=`headlessui-focus-sentinel-after-${ae()}`,u=d.exports.useRef(null),p=Y(u,e,E=>{o({type:4,panel:E})}),v=cn(u),y=wt(),h=(()=>y!==null?y===le.Open:i.popoverState===0)(),m=M(E=>{var I;switch(E.key){case Z.Escape:if(i.popoverState!==0||!u.current||(v==null?void 0:v.activeElement)&&!u.current.contains(v.activeElement))return;E.preventDefault(),E.stopPropagation(),o({type:1}),(I=i.button)==null||I.focus();break}});d.exports.useEffect(()=>{var E;t.static||i.popoverState===1&&((E=t.unmount)!=null?E:!0)&&o({type:4,panel:null})},[i.popoverState,t.unmount,t.static,o]),d.exports.useEffect(()=>{if(!n||i.popoverState!==0||!u.current)return;let E=v==null?void 0:v.activeElement;u.current.contains(E)||Re(u.current,Ie.First)},[n,u,i.popoverState]);let w=d.exports.useMemo(()=>({open:i.popoverState===0,close:s}),[i,s]),b={ref:p,id:i.panelId,onKeyDown:m,onBlur:n&&i.popoverState===0?E=>{var I,T,k,x,C;let N=E.relatedTarget;!N||!u.current||(I=u.current)!=null&&I.contains(N)||(o({type:1}),(((k=(T=i.beforePanelSentinel.current)==null?void 0:T.contains)==null?void 0:k.call(T,N))||((C=(x=i.afterPanelSentinel.current)==null?void 0:x.contains)==null?void 0:C.call(x,N)))&&N.focus({preventScroll:!0}))}:void 0,tabIndex:-1},P=wr(),S=M(()=>{let E=u.current;if(!E)return;function I(){_(P.current,{[ke.Forwards]:()=>{Re(E,Ie.First)},[ke.Backwards]:()=>{var T;(T=i.button)==null||T.focus({preventScroll:!0})}})}I()}),g=M(()=>{let E=u.current;if(!E)return;function I(){_(P.current,{[ke.Forwards]:()=>{var T,k,x;if(!i.button)return;let C=hr(),N=C.indexOf(i.button),V=C.slice(0,N+1),B=[...C.slice(N+1),...V];for(let Ne of B.slice())if(((k=(T=Ne==null?void 0:Ne.id)==null?void 0:T.startsWith)==null?void 0:k.call(T,"headlessui-focus-sentinel-"))||((x=i.panel)==null?void 0:x.contains(Ne))){let nt=B.indexOf(Ne);nt!==-1&&B.splice(nt,1)}Re(B,Ie.First,!1)},[ke.Backwards]:()=>Re(E,Ie.Last)})}I()});return L.createElement(fn.Provider,{value:i.panelId},h&&a&&f(pt,{id:l,ref:i.beforePanelSentinel,features:et.Focusable,as:"button",type:"button",onFocus:S}),q({ourProps:b,theirProps:r,slot:w,defaultTag:Co,features:Lo,visible:h,name:"Popover.Panel"}),h&&a&&f(pt,{id:c,ref:i.afterPanelSentinel,features:et.Focusable,as:"button",type:"button",onFocus:g}))}),Do="div",No=J(function(t,e){let n=d.exports.useRef(null),r=Y(n,e),[i,o]=d.exports.useState([]),s=M(h=>{o(m=>{let w=m.indexOf(h);if(w!==-1){let b=m.slice();return b.splice(w,1),b}return m})}),a=M(h=>(o(m=>[...m,h]),()=>s(h))),l=M(()=>{var h;let m=on(n);if(!m)return!1;let w=m.activeElement;return(h=n.current)!=null&&h.contains(w)?!0:i.some(b=>{var P,S;return((P=m.getElementById(b.buttonId))==null?void 0:P.contains(w))||((S=m.getElementById(b.panelId))==null?void 0:S.contains(w))})}),c=M(h=>{for(let m of i)m.buttonId!==h&&m.close()}),u=d.exports.useMemo(()=>({registerPopover:a,unregisterPopover:s,isFocusWithinPopoverGroup:l,closeOthers:c}),[a,s,l,c]),p=d.exports.useMemo(()=>({}),[]),v=t,y={ref:r};return L.createElement(hn.Provider,{value:u},q({ourProps:y,theirProps:v,slot:p,defaultTag:Do,name:"Popover.Group"}))}),Nt=Object.assign(bo,{Button:Eo,Overlay:ko,Panel:To,Group:No}),Sr=d.exports.createContext(null);function Ir(){let t=d.exports.useContext(Sr);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Ir),e}return t}function Mo(){let[t,e]=d.exports.useState([]);return[t.length>0?t.join(" "):void 0,d.exports.useMemo(()=>function(n){let r=M(o=>(e(s=>[...s,o]),()=>e(s=>{let a=s.slice(),l=a.indexOf(o);return l!==-1&&a.splice(l,1),a}))),i=d.exports.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props}),[r,n.slot,n.name,n.props]);return L.createElement(Sr.Provider,{value:i},n.children)},[e])]}let Oo="label",Ao=J(function(t,e){let{passive:n=!1,...r}=t,i=Ir(),o=`headlessui-label-${ae()}`,s=Y(e);se(()=>i.register(o),[o,i.register]);let a={ref:s,...i.props,id:o};return n&&("onClick"in a&&delete a.onClick,"onClick"in r&&delete r.onClick),q({ourProps:a,theirProps:r,slot:i.slot||{},defaultTag:Oo,name:i.name||"Label"})}),vn=d.exports.createContext(null);vn.displayName="GroupContext";let $o=d.exports.Fragment;function _o(t){let[e,n]=d.exports.useState(null),[r,i]=Mo(),[o,s]=po(),a=d.exports.useMemo(()=>({switch:e,setSwitch:n,labelledby:r,describedby:o}),[e,n,r,o]),l={},c=t;return L.createElement(s,{name:"Switch.Description"},L.createElement(i,{name:"Switch.Label",props:{onClick(){!e||(e.click(),e.focus({preventScroll:!0}))}}},L.createElement(vn.Provider,{value:a},q({ourProps:l,theirProps:c,defaultTag:$o,name:"Switch.Group"}))))}let Fo="button",Ro=J(function(t,e){let{checked:n,defaultChecked:r=!1,onChange:i,name:o,value:s,...a}=t,l=`headlessui-switch-${ae()}`,c=d.exports.useContext(vn),u=d.exports.useRef(null),p=Y(u,e,c===null?null:c.setSwitch),[v,y]=lo(n,i,r),h=M(()=>y==null?void 0:y(!v)),m=M(g=>{if(an(g.currentTarget))return g.preventDefault();g.preventDefault(),h()}),w=M(g=>{g.key===Z.Space?(g.preventDefault(),h()):g.key===Z.Enter&&so(g.currentTarget)}),b=M(g=>g.preventDefault()),P=d.exports.useMemo(()=>({checked:v}),[v]),S={id:l,ref:p,role:"switch",type:vr(t,u),tabIndex:0,"aria-checked":v,"aria-labelledby":c==null?void 0:c.labelledby,"aria-describedby":c==null?void 0:c.describedby,onClick:m,onKeyUp:w,onKeyPress:b};return F(Q,{children:[o!=null&&v&&L.createElement(pt,{features:et.Hidden,...Kt({as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:v,name:o,value:s})}),q({ourProps:S,theirProps:a,slot:P,defaultTag:Fo,name:"Switch"})]})}),zo=Object.assign(Ro,{Group:_o,Label:Ao,Description:fo});function Vo(t){let e={called:!1};return(...n)=>{if(!e.called)return e.called=!0,t(...n)}}function Mt(t,...e){t&&e.length>0&&t.classList.add(...e)}function Ot(t,...e){t&&e.length>0&&t.classList.remove(...e)}var Wt=(t=>(t.Ended="ended",t.Cancelled="cancelled",t))(Wt||{});function Bo(t,e){let n=yt();if(!t)return n.dispose;let{transitionDuration:r,transitionDelay:i}=getComputedStyle(t),[o,s]=[r,i].map(a=>{let[l=0]=a.split(",").filter(Boolean).map(c=>c.includes("ms")?parseFloat(c):parseFloat(c)*1e3).sort((c,u)=>u-c);return l});if(o+s!==0){let a=[];a.push(n.addEventListener(t,"transitionrun",l=>{l.target===l.currentTarget&&(a.splice(0).forEach(c=>c()),a.push(n.addEventListener(t,"transitionend",c=>{c.target===c.currentTarget&&(e("ended"),a.splice(0).forEach(u=>u()))}),n.addEventListener(t,"transitioncancel",c=>{c.target===c.currentTarget&&(e("cancelled"),a.splice(0).forEach(u=>u()))})))}))}else e("ended");return n.add(()=>e("cancelled")),n.dispose}function Uo(t,e,n,r){let i=n?"enter":"leave",o=yt(),s=r!==void 0?Vo(r):()=>{};i==="enter"&&(t.removeAttribute("hidden"),t.style.display="");let a=_(i,{enter:()=>e.enter,leave:()=>e.leave}),l=_(i,{enter:()=>e.enterTo,leave:()=>e.leaveTo}),c=_(i,{enter:()=>e.enterFrom,leave:()=>e.leaveFrom});return Ot(t,...e.enter,...e.enterTo,...e.enterFrom,...e.leave,...e.leaveFrom,...e.leaveTo,...e.entered),Mt(t,...a,...c),o.nextFrame(()=>{Ot(t,...c),Mt(t,...l),Bo(t,u=>(u==="ended"&&(Ot(t,...a),Mt(t,...e.entered)),s(u)))}),o.dispose}function jo({container:t,direction:e,classes:n,onStart:r,onStop:i}){let o=xr(),s=pr(),a=re(e);se(()=>{let l=yt();s.add(l.dispose);let c=t.current;if(!!c&&a.current!=="idle"&&!!o.current)return l.dispose(),r.current(a.current),l.add(Uo(c,n.current,a.current==="enter",u=>{l.dispose(),_(u,{[Wt.Ended](){i.current(a.current)},[Wt.Cancelled]:()=>{}})})),l.dispose},[e])}function xe(t=""){return t.split(" ").filter(e=>e.trim().length>1)}let bt=d.exports.createContext(null);bt.displayName="TransitionContext";var Ho=(t=>(t.Visible="visible",t.Hidden="hidden",t))(Ho||{});function Ko(){let t=d.exports.useContext(bt);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function Wo(){let t=d.exports.useContext(Pt);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let Pt=d.exports.createContext(null);Pt.displayName="NestingContext";function Et(t){return"children"in t?Et(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function kr(t,e){let n=re(t),r=d.exports.useRef([]),i=xr(),o=pr(),s=M((y,h=te.Hidden)=>{let m=r.current.findIndex(({el:w})=>w===y);m!==-1&&(_(h,{[te.Unmount](){r.current.splice(m,1)},[te.Hidden](){r.current[m].state="hidden"}}),o.microTask(()=>{var w;!Et(r)&&i.current&&((w=n.current)==null||w.call(n))}))}),a=M(y=>{let h=r.current.find(({el:m})=>m===y);return h?h.state!=="visible"&&(h.state="visible"):r.current.push({el:y,state:"visible"}),()=>s(y,te.Unmount)}),l=d.exports.useRef([]),c=d.exports.useRef(Promise.resolve()),u=d.exports.useRef({enter:[],leave:[],idle:[]}),p=M((y,h,m)=>{l.current.splice(0),e&&(e.chains.current[h]=e.chains.current[h].filter(([w])=>w!==y)),e==null||e.chains.current[h].push([y,new Promise(w=>{l.current.push(w)})]),e==null||e.chains.current[h].push([y,new Promise(w=>{Promise.all(u.current[h].map(([b,P])=>P)).then(()=>w())})]),h==="enter"?c.current=c.current.then(()=>e==null?void 0:e.wait.current).then(()=>m(h)):m(h)}),v=M((y,h,m)=>{Promise.all(u.current[h].splice(0).map(([w,b])=>b)).then(()=>{var w;(w=l.current.shift())==null||w()}).then(()=>m(h))});return d.exports.useMemo(()=>({children:r,register:a,unregister:s,onStart:p,onStop:v,wait:c,chains:u}),[a,s,r,p,v,u,c])}function Go(){}let qo=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function $n(t){var e;let n={};for(let r of qo)n[r]=(e=t[r])!=null?e:Go;return n}function Jo(t){let e=d.exports.useRef($n(t));return d.exports.useEffect(()=>{e.current=$n(t)},[t]),e}let Yo="div",Cr=Ke.RenderStrategy,Lr=J(function(t,e){let{beforeEnter:n,afterEnter:r,beforeLeave:i,afterLeave:o,enter:s,enterFrom:a,enterTo:l,entered:c,leave:u,leaveFrom:p,leaveTo:v,...y}=t,h=d.exports.useRef(null),m=Y(h,e),w=y.unmount?te.Unmount:te.Hidden,{show:b,appear:P,initial:S}=Ko(),[g,E]=d.exports.useState(b?"visible":"hidden"),I=Wo(),{register:T,unregister:k}=I,x=d.exports.useRef(null);d.exports.useEffect(()=>T(h),[T,h]),d.exports.useEffect(()=>{if(w===te.Hidden&&!!h.current){if(b&&g!=="visible"){E("visible");return}return _(g,{hidden:()=>k(h),visible:()=>T(h)})}},[g,h,T,k,b,w]);let C=re({enter:xe(s),enterFrom:xe(a),enterTo:xe(l),entered:xe(c),leave:xe(u),leaveFrom:xe(p),leaveTo:xe(v)}),N=Jo({beforeEnter:n,afterEnter:r,beforeLeave:i,afterLeave:o}),V=rn();d.exports.useEffect(()=>{if(V&&g==="visible"&&h.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[h,g,V]);let B=S&&!P,Ne=(()=>!V||B||x.current===b?"idle":b?"enter":"leave")(),nt=M(ue=>_(ue,{enter:()=>N.current.beforeEnter(),leave:()=>N.current.beforeLeave(),idle:()=>{}})),Fr=M(ue=>_(ue,{enter:()=>N.current.afterEnter(),leave:()=>N.current.afterLeave(),idle:()=>{}})),rt=kr(()=>{E("hidden"),k(h)},I);jo({container:h,classes:C,direction:Ne,onStart:re(ue=>{rt.onStart(h,ue,nt)}),onStop:re(ue=>{rt.onStop(h,ue,Fr),ue==="leave"&&!Et(rt)&&(E("hidden"),k(h))})}),d.exports.useEffect(()=>{!B||(w===te.Hidden?x.current=null:x.current=b)},[b,B,g]);let Rr=y,zr={ref:m};return f(Pt.Provider,{value:rt,children:f(yr,{value:_(g,{visible:le.Open,hidden:le.Closed}),children:q({ourProps:zr,theirProps:Rr,defaultTag:Yo,features:Cr,visible:g==="visible",name:"Transition.Child"})})})}),Gt=J(function(t,e){let{show:n,appear:r=!1,unmount:i,...o}=t,s=d.exports.useRef(null),a=Y(s,e);rn();let l=wt();if(n===void 0&&l!==null&&(n=_(l,{[le.Open]:!0,[le.Closed]:!1})),![!0,!1].includes(n))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[c,u]=d.exports.useState(n?"visible":"hidden"),p=kr(()=>{u("hidden")}),[v,y]=d.exports.useState(!0),h=d.exports.useRef([n]);se(()=>{v!==!1&&h.current[h.current.length-1]!==n&&(h.current.push(n),y(!1))},[h,n]);let m=d.exports.useMemo(()=>({show:n,appear:r,initial:v}),[n,r,v]);d.exports.useEffect(()=>{if(n)u("visible");else if(!Et(p))u("hidden");else{let b=s.current;if(!b)return;let P=b.getBoundingClientRect();P.x===0&&P.y===0&&P.width===0&&P.height===0&&u("hidden")}},[n,p]);let w={unmount:i};return f(Pt.Provider,{value:p,children:f(bt.Provider,{value:m,children:q({ourProps:{...w,as:d.exports.Fragment,children:L.createElement(Lr,{ref:a,...w,...o})},theirProps:{},defaultTag:d.exports.Fragment,features:Cr,visible:c==="visible",name:"Transition"})})})}),Zo=J(function(t,e){let n=d.exports.useContext(bt)!==null,r=wt()!==null;return f(Q,{children:!n&&r?L.createElement(Gt,{ref:e,...t}):L.createElement(Lr,{ref:e,...t})})}),fe=Object.assign(Gt,{Child:Zo,Root:Gt});const Tr="splatapus.debugSettings",Xo=j.object({shouldShowPoints:j.boolean}),Qo={shouldShowPoints:!1};function es(){const t=ie(ht),[e,n]=d.exports.useState(null),r=lr(e,16);return F(Nt,{className:"pointer-events-auto relative px-3 py-2 opacity-0 hover:opacity-100 ui-open:opacity-100",children:[f(Nt.Button,{as:oe,children:"!"}),f(fe,{className:"absolute bottom-12 right-3 origin-bottom-right",enter:"transition duration-200 ease-out-back",enterFrom:"opacity-0 scale-75",enterTo:"opacity-100",leave:"transition duration-300 ease-in-back",leaveFrom:"opacity-100",leaveTo:"opacity-0 scale-75",children:f(Nt.Panel,{ref:n,className:K("flex  w-60 flex-col gap-3 bg-stone-100 p-3"),style:{clipPath:r},children:f(ts,{label:"Show points",value:t.shouldShowPoints,onChange:i=>ht.update({...t,shouldShowPoints:i})})})})]})}function ts({label:t,value:e,onChange:n}){return F(zo,{checked:e,onChange:n,as:cr,className:"justify-between py-1 pl-3 pr-1",children:[f("span",{children:t}),f("div",{className:"relative inline-flex h-6 w-10 rounded-full bg-stone-200 transition ui-checked:bg-green-400",children:f("div",{className:"absolute top-[2px] left-[2px] h-5 w-5 rounded-full bg-white transition ui-checked:translate-x-4"})})]})}function ns(){const t=Ft(Tr);try{return Xo.parse(JSON.parse(t)).unwrap()}catch{return Qo}}const ht=new W(ns(),"debugSettings");ut(me.idle,()=>{Kn(Tr,JSON.stringify(ht.live()))});function rs(t){return ie(ht)[t]}const is=L.memo(function({shapeId:e,splatapus:n}){const r=rs("shouldShowPoints"),i=H(()=>{if(n.location.shapeId.live()===e){const l=n.interaction.activeMode.live();switch(l.type){case A.Draw:{const c=l.previewPoints.live();return c.length?Zn(Jn(Yn(c,Ze),Ze),Ze.size):null}case A.Rig:case A.Play:return null;default:throw U(l)}}return null},[n,e]),o=H(()=>{const l=n.document.live(),c=n.previewPosition.live(),u=ur.getCenterPointsAtPosition(l,e,c);if(u)return u;const p=n.keyPointIdHistory.live();for(let v=p.length-1;v>=0;v--){const y=l.getShapeVersion(p[v],e);if(y)return l.getNormalizedCenterPointsForShapeVersion(y.id)}return null},[e,n]),s=H(()=>n.location.shapeId.live()===e,[n,e]),a=i||o;return F(Q,{children:[o&&f("path",{d:lt(dt(o)),className:K(i?"fill-stone-300":s?"fill-stone-800":"fill-stone-600")}),i&&f("path",{d:lt(dt(i)),className:K(s?"fill-stone-800":"fill-stone-600")}),r&&a&&a.map((l,c)=>f("circle",{cx:l.center.x,cy:l.center.y,r:l.radius,className:"fill-transparent stroke-cyan-400"},c))]})});function os(t){const e=d.exports.useRef(t);return d.exports.useEffect(()=>{e.current=t},[t]),e.current}const ss=L.memo(function({splatapus:e}){const n=H(()=>e.interaction.getCanvasClassNameLive(),[e]),r=ie(e.viewport.isSidebarOpen),i=ie(e.viewport.screenSize),o=H(()=>e.viewport.getSceneTransformLive(),[e]),s=os(r),[a,l]=d.exports.useState(!1);return d.exports.useLayoutEffect(()=>{l(!0);const c=setTimeout(()=>l(!1),400);return()=>clearTimeout(c)},[r]),f("svg",{viewBox:`0 0 ${i.x} ${i.y}`,className:K("absolute top-0 left-0",n),children:f("g",{style:{transform:o},className:K((a||r!==s)&&"transition-transform"),children:f(as,{splatapus:e})})})}),as=L.memo(function({splatapus:e}){return f(Q,{children:Array.from(H(()=>e.document.live().shapes,[e]),n=>f(is,{shapeId:n.id,splatapus:e},n.id))})});class ls{constructor(){this.state={type:"idle"}}onPointerDown(e){const{event:n,splatapus:r}=e;switch(this.state.type){case"idle":return this.state={type:"oneFingerDown",pointerA:{id:n.pointerId,startScreenPosition:D.fromEvent(n),currentScreenPosition:D.fromEvent(n),startEvent:n}},e;case"oneFingerDown":return this.state={type:"bothFingersDown",pointerA:this.state.pointerA,pointerB:{id:n.pointerId,startScreenPosition:D.fromEvent(n),currentScreenPosition:D.fromEvent(n),startEvent:n},initialViewportState:r.viewport.state.getOnce()},{splatapus:r,eventType:"cancel",event:this.state.pointerA.startEvent};case"bothFingersDown":return e;default:throw U(this.state)}}onPointerMove(e){const{event:n,splatapus:r}=e;switch(this.state.type){case"idle":return e;case"oneFingerDown":return this.state.pointerA.id===n.pointerId&&(this.state.pointerA.currentScreenPosition=D.fromEvent(n)),e;case"bothFingersDown":if(n.pointerId===this.state.pointerA.id||n.pointerId===this.state.pointerB.id){const i=n.pointerId===this.state.pointerA.id?D.fromEvent(n):this.state.pointerA.currentScreenPosition,o=n.pointerId===this.state.pointerB.id?D.fromEvent(n):this.state.pointerB.currentScreenPosition,s=this.state.pointerA.startScreenPosition.distanceTo(this.state.pointerB.startScreenPosition),l=i.distanceTo(o)/s,c=this.state.pointerA.startScreenPosition.lerp(this.state.pointerB.startScreenPosition,.5),u=i.lerp(o,.5),p=c.add(this.state.initialViewportState.pan).scale(l).sub(u);return r.viewport.state.update({zoom:this.state.initialViewportState.zoom*l,pan:p}),this.state.pointerA.currentScreenPosition=i,this.state.pointerB.currentScreenPosition=o,null}return e;default:throw U(this.state)}}onPointerUp(e){const{event:n}=e;switch(this.state.type){case"idle":return e;case"oneFingerDown":return n.pointerId===this.state.pointerA.id&&(this.state={type:"idle"}),e;case"bothFingersDown":return n.pointerId===this.state.pointerA.id||n.pointerId===this.state.pointerB.id?(this.state={type:"idle"},null):e;default:throw U(this.state)}}onPointerCancel(e){return this.onPointerUp(e)}}const cs=10,us=Qt,Dr=()=>null;class ds{constructor({onTap:e=us,onDragStart:n=Dr}){this.state={type:"idle"},this.lastEvent=null,this.onTap=e,this.onDragStart=n}isGestureInProgress(){return this.state.type!=="idle"}onPointerDown(e,...n){var r,i;switch(this.lastEvent=e,this.state.type){case"idle":{const o=this.onDragStart(e,...n);if(!o)return;(r=o.couldBeTap)==null||r?this.state={type:"dragUnconfirmed",pointerId:e.pointerId,startPosition:D.fromEvent(e),dragHandler:o,args:n}:(this.state={type:"dragConfirmed",pointerId:e.pointerId,dragHandler:o},(i=o.onConfirm)==null||i.call(o,e));return}case"dragUnconfirmed":case"dragConfirmed":return;default:U(this.state)}}onPointerMove(e){var n,r;switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onMove(e),this.state.startPosition.distanceTo(D.fromEvent(e))>=cs&&((r=(n=this.state.dragHandler).onConfirm)==null||r.call(n,e),this.state={type:"dragConfirmed",pointerId:this.state.pointerId,dragHandler:this.state.dragHandler});return;case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onMove(e);return;default:U(this.state)}}onPointerUp(e){switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onCancel(e),this.onTap(e,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onEnd(e),this.state={type:"idle"};return;default:U(this.state)}}onPointerCancel(e){switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onCancel(e),this.state={type:"idle"};return;default:U(this.state)}}cancel(){switch(this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":this.state.dragHandler.onCancel(X(this.lastEvent)),this.state={type:"idle"};return;default:U(this.state)}}end(){const e=X(this.lastEvent);switch(this.state.type){case"idle":return;case"dragUnconfirmed":this.state.dragHandler.onCancel(e),this.onTap(e,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":this.state.dragHandler.onEnd(e),this.state={type:"idle"};return;default:U(this.state)}}}function ps(t,e){switch(e.eventType){case"down":return t.onPointerDown(e);case"move":return t.onPointerMove(e);case"up":return t.onPointerUp(e);case"cancel":return t.onPointerCancel(e);default:U(e.eventType)}}class mn{constructor({onTap:e,onDragStart:n}){this.isDragging=new W(!1,"Gesture.isDragging"),this.isDragConfirmed=new W(!1,"Gesture.isDragConfirmed");const r=n!=null?n:Dr;this.gesture=new ds({onTap:e,onDragStart:(i,o,...s)=>{const a=r(i,o,...s);return a?(this.isDragging.update(!0),{couldBeTap:a.couldBeTap,onMove:a.onMove,onEnd:l=>(this.isDragging.update(!1),this.isDragConfirmed.update(!1),a.onEnd(l)),onCancel:l=>(this.isDragging.update(!1),this.isDragConfirmed.update(!1),a.onCancel(l)),onConfirm:l=>{if(this.isDragConfirmed.update(!1),a.onConfirm)return a.onConfirm(l)}}):null}})}onPointerEvent(e,...n){switch(e.eventType){case"down":return this.gesture.onPointerDown(e.event,e.splatapus,...n);case"move":return this.gesture.onPointerMove(e.event);case"up":return this.gesture.onPointerUp(e.event);case"cancel":return this.gesture.onPointerCancel(e.event);default:U(e.eventType)}}end(){this.gesture.end()}cancel(){this.gesture.end()}}class hs{constructor(){this.type=A.Draw,this.previewPoints=new W([],"DrawMode.previewPoints"),this.gesture=new mn({onDragStart:(e,{viewport:n,location:r,document:i})=>(this.previewPoints.update([n.eventSceneCoords(e)]),{couldBeTap:!1,onMove:o=>this.previewPoints.update(s=>[...s,n.eventSceneCoords(o)]),onEnd:o=>{const s=this.previewPoints.getOnce();this.previewPoints.update([]),i.update(a=>a.replacePointsForVersion(r.keyPointId.getOnce(),r.shapeId.getOnce(),s))},onCancel:()=>{this.previewPoints.update([])}})})}isIdleLive(){return!this.gesture.isDragging.live()}toDebugStringLive(){return Ue("draw",this.isIdleLive()?{_:"idle"}:{_:"drawing",points:this.previewPoints.live().length})}onPointerEvent(e){this.gesture.onPointerEvent(e)}getPreviewPositionLive(){return null}renderOverlay(){return null}}const qt={interpolated:t=>({type:"interpolated",scenePosition:t}),keyPointId:t=>({type:"keyPointId",keyPointId:t}),toDebugString:t=>{switch(t.type){case"interpolated":return Ue(t.type,{_:t.scenePosition.toString(2)});case"keyPointId":return Ue(t.type,{_:t.keyPointId});default:U(t)}}};function Nr({splatapus:t,keyPointId:e,width:n,height:r,className:i}){const s=H(()=>{const P=t.document.live();return Wn(Array.from(P.shapes,S=>{const g=ur.getCenterPointsAtPosition(P,S.id,qt.keyPointId(e));return g?{centerPoints:g,svg:qi(g),shapeId:S.id}:null}))},[t,e]),{minX:a,minY:l,maxX:c,maxY:u}=d.exports.useMemo(()=>{let P=1/0,S=1/0,g=-1/0,E=-1/0;for(const I of s)for(const{center:T,radius:k}of I.centerPoints)P=Math.min(P,T.x-k),g=Math.max(g,T.x+k),S=Math.min(S,T.y-k),E=Math.max(E,T.y+k);return{minX:P,minY:S,maxX:g,maxY:E}},[s]);if(!s.length)return null;const p=c-a,v=u-l,y=n-4*2,h=r-4*2,m=Math.min(y/p,.8),w=Math.min(h/v,.8),b=Math.min(m,w);return f("svg",{viewBox:`0 0 ${n} ${r}`,style:{width:n,height:r},children:f("g",{transform:`translate(${4+Math.max(y-p*b,0)/2}, ${4+Math.max(h-v*b,0)/2}) scale(${b}) translate(${-a}, ${-l})`,children:s.map(({svg:P,shapeId:S})=>f("path",{d:P,className:"fill-stone-800"},S))})})}function fs(t){const e=d.exports.useRef(t);return d.exports.useEffect(()=>{t!=null&&(e.current=t)},[t]),t!=null?t:e.current}function Jt(){return Jt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jt.apply(this,arguments)}function gn(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Yt(t,e){return Yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Yt(t,e)}function yn(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Yt(t,e)}function vs(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function ms(t,e){t.classList?t.classList.add(e):vs(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function _n(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function gs(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=_n(t.className,e):t.setAttribute("class",_n(t.className&&t.className.baseVal||"",e))}const Fn={disabled:!1},ft=L.createContext(null);var Mr=function(e){return e.scrollTop},Je="unmounted",Pe="exited",Ee="entering",$e="entered",Zt="exiting",ce=function(t){yn(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var s=i,a=s&&!s.isMounting?r.enter:r.appear,l;return o.appearStatus=null,r.in?a?(l=Pe,o.appearStatus=Ee):l=$e:r.unmountOnExit||r.mountOnEnter?l=Je:l=Pe,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(i,o){var s=i.in;return s&&o.status===Je?{status:Pe}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var o=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==Ee&&s!==$e&&(o=Ee):(s===Ee||s===$e)&&(o=Zt)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,o,s,a;return o=s=a=i,i!=null&&typeof i!="number"&&(o=i.exit,s=i.enter,a=i.appear!==void 0?i.appear:s),{exit:o,enter:s,appear:a}},n.updateStatus=function(i,o){if(i===void 0&&(i=!1),o!==null)if(this.cancelNextCallback(),o===Ee){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:it.findDOMNode(this);s&&Mr(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Pe&&this.setState({status:Je})},n.performEnter=function(i){var o=this,s=this.props.enter,a=this.context?this.context.isMounting:i,l=this.props.nodeRef?[a]:[it.findDOMNode(this),a],c=l[0],u=l[1],p=this.getTimeouts(),v=a?p.appear:p.enter;if(!i&&!s||Fn.disabled){this.safeSetState({status:$e},function(){o.props.onEntered(c)});return}this.props.onEnter(c,u),this.safeSetState({status:Ee},function(){o.props.onEntering(c,u),o.onTransitionEnd(v,function(){o.safeSetState({status:$e},function(){o.props.onEntered(c,u)})})})},n.performExit=function(){var i=this,o=this.props.exit,s=this.getTimeouts(),a=this.props.nodeRef?void 0:it.findDOMNode(this);if(!o||Fn.disabled){this.safeSetState({status:Pe},function(){i.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:Zt},function(){i.props.onExiting(a),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:Pe},function(){i.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,o){o=this.setNextCallback(o),this.setState(i,o)},n.setNextCallback=function(i){var o=this,s=!0;return this.nextCallback=function(a){s&&(s=!1,o.nextCallback=null,i(a))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},n.onTransitionEnd=function(i,o){this.setNextCallback(o);var s=this.props.nodeRef?this.props.nodeRef.current:it.findDOMNode(this),a=i==null&&!this.props.addEndListener;if(!s||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],c=l[0],u=l[1];this.props.addEndListener(c,u)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===Je)return null;var o=this.props,s=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var a=gn(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return f(ft.Provider,{value:null,children:typeof s=="function"?s(i,a):L.cloneElement(L.Children.only(s),a)})},e}(L.Component);ce.contextType=ft;ce.propTypes={};function Oe(){}ce.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Oe,onEntering:Oe,onEntered:Oe,onExit:Oe,onExiting:Oe,onExited:Oe};ce.UNMOUNTED=Je;ce.EXITED=Pe;ce.ENTERING=Ee;ce.ENTERED=$e;ce.EXITING=Zt;const ys=ce;var ws=function(e,n){return e&&n&&n.split(" ").forEach(function(r){return ms(e,r)})},At=function(e,n){return e&&n&&n.split(" ").forEach(function(r){return gs(e,r)})},wn=function(t){yn(e,t);function e(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=t.call.apply(t,[this].concat(o))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(a,l){var c=r.resolveArguments(a,l),u=c[0],p=c[1];r.removeClasses(u,"exit"),r.addClass(u,p?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(a,l)},r.onEntering=function(a,l){var c=r.resolveArguments(a,l),u=c[0],p=c[1],v=p?"appear":"enter";r.addClass(u,v,"active"),r.props.onEntering&&r.props.onEntering(a,l)},r.onEntered=function(a,l){var c=r.resolveArguments(a,l),u=c[0],p=c[1],v=p?"appear":"enter";r.removeClasses(u,v),r.addClass(u,v,"done"),r.props.onEntered&&r.props.onEntered(a,l)},r.onExit=function(a){var l=r.resolveArguments(a),c=l[0];r.removeClasses(c,"appear"),r.removeClasses(c,"enter"),r.addClass(c,"exit","base"),r.props.onExit&&r.props.onExit(a)},r.onExiting=function(a){var l=r.resolveArguments(a),c=l[0];r.addClass(c,"exit","active"),r.props.onExiting&&r.props.onExiting(a)},r.onExited=function(a){var l=r.resolveArguments(a),c=l[0];r.removeClasses(c,"exit"),r.addClass(c,"exit","done"),r.props.onExited&&r.props.onExited(a)},r.resolveArguments=function(a,l){return r.props.nodeRef?[r.props.nodeRef.current,a]:[a,l]},r.getClassNames=function(a){var l=r.props.classNames,c=typeof l=="string",u=c&&l?l+"-":"",p=c?""+u+a:l[a],v=c?p+"-active":l[a+"Active"],y=c?p+"-done":l[a+"Done"];return{baseClassName:p,activeClassName:v,doneClassName:y}},r}var n=e.prototype;return n.addClass=function(i,o,s){var a=this.getClassNames(o)[s+"ClassName"],l=this.getClassNames("enter"),c=l.doneClassName;o==="appear"&&s==="done"&&c&&(a+=" "+c),s==="active"&&i&&Mr(i),a&&(this.appliedClasses[o][s]=a,ws(i,a))},n.removeClasses=function(i,o){var s=this.appliedClasses[o],a=s.base,l=s.active,c=s.done;this.appliedClasses[o]={},a&&At(i,a),l&&At(i,l),c&&At(i,c)},n.render=function(){var i=this.props;i.classNames;var o=gn(i,["classNames"]);return f(ys,{...o,onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited})},e}(L.Component);wn.defaultProps={classNames:""};wn.propTypes={};const xs=wn;function bs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xn(t,e){var n=function(o){return e&&d.exports.isValidElement(o)?e(o):o},r=Object.create(null);return t&&d.exports.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function Ps(t,e){t=t||{},e=e||{};function n(u){return u in e?e[u]:t[u]}var r=Object.create(null),i=[];for(var o in t)o in e?i.length&&(r[o]=i,i=[]):i.push(o);var s,a={};for(var l in e){if(r[l])for(s=0;s<r[l].length;s++){var c=r[l][s];a[r[l][s]]=n(c)}a[l]=n(l)}for(s=0;s<i.length;s++)a[i[s]]=n(i[s]);return a}function Ce(t,e,n){return n[e]!=null?n[e]:t.props[e]}function Es(t,e){return xn(t.children,function(n){return d.exports.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:Ce(n,"appear",t),enter:Ce(n,"enter",t),exit:Ce(n,"exit",t)})})}function Ss(t,e,n){var r=xn(t.children),i=Ps(e,r);return Object.keys(i).forEach(function(o){var s=i[o];if(!!d.exports.isValidElement(s)){var a=o in e,l=o in r,c=e[o],u=d.exports.isValidElement(c)&&!c.props.in;l&&(!a||u)?i[o]=d.exports.cloneElement(s,{onExited:n.bind(null,s),in:!0,exit:Ce(s,"exit",t),enter:Ce(s,"enter",t)}):!l&&a&&!u?i[o]=d.exports.cloneElement(s,{in:!1}):l&&a&&d.exports.isValidElement(c)&&(i[o]=d.exports.cloneElement(s,{onExited:n.bind(null,s),in:c.props.in,exit:Ce(s,"exit",t),enter:Ce(s,"enter",t)}))}}),i}var Is=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},ks={component:"div",childFactory:function(e){return e}},bn=function(t){yn(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var s=o.handleExited.bind(bs(o));return o.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,o){var s=o.children,a=o.handleExited,l=o.firstRender;return{children:l?Es(i,a):Ss(i,s,a),firstRender:!1}},n.handleExited=function(i,o){var s=xn(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(o),this.mounted&&this.setState(function(a){var l=Jt({},a.children);return delete l[i.key],{children:l}}))},n.render=function(){var i=this.props,o=i.component,s=i.childFactory,a=gn(i,["component","childFactory"]),l=this.state.contextValue,c=Is(this.state.children).map(s);return delete a.appear,delete a.enter,delete a.exit,o===null?f(ft.Provider,{value:l,children:c}):f(ft.Provider,{value:l,children:f(o,{...a,children:c})})},e}(L.Component);bn.propTypes={};bn.defaultProps=ks;const Cs=bn,Ls=80,Ts=64;function Or(t,e){return e.y>t.screenSize.live().y-Ls}const Pn=class{constructor(){this.type=A.Rig,this.previewMovement=new W(null,"RigMode.previewMovement"),this.previewPosition=new W(null,"RigMode.previewPosition"),this.gesture=new mn({onTap:(t,{location:e},n)=>{!n||e.keyPointId.update(n.id)},onDragStart:(t,{viewport:e,document:n,location:r},i)=>{if(t.preventDefault(),!i)return this.previewPosition.update(e.eventSceneCoords(t)),{couldBeTap:!1,onMove:a=>this.previewPosition.update(e.eventSceneCoords(a)),onEnd:()=>this.previewPosition.update(null),onCancel:()=>this.previewPosition.update(null)};r.keyPointId.update(i.id);const o=e.eventSceneCoords(t),s=i.initialScenePosition;return{couldBeTap:!0,onMove:a=>{this.previewMovement.update({keyPointId:i.id,scenePosition:e.eventSceneCoords(a).sub(o).add(s)})},onEnd:a=>{const l=e.eventSceneCoords(a).sub(o).add(s),c=Qe(()=>Or(e,e.sceneToScreenLive(l)));this.previewMovement.update(null),n.update(u=>u.updateKeyPoint(i.id,p=>({...p,position:c?null:l})))},onCancel:a=>{this.previewMovement.update(null)}}}})}isIdleLive(){return!this.gesture.isDragging.live()}toDebugStringLive(){const t=this.previewMovement.live(),e=this.previewPosition.live();return Ue("rig",e?{_:"preview",position:e.toString(2)}:t?{_:"moving",keyPointId:t.keyPointId,delta:t.scenePosition.toString(2)}:{_:"idle"})}onPointerEvent(t){this.gesture.onPointerEvent(t)}getPreviewPositionLive(){return this.previewPosition.live()}renderOverlay(t){return f(Pn.Overlay,{splatapus:t,mode:this})}};let St=Pn;St.Overlay=function({splatapus:e,mode:n}){const{points:r,pointsInDock:i,size:o,isAnyDragging:s,maxScreenProgress:a,minScreenProgress:l}=H(()=>{const b=e.viewport.screenSizeWithSidebarOpenLive(),P=n==null?void 0:n.previewMovement.live(),S=e.location.keyPointId.live();let g=0,E=1/0,I=-1/0;return{points:Array.from(e.document.live().keyPoints,(k,x)=>{const C=(P==null?void 0:P.keyPointId)===k.id?e.viewport.sceneToScreenLive(P.scenePosition):null,N=k.position?e.viewport.sceneToScreenLive(k.position):null,V=C?Or(e.viewport,C):!k.position;let B=null;return N&&(B=N.dot(b)/b.dot(b),E=Math.min(E,B),I=Math.max(I,B)),{dockIndex:V?g++:null,keyPoint:k,overallIndex:x,isSelected:k.id===S,screenPosition:C!=null?C:N,isDragging:!!C,screenProgress:B}}),pointsInDock:g,size:b,isAnyDragging:!!P,minScreenProgress:E,maxScreenProgress:I}},[e,n]),c=!!n,[u,p]=d.exports.useState(c),v=new D(o.x/2,o.y+50),[y,h]=d.exports.useState(null),m=r.find(b=>b.dockIndex!==null&&b.keyPoint.id===y),w=fs(m);return console.log({dockedHovered:m,prevDockedHovered:w}),console.log("render"),F(Q,{children:[f(fe,{show:c,className:"absolute left-0 right-0 bottom-0 z-10 h-24 bg-white/50 backdrop-blur-md ",enter:"transition duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",beforeEnter:()=>requestAnimationFrame(()=>p(!0)),beforeLeave:()=>p(!1)}),r.map(b=>f(Pn.KeyPoint,{shouldShow:c,shouldShowDock:u,splatapus:e,mode:n,screenSize:o,pointsInDock:i,exitPosition:v,isAnyDragging:s,minScreenProgress:l,maxScreenProgress:a,onPointerEnter:()=>h(b.keyPoint.id),onPointerLeave:()=>h(null),...b},b.keyPoint.id)),f(fe,{show:c&&i>0,className:"duration pointer-events-none absolute bottom-2 z-10 text-center font-semibold text-stone-400",enter:"transition duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition duration-75",leaveFrom:"opacity-100",leaveTo:"opacity-0",style:{width:o.x,transitionDelay:c?`${i*30+400}ms`:"0ms"},children:"drag each key point into the canvas"}),w&&f(fe,{show:!s&&!!m,className:"pointer-events-none absolute bottom-24 z-10 -mt-16 -ml-10 h-16 w-20 origin-bottom overflow-hidden rounded border border-stone-300 bg-stone-50 shadow-md transition",enter:"ease-out",enterFrom:"translate-y-4 opacity-0 scale-75",enterTo:"translate-y-0 opacity-100 scale-100",leave:"ease-in",leaveFrom:"translate-y-0 opacity-100 scale-100",leaveTo:"translate-y-4 opacity-0 scale-75",style:{left:o.x/2,transform:`translateX(${(X((m!=null?m:w).dockIndex)-(i-1)/2)*56}px) translateY(var(--tw-translate-y)) scale(var(--tw-scale-x), var(--tw-scale-y))`},children:f(Cs,{children:f(xs,{timeout:300,classNames:{enter:"transition-opacity bg-stone-50 absolute",enterActive:"transition-opacity bg-stone-50 absolute",enterDone:"transition-opacity bg-stone-50 absolute",exit:"transition-opacity opacity-0 bg-stone-50 absolute",exitActive:"transition-opacity opacity-0 bg-stone-50 absolute",exitDone:"transition-opacity opacity-0 bg-stone-50 absolute"},children:f(Nr,{width:78,height:62,keyPointId:w.keyPoint.id,splatapus:e})},w.keyPoint.id)})})]})};St.KeyPoint=function({dockIndex:e,screenPosition:n,shouldShowDock:r,shouldShow:i,screenSize:o,pointsInDock:s,keyPoint:a,exitPosition:l,isDragging:c,mode:u,splatapus:p,isSelected:v,isAnyDragging:y,overallIndex:h,screenProgress:m,minScreenProgress:w,maxScreenProgress:b,onPointerEnter:P,onPointerLeave:S}){const[g,E]=d.exports.useState(!!u),I=e!==null;n||(O(e!==null,"Assertion Error: dockIndex !== null"),n=r?new D(o.x/2+(e-(s-1)/2)*56,o.y-Ts):l);const[T,k]=d.exports.useState(!1);return F(Q,{children:[f(fe,{show:i,className:K("absolute top-0 left-0 flex cursor-move items-center justify-center",I?"-mt-7 -ml-7 h-14 w-14":"-mt-5 -ml-5 h-10 w-10 rounded-full",c?"z-20":I?"z-10":"z-[5]",!c&&(i?e!==null&&"transition duration-300 ease-out-back":e!==null&&"transition duration-200 ease-in")),enter:I?"transition-transform duration-300 ease-out-back":"transition-transform duration-200 ease-out-back",enterFrom:I?"scale-50":"scale-0",enterTo:"scale-100",leave:I?"transition-transform duration-200 ease-in":"transition-transform duration-200 ease-in-back",leaveFrom:"scale-100",leaveTo:I?"scale-50":"scale-0",afterEnter:()=>E(!0),beforeLeave:()=>E(!1),onPointerEnter:x=>{k(!0),P(x)},onPointerLeave:x=>{k(!1),S(x)},onPointerDown:x=>{!u||u.gesture.onPointerEvent({event:x,eventType:"down",splatapus:p},{id:a.id,initialScenePosition:Qe(()=>p.viewport.screenToSceneLive(X(n)))})},style:{transform:`translate(${n.x}px, ${n.y}px) scale(var(--tw-scale-x), var(--tw-scale-y))`,transitionDelay:y?"0ms":I?`${e*25}ms`:g?"0ms":`${jr(w,b,0,200,X(m))}ms`},children:f("div",{className:K("flex h-6 w-6 items-center justify-center rounded-full text-xs font-bold shadow-md transition-transform duration-200 ease-out-back-md",I?"scale-150":"scale-100",v?"bg-gradient-to-br from-cyan-400 to-blue-400 text-white":"border border-stone-200 bg-white text-stone-400"),children:h+1})},a.id),f(fe,{show:T&&!I&&!y,className:"pointer-events-none absolute top-0 left-0 z-[4]",style:{transform:`translate(${n.x}px, ${n.y-24}px)`},children:f(fe.Child,{className:"-mt-16 -ml-10 h-16 w-20 origin-bottom rounded border border-stone-300 bg-stone-50 shadow-md",enter:"transition ease-out",enterFrom:"translate-y-4 opacity-0 scale-75",enterTo:"translate-y-0 opacity-100 scale-100",leave:"transition ease-in",leaveFrom:"translate-y-0 opacity-100 scale-100",leaveTo:"translate-y-4 opacity-0 scale-75",children:f(Nr,{width:78,height:62,keyPointId:a.id,splatapus:p})})})]})};class Ds{constructor(){this.isKeyDown=new W(!1,"QuickPan.isKeyDown"),this.gesture=new mn({onDragStart:(e,n)=>{const r=n.viewport.pan.getOnce();let i=D.fromEvent(e);return{couldBeTap:!1,onMove:o=>{const s=D.fromEvent(o),a=i.sub(s);n.viewport.pan.update(l=>l.add(a)),i=s},onEnd:Qt,onCancel:()=>{n.viewport.pan.update(r)}}}}),this.isDragging=this.gesture.isDragging}onKeyDown({event:e}){return Ae(e," ")?(this.isKeyDown.update(!0),!0):!1}onKeyUp({event:e}){return this.isKeyDown.getOnce()&&Yr(e," ")?(this.isKeyDown.update(!1),this.gesture.end(),!0):!1}getCanvasClassNameLive(){if(this.isKeyDown.live()){if(this.isDragging.live())return"cursor-grabbing"}else return null;return"cursor-grab"}onPointerEvent(e){this.gesture.onPointerEvent(e)}toDebugStringLive(){return this.isKeyDown.live()?Ue("quickPan",{dragging:this.isDragging.live()}):null}}const G={initialize:t=>({undoStates:[],redoStates:[],pendingOp:null,current:{...t,options:{}}}),canUndo:t=>t.undoStates.length>0,canRedo:t=>{var e,n;return((n=(e=t.redoStates)==null?void 0:e.length)!=null?n:0)>0},beginOperation:t=>{const e=Math.random();return O(t.pendingOp==null,"pending op already in progress"),{undoStack:{...t,pendingOp:{txId:e,initialDoc:t.current.document,initialOptions:t.current.options},current:{...t.current,options:{}}},txId:e}},updateOperation:(t,e,n)=>{var r;return O(((r=t.pendingOp)==null?void 0:r.txId)===e,"pending op mismatch"),{...t,current:{...t.current,document:Se(t.current.document,n)}}},revertOperation:(t,e)=>{var n;return O(((n=t.pendingOp)==null?void 0:n.txId)===e,"Pending op mismatch"),{...t,pendingOp:null,current:{document:t.pendingOp.initialDoc,location:t.current.location,options:t.pendingOp.initialOptions}}},commitOperation:(t,e,n={})=>{var o;O(((o=t.pendingOp)==null?void 0:o.txId)===e,"Pending op mismatch");const r=[{document:t.pendingOp.initialDoc,location:t.current.location,options:t.pendingOp.initialOptions},...t.undoStates];for(;r.length>ti;)r.pop();const i={...t.current,options:n};return n.lockstepLocation&&(i.location=Se(i.location,n.lockstepLocation)),{...t,current:i,pendingOp:null,undoStates:r,redoStates:null}},updateDocument:(t,e,n)=>{let r;return{undoStack:t,txId:r}=G.beginOperation(t),t=G.updateOperation(t,r,e),G.commitOperation(t,r,n)},undo:(t,e)=>{var o;if(O(t.pendingOp==null,"Pending op in progress"),t.undoStates.length==0)return t;e.triggerAnimation("undo");const[n,...r]=t.undoStates;if(!Rt(n.location,t.current.location)&&!t.current.options.lockstepLocation)return{...t,current:{...t.current,location:n.location}};const i=[t.current,...(o=t.redoStates)!=null?o:[]];return{...t,current:n,undoStates:r,redoStates:i}},redo:(t,e)=>{if(O(t.pendingOp==null,"pending op in progress"),!t.redoStates||t.redoStates.length==0)return t;e.triggerAnimation("redo");const[n,...r]=t.redoStates;if(!Rt(n.location,t.current.location)&&!n.options.lockstepLocation)return{...t,current:{...t.current,location:n.location}};const i=[t.current,...t.undoStates];return{...t,current:n.options.lockstepLocation?{...n,location:Se(t.current.location,n.options.lockstepLocation)}:n,undoStates:i,redoStates:r.length===0?null:r}},updateLocation:(t,e)=>({...t,current:{...t.current,location:Se(t.current.location,e)}})};class Ns{constructor(){this.type=A.Play,this.previewPosition=new W(null,"PlayMode.previewPosition")}isIdleLive(){return!0}toDebugStringLive(){var e,n;return Ue("play",{_:(n=(e=this.previewPosition.live())==null?void 0:e.toString(2))!=null?n:null})}onPointerEvent({event:e,eventType:n,splatapus:r}){switch(n){case"move":case"down":e.isPrimary&&this.previewPosition.update(r.viewport.eventSceneCoords(e));return;case"cancel":case"up":return;default:U(n)}}getPreviewPositionLive(){return this.previewPosition.live()}renderOverlay(){return null}}function $t(t){switch(t){case A.Draw:return new hs;case A.Rig:return new St;case A.Play:return new Ns;default:U(t)}}const Ms={[A.Draw]:"d",[A.Rig]:"r",[A.Play]:"p"};class Os{constructor(e){this.multiTouchPan=new ls,this.quickPan=new Ds,this.activeMode=new W($t(e),"Interaction.activeMode"),this.activeMode.addBatchInvalidateListener(()=>this.activeMode.getOnce())}toDebugStringLive(){var e;return(e=this.quickPan.toDebugStringLive())!=null?e:this.activeMode.live().toDebugStringLive()}getCanvasClassNameLive(){return this.quickPan.getCanvasClassNameLive()}getPreviewPositionLive(){return this.activeMode.live().getPreviewPositionLive()}isSidebarOpenLive(){return this.activeMode.live().type!==A.Play}requestSetActiveMode(e){this.quickPan.isKeyDown.getOnce()||this.activeMode.update(n=>Qe(()=>!n.isIdleLive())?n:$t(e))}onKeyDown(e){var r;const n=this.activeMode.getOnce();if(Qe(()=>n.isIdleLive())){if(this.quickPan.onKeyDown(e)||this.quickPan.isKeyDown.getOnce())return;for(const[i,o]of Hr(Ms))if(Ae(e.event,o)){const s=$t(i);e.splatapus.vfx.triggerAnimation(i),this.activeMode.update(s);return}if(Ae(e.event,{key:"z",command:!0})){e.splatapus.undoStack.update(i=>G.undo(i,e.splatapus.vfx));return}if(Ae(e.event,{key:"z",command:!0,shift:!0})){e.splatapus.undoStack.update(i=>G.redo(i,e.splatapus.vfx));return}}if(Ae(e.event,{key:"0",command:!0})){e.splatapus.viewport.pan.update(D.ZERO),e.splatapus.viewport.zoom.update(1);return}for(let i=0;i<9;i++)if(Ae(e.event,`${i+1}`)){const o=(r=[...e.splatapus.document.getOnce().keyPoints][i])==null?void 0:r.id;if(o){e.splatapus.location.keyPointId.update(o);return}}}onKeyUp(e){this.quickPan.onKeyUp(e)}onPointerEvent(e){const n=ps(this.multiTouchPan,e);!n||(this.quickPan.isKeyDown.getOnce()?this.quickPan.onPointerEvent(n):this.activeMode.getOnce().onPointerEvent(n))}}class As{constructor(e,n){this.screenSize=e,this.vfx=new zi,this.location=new Ni(new he(()=>this.undoStack.live().current.location,r=>this.undoStack.update(i=>G.updateLocation(i,r)),"location")),this.document=new he(()=>this.undoStack.live().current.document,(r,i)=>this.undoStack.update(o=>G.updateDocument(o,r,i)),"document"),this.viewport=new Ti(this.screenSize,new ct(()=>this.interaction.isSidebarOpenLive(),"viewport.isSidebarOpen"),this.location.viewportState),this.onPointerDown=r=>this.onPointerEvent("down",r),this.onPointerMove=r=>this.onPointerEvent("move",r),this.onPointerUp=r=>this.onPointerEvent("up",r),this.onPointerCancel=r=>this.onPointerEvent("cancel",r),this.onWheel=r=>{this.viewport.handleWheelEvent(r)},this.onKeyDown=r=>this.interaction.onKeyDown({event:r,splatapus:this}),this.onKeyUp=r=>this.interaction.onKeyUp({event:r,splatapus:this}),this.previewPosition=new ct(()=>{const r=this.interaction.getPreviewPositionLive();return r?qt.interpolated(r):qt.keyPointId(this.location.keyPointId.live())},"previewPosition"),this.undoStack=new W(G.initialize(n),"undoStack"),this.interaction=new Os(n.location.mode),this.keyPointIdHistory=new W(Array.from(this.document.getOnce().keyPoints,r=>r.id),"keyPointIdHistory")}onPointerEvent(e,n){this.interaction.onPointerEvent({event:n,eventType:e,splatapus:this})}}function $s(t){const e=d.exports.useState(()=>new As(new W(D.ZERO,"screenSize"),t()))[0];return d.exports.useEffect(()=>{window.splatapus=e;const n=[ut(me.eager,()=>{const r=e.interaction.activeMode.live().type;e.location.mode.live()!==r&&e.location.mode.update(r)}),ut(me.eager,()=>{const r=e.location.keyPointId.live(),i=e.document.live();e.keyPointIdHistory.update(o=>{const s=o.filter(a=>i.keyPoints.has(a)&&a!==r);return s.length===o.length-1&&Kr(o)===r?(console.log("update keyPointIdHistory (static)"),o):(console.log("update keyPointIdHistory (changed)"),s.push(r),s)})})];return()=>{for(const r of n)r()}},[e]),e}const _s=L.memo(function({width:e,height:n,shapeId:r,keyPointId:i,splatapus:o}){const a=H(()=>{const S=o.document.live(),g=S.getShapeVersion(i,r);return g?S.getNormalizedCenterPointsForShapeVersion(g.id):null},[i,r,o.document]);if(!a||a.length<2)return null;let l=1/0,c=1/0,u=-1/0,p=-1/0;for(const{center:S,radius:g}of a)l=Math.min(l,S.x-g),u=Math.max(u,S.x+g),c=Math.min(c,S.y-g),p=Math.max(p,S.y+g);const v=u-l,y=p-c,h=e-4*2,m=n-4*2,w=Math.min(h/v,.8),b=Math.min(m/y,.8),P=Math.min(w,b);return f("svg",{viewBox:`0 0 ${e} ${n}`,style:{width:e,height:n},children:f("g",{transform:`translate(${4+Math.max(h-v*P,0)/2}, ${4+Math.max(m-y*P,0)/2}) scale(${P}) translate(${-l}, ${-c})`,children:f("path",{d:lt(dt(a)),className:"fill-stone-800"})})})}),Rn=84,zn=80;function Fs({splatapus:t}){const e=ie(t.location.keyPointId),n=ie(t.location.shapeId),r=Array.from(H(()=>t.document.live().keyPoints,[t])),i=Array.from(H(()=>t.document.live().shapes,[t])),o=Array.from(r).findIndex(l=>e===l.id),s=Array.from(i).findIndex(l=>n===l.id),a=_i(t);return F("div",{className:"relative flex h-0 flex-auto flex-col gap-4 overflow-auto p-5 [-webkit-overflow-scrolling:touch]",children:[f("div",{className:"absolute top-5 left-5 z-0 w-20 rounded bg-stone-200 ring-2 ring-stone-200 transition-transform",style:{height:-16+zn*i.length,transform:`translateX(${o*Rn}px)`}}),f("div",{className:"absolute top-5 z-0 h-16 rounded bg-stone-200 ring-2 ring-stone-200 transition-transform",style:{width:-4+Rn*(r.length+1),transform:`translateY(${s*zn}px)`}}),i.map((l,c)=>f("div",{className:"relative flex w-max flex-col gap-2",children:F("div",{className:"flex gap-1",children:[r.map(u=>f("button",{className:K("overflow-none h-16 w-20 flex-none rounded border",l.id===n&&u.id===e?`${a.border500} ring-1 ${a.ring500} bg-white`:"border-stone-300 bg-white/25 hover:bg-white/50"),onClick:()=>{t.location.shapeId.update(l.id),t.location.keyPointId.update(u.id)},children:f(_s,{width:78,height:62,keyPointId:u.id,shapeId:l.id,splatapus:t})},u.id)),f("button",{className:"h-16 w-20 flex-none rounded border border-stone-300 text-xl text-stone-400 hover:bg-white/50",onClick:()=>{const u=We.generate();t.document.update(p=>p.addKeyPoint(u,null),{lockstepLocation:p=>({...p,keyPointId:u,shapeId:l.id})})},children:"+"})]})},l.id)),f(oe,{className:"sticky left-0",onClick:()=>{const l=Ge.generate();t.document.update(c=>c.addShape(l),{lockstepLocation:c=>({...c,shapeId:l})})},children:"+ shape"})]})}const Rs={width:en},de=20,zs=f("svg",{viewBox:`0 0 ${de} ${de}`,className:"flex-none",style:{width:de,height:de},children:f("path",{className:"fill-stone-100",d:["M 0,0",`L ${de},0`,`L ${de},${de}`,`Q ${de},0 0,0`,"Z"].join(" ")})});function Vs({topBarRight:t,topBarLeft:e,rightBar:n,bottomBarLeft:r,bottomBarRight:i,splatapus:o}){const s=ie(o.viewport.isSidebarOpen);return F("div",{className:"pointer-events-none absolute inset-0 z-20 flex flex-col items-stretch",children:[F("div",{className:"pointer-events-auto flex flex-none items-center justify-between gap-3 bg-stone-100 px-3 py-2",children:[f("h1",{className:"order-1 flex-1 font-bold tracking-wide text-stone-600",children:"splatapus"}),f("div",{className:"order-2 flex flex-1 items-center justify-center gap-2",children:e}),f("div",{className:"order-3 flex flex-1 items-center justify-end gap-2",children:t})]}),F(fe,{className:"flex flex-auto items-start justify-end",show:s,enter:"transition",enterFrom:"translate-x-80",enterTo:"translate-x-0",leave:"transition",leaveFrom:"translate-0",leaveTo:"translate-x-80",children:[zs,f("div",{className:"pointer-events-auto flex h-full flex-col bg-stone-100",style:Rs,children:n})]}),f("div",{className:"absolute bottom-0 left-0",children:r}),f("div",{className:"absolute bottom-0 right-0 transition-transform",style:{transform:`translateX(${-en}px)`},children:i})]})}const Bs={id:"doc.0_VcKaG8h9Zf8pyG",keyPoints:{"key.0_a3vKHuIcxpHnVg":{id:"key.0_a3vKHuIcxpHnVg",position:[84.4612113767582,-310.6259226617922]},"key.1_TYmFrn9Wh1QZ3t":{id:"key.1_TYmFrn9Wh1QZ3t",position:[76.77421647506128,82.8797180046771]},"key.2_8mSx0MUXiSEjNK":{id:"key.2_8mSx0MUXiSEjNK",position:[-290.00197453390416,88.34970510918276]},"key.3_RariJQz2eTMOkJ":{id:"key.3_RariJQz2eTMOkJ",position:[466.25676711635367,91.8418718809971]}},shapes:{"shp.0_n9ry1znj34Bp1k":{id:"shp.0_n9ry1znj34Bp1k"},"shp.1_ONCgL3fjUYIryN":{id:"shp.1_ONCgL3fjUYIryN"},"shp.2_Zwa9ObnrYgWogq":{id:"shp.2_Zwa9ObnrYgWogq"},"shp.3_mUCVyzbyAGCuIa":{id:"shp.3_mUCVyzbyAGCuIa"},"shp.4_SMMSTDAbn3tdXv":{id:"shp.4_SMMSTDAbn3tdXv"},"shp.5_pFzZ21ghrzLlt1":{id:"shp.5_pFzZ21ghrzLlt1"}},shapeVersions:{"shv.0_LwpIe0fFofKDNO":{id:"shv.0_LwpIe0fFofKDNO",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[[-41,-45],[-47,-41],[-49,-39],[-53,-34],[-57,-30],[-61,-25],[-64,-20],[-66,-16],[-69,-11],[-71,-6],[-73,-1],[-74,5],[-76,11],[-76,16],[-77,22],[-78,28],[-78,35],[-78,42],[-78,49],[-78,56],[-78,62],[-78,68],[-76,74],[-74,80],[-71,86],[-68,91],[-64,96],[-60,102],[-55,107],[-49,112],[-44,118],[-37,123],[-30,128],[-23,132],[-15,137],[-7,140],[2,144],[11,147],[20,150],[30,152],[39,152],[49,153],[59,153],[69,153],[78,153],[89,152],[99,149],[109,147],[120,143],[129,139],[138,134],[148,129],[156,123],[164,117],[172,110],[179,103],[187,96],[193,89],[198,83],[202,76],[206,69],[208,63],[210,58],[211,52],[212,46],[213,38],[213,30],[213,23],[213,17],[213,11],[213,5],[213,-3],[213,-11],[213,-18],[213,-23],[212,-28],[211,-32],[209,-36],[208,-40],[206,-42],[205,-44],[203,-46],[201,-47],[200,-48],[199,-48],[199,-50]]},"shv.1_SWgK9k5Y2kn7dj":{id:"shv.1_SWgK9k5Y2kn7dj",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[[-25,-43],[-25,-47],[-25,-49],[-24,-56],[-22,-65],[-19,-77],[-16,-90],[-14,-101],[-10,-113],[-8,-123],[-4,-131],[-2,-139],[1,-145],[3,-149],[4,-152],[6,-154],[7,-154],[8,-154],[10,-153],[12,-151],[15,-147],[18,-142],[21,-135],[24,-127],[27,-118],[29,-108],[30,-98],[30,-88],[31,-79],[32,-72],[32,-67],[33,-64],[33,-62],[34,-62],[34,-61],[34,-60],[35,-59]]},"shv.3_3ILI63YytH2Ite":{id:"shv.3_3ILI63YytH2Ite",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[[126,-69],[127,-75],[130,-84],[136,-96],[142,-108],[148,-118],[154,-128],[161,-137],[169,-145],[177,-152],[183,-158],[188,-162],[191,-164],[192,-164],[193,-164],[193,-163],[194,-158],[194,-152],[196,-144],[196,-135],[197,-125],[197,-114],[197,-103],[197,-92],[196,-83],[195,-74],[194,-67],[193,-62],[192,-60],[192,-58],[192,-57],[192,-55],[192,-50],[192,-48]]},"shv.4_dljDpCZ90LHjbP":{id:"shv.4_dljDpCZ90LHjbP",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[[41,-63],[46,-66],[51,-67],[57,-69],[65,-71],[72,-72],[80,-73],[89,-74],[99,-74],[109,-74],[115,-74],[120,-74],[124,-74],[127,-74],[129,-74],[130,-73],[130,-72]]},"shv.5_g5nKgDG7juS3Au":{id:"shv.5_g5nKgDG7juS3Au",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[[21,-10],[15,-10],[11,-10],[5,-7],[-2,-3],[-8,1],[-14,6],[-18,10],[-22,14],[-25,19],[-27,24],[-29,30],[-30,38],[-30,44],[-30,48],[-29,52],[-26,55],[-22,59],[-17,62],[-10,65],[-3,66],[4,67],[11,67],[17,67],[22,64],[26,59],[29,53],[32,47],[33,44],[33,41],[33,40],[33,39],[33,36],[33,22],[33,16],[33,13],[33,11],[32,10],[31,9],[29,8],[27,8],[25,7],[24,6],[23,6],[22,6],[22,5],[21,4],[20,4],[20,3],[19,3],[18,3],[17,3]]},"shv.6_fOyfl45j6IoVJD":{id:"shv.6_fOyfl45j6IoVJD",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[[151,-26],[145,-27],[138,-26],[127,-21],[116,-14],[106,-6],[98,3],[91,11],[87,20],[84,30],[83,39],[83,47],[86,53],[92,57],[100,59],[110,60],[121,60],[133,59],[144,56],[154,51],[163,45],[172,37],[177,30],[180,24],[182,18],[184,11],[184,4],[184,-6],[180,-13],[176,-19],[171,-23],[166,-25],[161,-27],[155,-27],[148,-27],[141,-27],[135,-26],[129,-23],[123,-18]]},"shv.7_MNXQuLFOxPhQSP":{id:"shv.7_MNXQuLFOxPhQSP",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[[-35,25],[-41,26],[-44,26],[-48,26],[-53,27],[-57,29],[-62,30],[-67,33],[-72,35],[-77,38],[-83,42],[-88,46],[-92,50],[-97,55],[-101,62],[-105,68],[-108,75],[-111,81],[-113,87],[-114,92],[-114,96],[-114,101],[-114,104],[-113,108],[-111,111],[-108,115],[-105,118],[-101,121],[-98,123],[-94,126],[-90,128],[-85,130],[-80,132],[-74,133],[-69,135],[-62,137],[-56,138],[-49,139],[-43,140],[-36,140],[-30,140],[-24,140],[-18,140],[-12,140],[-7,140],[-1,141],[4,142],[9,142],[14,143],[21,144],[27,145],[33,147],[40,147],[46,148],[52,148],[58,148],[64,148],[70,148],[77,149],[83,149],[89,149],[95,149],[101,149],[107,149],[114,149],[121,149],[128,149],[136,149],[144,148],[151,147],[158,147],[165,145],[172,144],[179,144],[186,143],[193,142],[200,140],[206,139],[213,137],[220,134],[225,132],[231,130],[237,127],[242,123],[249,119],[255,113],[262,108],[266,103],[270,99],[274,95],[276,92],[278,89],[279,86],[280,83],[281,80],[281,77],[281,75],[281,74],[281,72],[280,69],[279,65],[277,60],[275,56],[274,53],[272,50],[270,47],[267,43],[265,39],[262,35],[259,30],[256,27],[252,23],[250,21],[246,18],[242,16],[239,14],[235,11],[230,10],[227,8],[223,8],[221,7],[217,7],[213,6],[210,6],[206,6],[204,6],[202,6],[201,6],[200,6],[200,5]]},"shv.8_dqc9S1VROeclkw":{id:"shv.8_dqc9S1VROeclkw",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[[-20,20],[-23,16],[-23,13],[-25,10],[-26,7],[-29,4],[-32,1],[-35,-1],[-38,-4],[-39,-5],[-41,-6],[-43,-6],[-46,-8],[-49,-9],[-53,-9],[-56,-10],[-58,-10],[-59,-10],[-61,-11],[-62,-11],[-63,-11],[-64,-11],[-64,-12],[-64,-13],[-64,-14],[-64,-15],[-64,-16],[-63,-17],[-62,-18],[-61,-20],[-59,-22],[-56,-24],[-54,-26],[-52,-28],[-49,-29],[-46,-31],[-43,-32],[-39,-33],[-36,-33],[-32,-33],[-28,-33],[-24,-33],[-19,-33],[-15,-32],[-12,-31],[-9,-29],[-7,-28],[-5,-26],[-3,-24],[-2,-22],[0,-20],[2,-18],[3,-14],[5,-11],[7,-8],[7,-6],[9,-4],[9,-3],[11,-1],[12,0],[14,2],[15,4],[16,6],[16,8],[17,8],[17,9],[18,10],[18,11],[19,11],[19,12],[19,13],[19,14],[19,15],[20,16],[21,17]]},"shv.9_wkf9c4ZDBAwLRf":{id:"shv.9_wkf9c4ZDBAwLRf",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[[152,-11],[156,-17],[158,-21],[162,-25],[167,-31],[174,-36],[181,-42],[189,-48],[196,-54],[204,-59],[212,-62],[220,-63],[228,-63],[236,-63],[245,-63],[252,-63],[257,-62],[259,-61],[261,-60],[262,-60],[263,-59],[263,-58],[263,-57],[260,-55],[255,-52],[250,-48],[243,-43],[237,-38],[230,-33],[225,-27],[218,-20],[213,-13],[208,-6],[206,-2],[204,0],[204,1],[204,2]]},"shv.10_QVHVJVxyuxdpD":{id:"shv.10_QVHVJVxyuxdpD",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[[31,17],[33,16],[36,16],[47,11],[58,6],[72,1],[84,-1],[99,-4],[113,-6],[124,-6],[134,-7],[141,-8],[147,-8],[152,-8],[154,-8],[155,-7],[155,-6],[155,-4]]},"shv.12_5jxllLtpm93b7":{id:"shv.12_5jxllLtpm93b7",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[[19,55],[12,55],[9,55],[4,55],[-1,56],[-6,57],[-10,57],[-15,58],[-20,59],[-26,60],[-32,63],[-37,65],[-43,68],[-47,71],[-52,74],[-54,77],[-57,81],[-59,86],[-61,90],[-62,95],[-62,98],[-62,101],[-62,103],[-61,105],[-56,107],[-51,108],[-44,110],[-37,110],[-30,110],[-24,110],[-17,108],[-9,106],[-3,103],[4,100],[10,97],[16,94],[21,91],[25,88],[30,84],[33,81],[36,77],[37,75],[38,73],[38,72],[38,71],[38,70],[38,69],[37,69],[36,67],[35,66],[34,65],[32,61],[29,54],[26,51],[25,50],[24,50],[23,50],[22,50],[21,50],[20,51],[19,52],[17,54],[14,57],[13,59]]},"shv.14_GWIuG0AcQVcWv":{id:"shv.14_GWIuG0AcQVcWv",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[[221,50],[215,47],[211,47],[206,46],[200,46],[195,45],[191,45],[185,45],[179,45],[173,46],[166,50],[160,53],[155,57],[150,60],[148,64],[146,67],[145,71],[144,76],[144,81],[144,86],[144,89],[145,92],[148,94],[152,97],[158,99],[165,100],[173,101],[181,101],[189,101],[197,99],[205,96],[213,93],[221,90],[228,87],[234,84],[238,81],[241,80],[244,78],[247,76],[248,74],[248,73],[248,72],[248,70],[248,69],[248,68],[248,67],[246,66],[243,60],[240,57],[238,55],[237,54],[235,54],[233,53],[229,52],[224,52],[218,52],[214,52],[210,52],[204,52],[197,54]]},"shv.15_IegtY8uWpenHx":{id:"shv.15_IegtY8uWpenHx",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[[-137,13],[-143,8],[-144,8],[-146,8],[-148,7],[-150,6],[-152,6],[-155,5],[-158,4],[-161,3],[-165,2],[-169,1],[-173,1],[-176,1],[-180,1],[-183,1],[-186,1],[-189,1],[-192,1],[-195,1],[-196,1],[-198,3],[-200,5],[-202,10],[-204,15],[-206,20],[-207,24],[-208,28],[-209,31],[-209,35],[-209,38],[-209,40],[-209,43],[-209,46],[-207,49],[-205,52],[-204,56],[-202,59],[-200,63],[-199,67],[-197,70],[-195,72],[-194,74],[-193,76],[-190,77],[-188,80],[-186,82],[-183,84],[-179,87],[-175,90],[-171,93],[-166,96],[-160,99],[-155,102],[-149,105],[-143,108],[-137,110],[-131,113],[-125,116],[-119,120],[-112,123],[-106,125],[-100,127],[-94,129],[-88,132],[-82,134],[-76,135],[-70,137],[-64,139],[-58,141],[-52,142],[-45,144],[-38,145],[-31,146],[-23,147],[-16,147],[-8,147],[0,147],[8,147],[17,147],[25,147],[34,147],[42,147],[49,147],[56,146],[63,146],[71,145],[78,144],[85,143],[92,142],[99,142],[106,141],[113,140],[120,139],[127,138],[134,137],[141,137],[149,136],[156,135],[164,134],[172,132],[179,131],[187,130],[194,128],[201,126],[208,123],[214,121],[221,118],[226,114],[230,111],[235,108],[238,104],[241,99],[244,93],[247,89],[250,82],[252,75],[255,65],[257,55],[257,48],[257,45],[257,43],[257,42],[252,36],[249,32],[245,28],[241,26],[239,25],[235,24],[231,21],[225,18],[219,16],[215,13],[211,11],[209,10],[208,8],[208,7],[207,6],[206,6],[205,6],[204,6],[203,6],[202,6],[201,6],[199,6],[198,6],[196,6],[194,6],[191,5],[189,5],[187,4],[184,4],[180,3],[177,3],[172,2],[168,1],[164,1],[160,0],[155,0],[151,0],[147,-1],[143,-1],[139,-1],[136,-1],[132,-1],[128,-1],[123,-1],[119,-1],[114,-1],[110,-1],[106,-1],[102,-1],[99,0],[95,1],[92,1],[90,1],[89,1],[87,2],[86,2],[85,2],[84,2],[84,3],[83,3],[82,3],[82,4],[81,4],[80,4],[79,4],[78,4],[77,4],[77,5],[76,5],[75,5],[74,5],[73,6],[72,6],[70,6],[67,7],[65,7],[63,8],[61,8],[59,8],[57,9],[55,10],[53,10],[52,11],[50,11],[49,11],[48,11],[47,11],[47,12],[47,13]]},"shv.17_JPHh1b7aVM4a5":{id:"shv.17_JPHh1b7aVM4a5",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[[-130,1],[-135,-3],[-137,-4],[-140,-8],[-143,-11],[-147,-13],[-151,-15],[-155,-17],[-160,-19],[-165,-21],[-170,-23],[-175,-23],[-179,-23],[-183,-23],[-188,-23],[-191,-23],[-194,-22],[-197,-21],[-200,-20],[-201,-19],[-202,-19],[-203,-19],[-204,-19],[-204,-20],[-204,-21],[-204,-25],[-202,-30],[-198,-35],[-194,-40],[-190,-43],[-185,-46],[-181,-48],[-176,-49],[-171,-50],[-165,-52],[-159,-52],[-154,-54],[-149,-54],[-145,-54],[-139,-54],[-134,-53],[-130,-50],[-127,-48],[-124,-45],[-121,-41],[-119,-37],[-117,-32],[-115,-26],[-113,-19],[-112,-12],[-112,-6],[-112,-2],[-112,0],[-112,1],[-112,2],[-112,3],[-111,3],[-111,4],[-111,5]]},"shv.19_XdsJ3W4A719pc":{id:"shv.19_XdsJ3W4A719pc",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[[-31,2],[-33,-4],[-33,-7],[-34,-11],[-36,-14],[-38,-17],[-40,-22],[-43,-27],[-46,-32],[-48,-35],[-50,-38],[-52,-41],[-55,-44],[-59,-48],[-62,-52],[-66,-56],[-69,-58],[-72,-60],[-76,-61],[-79,-61],[-82,-61],[-85,-61],[-87,-61],[-88,-61],[-89,-61],[-90,-62],[-88,-62],[-87,-63],[-85,-63],[-83,-63],[-80,-63],[-76,-63],[-70,-63],[-64,-63],[-58,-63],[-52,-63],[-47,-62],[-42,-61],[-38,-59],[-34,-56],[-30,-53],[-27,-49],[-24,-45],[-21,-42],[-19,-39],[-17,-35],[-14,-31],[-10,-25],[-7,-19],[-3,-13],[0,-8],[3,-4],[5,-1],[7,2],[9,5],[12,9],[16,13],[19,17],[22,19],[24,21],[26,23],[27,23],[28,24],[28,25],[29,25],[29,26]]},"shv.20_QSK3n1l8MmGEZ":{id:"shv.20_QSK3n1l8MmGEZ",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[[-102,9],[-100,8],[-97,8],[-93,8],[-89,7],[-86,6],[-83,5],[-79,4],[-75,4],[-71,4],[-67,4],[-63,4],[-60,3],[-58,3],[-55,3],[-52,3],[-49,3],[-47,3],[-44,3],[-43,3],[-42,3]]},"shv.22_I2STbWZAXgo1B":{id:"shv.22_I2STbWZAXgo1B",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[[-110,42],[-115,40],[-118,40],[-122,40],[-126,38],[-130,36],[-134,34],[-138,32],[-141,31],[-144,30],[-147,29],[-151,28],[-154,27],[-158,26],[-162,26],[-165,26],[-168,26],[-170,27],[-171,29],[-172,32],[-173,34],[-174,37],[-174,39],[-174,41],[-174,43],[-174,45],[-174,47],[-172,49],[-169,52],[-165,56],[-160,60],[-155,64],[-149,68],[-143,72],[-137,75],[-132,78],[-125,81],[-119,83],[-112,85],[-107,86],[-101,86],[-96,86],[-92,86],[-88,84],[-85,80],[-83,77],[-82,74],[-82,72],[-82,71],[-82,69],[-82,67],[-83,63],[-86,60],[-87,57],[-88,55],[-90,51],[-93,44],[-96,37],[-100,32],[-102,29],[-103,28],[-105,28],[-106,28],[-107,28],[-108,28],[-108,29]]},"shv.23_wW18nQbpEd7gx":{id:"shv.23_wW18nQbpEd7gx",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[[4,40],[-2,38],[-5,38],[-9,38],[-14,37],[-18,37],[-24,37],[-28,37],[-32,37],[-35,38],[-38,39],[-40,41],[-42,43],[-42,45],[-43,46],[-43,47],[-43,50],[-43,54],[-41,59],[-38,64],[-35,68],[-32,72],[-29,74],[-25,77],[-22,79],[-18,79],[-13,80],[-8,80],[-3,80],[3,80],[9,79],[15,75],[21,72],[26,69],[31,66],[34,64],[36,61],[38,59],[38,58],[38,57],[37,56],[36,56],[34,55],[31,52],[26,49],[21,45],[16,42],[12,40],[9,38],[6,36],[3,35],[-1,35],[-4,34],[-7,34],[-10,33],[-12,33],[-13,33],[-21,38]]},"shv.25_bSftSx0IJxw7H":{id:"shv.25_bSftSx0IJxw7H",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[[110.49240292871617,19.52362771067062],[101.42737067012109,11.753600060446258],[100.13236606175036,11.753600060446258],[96.24735223663818,11.753600060446258],[89.77232919478455,10.458595452075532],[84.59231076130163,9.163590843704805],[75.52727850270655,9.163590843704805],[67.75725085248219,7.868586235334078],[58.6922185938871,7.868586235334078],[50.922190943662734,7.868586235334078],[43.15216329343838,7.868586235334078],[35.38213564321401,7.868586235334078],[27.612107992989653,7.868586235334078],[19.84208034276529,7.868586235334078],[13.367057300911656,7.868586235334078],[6.892034259058021,9.163590843704805],[.4170112172043865,9.163590843704805],[-6.058011824649248,11.753600060446258],[-12.533034866502883,14.343609277187712],[-17.71305329998579,15.63861388555844],[-22.893071733468698,19.52362771067062],[-29.368094775322334,22.113636927412074],[-34.54811320880524,24.703646144153527],[-41.02313625065887,29.883664577636434],[-47.49815929251251,33.76867840274862],[-51.38317311762469,37.653692227860795],[-55.268186942736875,40.24370144460225],[-56.5631915511076,41.53870605297298],[-57.858196159478325,42.83371066134371],[-59.15320076784905,44.128715269714434],[-59.15320076784905,46.71872448645588],[-60.44820537621978,50.603738311568065],[-61.74320998459051,55.78375674505097],[-63.03821459296123,60.96377517853388],[-64.33321920133196,67.43879822038751],[-64.33321920133196,73.91382126224116],[-64.33321920133196,80.38884430409479],[-64.33321920133196,86.86386734594842],[-61.74320998459051,92.04388577943133],[-59.15320076784905,95.92889960454352],[-55.268186942736875,99.81391342965568],[-51.38317311762469,102.40392264639715],[-47.49815929251251,106.28893647150933],[-42.318140859029604,108.87894568825078],[-35.843117817175965,111.46895490499223],[-29.368094775322334,112.76395951336296],[-21.598067125097973,115.35396873010441],[-15.123044083244336,116.64897333847514],[-7.353016433019975,116.64897333847514],[-.8779933911663405,117.94397794684586],[6.892034259058021,119.2389825552166],[15.95706651765311,120.53398716358733],[23.72709416787747,123.12399638032878],[34.08713103484329,123.12399638032878],[41.85715868506765,124.41900098869951],[50.922190943662734,125.71400559707023],[58.6922185938871,128.30401481381168],[67.75725085248219,129.5990194221824],[76.82228311107728,132.18902863892387],[87.1823199780431,133.4840332472946],[96.24735223663818,134.7790378556653],[106.60738910360399,136.07404246403604],[115.67242136219909,137.36904707240677],[124.73745362079417,138.6640516807775],[132.50748127101855,138.6640516807775],[140.27750892124288,139.95905628914824],[149.34254117983798,141.25406089751894],[157.11256883006234,142.54906550588967],[166.17760108865744,143.8440701142604],[175.24263334725254,145.13907472263114],[184.3076656058476,145.13907472263114],[192.07769325607197,146.43407933100187],[201.14272551466706,146.43407933100187],[210.20775777326216,146.43407933100187],[219.27279003185726,146.43407933100187],[228.33782229045232,146.43407933100187],[239.99286376578888,146.43407933100187],[250.35290063275468,143.8440701142604],[263.302946716462,141.25406089751894],[276.25299280016924,137.36904707240677],[289.2030388838765,133.4840332472946],[300.85808035921303,129.5990194221824],[312.51312183454957,125.71400559707023],[322.8731587015154,121.82899177195804],[333.2331955684812,117.94397794684586],[344.88823704381775,111.46895490499223],[355.24827391078355,104.9939318631386],[364.3133061693787,98.51890882128497],[372.083333819603,92.04388577943133],[379.8533614698274,86.86386734594842],[386.328384511681,80.38884430409479],[394.0984121619054,72.61881665387043],[401.86843981212974,66.1437936120168],[408.3434628539834,57.078761353421704],[412.22847667909554,50.603738311568065],[414.818485895837,46.71872448645588],[414.818485895837,44.128715269714434],[414.818485895837,42.83371066134371],[414.818485895837,41.53870605297298],[414.818485895837,40.24370144460225],[413.52348128746627,37.653692227860795],[410.9334720707248,36.35868761949007],[408.3434628539834,33.76867840274862],[405.75345363724193,29.883664577636434],[401.86843981212974,24.703646144153527],[397.98342598701754,19.52362771067062],[392.80340755353467,13.048604668816985],[388.9183937284225,9.163590843704805],[386.328384511681,6.5735816269633505],[382.4433706865688,2.68856780185117],[379.8533614698274,.098558585109716],[375.9683476447152,-2.491450631631738],[372.083333819603,-3.7864552400024647],[368.1983199944908,-6.376464456743919],[364.3133061693787,-7.671469065114645],[360.4282923442665,-8.966473673485373],[357.838283127525,-8.966473673485373],[352.65826469404215,-8.966473673485373],[348.77325086892995,-10.2614782818561],[343.593232435447,-10.2614782818561],[338.4132140019641,-10.2614782818561],[331.9381909601105,-10.2614782818561],[326.75817252662756,-10.2614782818561],[320.28314948477396,-10.2614782818561],[313.8081264429203,-10.2614782818561],[307.3331034010667,-10.2614782818561],[302.15308496758377,-10.2614782818561],[296.97306653410084,-10.2614782818561],[291.79304810061797,-10.2614782818561],[285.3180250587643,-10.2614782818561],[277.54799740853997,-10.2614782818561],[269.7779697583156,-8.966473673485373],[262.00794210809124,-7.671469065114645],[255.53291906623758,-6.376464456743919],[251.64790524112541,-5.081459848373192],[250.35290063275468,-3.7864552400024647],[249.05789602438395,-3.7864552400024647],[250.35290063275468,-2.491450631631738]]},"shv.26_FUFwushsNIoT8":{id:"shv.26_FUFwushsNIoT8",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[[116.9674259705698,15.63861388555844],[120.85243979568199,6.5735816269633505],[122.14744440405272,2.68856780185117],[124.73745362079417,.098558585109716],[128.62246744590635,-3.7864552400024647],[131.21247666264782,-7.671469065114645],[135.09749048775998,-12.851487498597553],[138.98250431287218,-16.736501323709735],[144.16252274635508,-21.916519757192642],[149.34254117983798,-25.801533582304824],[153.22755500495018,-29.686547407417002],[157.11256883006234,-33.571561232529184],[160.99758265517454,-36.16157044927064],[164.8825964802867,-38.75157966601209],[168.7676103053989,-41.34158888275355],[172.65262413051107,-42.63659349112427],[176.53763795562324,-43.931598099495],[179.1276471723647,-43.931598099495],[181.71765638910617,-43.931598099495],[183.0126609974769,-43.931598099495],[184.3076656058476,-45.22660270786573],[185.60267021421834,-45.22660270786573],[188.1926794309598,-46.521607316236455],[189.48768403933053,-46.521607316236455],[190.78268864770124,-46.521607316236455],[192.07769325607197,-46.521607316236455],[193.3726978644427,-46.521607316236455],[194.66770247281343,-46.521607316236455],[195.96270708118416,-45.22660270786573],[195.96270708118416,-43.931598099495],[195.96270708118416,-42.63659349112427],[195.96270708118416,-40.046584274382816],[195.96270708118416,-37.456575057641366],[194.66770247281343,-32.27655662415846],[193.3726978644427,-28.391542799046277],[189.48768403933053,-21.916519757192642],[185.60267021421834,-15.441496715339007],[181.71765638910617,-8.966473673485373],[177.83264256399397,-3.7864552400024647],[173.9476287388818,1.3935631934804429],[171.35761952214034,5.278577018592624],[170.0626149137696,6.5735816269633505],[168.7676103053989,7.868586235334078],[168.7676103053989,9.163590843704805],[168.7676103053989,10.458595452075532],[168.7676103053989,11.753600060446258],[168.7676103053989,13.048604668816985]]},"shv.28_mqL5cK4iYMnLO":{id:"shv.28_mqL5cK4iYMnLO",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[[241.2878683741596,-8.966473673485373],[238.69785915741815,-15.441496715339007],[238.69785915741815,-18.03150593208046],[238.69785915741815,-21.916519757192642],[241.2878683741596,-25.801533582304824],[242.58287298253032,-30.98155201578773],[245.17288219927178,-34.86656584089991],[247.76289141601325,-38.75157966601209],[251.64790524112541,-42.63659349112427],[256.8279236746083,-47.81661192460718],[264.5979513248327,-52.99663035809009],[271.0729743666863,-59.471653399943726],[277.54799740853997,-63.35666722505591],[284.0230204503936,-65.94667644179736],[290.49804349224723,-67.24168105016808],[298.26807114247157,-67.24168105016808],[306.03809879269596,-67.24168105016808],[313.8081264429203,-67.24168105016808],[321.5781540931447,-67.24168105016808],[328.0531771349983,-67.24168105016808],[333.2331955684812,-65.94667644179736],[335.8232047852227,-65.94667644179736],[337.1182093935934,-64.65167183342663],[338.4132140019641,-64.65167183342663],[335.8232047852227,-64.65167183342663],[333.2331955684812,-64.65167183342663],[325.46316791825683,-63.35666722505591],[317.6931402680325,-62.061662616685176],[311.21811722617883,-60.76665800831445],[303.4480895759545,-58.176648791572994],[294.38305731735943,-52.99663035809009],[286.61302966713504,-47.81661192460718],[277.54799740853997,-41.34158888275355],[271.0729743666863,-34.86656584089991],[265.89295593320344,-28.391542799046277],[262.00794210809124,-25.801533582304824],[260.7129374997205,-21.916519757192642],[259.4179328913498,-20.621515148821913],[258.12292828297905,-19.32651054045119],[258.12292828297905,-18.03150593208046],[258.12292828297905,-16.736501323709735],[258.12292828297905,-15.441496715339007],[258.12292828297905,-14.14649210696828],[258.12292828297905,-12.851487498597553],[258.12292828297905,-11.556482890226826],[258.12292828297905,-10.2614782818561],[258.12292828297905,-8.966473673485373],[259.4179328913498,-8.966473673485373],[259.4179328913498,-1.196446023261011]]},"shv.29_7s9cPPIlpJ9Np":{id:"shv.29_7s9cPPIlpJ9Np",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[[188.1926794309598,16.933618493929167],[192.07769325607197,10.458595452075532],[195.96270708118416,10.458595452075532],[202.4377301230378,9.163590843704805],[210.20775777326216,9.163590843704805],[217.97778542348652,7.868586235334078],[224.45280846534015,6.5735816269633505],[230.9278315071938,5.278577018592624],[236.1078499406767,2.68856780185117],[239.99286376578888,2.68856780185117],[242.58287298253032,1.3935631934804429],[243.87787759090105,1.3935631934804429],[245.17288219927178,1.3935631934804429],[246.46788680764251,1.3935631934804429]]},"shv.30_gZeoEkcUkLcml":{id:"shv.30_gZeoEkcUkLcml",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[[238.69785915741815,38.94869683623153],[232.22283611556452,41.53870605297298],[228.33782229045232,41.53870605297298],[225.7478130737109,45.42371987808516],[220.56779464022796,49.30873370319734],[216.6827808151158,54.48875213668025],[211.5027623816329,59.668770570163154],[206.32274394814996,66.1437936120168],[201.14272551466706,71.3238120454997],[198.5527162979256,76.50383047898261],[195.96270708118416,81.6838489124655],[194.66770247281343,84.27385812920697],[193.3726978644427,88.15887195431915],[193.3726978644427,89.45387656268987],[193.3726978644427,90.7488811710606],[193.3726978644427,93.33889038780205],[194.66770247281343,94.63389499617278],[198.5527162979256,95.92889960454352],[203.73273473140853,97.22390421291423],[208.91275316489143,98.51890882128497],[214.09277159837433,99.81391342965568],[220.56779464022796,99.81391342965568],[228.33782229045232,99.81391342965568],[237.40285454904742,97.22390421291423],[246.46788680764251,93.33889038780205],[256.8279236746083,88.15887195431915],[264.5979513248327,80.38884430409479],[272.36797897505704,72.61881665387043],[278.8430020169107,66.1437936120168],[282.72801584202284,60.96377517853388],[286.61302966713504,54.48875213668025],[287.90803427550577,49.30873370319734],[289.2030388838765,45.42371987808516],[289.2030388838765,44.128715269714434],[287.90803427550577,44.128715269714434],[285.3180250587643,44.128715269714434],[281.4330112336521,42.83371066134371],[276.25299280016924,42.83371066134371],[269.7779697583156,42.83371066134371],[262.00794210809124,42.83371066134371],[252.94290984949615,42.83371066134371],[245.17288219927178,42.83371066134371],[239.99286376578888,42.83371066134371],[237.40285454904742,42.83371066134371],[236.1078499406767,42.83371066134371],[236.1078499406767,44.128715269714434]]},"shv.32_Is4OGgrMoyylx":{id:"shv.32_Is4OGgrMoyylx",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[[377.26335225308594,20.81863231904135],[366.90331538612014,19.52362771067062],[364.3133061693787,19.52362771067062],[359.13328773589575,22.113636927412074],[352.65826469404215,27.29365536089498],[344.88823704381775,35.063683011119345],[337.1182093935934,44.128715269714434],[330.64318635173976,51.8987429199388],[326.75817252662756,59.668770570163154],[321.5781540931447,66.1437936120168],[320.28314948477396,72.61881665387043],[317.6931402680325,77.79883508735334],[317.6931402680325,80.38884430409479],[317.6931402680325,82.97885352083624],[318.9881448764032,84.27385812920697],[321.5781540931447,85.56886273757769],[326.75817252662756,85.56886273757769],[331.9381909601105,85.56886273757769],[339.7082186103348,84.27385812920697],[347.4782462605592,80.38884430409479],[355.24827391078355,76.50383047898261],[363.01830156100795,71.3238120454997],[370.7883292112323,67.43879822038751],[375.9683476447152,62.25877978690461],[381.14836607819814,57.078761353421704],[383.73837529493954,51.8987429199388],[387.62338912005174,46.71872448645588],[390.2133983367932,40.24370144460225],[392.80340755353467,35.063683011119345],[392.80340755353467,31.178669186007163],[392.80340755353467,28.58865996926571],[392.80340755353467,27.29365536089498],[390.2133983367932,27.29365536089498],[388.9183937284225,27.29365536089498],[387.62338912005174,27.29365536089498],[386.328384511681,27.29365536089498],[386.328384511681,28.58865996926571],[386.328384511681,31.178669186007163]]}}},Us={keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.0_n9ry1znj34Bp1k",viewport:{pan:[120,-2],zoom:1},mode:"draw"},js={document:Bs,location:Us};function Hs({splatapus:t}){return F(Q,{children:[f(Ws,{splatapus:t}),f(Ks,{splatapus:t}),f(qs,{splatapus:t}),f(Gs,{splatapus:t})]})}function Ks({splatapus:t}){return f(oe,{onClick:()=>{const e=encodeURIComponent(JSON.stringify(tt.serialize({document:t.document.getOnce(),location:t.location.state.getOnce()}))),n=window.document.createElement("a");n.setAttribute("href",`data:text/json;charset=utf-8,${e}`),n.setAttribute("download","splatapus.json"),n.click()},children:"export"})}function Ws({splatapus:t}){return f(oe,{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",n=>{var o;const r=(o=e.files)==null?void 0:o.item(0);if(!r)return;const i=new FileReader;i.addEventListener("load",()=>{const s=i.result;if(!s){alert("could not read file :(");return}O(typeof s=="string",'Assertion Error: typeof result === "string"');try{const a=tt.parse(JSON.parse(s));if(a.isError()){alert(`cannot read splat doc: ${a.error.message}`);return}const l=a.value;t.document.update(()=>l.document,{lockstepLocation:c=>l.location})}catch(a){alert(`could not parse json: ${Wr(a)}`)}}),i.readAsText(r)}),e.click()},children:"import"})}function Gs({splatapus:t}){return f(oe,{onClick:()=>{const{document:e,location:n}=sr();t.document.update(()=>e,{lockstepLocation:n})},children:"reset"})}function qs({splatapus:t}){return f(oe,{onClick:()=>{const e=tt.parse(js).unwrap();t.document.update(()=>e.document,{lockstepLocation:e.location})},children:"example"})}var Ar={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Vn=L.createContext&&L.createContext(Ar),ve=globalThis&&globalThis.__assign||function(){return ve=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ve.apply(this,arguments)},Js=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function $r(t){return t&&t.map(function(e,n){return L.createElement(e.tag,ve({key:n},e.attr),$r(e.child))})}function _r(t){return function(e){return f(Ys,{...ve({attr:ve({},t.attr)},e),children:$r(t.child)})}}function Ys(t){var e=function(n){var r=t.attr,i=t.size,o=t.title,s=Js(t,["attr","size","title"]),a=i||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),F("svg",{...ve({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:ve(ve({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),children:[o&&f("title",{children:o}),t.children]})};return Vn!==void 0?f(Vn.Consumer,{children:function(n){return e(n)}}):e(Ar)}function Zs(t){return _r({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556 4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504 119.034 504 8.001 392.967 8 256.002 7.999 119.193 119.646 7.755 256.455 8z"}}]})(t)}function Xs(t){return _r({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M255.545 8c-66.269.119-126.438 26.233-170.86 68.685L48.971 40.971C33.851 25.851 8 36.559 8 57.941V192c0 13.255 10.745 24 24 24h134.059c21.382 0 32.09-25.851 16.971-40.971l-41.75-41.75c30.864-28.899 70.801-44.907 113.23-45.273 92.398-.798 170.283 73.977 169.484 169.442C423.236 348.009 349.816 424 256 424c-41.127 0-79.997-14.678-110.63-41.556-4.743-4.161-11.906-3.908-16.368.553L89.34 422.659c-4.872 4.872-4.631 12.815.482 17.433C133.798 479.813 192.074 504 256 504c136.966 0 247.999-111.033 248-247.998C504.001 119.193 392.354 7.755 255.545 8z"}}]})(t)}function Qs({splatapus:t}){const e=H(()=>G.canUndo(t.undoStack.live()),[t]),n=H(()=>G.canRedo(t.undoStack.live()),[t]),r=jt(t.vfx,"undo",()=>({keyFrames:{transform:["rotate(0)","rotate(-360deg)"]},duration:300,easing:zt.DEFAULT})),i=jt(t.vfx,"redo",()=>({keyFrames:{transform:["rotate(0)","rotate(360deg)"]},duration:300,easing:zt.DEFAULT}));return F("div",{className:"pointer-events-auto pb-2 pl-3",children:[f(oe,{disabled:!e,className:K("transition-all duration-300",e?"pointer-events-auto ease-out-back":n?"pointer-events-none opacity-50":"pointer-events-none scale-0 opacity-0 ease-in-back"),onClick:()=>t.undoStack.update(o=>G.undo(o,t.vfx)),iconLeft:f("div",{className:"mt-[2px] h-3 w-3 transition-transform duration-300 ease-in-out",ref:r,children:f(Xs,{size:12})}),children:"undo"}),f(oe,{disabled:!n,className:K("transition-all duration-300",n?"pointer-events-auto ease-out-back-md":"scale-0 opacity-0 ease-in-back-md"),onClick:()=>t.undoStack.update(o=>G.redo(o,t.vfx)),iconRight:f("div",{className:"mt-[2px] h-3 w-3 transition-transform duration-300 ease-in-out",ref:i,children:f(Zs,{size:12})}),children:"redo"})]})}function ea(){{const t=Mi("autosave");if(t.isOk())return t.value;console.error(`Error loading autosave: ${t.error}`)}return sr()}function ta(){const[t,e]=d.exports.useState(null),n=$s(ea),r=Gn(t,i=>{const o=Zr(i);return n.screenSize.update(o),o});return f("div",{ref:e,className:"absolute inset-0 touch-none overflow-hidden",children:r&&f(na,{splatapus:n})})}function na({splatapus:t}){const e=d.exports.useRef(null);d.exports.useEffect(()=>{const r=X(e.current);return r.addEventListener("wheel",t.onWheel,{passive:!1}),window.addEventListener("keydown",t.onKeyDown),window.addEventListener("keyup",t.onKeyUp),()=>{r.removeEventListener("wheel",t.onWheel),window.removeEventListener("keydown",t.onKeyDown),window.removeEventListener("keyup",t.onKeyUp)}},[t]),d.exports.useEffect(()=>ut(me.idle,()=>{Ai("autosave",{document:t.document.live(),location:t.location.state.live()})}),[t]);const n=ie(t.interaction.activeMode);return F(Q,{children:[F("div",{className:"absolute inset-0",ref:e,onPointerDown:t.onPointerDown,onPointerMove:t.onPointerMove,onPointerUp:t.onPointerUp,onPointerCancel:t.onPointerCancel,children:[f(ss,{splatapus:t}),f(St.Overlay,{splatapus:t,mode:n.type===A.Rig?n:null})]}),f(Vs,{topBarLeft:f(Ui,{splatapus:t}),topBarRight:f(Hs,{splatapus:t}),rightBar:f(Fs,{splatapus:t}),bottomBarLeft:f(Qs,{splatapus:t}),bottomBarRight:f(es,{}),splatapus:t}),!1]})}const ra=X(document.getElementById("root"));Xr(ra).render(f(L.StrictMode,{children:f(ta,{})}));
