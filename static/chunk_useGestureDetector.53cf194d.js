import{q as m,c as n,b as l}from"./chunk_assert.ed7d9aac.js";import{V as u}from"./chunk_Vector2.6fc60e01.js";import{u as p}from"./chunk_client.c5475742.js";import{r as d}from"./chunk_index.9ef61b8f.js";const I=10,f=m,g=()=>null;class P{constructor({onTap:t=f,onDragStart:r=g}){this.state={type:"idle"},this.lastEvent=null,this.onTap=t,this.onDragStart=r}isGestureInProgress(){return this.state.type!=="idle"}onPointerDown(t,...r){var e,i;switch(this.lastEvent=t,this.state.type){case"idle":{const s=this.onDragStart(t,...r);if(!s)return;(e=s.couldBeTap)==null||e?this.state={type:"dragUnconfirmed",pointerId:t.pointerId,startPosition:u.fromEvent(t),dragHandler:s,args:r}:(this.state={type:"dragConfirmed",pointerId:t.pointerId,dragHandler:s},(i=s.onConfirm)==null||i.call(s,t));return}case"dragUnconfirmed":case"dragConfirmed":return;default:n(this.state)}}onPointerMove(t){var r,e;switch(this.lastEvent=t,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==t.pointerId)return;this.state.dragHandler.onMove(t),this.state.startPosition.distanceTo(u.fromEvent(t))>=I&&((e=(r=this.state.dragHandler).onConfirm)==null||e.call(r,t),this.state={type:"dragConfirmed",pointerId:this.state.pointerId,dragHandler:this.state.dragHandler});return;case"dragConfirmed":if(this.state.pointerId!==t.pointerId)return;this.state.dragHandler.onMove(t);return;default:n(this.state)}}onPointerUp(t){switch(this.lastEvent=t,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==t.pointerId)return;this.state.dragHandler.onCancel(t),this.onTap(t,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":if(this.state.pointerId!==t.pointerId)return;this.state.dragHandler.onEnd(t),this.state={type:"idle"};return;default:n(this.state)}}onPointerCancel(t){switch(this.lastEvent=t,this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":if(this.state.pointerId!==t.pointerId)return;this.state.dragHandler.onCancel(t),this.state={type:"idle"};return;default:n(this.state)}}cancel(){switch(this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":this.state.dragHandler.onCancel(l(this.lastEvent,"Assertion Error: this.lastEvent")),this.state={type:"idle"};return;default:n(this.state)}}end(){const t=l(this.lastEvent,"Assertion Error: this.lastEvent");switch(this.state.type){case"idle":return;case"dragUnconfirmed":this.state.dragHandler.onCancel(t),this.onTap(t,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":this.state.dragHandler.onEnd(t),this.state={type:"idle"};return;default:n(this.state)}}}function D(o){var h,c;const t=p((h=o.onTap)!=null?h:f),r=p((c=o.onDragStart)!=null?c:g),[e]=d.exports.useState(()=>new P({onTap:t,onDragStart:r})),[i,s]=d.exports.useState(!1);return{isGestureInProgress:i,events:d.exports.useMemo(()=>({onPointerDown:a=>{e.onPointerDown(a),s(e.isGestureInProgress())},onPointerMove:a=>{e.onPointerMove(a),s(e.isGestureInProgress())},onPointerUp:a=>{e.onPointerUp(a),s(e.isGestureInProgress())},onPointerCancel:a=>{e.onPointerCancel(a),s(e.isGestureInProgress())}}),[e])}}export{P as G,g as d,D as u};
