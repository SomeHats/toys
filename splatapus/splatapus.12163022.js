var $e=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var k=(t,e,n)=>($e(t,e,"read from private field"),n?n.call(t):e.get(t)),R=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},B=(t,e,n,o)=>($e(t,e,"write to private field"),o?o.call(t,n):e.set(t,n),n);import{t as A,s as It,N as Ne,k as St,h as qe,g as kt,a as I,O as $,b as Ie,l as it,f as xe,P as We,E as bt,D as Ze,G as Ct,c as E,Q as ee,e as Tt,r as He}from"../chunks/chunk_assert.67ae27bf.js";/* empty css                               */import{r as V,R as Et}from"../chunks/chunk_index.0b2a17fa.js";import{e as _e,d as Je,b as z,m as zt,u as yt,a as _t,s as Dt,c as Vt}from"../chunks/chunk_debugPropsToString.8c4221d5.js";import{j as h,c as _,F as Se,a as U}from"../chunks/chunk_jsx-runtime.3f231529.js";import{b as Ae,R as ce,P as Ot,d as Lt,c as J,V as m,a as Mt,e as Te,f as Nt,p as At}from"../chunks/chunk_Vector2.60c0b602.js";import{A as xt}from"../chunks/chunk_AABB.e3ed9fa1.js";import{b as Kt}from"../chunks/chunk_easings.49fa61fa.js";import"../chunks/chunk__commonjsHelpers.fbcca4d8.js";const ke=300,Ut=30,Ft=500,jt=10,ae={size:16,streamline:.5,smoothing:.5,thinning:.5,simulatePressure:!0,easing:t=>t,start:{},end:{},last:!1},Rt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split("");class be{constructor(e,n=16){this.randomLength=n,this.debugIdCounter=0,this.prefix=e,this.Id=`${e}.SAMPLE`;const o=new RegExp(`^${this.prefix}\\.([a-zA-Z0-9_]+)$`);this.parse=Ae(Lt,r=>o.test(r)?ce.ok(r):ce.error(new Ot(`Expected ${this.prefix}.*, got ${r}`,[])))}generate(){const e=A(this.randomLength,()=>It(Rt)).join("");return`${this.prefix}.${e}`}}const ne=new be("key"),Bt=J({id:ne.parse,position:m.parse}),oe=new be("shp"),$t=J({id:oe.parse}),Ke=new be("shv"),qt=J({id:Ke.parse,keyPointId:ne.parse,shapeId:oe.parse,rawPoints:Mt(m.parse)}),at=new be("doc"),Wt=J({id:at.parse,keyPoints:Te(ne.parse,Bt),shapes:Te(oe.parse,$t),shapeVersions:Te(Ke.parse,qt)});function Zt(){return{id:at.generate(),keyPoints:{},shapes:{},shapeVersions:{}}}class N{static fromArray(e){return new N(Ne(e.map(n=>[n.id,n])))}constructor(e){this.data=e}count(){return St(this.data).length}has(e){return qe(this.data,e)}getIfExists(e){return kt(this.data,e)}get(e){const n=this.getIfExists(e);return I(n!=null,`Item with id ${e} not found`),n}insert(e){return new N({...this.data,[e.id]:e})}update(e,n){const o=this.get(e),r=$(o,n);return I(o.id===r.id),this.insert(r)}delete(e){const{[e]:n,...o}=this.data;return new N(o)}*[Symbol.iterator](){for(const e in this.data)qe(this.data,e)&&(yield Ie(this.data[e]))}toJSON(){return this.data}}var K,W,G;const we=class{constructor(e,n,o,r){R(this,K,void 0);R(this,W,void 0);R(this,G,void 0);this.index=e,B(this,K,n),B(this,W,o),B(this,G,r)}static build(e,n,o,r){const s=new Map;for(const i of e){const y=n(i);I(!s.has(y)),s.set(y,o(i))}return new we(s,n,o,r)}withIndex(e){return new we(e,k(this,K),k(this,W),k(this,G))}lookup(e){return this.index.get(k(this,G).call(this,e))}insert(e){const n=k(this,K).call(this,e);I(!this.index.has(n),`key ${n} already exists in index`);const o=new Map(this.index);return o.set(n,k(this,W).call(this,e)),this.withIndex(o)}remove(e){const n=k(this,K).call(this,e);I(this.index.has(n),`key ${n} does not exist in index`);const o=new Map(this.index);return o.delete(n),this.withIndex(o)}update(e){const n=k(this,K).call(this,e);I(this.index.has(n),`key ${n} does not exist in index`);const o=new Map(this.index);return o.set(n,k(this,W).call(this,e)),this.withIndex(o)}toJSON(){return Ne(this.index)}};let De=we;K=new WeakMap,W=new WeakMap,G=new WeakMap;const Ht=new Set;var Z,H,X;const Pe=class{constructor(e,n,o,r){R(this,Z,void 0);R(this,H,void 0);R(this,X,void 0);this.index=e,B(this,Z,n),B(this,H,o),B(this,X,r)}static build(e,n,o,r){const s=new Map;for(const i of e){const y=n(i);let x=s.get(y);x||(x=new Set,s.set(y,x)),x.add(o(i))}return new Pe(s,n,o,r)}withIndex(e){return new Pe(e,k(this,Z),k(this,H),k(this,X))}lookup(e){var n;return(n=this.index.get(k(this,X).call(this,e)))!=null?n:Ht}insert(e){const n=k(this,Z).call(this,e),o=k(this,H).call(this,e),r=this.index.get(n);let s;r?(I(!r.has(o),"already exists"),s=new Set(r)):s=new Set,s.add(o);const i=new Map(this.index);return i.set(n,s),this.withIndex(i)}remove(e){const n=k(this,Z).call(this,e),o=k(this,H).call(this,e),r=this.index.get(n);I(r&&r.has(o),"value does not exist"),new Set(r).delete(o);const i=new Map(this.index);return i.delete(n),this.withIndex(i)}update(e,n){return this.remove(e).insert(n)}toJSON(){return Ne(this.index)}};let ve=Pe;Z=new WeakMap,H=new WeakMap,X=new WeakMap;const{min:Y,PI:Wn}=Math,Qe=.275;function lt(t,e={}){const{size:n=16,smoothing:o=.5,thinning:r=.5,simulatePressure:s=!0,easing:i=g=>g,start:y={},end:x={}}=e,{easing:a=g=>g*(2-g)}=y,{easing:c=g=>--g*g*g+1}=x;if(t.length===0||n<=0)return[];const l=t[t.length-1].runningLength,u=y.taper===!1?0:y.taper===!0?Math.max(n,l):y.taper,p=x.taper===!1?0:x.taper===!0?Math.max(n,l):x.taper,f=Math.pow(n*o,2),d=[];let w=t.slice(0,10).reduce((g,T)=>{let Q=T.pressure;if(s){const he=Y(1,T.distance/n),j=Y(1,1-he);Q=Y(1,g+(j-g)*(he*Qe))}return(g+Q)/2},t[0].pressure),P=Ye(n,r,t[t.length-1].pressure,i),S=t[0].point,v=S;for(let g=0;g<t.length;g++){let{pressure:T}=t[g];const{point:Q,distance:he,runningLength:j}=t[g];if(g<t.length-1&&l-j<3)continue;if(r){if(s){const Be=Y(1,he/n),Pt=Y(1,1-Be);T=Y(1,w+(Pt-w)*(Be*Qe))}P=Ye(n,r,T,i)}else P=n/2;const mt=j<u?a(j/u):1,wt=l-j<p?c((l-j)/p):1;if(P=Math.max(.01,P*Math.min(mt,wt)),g===t.length-1){d.push({center:Q,radius:P});continue}v=Q,(g<=1||S.distanceToSq(v)>f)&&(d.push({center:Q,radius:P}),S=v),w=T}return d}function ct(t,e={}){var u,p;const{streamline:n=.5,size:o=16,last:r=!1}=e;if(t.length===0)return[];const s=.15+(1-n)*.85;let i=t.map(f=>({point:m.fromVectorLike(f),pressure:f.pressure}));if(i.length===2){const f=i[1];i=i.slice(0,-1);for(let d=1;d<5;d++)i.push({point:i[0].point.lerp(f.point,d/4),pressure:f.pressure})}i.length===1&&i.push({point:i[0].point.add(m.UNIT),pressure:i[0].pressure});const y=[{point:i[0].point,pressure:i[0].pressure!=null&&i[0].pressure>=0?i[0].pressure:.25,vector:m.UNIT,distance:0,runningLength:0}];let x=!1,a=0,c=y[0];const l=i.length-1;for(let f=1;f<i.length;f++){const d=i[f],w=r&&f===l?d.point:c.point.lerp(d.point,s);if(c.point.equals(w))continue;const P=w.distanceTo(c.point);if(a+=P,f<l&&!x){if(a<o)continue;x=!0}c={point:w,pressure:d.pressure!=null&&d.pressure>=0?d.pressure:.5,vector:c.point.sub(w).normalize(),distance:P,runningLength:a},y.push(c)}return y[0].vector=(p=(u=y[1])==null?void 0:u.vector)!=null?p:m.ZERO,y}function Ye(t,e,n,o=r=>r){return t*o(.5-e*(.5-n))}function Ve(t){if(!t.length)return"";const e=["M",t[0].x,t[0].y,"Q"];for(let n=0;n<t.length;n++){const o=t[n],r=t[(n+1)%t.length],s=o.add(r).scale(.5);e.push(o.x,o.y,s.x,s.y)}return e.push("Z"),e.join(" ")}function ut(t,e){const n=[t[0]];if(t.length===0)return[];let o=e,r=t[0],s=t[0].center;for(let i=1;i<t.length;i++){const y=t[i],x=t[Math.min(i+1,t.length-1)],a=y.center.add(x.center).scale(.5),c=y.center.distanceTo(r.center),l=s,u=y.center,p=a;let f=0;for(;c-f>=o;){const d=(o+f)/c;n.push({center:l.lerp(u,d).lerp(u.lerp(p,d),d),radius:it(r.radius,y.radius,d)}),f+=o,o=e}o-=c-f,r=y,s=a}return n.push(t[t.length-1]),n}function Ee(t){var s,i;const e=Array.from(t);if(e.length===0)return{versions:new N({})};const n=[];let o=0;for(const y of e){const x=ct(y.rawPoints),a=(i=(s=x[x.length-1])==null?void 0:s.runningLength)!=null?i:0;n.push({id:y.id,strokePoints:x,length:a}),a>o&&(o=a)}const r=Math.floor(o/ae.size);return{versions:N.fromArray(n.map(({strokePoints:y,length:x,id:a})=>({id:a,length:x,normalizedCenterPoints:ut(lt(y,ae),x/r)})))}}function F(){}F.prototype={diff:function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.callback;typeof o=="function"&&(r=o,o={}),this.options=o;var s=this;function i(d){return r?(setTimeout(function(){r(void 0,d)},0),!0):d}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var y=n.length,x=e.length,a=1,c=y+x;o.maxEditLength&&(c=Math.min(c,o.maxEditLength));var l=[{newPos:-1,components:[]}],u=this.extractCommon(l[0],n,e,0);if(l[0].newPos+1>=y&&u+1>=x)return i([{value:this.join(n),count:n.length}]);function p(){for(var d=-1*a;d<=a;d+=2){var w=void 0,P=l[d-1],S=l[d+1],v=(S?S.newPos:0)-d;P&&(l[d-1]=void 0);var g=P&&P.newPos+1<y,T=S&&0<=v&&v<x;if(!g&&!T){l[d]=void 0;continue}if(!g||T&&P.newPos<S.newPos?(w=Qt(S),s.pushComponent(w.components,void 0,!0)):(w=P,w.newPos++,s.pushComponent(w.components,!0,void 0)),v=s.extractCommon(w,n,e,d),w.newPos+1>=y&&v+1>=x)return i(Jt(s,w.components,n,e,s.useLongestToken));l[d]=w}a++}if(r)(function d(){setTimeout(function(){if(a>c)return r();p()||d()},0)})();else for(;a<=c;){var f=p();if(f)return f}},pushComponent:function(e,n,o){var r=e[e.length-1];r&&r.added===n&&r.removed===o?e[e.length-1]={count:r.count+1,added:n,removed:o}:e.push({count:1,added:n,removed:o})},extractCommon:function(e,n,o,r){for(var s=n.length,i=o.length,y=e.newPos,x=y-r,a=0;y+1<s&&x+1<i&&this.equals(n[y+1],o[x+1]);)y++,x++,a++;return a&&e.components.push({count:a}),e.newPos=y,x},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],o=0;o<e.length;o++)e[o]&&n.push(e[o]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function Jt(t,e,n,o,r){for(var s=0,i=e.length,y=0,x=0;s<i;s++){var a=e[s];if(a.removed){if(a.value=t.join(o.slice(x,x+a.count)),x+=a.count,s&&e[s-1].added){var l=e[s-1];e[s-1]=e[s],e[s]=l}}else{if(!a.added&&r){var c=n.slice(y,y+a.count);c=c.map(function(p,f){var d=o[x+f];return d.length>p.length?d:p}),a.value=t.join(c)}else a.value=t.join(n.slice(y,y+a.count));y+=a.count,a.added||(x+=a.count)}}var u=e[i-1];return i>1&&typeof u.value=="string"&&(u.added||u.removed)&&t.equals("",u.value)&&(e[i-2].value+=u.value,e.pop()),e}function Qt(t){return{newPos:t.newPos,components:t.components.slice(0)}}var Ge=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Xe=/\S/,dt=new F;dt.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Xe.test(t)&&!Xe.test(e)};dt.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<e.length-1;n++)!e[n+1]&&e[n+2]&&Ge.test(e[n])&&Ge.test(e[n+2])&&(e[n]+=e[n+2],e.splice(n+1,2),n--);return e};var pt=new F;pt.tokenize=function(t){var e=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var o=0;o<n.length;o++){var r=n[o];o%2&&!this.options.newlineIsToken?e[e.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),e.push(r))}return e};var Yt=new F;Yt.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Gt=new F;Gt.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function ge(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ge=function(e){return typeof e}:ge=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(t)}var Xt=Object.prototype.toString,te=new F;te.useLongestToken=!0;te.tokenize=pt.tokenize;te.castInput=function(t){var e=this.options,n=e.undefinedReplacement,o=e.stringifyReplacer,r=o===void 0?function(s,i){return typeof i>"u"?n:i}:o;return typeof t=="string"?t:JSON.stringify(Oe(t,null,null,r),r,"  ")};te.equals=function(t,e){return F.prototype.equals.call(te,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function en(t,e,n){return te.diff(t,e,n)}function Oe(t,e,n,o,r){e=e||[],n=n||[],o&&(t=o(r,t));var s;for(s=0;s<e.length;s+=1)if(e[s]===t)return n[s];var i;if(Xt.call(t)==="[object Array]"){for(e.push(t),i=new Array(t.length),n.push(i),s=0;s<t.length;s+=1)i[s]=Oe(t[s],e,n,o,r);return e.pop(),n.pop(),i}if(t&&t.toJSON&&(t=t.toJSON()),ge(t)==="object"&&t!==null){e.push(t),i={},n.push(i);var y=[],x;for(x in t)t.hasOwnProperty(x)&&y.push(x);for(y.sort(),s=0;s<y.length;s+=1)x=y[s],i[x]=Oe(t[x],e,n,o,x);e.pop(),n.pop()}else i=t;return i}var Le=new F;Le.tokenize=function(t){return t.slice()};Le.join=Le.removeEmpty=function(t){return t};class q{constructor(e,n=0,o=!0){if(this.data=e,this.version=n,!o)return;const r=this.serialize(),s=q.deserialize(r,this.version);if(!_e(this,s)){console.log({actual:this,expected:s});const i=JSON.stringify(this,null,2),y=JSON.stringify(s,null,2);for(const x of en(i,y))console.log("CHANGE",x);xe(`Mismatch after update:
Actual:
${JSON.stringify(this,null,2)}

Expected:
${JSON.stringify(s,null,2)}`)}}static create(){return q.deserialize(Zt())}static deserialize(e,n=0){const o=new N(e.shapeVersions);return new q({id:e.id,keyPoints:new N(e.keyPoints),shapes:new N(e.shapes),shapeVersions:o,shapeVersionLookup:De.build(o,r=>`${r.shapeId}/${r.keyPointId}`,r=>r.id,([r,s])=>`${r}/${s}`),shapeVersionIdsByShape:ve.build(o,r=>r.shapeId,r=>r.id,We),shapeVersionIdsByKeyPoint:ve.build(o,r=>r.keyPointId,r=>r.id,We),normalizedShapeVersions:Ee(Array.from(o)).versions},n,!1)}with(e){return new q({...this.data,...e},this.version+1)}serialize(){return{id:this.data.id,keyPoints:this.data.keyPoints.data,shapes:this.data.shapes.data,shapeVersions:this.data.shapeVersions.data}}get shapes(){return this.data.shapes}get keyPoints(){return this.data.keyPoints}get shapeVersions(){return this.data.shapeVersions}getShapeVersion(e,n){const o=this.data.shapeVersionLookup.lookup([n,e]);return o?this.shapeVersions.get(o):null}getNormalizedCenterPointsForShapeVersion(e){return this.data.normalizedShapeVersions.get(e).normalizedCenterPoints}*iterateShapeVersionsForShape(e){for(const n of this.data.shapeVersionIdsByShape.lookup(e))yield this.shapeVersions.get(n)}addShape(e){console.log("doc.addShape",e);const n=this.shapes.insert({id:e});return this.with({shapes:n})}addKeyPoint(e,n){console.log("doc.addKeyPoint",e);const o=this.keyPoints.insert({id:e,position:n});return this.with({keyPoints:o})}updateKeypoint(e,n){return this.with({keyPoints:this.keyPoints.update(e,n)})}replacePointsForVersion(e,n,o){const r=this.getShapeVersion(e,n);if(r){const y=this.shapeVersions.insert({...r,rawPoints:o});return this.with({shapeVersions:y,normalizedShapeVersions:Ee(y).versions})}const s={id:Ke.generate(),keyPointId:e,shapeId:n,rawPoints:o},i=this.shapeVersions.insert(s);return this.with({shapeVersions:i,normalizedShapeVersions:Ee(i).versions,shapeVersionLookup:this.data.shapeVersionLookup.insert(s),shapeVersionIdsByShape:this.data.shapeVersionIdsByShape.insert(s),shapeVersionIdsByKeyPoint:this.data.shapeVersionIdsByKeyPoint.insert(s)})}}var b=(t=>(t.Draw="draw",t.KeyPoint="keyPoint",t))(b||{});const tn=Nt(b);var ue=(t=>(t.Pan="quickPan",t))(ue||{});const nn=J({pan:m.parse,zoom:At});class on{constructor({pan:e,zoom:n},o,r){this.screenSize=o,this.update=r,this.pan=e,this.zoom=n}canvasScreenSize(){return this.screenSize.sub(new m(ke,0))}handleWheelEvent(e){console.log("wheel",e),e.preventDefault(),e.stopImmediatePropagation();const{deltaX:n,deltaY:o}=e;if(e.ctrlKey){const r=m.fromEvent(e);this.update(({pan:s,zoom:i})=>{const y=Math.exp(-o/100)*i,x=r.add(s).scale(y/i).sub(r);return{zoom:y,pan:x}})}else this.update(({pan:r,zoom:s})=>({pan:r.add(new m(n,o)),zoom:s}))}origin(){return this.pan.sub(this.canvasScreenSize().scale(.5*this.zoom))}visibleSceneBounds(){return new xt(this.origin(),this.canvasScreenSize())}screenToScene(e){return e.add(this.origin()).scale(1/this.zoom)}sceneToScreen(e){return e.scale(this.zoom).sub(this.origin())}eventSceneCoords(e){return this.screenToScene(m.fromEvent(e))}getSceneTransform(){const e=this.origin();return`translate(${-e.x}, ${-e.y}) scale(${this.zoom}) `}}const rn=J({keyPointId:ne.parse,shapeId:oe.parse,viewport:nn,tool:tn}),Ue=class{constructor({keyPointId:t,shapeId:e,viewport:n={pan:m.ZERO,zoom:1},tool:o=b.Draw}){this.keyPointId=t,this.shapeId=e,this.viewportState=n,this.tool=o}serialize(){return{keyPointId:this.keyPointId,shapeId:this.shapeId,viewport:this.viewportState,tool:this.tool}}with(t){var e,n,o,r;return new Ue({keyPointId:(e=t.keyPointId)!=null?e:this.keyPointId,shapeId:(n=t.shapeId)!=null?n:this.shapeId,viewport:(o=t.viewport)!=null?o:this.viewportState,tool:(r=t.tool)!=null?r:this.tool})}};let Ce=Ue;Ce.parse=Ae(rn,t=>ce.ok(new Ue(t)));const ht=J({doc:Ae(Wt,t=>ce.ok(q.deserialize(t))),location:Ce.parse});function sn(t){return Ze(`splatapus.${t}`)?ht(Ze(`splatapus.${t}`)).mapErr(n=>n.toString()):ce.error("No saved data found")}function yn(t,{doc:e,location:n}){const o={doc:e.serialize(),location:n.serialize()};window.splatSerializedDoc=o,Ct(`splatapus.${t}`,o)}const xn=bt(Ft,yn);function et(){const t=ne.generate(),e=oe.generate();return{doc:q.create().addKeyPoint(t,m.ZERO).addShape(e).replacePointsForVersion(t,e,[]),location:new Ce({keyPointId:t,shapeId:e})}}const tt={initialize(){return{state:"idle"}},onPointerEvent(t,e){switch(t.eventType){case"down":switch(e.state){case"idle":return{pan:{state:"oneFingerDown",pointerA:{id:t.event.pointerId,startScreenPosition:m.fromEvent(t.event),currentScreenPosition:m.fromEvent(t.event),startEvent:t.event}},passthroughContext:t};case"oneFingerDown":return{pan:{state:"bothFingersDown",pointerA:e.pointerA,pointerB:{id:t.event.pointerId,startScreenPosition:m.fromEvent(t.event),currentScreenPosition:m.fromEvent(t.event),startEvent:t.event},initialPan:t.viewport.pan,initialZoom:t.viewport.zoom},passthroughContext:{...t,eventType:"cancel",event:e.pointerA.startEvent}};case"bothFingersDown":return{pan:e,passthroughContext:t};default:throw E(e)}case"move":switch(e.state){case"idle":return{pan:e,passthroughContext:t};case"oneFingerDown":return e.pointerA.id===t.event.pointerId?{pan:{...e,pointerA:{...e.pointerA,currentScreenPosition:m.fromEvent(t.event)}},passthroughContext:t}:{pan:e,passthroughContext:t};case"bothFingersDown":if(t.event.pointerId===e.pointerA.id||t.event.pointerId===e.pointerB.id){const n=t.event.pointerId===e.pointerA.id?m.fromEvent(t.event):e.pointerA.currentScreenPosition,o=t.event.pointerId===e.pointerB.id?m.fromEvent(t.event):e.pointerB.currentScreenPosition,r=e.pointerA.startScreenPosition.distanceTo(e.pointerB.startScreenPosition),i=n.distanceTo(o)/r,y=e.pointerA.startScreenPosition.lerp(e.pointerB.startScreenPosition,.5),x=n.lerp(o,.5);return t.updateViewport(()=>{const a=y.add(e.initialPan).scale(i).sub(x);return{zoom:e.initialZoom*i,pan:a}}),{pan:{...e,pointerA:{...e.pointerA,currentScreenPosition:n},pointerB:{...e.pointerB,currentScreenPosition:o}},passthroughContext:null}}return{pan:e,passthroughContext:t};default:throw E(e)}case"up":case"cancel":switch(e.state){case"idle":return{pan:e,passthroughContext:t};case"oneFingerDown":return t.event.pointerId===e.pointerA.id?{pan:{state:"idle"},passthroughContext:t}:{pan:e,passthroughContext:t};case"bothFingersDown":return t.event.pointerId===e.pointerA.id||t.event.pointerId===e.pointerB.id?{pan:{state:"idle"},passthroughContext:null}:{pan:e,passthroughContext:t};default:throw E(e)}default:E(t.eventType)}}};function an(t){return null}function Fe(){return function(e){return{getCanvasClassName:n=>"",getPreviewPosition:n=>null,Overlay:an,...e}}}function je(t){const e={initialize:n=>({state:"idle",childState:n}),isIdle:n=>n.state==="idle",getState:n=>n.childState,onPointerEvent:(n,o,r)=>{switch(n.eventType){case"down":switch(o.state){case"idle":{const s=t.onDragStart(n,o.childState,r);return s?(n.event.preventDefault(),t.onTap?{state:"dragUnconfirmed",pointerId:n.event.pointerId,startPosition:m.fromEvent(n.event),childState:s,startArg:r}:{state:"dragConfirmed",pointerId:n.event.pointerId,childState:s,startArg:r}):o}case"dragUnconfirmed":case"dragConfirmed":return o;default:throw E(o)}case"move":switch(o.state){case"idle":return o;case"dragUnconfirmed":{if(o.pointerId!==n.event.pointerId)return o;const s=t.onDragMove(n,o.childState);return o.startPosition.distanceTo(m.fromEvent(n.event))>=jt?{state:"dragConfirmed",pointerId:o.pointerId,childState:s,startArg:o.startArg}:Object.is(o.childState,s)?o:{...o,childState:s}}case"dragConfirmed":{if(o.pointerId!==n.event.pointerId)return o;const s=t.onDragMove(n,o.childState);return Object.is(o.childState,s)?o:{...o,childState:s}}default:throw E(o)}case"up":switch(o.state){case"idle":return o;case"dragUnconfirmed":{if(o.pointerId!==n.event.pointerId)return o;let s=t.onDragCancel(n,o.childState);return s=t.onTap?t.onTap(n,s,o.startArg):s,{state:"idle",childState:s}}case"dragConfirmed":{if(o.pointerId!==n.event.pointerId)return o;const s=t.onDragEnd(n,o.childState);return{state:"idle",childState:s}}default:throw E(o)}case"cancel":switch(o.state){case"idle":return o;case"dragUnconfirmed":case"dragConfirmed":{if(o.pointerId!==n.event.pointerId)return o;const s=t.onDragCancel(n,o.childState);return{state:"idle",childState:s}}default:throw E(o)}default:E(n.eventType)}},createOnPointerEvent:n=>(o,r,s)=>ee(r,n,i=>e.onPointerEvent(o,i,s))};return e}const re=je({onDragStart:({event:t,viewport:e})=>({state:"drawing",points:[e.eventSceneCoords(t)]}),onDragMove:({event:t,viewport:e},n)=>({state:"drawing",points:[...n.points,e.eventSceneCoords(t)]}),onDragEnd:({updateDocument:t,location:e},n)=>(t(o=>{const r=o.shapes.get(e.shapeId);return o.replacePointsForVersion(e.keyPointId,r.id,n.points)}),{state:"idle"}),onDragCancel:(t,e)=>({state:"idle"})}),de=Fe()({initialize:()=>({type:b.Draw,gesture:re.initialize({state:"idle"})}),isIdle:t=>re.isIdle(t.gesture),getDebugProperties:t=>{const e=re.getState(t.gesture);switch(e.state){case"idle":return{_:"idle"};case"drawing":return{_:"drawing",points:String(e.points.length)};default:E(e)}},getState:t=>re.getState(t.gesture),onPointerEvent:re.createOnPointerEvent("gesture")}),Re={interpolated:(t,e)=>({type:"interpolated",scenePosition:t,selectedShapeId:e}),keyPointId:(t,e)=>({type:"keyPointId",keyPointId:t,selectedShapeId:e}),toDebugString:t=>{switch(t.type){case"interpolated":return Je(t.type,{_:t.scenePosition.toString(2),shape:t.selectedShapeId});case"keyPointId":return Je(t.type,{_:t.keyPointId,shape:t.selectedShapeId});default:E(t)}}};function ln({position:t,children:e,className:n,style:o,...r}){return h("div",{className:_("absolute top-0 left-0",n),style:{transform:`translate(${t.x}px, ${t.y}px)`,...o},...r,children:e})}function cn({position:t,viewport:e,screenOffset:n=m.ZERO,...o}){return h(ln,{position:e.sceneToScreen(t).add(n),...o})}const se=je({onTap:({updateLocation:t},e,n)=>(n&&t(o=>o.with({keyPointId:n})),e),onDragStart:({updateLocation:t,viewport:e,event:n},o,r)=>r?(t(s=>s.with({keyPointId:r})),{state:"moving",keyPointId:r,delta:m.ZERO,startingPosition:e.eventSceneCoords(n)}):null,onDragMove:({viewport:t,event:e},n)=>({...n,delta:t.eventSceneCoords(e).sub(n.startingPosition)}),onDragEnd:({event:t,viewport:e,updateDocument:n},o)=>{const r=e.eventSceneCoords(t).sub(o.startingPosition);return n(s=>s.updateKeypoint(o.keyPointId,i=>({...i,position:i.position.add(r)}))),{state:"idle"}},onDragCancel:()=>({state:"idle"})}),un=new m(-12,-12),pe=Fe()({initialize:()=>({type:b.KeyPoint,gesture:se.initialize({state:"idle"}),previewPosition:null}),isIdle:t=>!0,getDebugProperties:t=>{const e=se.getState(t.gesture);switch(e.state){case"idle":return{_:e.state};case"moving":return{_:e.state,keyPointId:e.keyPointId,delta:e.delta.toString(2)}}},getPreviewPosition:(t,e)=>se.isIdle(t.gesture)&&t.previewPosition?Re.interpolated(t.previewPosition,e):null,onPointerEvent:(t,e,n)=>({...e,previewPosition:t.viewport.eventSceneCoords(t.event),gesture:se.onPointerEvent(t,e.gesture,n)}),Overlay:({tool:t,document:e,viewport:n,location:o,onUpdateTool:r})=>{const s=se.getState(t.gesture);return h(Se,{children:Array.from(e.keyPoints,(i,y)=>{const x=s.state==="moving"&&s.keyPointId===i.id?i.position.add(s.delta):i.position;return h(cn,{position:x,screenOffset:un,viewport:n,className:_("flex h-6 w-6 cursor-move items-center justify-center rounded-full border border-stone-200 bg-white text-xs text-stone-400 shadow-md",i.id===o.keyPointId?"text-stone-500 ring-2 ring-inset ring-purple-400":"text-stone-400"),onPointerDown:a=>{r((c,l)=>pe.onPointerEvent({...c,event:a,eventType:"down"},l,i.id))},children:y+1},i.id)})})}}),fe=je({onDragStart:({event:t,location:e})=>({state:"active",initialPan:e.viewportState.pan,previousScreenPoint:m.fromEvent(t)}),onDragMove:({event:t,updateViewport:e},n)=>{const o=m.fromEvent(t);return e(({pan:r,zoom:s})=>({pan:r.add(n.previousScreenPoint.sub(o).scale(s)),zoom:s})),{...n,previousScreenPoint:o}},onDragEnd:()=>({state:"idle"}),onDragCancel:({updateViewport:t},e)=>(t(({zoom:n})=>({zoom:n,pan:e.initialPan})),{state:"idle"})}),me=Fe()({initialize:()=>({type:ue.Pan,gesture:fe.initialize({state:"idle"})}),getDebugProperties:t=>{const e=fe.getState(t.gesture);switch(e.state){case"idle":return{_:e.state};case"active":return{_:e.state,initialPan:e.initialPan.toString(2),previousScreenPoint:e.previousScreenPoint.toString(0)}}},isIdle:t=>fe.isIdle(t.gesture),getCanvasClassName:t=>me.isIdle(t)?"cursor-grab":"cursor-grabbing",gesture:fe}),ft={[b.Draw]:de,[b.KeyPoint]:pe,[ue.Pan]:me};function ye(t){return ft[t]}function gt(t){const e=ye(t.type).getDebugProperties(t),n=Tt(e).map(([o,r])=>o.startsWith("_")?r:`${o} = ${r}`).join(", ");return`${t.type}(${n})`}const M={initialize:t=>ye(t).initialize(),initializeForKeyDown:({event:t})=>z(t,"d")?de.initialize():z(t,"k")?pe.initialize():null,isIdle:t=>ye(t.type).isIdle(t),getCanvasClassName:t=>ye(t.type).getCanvasClassName(t),getPreviewPosition:(t,e)=>ye(t.type).getPreviewPosition(t,e),toDebugString:gt,onPointerEvent:(t,e)=>{switch(e.type){case b.Draw:return de.onPointerEvent(t,e);case b.KeyPoint:return pe.onPointerEvent(t,e);default:E(e)}}},ie={initializeForKeyDown:({event:t})=>z(t," ")?me.initialize():null,toDebugString:gt,getCanvasClassName:t=>ft[t.type].getCanvasClassName(t),onPointerEvent:(t,e)=>{switch(e.type){case ue.Pan:return ee(e,"gesture",n=>me.gesture.onPointerEvent(t,n))}},onKeyUp:({event:t},e)=>{switch(e.type){case ue.Pan:return zt(t," ")?null:e}}},L={initialize:t=>({undoStates:[],redoStates:[],pendingOp:null,current:{...t,options:{}}}),beginOperation:t=>{const e=Math.random();return I(t.pendingOp==null,"pending op already in progress"),{undoStack:{...t,pendingOp:{txId:e,initialDoc:t.current.doc,initialOptions:t.current.options},current:{...t.current,options:{}}},txId:e}},updateOperation:(t,e,n)=>{var o;return I(((o=t.pendingOp)==null?void 0:o.txId)===e,"pending op mismatch"),{...t,current:{...t.current,doc:$(t.current.doc,n)}}},revertOperation:(t,e)=>{var n;return I(((n=t.pendingOp)==null?void 0:n.txId)===e,"Pending op mismatch"),{...t,pendingOp:null,current:{doc:t.pendingOp.initialDoc,location:t.current.location,options:t.pendingOp.initialOptions}}},commitOperation:(t,e,n={})=>{var s;I(((s=t.pendingOp)==null?void 0:s.txId)===e,"Pending op mismatch");const o=[{doc:t.pendingOp.initialDoc,location:t.current.location,options:t.pendingOp.initialOptions},...t.undoStates];for(;o.length>Ut;)o.pop();const r={...t.current,options:n};return n.lockstepLocation&&(r.location=$(r.location,n.lockstepLocation)),{...t,current:r,pendingOp:null,undoStates:o,redoStates:null}},updateDocument:(t,e,n)=>{let o;return{undoStack:t,txId:o}=L.beginOperation(t),t=L.updateOperation(t,o,e),L.commitOperation(t,o,n)},undo:t=>{var r;if(I(t.pendingOp==null,"Pending op in progress"),t.undoStates.length==0)return t;const[e,...n]=t.undoStates;if(!_e(e.location,t.current.location)&&!t.current.options.lockstepLocation)return{...t,current:{...t.current,location:e.location}};const o=[t.current,...(r=t.redoStates)!=null?r:[]];return{...t,current:e,undoStates:n,redoStates:o}},redo:t=>{if(I(t.pendingOp==null,"pending op in progress"),!t.redoStates||t.redoStates.length==0)return t;const[e,...n]=t.redoStates;if(!_e(e.location,t.current.location)&&!e.options.lockstepLocation)return{...t,current:{...t.current,location:e.location}};const o=[t.current,...t.undoStates];return{...t,current:e.options.lockstepLocation?{...e,location:$(t.current.location,e.options.lockstepLocation)}:e,undoStates:o,redoStates:n.length===0?null:n}},updateLocation:(t,e)=>({...t,current:{...t.current,location:$(t.current.location,e)}})},D={initialize:t=>({multiTouchPan:tt.initialize(),quickTool:null,selectedTool:M.initialize(t)}),toDebugString:t=>t.quickTool?ie.toDebugString(t.quickTool):M.toDebugString(t.selectedTool),getCanvasClassName:t=>t.quickTool?ie.getCanvasClassName(t.quickTool):M.getCanvasClassName(t.selectedTool),getPreviewPosition:(t,e)=>M.getPreviewPosition(t.selectedTool,e),updateSelectedTool:(t,e)=>ee(t,"selectedTool",e),updateQuickTool:(t,e)=>ee(t,"quickTool",e),requestSetSelectedTool:(t,e)=>t.quickTool||!M.isIdle(t.selectedTool)?t:{...t,selectedTool:M.initialize(e)},onKeyDown:(t,e)=>{if(M.isIdle(e.selectedTool)){if(!e.quickTool){const r=ie.initializeForKeyDown(t);if(r)return{...e,quickTool:r}}const o=M.initializeForKeyDown(t);if(o&&!e.quickTool)return{...e,selectedTool:o};if(z(t.event,{key:"z",command:!0}))return t.updateUndoStack(r=>L.undo(r)),e;if(z(t.event,{key:"z",command:!0,shift:!0}))return t.updateUndoStack(r=>L.redo(r)),e}if(z(t.event,{key:"0",command:!0}))return t.updateViewport({pan:m.ZERO,zoom:1}),e;const n=o=>{var s;const r=(s=[...t.document.keyPoints][o])==null?void 0:s.id;r&&t.updateLocation(i=>i.with({keyPointId:r}))};return z(t.event,"1")&&n(0),z(t.event,"2")&&n(1),z(t.event,"3")&&n(2),z(t.event,"4")&&n(3),z(t.event,"5")&&n(4),z(t.event,"6")&&n(5),z(t.event,"7")&&n(6),z(t.event,"8")&&n(7),z(t.event,"9")&&n(8),e},onKeyUp:(t,e)=>{if(e.quickTool){const n=ie.onKeyUp(t,e.quickTool);if(n!==e.quickTool)return{...e,quickTool:n}}return e},onPointerEvent:(t,e)=>{const{pan:n,passthroughContext:o}=tt.onPointerEvent(t,e.multiTouchPan);return n!==e.multiTouchPan&&(e={...e,multiTouchPan:n}),o?e.quickTool?D.updateQuickTool(e,r=>ie.onPointerEvent(o,Ie(r))):D.updateSelectedTool(e,r=>M.onPointerEvent(o,r)):e},Overlay:({interaction:t,onUpdateInteraction:e,...n})=>{const o=r=>e((s,i)=>D.updateSelectedTool(i,y=>(I(y.type===i.selectedTool.type),r(s,y))));switch(t.selectedTool.type){case b.Draw:return h(de.Overlay,{tool:t.selectedTool,onUpdateTool:o,...n});case b.KeyPoint:return h(pe.Overlay,{tool:t.selectedTool,onUpdateTool:o,...n});default:E(t.selectedTool)}}};function dn({selectedToolType:t,updateInteraction:e}){const n=o=>()=>e((r,s)=>D.requestSetSelectedTool(s,o));return U("div",{className:"pointer-events-none absolute top-0 bottom-0 flex cursor-wait flex-col items-center justify-center gap-3 p-3",children:[h(nt,{letter:"d",isSelected:t===b.Draw,onClick:n(b.Draw)}),h(nt,{letter:"k",isSelected:t===b.KeyPoint,onClick:n(b.KeyPoint)})]})}function nt({letter:t,onClick:e,isSelected:n}){return h("button",{className:_("pointer-events-auto flex h-10 w-10 items-center justify-center rounded-full border border-stone-200 bg-white shadow-md",n?"text-stone-500 ring-2 ring-inset ring-purple-400":"text-stone-400"),onClick:e,children:t})}class le{static distance(e,n){let o=0;for(let r=0;r<e.length;r++)o+=Math.pow(e[r]-n[r],2);return Math.sqrt(o)}static kernel(e,n){const o=le.distance(e,n);return o===0?0:Math.pow(o,2)*Math.log(o)}constructor(e,n){e.length===0&&xe("bad centers array :/"),e.every(a=>a.length===e[0].length)||xe("centers must have same dimensions :/"),this.centers=e;const o=n.slice(),r=[],s=[];for(let a=0;a<e.length;a++){const c=[],l=[1];for(let u=0;u<e[a].length;u++)l.push(e[a][u]);for(let u=0;u<e.length;u++)c.push(le.kernel(e[a],e[u]));s.push(l),r.push(c.concat(l))}const y=C.transpose(s).map(a=>{for(let c=a.length;c<r[0].length;c++)a.push(0);return a});for(let a=0;a<y.length;a++)r.push(y[a]),o.push(0);const x=this.solve(o,r);x||xe("rbf failed to compile with given centers./nCenters must be unique :/"),this.ws=x}solve(e,n){const o=C.inverse(n);return o?C.multiplyVector(o,e):null}getValue(e){I(this.ws);let n=0,o=0;for(o=0;o<this.centers.length;o++)n+=Number(this.ws[o])*le.kernel(e,this.centers[o]);for(n+=Number(this.ws[this.centers.length]),o=0;o<e.length;o++)n+=e[o]*Number(this.ws[this.centers.length+(o+1)]);return n}}const C={create(t){return t.map(e=>e.slice())},fromVector(t){return t.map(e=>[e])},identity(t){return A(t,e=>A(t,n=>e===n?1:0))},col(t,e){return t.map(n=>n[e-1])},clone(t){return t.slice()},canMultiplyFromLeft(t,e){return t[0].length===e.length},multiplyMatrix(t,e){if(!C.canMultiplyFromLeft(t,e))return null;const n=t[0].length;return A(t.length,o=>A(e[0].length,r=>{let s=0;for(let i=0;i<n;i++)s+=t[o][i]*e[i][r];return s}))},multiplyVector(t,e){return C.multiplyMatrix(t,C.fromVector(e))},transpose(t){return A(t[0].length,e=>A(t.length,n=>t[n][e]))},isSquare(t){return t.length===t[0].length},toRightTriangular(t){const e=C.clone(t),n=t.length,o=t[0].length;for(let r=0;r<n;r++){if(e[r][r]===0){for(let s=r+1;s<n;s++)if(e[s][r]!==0){const i=[];for(let y=0;y<o;y++)i.push(e[r][y]+e[s][y]);e[r]=i;break}}if(e[r][r]!==0)for(let s=r+1;s<n;s++){const i=e[s][r]/e[r][r],y=[];for(let x=0;x<o;x++)y.push(x<=r?0:e[s][x]-e[r][x]*i);e[s]=y}}return e},determinant(t){if(!C.isSquare(t))return null;const e=C.toRightTriangular(t);let n=e[0][0];for(let o=1;o<e.length;o++)n=n*e[o][o];return n},isSingular(t){return C.isSquare(t)&&C.determinant(t)===0},augment(t,e){const n=C.clone(t),o=n[0].length;I(n.length===e.length);for(let r=0;r<n.length;r++)for(let s=0;s<e[0].length;s++)n[r][o+s]=e[r][s];return n},inverse(t){if(!C.isSquare(t)||C.isSingular(t))return null;const e=t.length,n=[],o=C.toRightTriangular(C.augment(t,C.identity(e))),r=o[0].length;let s=t.length;for(;s--;){const i=[];n[s]=[];const y=o[s][s];for(let a=0;a<r;a++){const c=o[s][a]/y;i.push(c),a>=e&&n[s].push(c)}o[s]=i;let x=s;for(;x--;){const a=[];for(let c=0;c<r;c++)a.push(o[x][c]-o[s][c]*o[x][s]);o[x]=a}}return n}};class pn{interpolate(e){xe("cannot interpolate none")}}class hn{constructor(e){this.value=e}interpolate(e){return this.value}}class fn{constructor(e,n,o,r){this.centerA=e,this.centerB=n,this.valueA=o,this.valueB=r}interpolate(e){const n=this.centerB.sub(this.centerA),r=e.sub(this.centerA).dot(n)/n.dot(n);return it(this.valueA,this.valueB,r)}}class gn extends le{constructor(e,n){super(e.map(({x:o,y:r})=>[o,r]),n)}interpolate(e){return this.getValue([e.x,e.y])}}class ze{constructor(e,n){switch(I(e.length===n.length),e.length){case 0:this.interpolator=new pn;break;case 1:this.interpolator=new hn(n[0]);break;case 2:this.interpolator=new fn(e[0],e[1],n[0],n[1]);break;default:this.interpolator=new gn(e,n)}}interpolate(e){return this.interpolator.interpolate(e)}}class vn{constructor(){this.cache=new Map}getCenterPointsAtPosition(e,n,o){switch(o.type){case"keyPointId":{const r=e.getShapeVersion(o.keyPointId,n);if(!r){const s=e.keyPoints.get(o.keyPointId);return this.getCenterPointsAtInterpolatedPosition(e,n,s.position)}return e.getNormalizedCenterPointsForShapeVersion(r.id)}case"interpolated":return this.getCenterPointsAtInterpolatedPosition(e,n,o.scenePosition);default:E(o)}}getCenterPointsAtInterpolatedPosition(e,n,o){const r=e.shapes.get(n),s=new Set(e.iterateShapeVersionsForShape(n));if(!s.size)return[];const i=new Set;for(const a of s)i.add(e.keyPoints.get(a.keyPointId));const y=this.getCacheEntry(r,s,i);let x;return y?x=y.interpolators:(x=this.calculateInterpolators(e,s),this.cache.set(r,{versions:s,keyPoints:i,interpolators:x})),x.map(({x:a,y:c,r:l})=>({center:new m(a.interpolate(o),c.interpolate(o)),radius:l.interpolate(o)}))}calculateInterpolators(e,n){console.time("calculatInterpolators");const o=Array.from(n,y=>({normalizedCenterPoints:e.getNormalizedCenterPointsForShapeVersion(y.id),version:y,keyPoint:e.keyPoints.get(y.keyPointId)})),r=o.map(({keyPoint:y})=>y.position),s=Math.min(...o.map(({normalizedCenterPoints:y})=>y.length)),i=[];for(let y=0;y<s;y++){const x=o.map(({normalizedCenterPoints:l})=>l[y].center.x),a=o.map(({normalizedCenterPoints:l})=>l[y].center.y),c=o.map(({normalizedCenterPoints:l})=>l[y].radius);i.push({x:new ze(r,x),y:new ze(r,a),r:new ze(r,c)})}return console.timeEnd("calculatInterpolators"),i}getCacheEntry(e,n,o){const r=this.cache.get(e);if(!r||n.size!==r.versions.size||o.size!==r.keyPoints.size)return null;for(const s of n)if(!r.versions.has(s))return null;for(const s of o)if(!r.keyPoints.has(s))return null;return r}}const mn=new vn;function Me(t){const e=[],n=[];if(t.length===0)return[];if(t.length===1){const l=[];for(let u=0;u<12;u++)l.push(t[0].center.add(m.fromPolar(u*Math.PI/6,t[0].radius)));return l}const o=t[0],s=t[1].center.sub(o.center).normalize(),i=s.perpendicular().scale(o.radius);e.push(o.center.sub(s.scale(o.radius))),e.push(o.center.sub(i)),n.push(o.center.add(i));for(let l=1;l<t.length-1;l++){const u=t[l-1],p=t[l],w=t[l+1].center.sub(u.center).normalize().perpendicular().scale(p.radius);e.push(p.center.sub(w)),n.push(p.center.add(w))}const y=t[t.length-2],x=t[t.length-1],a=x.center.sub(y.center).normalize(),c=a.perpendicular().scale(x.radius);return e.push(x.center.sub(c)),e.push(x.center.add(a.scale(x.radius))),n.push(x.center.add(c)),e.concat(n.reverse())}function wn({interaction:t,document:e,shapeId:n,previewPosition:o}){let r=null;if(o.selectedShapeId===n)switch(t.selectedTool.type){case b.Draw:{const i=de.getState(t.selectedTool);switch(i.state){case"drawing":r=ut(lt(ct(i.points,ae),ae),ae.size);break;case"idle":break;default:E(i)}break}case b.KeyPoint:break;default:E(t.selectedTool)}const s=mn.getCenterPointsAtPosition(e,n,o);return U(Se,{children:[h("path",{d:Ve(Me(s)),className:_(r?"fill-stone-300":o.selectedShapeId===n?"fill-stone-800":"fill-stone-600")}),r&&h("path",{d:Ve(Me(r)),className:_(o.selectedShapeId===n?"fill-stone-800":"fill-stone-600")})]})}function Pn({document:t,previewPosition:e,interaction:n}){return h(Se,{children:Array.from(t.shapes,o=>h(wn,{document:t,interaction:n,shapeId:o.id,previewPosition:e},o.id))})}const O={initialize:t=>({undoStack:L.initialize(t),interaction:D.initialize(b.Draw)}),updateUndoStack:(t,e)=>ee(t,"undoStack",e),updateLocation:(t,e)=>O.updateUndoStack(t,n=>L.updateLocation(n,e)),updateDocument:(t,e,n)=>O.updateUndoStack(t,o=>L.updateDocument(o,e,n)),updateViewport:(t,e)=>O.updateLocation(t,n=>n.with({viewport:$(n.viewportState,e)})),updateInteraction:(t,e)=>ee(t,"interaction",e)};function In(t){return(e,n)=>{const o=[];let r=!1;function s(y){I(!r),o.push(y)}const i=t();n({update:s,updateUndoStack:y=>s(x=>O.updateUndoStack(x,y)),updateLocation:y=>s(x=>O.updateLocation(x,y)),updateDocument:(y,x)=>s(a=>O.updateDocument(a,y,x)),updateViewport:y=>s(x=>O.updateViewport(x,y)),updateInteraction:y=>s(x=>O.updateInteraction(x,y)),document:e.undoStack.current.doc,location:e.undoStack.current.location,viewport:i.viewport});for(let y=0;y<o.length;y++)e=o[y](e);return r=!0,e}}function Sn(t,e){const n=yt(e),o=V.exports.useMemo(()=>In(n),[n]),[r,s]=V.exports.useReducer(o,null,t),i=V.exports.useMemo(()=>{const a=l=>s(u=>u.updateInteraction(p=>l(u,p))),c=l=>u=>a((p,f)=>D.onPointerEvent({...p,event:u,eventType:l},f));return{updateUndoStack:l=>s(u=>u.updateUndoStack(p=>l(u,p))),updateLocation:l=>s(u=>u.updateLocation(p=>l(u,p))),updateDocument:(l,u)=>s(p=>p.updateDocument(f=>l(p,f),u)),updateViewport:l=>s(u=>u.updateViewport(p=>l(u,p))),updateInteraction:a,onPointerDown:c("down"),onPointerMove:c("move"),onPointerUp:c("up"),onPointerCancel:c("cancel"),onKeyDown:l=>a((u,p)=>D.onKeyDown({...u,event:l},p)),onKeyUp:l=>a((u,p)=>D.onKeyUp({...u,event:l},p))}},[]),{keyPointId:y,shapeId:x}=r.undoStack.current.location;return{...i,document:r.undoStack.current.doc,location:r.undoStack.current.location,interaction:r.interaction,previewPosition:V.exports.useMemo(()=>{var a;return(a=D.getPreviewPosition(r.interaction,x))!=null?a:Re.keyPointId(y,x)},[y,x,r.interaction])}}function kn(t,e){const n=e.visibleSceneBounds(),o=xt.fromLeftTopRightBottom(n.left+n.width/10,n.top+n.height/10,n.right-n.width/10,n.bottom-n.height/10),r=Array.from(t.keyPoints,x=>x.position),i=(Math.min(n.width,n.height)/10)**2;let y=o.getCenter();for(let x=0;x<500;x++){if(r.every(a=>a.distanceToSq(y)>i))return y;y=new m(He(o.left,o.right),He(o.top,o.bottom))}return y}function vt(t,e){return`linear-gradient(to right, ${A(10,r=>`rgba(250, 250, 249, ${Kt(r/9)*e}) ${(t*(r/9)).toFixed(2)}px`).join(",")})`}const ot=vt(60,1),bn={width:ke+60,background:"rgba(250, 250, 249, 0.7)",webkitMaskImage:ot,maskImage:ot},rt=vt(40,1),Cn={webkitMaskImage:rt,maskImage:rt},Tn={width:ke-24},En={minWidth:ke-24},zn=84,_n=80;function Dn({document:t,location:e,updateDocument:n,updateLocation:o}){const r=Array.from(t.keyPoints).findIndex(s=>e.keyPointId===s.id);return h("div",{className:"absolute top-0 right-0 h-full pl-8 backdrop-blur-lg ",style:bn,children:U("div",{className:"relative flex h-full flex-col gap-4 overflow-auto p-5 [-webkit-overflow-scrolling:touch]",style:Cn,children:[h("div",{className:"absolute top-5 z-0 w-20 rounded bg-stone-300/25 ring-2 ring-stone-300/25",style:{height:-16+_n*t.shapes.count(),left:32+r*zn}}),Array.from(t.shapes,(s,i)=>h("div",{className:"relative flex w-max flex-col gap-2",children:U("div",{className:_("mx-3 flex gap-1",s.id===e.shapeId&&"rounded bg-stone-300/25 ring-2 ring-stone-300/25"),style:En,children:[Array.from(t.keyPoints,y=>h("button",{className:_("overflow-none h-16 w-20 flex-none rounded border",s.id===e.shapeId&&y.id===e.keyPointId?"border-purple-500 bg-stone-50":"border-stone-200 bg-stone-50/50"),onClick:()=>{o(({location:x})=>x.with({shapeId:s.id,keyPointId:y.id}))},children:h(Vn,{width:78,height:62,shapeVersion:t.getShapeVersion(y.id,s.id),document:t})})),h("button",{className:"h-16 w-20 flex-none rounded border border-stone-200 text-xl text-stone-400",onClick:()=>{const y=ne.generate();n(({document:x,viewport:a})=>x.addKeyPoint(y,kn(x,a)),{lockstepLocation:x=>x.with({keyPointId:y,shapeId:s.id})})},children:"+"})]})})),h("button",{className:"sticky left-3 flex items-center justify-center rounded px-3 py-1 text-center hover:bg-stone-300/25",style:Tn,onClick:()=>{const s=oe.generate();n(({document:i})=>i.addShape(s),{lockstepLocation:i=>i.with({shapeId:s})})},children:"+ shape"})]})})}const Vn=Et.memo(function({width:e,height:n,shapeVersion:o,document:r}){if(!o)return null;const i=r.getNormalizedCenterPointsForShapeVersion(o.id);if(i.length<2)return null;let y=1/0,x=1/0,a=-1/0,c=-1/0;for(const{center:S,radius:v}of i)y=Math.min(y,S.x-v),a=Math.max(a,S.x+v),x=Math.min(x,S.y-v),c=Math.max(c,S.y+v);const l=a-y,u=c-x,p=e-4*2,f=n-4*2,d=Math.min(p/l,.8),w=Math.min(f/u,.8),P=Math.min(d,w);return h("svg",{viewBox:`0 0 ${e} ${n}`,style:{width:e,height:n},children:h("g",{transform:`translate(${4+Math.max(p-l*P,0)/2}, ${4+Math.max(f-u*P,0)/2}) scale(${P}) translate(${-y}, ${-x})`,children:h("path",{d:Ve(Me(i)),className:"fill-stone-800"})})})}),st=ht({doc:{id:"doc.0_VcKaG8h9Zf8pyG",keyPoints:{"key.0_a3vKHuIcxpHnVg":{id:"key.0_a3vKHuIcxpHnVg",position:{x:70.1201469236332,y:-422.7236094293703}},"key.1_TYmFrn9Wh1QZ3t":{id:"key.1_TYmFrn9Wh1QZ3t",position:{x:70.37132340865503,y:-196.2322204718854}},"key.2_8mSx0MUXiSEjNK":{id:"key.2_8mSx0MUXiSEjNK",position:{x:-178.2338928688651,y:-164.74554025214536}},"key.3_RariJQz2eTMOkJ":{id:"key.3_RariJQz2eTMOkJ",position:{x:299.9792402608849,y:-180.6942609315029}}},shapes:{"shp.0_n9ry1znj34Bp1k":{id:"shp.0_n9ry1znj34Bp1k"},"shp.1_ONCgL3fjUYIryN":{id:"shp.1_ONCgL3fjUYIryN"},"shp.2_Zwa9ObnrYgWogq":{id:"shp.2_Zwa9ObnrYgWogq"},"shp.3_mUCVyzbyAGCuIa":{id:"shp.3_mUCVyzbyAGCuIa"},"shp.4_SMMSTDAbn3tdXv":{id:"shp.4_SMMSTDAbn3tdXv"},"shp.5_pFzZ21ghrzLlt1":{id:"shp.5_pFzZ21ghrzLlt1"}},shapeVersions:{"shv.0_LwpIe0fFofKDNO":{id:"shv.0_LwpIe0fFofKDNO",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:-41,y:-45},{x:-47,y:-41},{x:-49,y:-39},{x:-53,y:-34},{x:-57,y:-30},{x:-61,y:-25},{x:-64,y:-20},{x:-66,y:-16},{x:-69,y:-11},{x:-71,y:-6},{x:-73,y:-1},{x:-74,y:5},{x:-76,y:11},{x:-76,y:16},{x:-77,y:22},{x:-78,y:28},{x:-78,y:35},{x:-78,y:42},{x:-78,y:49},{x:-78,y:56},{x:-78,y:62},{x:-78,y:68},{x:-76,y:74},{x:-74,y:80},{x:-71,y:86},{x:-68,y:91},{x:-64,y:96},{x:-60,y:102},{x:-55,y:107},{x:-49,y:112},{x:-44,y:118},{x:-37,y:123},{x:-30,y:128},{x:-23,y:132},{x:-15,y:137},{x:-7,y:140},{x:2,y:144},{x:11,y:147},{x:20,y:150},{x:30,y:152},{x:39,y:152},{x:49,y:153},{x:59,y:153},{x:69,y:153},{x:78,y:153},{x:89,y:152},{x:99,y:149},{x:109,y:147},{x:120,y:143},{x:129,y:139},{x:138,y:134},{x:148,y:129},{x:156,y:123},{x:164,y:117},{x:172,y:110},{x:179,y:103},{x:187,y:96},{x:193,y:89},{x:198,y:83},{x:202,y:76},{x:206,y:69},{x:208,y:63},{x:210,y:58},{x:211,y:52},{x:212,y:46},{x:213,y:38},{x:213,y:30},{x:213,y:23},{x:213,y:17},{x:213,y:11},{x:213,y:5},{x:213,y:-3},{x:213,y:-11},{x:213,y:-18},{x:213,y:-23},{x:212,y:-28},{x:211,y:-32},{x:209,y:-36},{x:208,y:-40},{x:206,y:-42},{x:205,y:-44},{x:203,y:-46},{x:201,y:-47},{x:200,y:-48},{x:199,y:-48},{x:199,y:-50}]},"shv.1_SWgK9k5Y2kn7dj":{id:"shv.1_SWgK9k5Y2kn7dj",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:-25,y:-43},{x:-25,y:-47},{x:-25,y:-49},{x:-24,y:-56},{x:-22,y:-65},{x:-19,y:-77},{x:-16,y:-90},{x:-14,y:-101},{x:-10,y:-113},{x:-8,y:-123},{x:-4,y:-131},{x:-2,y:-139},{x:1,y:-145},{x:3,y:-149},{x:4,y:-152},{x:6,y:-154},{x:7,y:-154},{x:8,y:-154},{x:10,y:-153},{x:12,y:-151},{x:15,y:-147},{x:18,y:-142},{x:21,y:-135},{x:24,y:-127},{x:27,y:-118},{x:29,y:-108},{x:30,y:-98},{x:30,y:-88},{x:31,y:-79},{x:32,y:-72},{x:32,y:-67},{x:33,y:-64},{x:33,y:-62},{x:34,y:-62},{x:34,y:-61},{x:34,y:-60},{x:35,y:-59}]},"shv.3_3ILI63YytH2Ite":{id:"shv.3_3ILI63YytH2Ite",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:126,y:-69},{x:127,y:-75},{x:130,y:-84},{x:136,y:-96},{x:142,y:-108},{x:148,y:-118},{x:154,y:-128},{x:161,y:-137},{x:169,y:-145},{x:177,y:-152},{x:183,y:-158},{x:188,y:-162},{x:191,y:-164},{x:192,y:-164},{x:193,y:-164},{x:193,y:-163},{x:194,y:-158},{x:194,y:-152},{x:196,y:-144},{x:196,y:-135},{x:197,y:-125},{x:197,y:-114},{x:197,y:-103},{x:197,y:-92},{x:196,y:-83},{x:195,y:-74},{x:194,y:-67},{x:193,y:-62},{x:192,y:-60},{x:192,y:-58},{x:192,y:-57},{x:192,y:-55},{x:192,y:-50},{x:192,y:-48}]},"shv.4_dljDpCZ90LHjbP":{id:"shv.4_dljDpCZ90LHjbP",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:41,y:-63},{x:46,y:-66},{x:51,y:-67},{x:57,y:-69},{x:65,y:-71},{x:72,y:-72},{x:80,y:-73},{x:89,y:-74},{x:99,y:-74},{x:109,y:-74},{x:115,y:-74},{x:120,y:-74},{x:124,y:-74},{x:127,y:-74},{x:129,y:-74},{x:130,y:-73},{x:130,y:-72}]},"shv.5_g5nKgDG7juS3Au":{id:"shv.5_g5nKgDG7juS3Au",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:21,y:-10},{x:15,y:-10},{x:11,y:-10},{x:5,y:-7},{x:-2,y:-3},{x:-8,y:1},{x:-14,y:6},{x:-18,y:10},{x:-22,y:14},{x:-25,y:19},{x:-27,y:24},{x:-29,y:30},{x:-30,y:38},{x:-30,y:44},{x:-30,y:48},{x:-29,y:52},{x:-26,y:55},{x:-22,y:59},{x:-17,y:62},{x:-10,y:65},{x:-3,y:66},{x:4,y:67},{x:11,y:67},{x:17,y:67},{x:22,y:64},{x:26,y:59},{x:29,y:53},{x:32,y:47},{x:33,y:44},{x:33,y:41},{x:33,y:40},{x:33,y:39},{x:33,y:36},{x:33,y:22},{x:33,y:16},{x:33,y:13},{x:33,y:11},{x:32,y:10},{x:31,y:9},{x:29,y:8},{x:27,y:8},{x:25,y:7},{x:24,y:6},{x:23,y:6},{x:22,y:6},{x:22,y:5},{x:21,y:4},{x:20,y:4},{x:20,y:3},{x:19,y:3},{x:18,y:3},{x:17,y:3}]},"shv.6_fOyfl45j6IoVJD":{id:"shv.6_fOyfl45j6IoVJD",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:151,y:-26},{x:145,y:-27},{x:138,y:-26},{x:127,y:-21},{x:116,y:-14},{x:106,y:-6},{x:98,y:3},{x:91,y:11},{x:87,y:20},{x:84,y:30},{x:83,y:39},{x:83,y:47},{x:86,y:53},{x:92,y:57},{x:100,y:59},{x:110,y:60},{x:121,y:60},{x:133,y:59},{x:144,y:56},{x:154,y:51},{x:163,y:45},{x:172,y:37},{x:177,y:30},{x:180,y:24},{x:182,y:18},{x:184,y:11},{x:184,y:4},{x:184,y:-6},{x:180,y:-13},{x:176,y:-19},{x:171,y:-23},{x:166,y:-25},{x:161,y:-27},{x:155,y:-27},{x:148,y:-27},{x:141,y:-27},{x:135,y:-26},{x:129,y:-23},{x:123,y:-18}]},"shv.7_MNXQuLFOxPhQSP":{id:"shv.7_MNXQuLFOxPhQSP",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:-35,y:25},{x:-41,y:26},{x:-44,y:26},{x:-48,y:26},{x:-53,y:27},{x:-57,y:29},{x:-62,y:30},{x:-67,y:33},{x:-72,y:35},{x:-77,y:38},{x:-83,y:42},{x:-88,y:46},{x:-92,y:50},{x:-97,y:55},{x:-101,y:62},{x:-105,y:68},{x:-108,y:75},{x:-111,y:81},{x:-113,y:87},{x:-114,y:92},{x:-114,y:96},{x:-114,y:101},{x:-114,y:104},{x:-113,y:108},{x:-111,y:111},{x:-108,y:115},{x:-105,y:118},{x:-101,y:121},{x:-98,y:123},{x:-94,y:126},{x:-90,y:128},{x:-85,y:130},{x:-80,y:132},{x:-74,y:133},{x:-69,y:135},{x:-62,y:137},{x:-56,y:138},{x:-49,y:139},{x:-43,y:140},{x:-36,y:140},{x:-30,y:140},{x:-24,y:140},{x:-18,y:140},{x:-12,y:140},{x:-7,y:140},{x:-1,y:141},{x:4,y:142},{x:9,y:142},{x:14,y:143},{x:21,y:144},{x:27,y:145},{x:33,y:147},{x:40,y:147},{x:46,y:148},{x:52,y:148},{x:58,y:148},{x:64,y:148},{x:70,y:148},{x:77,y:149},{x:83,y:149},{x:89,y:149},{x:95,y:149},{x:101,y:149},{x:107,y:149},{x:114,y:149},{x:121,y:149},{x:128,y:149},{x:136,y:149},{x:144,y:148},{x:151,y:147},{x:158,y:147},{x:165,y:145},{x:172,y:144},{x:179,y:144},{x:186,y:143},{x:193,y:142},{x:200,y:140},{x:206,y:139},{x:213,y:137},{x:220,y:134},{x:225,y:132},{x:231,y:130},{x:237,y:127},{x:242,y:123},{x:249,y:119},{x:255,y:113},{x:262,y:108},{x:266,y:103},{x:270,y:99},{x:274,y:95},{x:276,y:92},{x:278,y:89},{x:279,y:86},{x:280,y:83},{x:281,y:80},{x:281,y:77},{x:281,y:75},{x:281,y:74},{x:281,y:72},{x:280,y:69},{x:279,y:65},{x:277,y:60},{x:275,y:56},{x:274,y:53},{x:272,y:50},{x:270,y:47},{x:267,y:43},{x:265,y:39},{x:262,y:35},{x:259,y:30},{x:256,y:27},{x:252,y:23},{x:250,y:21},{x:246,y:18},{x:242,y:16},{x:239,y:14},{x:235,y:11},{x:230,y:10},{x:227,y:8},{x:223,y:8},{x:221,y:7},{x:217,y:7},{x:213,y:6},{x:210,y:6},{x:206,y:6},{x:204,y:6},{x:202,y:6},{x:201,y:6},{x:200,y:6},{x:200,y:5}]},"shv.8_dqc9S1VROeclkw":{id:"shv.8_dqc9S1VROeclkw",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:-20,y:20},{x:-23,y:16},{x:-23,y:13},{x:-25,y:10},{x:-26,y:7},{x:-29,y:4},{x:-32,y:1},{x:-35,y:-1},{x:-38,y:-4},{x:-39,y:-5},{x:-41,y:-6},{x:-43,y:-6},{x:-46,y:-8},{x:-49,y:-9},{x:-53,y:-9},{x:-56,y:-10},{x:-58,y:-10},{x:-59,y:-10},{x:-61,y:-11},{x:-62,y:-11},{x:-63,y:-11},{x:-64,y:-11},{x:-64,y:-12},{x:-64,y:-13},{x:-64,y:-14},{x:-64,y:-15},{x:-64,y:-16},{x:-63,y:-17},{x:-62,y:-18},{x:-61,y:-20},{x:-59,y:-22},{x:-56,y:-24},{x:-54,y:-26},{x:-52,y:-28},{x:-49,y:-29},{x:-46,y:-31},{x:-43,y:-32},{x:-39,y:-33},{x:-36,y:-33},{x:-32,y:-33},{x:-28,y:-33},{x:-24,y:-33},{x:-19,y:-33},{x:-15,y:-32},{x:-12,y:-31},{x:-9,y:-29},{x:-7,y:-28},{x:-5,y:-26},{x:-3,y:-24},{x:-2,y:-22},{x:0,y:-20},{x:2,y:-18},{x:3,y:-14},{x:5,y:-11},{x:7,y:-8},{x:7,y:-6},{x:9,y:-4},{x:9,y:-3},{x:11,y:-1},{x:12,y:0},{x:14,y:2},{x:15,y:4},{x:16,y:6},{x:16,y:8},{x:17,y:8},{x:17,y:9},{x:18,y:10},{x:18,y:11},{x:19,y:11},{x:19,y:12},{x:19,y:13},{x:19,y:14},{x:19,y:15},{x:20,y:16},{x:21,y:17}]},"shv.9_wkf9c4ZDBAwLRf":{id:"shv.9_wkf9c4ZDBAwLRf",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:152,y:-11},{x:156,y:-17},{x:158,y:-21},{x:162,y:-25},{x:167,y:-31},{x:174,y:-36},{x:181,y:-42},{x:189,y:-48},{x:196,y:-54},{x:204,y:-59},{x:212,y:-62},{x:220,y:-63},{x:228,y:-63},{x:236,y:-63},{x:245,y:-63},{x:252,y:-63},{x:257,y:-62},{x:259,y:-61},{x:261,y:-60},{x:262,y:-60},{x:263,y:-59},{x:263,y:-58},{x:263,y:-57},{x:260,y:-55},{x:255,y:-52},{x:250,y:-48},{x:243,y:-43},{x:237,y:-38},{x:230,y:-33},{x:225,y:-27},{x:218,y:-20},{x:213,y:-13},{x:208,y:-6},{x:206,y:-2},{x:204,y:0},{x:204,y:1},{x:204,y:2}]},"shv.10_QVHVJVxyuxdpD":{id:"shv.10_QVHVJVxyuxdpD",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:31,y:17},{x:33,y:16},{x:36,y:16},{x:47,y:11},{x:58,y:6},{x:72,y:1},{x:84,y:-1},{x:99,y:-4},{x:113,y:-6},{x:124,y:-6},{x:134,y:-7},{x:141,y:-8},{x:147,y:-8},{x:152,y:-8},{x:154,y:-8},{x:155,y:-7},{x:155,y:-6},{x:155,y:-4}]},"shv.12_5jxllLtpm93b7":{id:"shv.12_5jxllLtpm93b7",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:19,y:55},{x:12,y:55},{x:9,y:55},{x:4,y:55},{x:-1,y:56},{x:-6,y:57},{x:-10,y:57},{x:-15,y:58},{x:-20,y:59},{x:-26,y:60},{x:-32,y:63},{x:-37,y:65},{x:-43,y:68},{x:-47,y:71},{x:-52,y:74},{x:-54,y:77},{x:-57,y:81},{x:-59,y:86},{x:-61,y:90},{x:-62,y:95},{x:-62,y:98},{x:-62,y:101},{x:-62,y:103},{x:-61,y:105},{x:-56,y:107},{x:-51,y:108},{x:-44,y:110},{x:-37,y:110},{x:-30,y:110},{x:-24,y:110},{x:-17,y:108},{x:-9,y:106},{x:-3,y:103},{x:4,y:100},{x:10,y:97},{x:16,y:94},{x:21,y:91},{x:25,y:88},{x:30,y:84},{x:33,y:81},{x:36,y:77},{x:37,y:75},{x:38,y:73},{x:38,y:72},{x:38,y:71},{x:38,y:70},{x:38,y:69},{x:37,y:69},{x:36,y:67},{x:35,y:66},{x:34,y:65},{x:32,y:61},{x:29,y:54},{x:26,y:51},{x:25,y:50},{x:24,y:50},{x:23,y:50},{x:22,y:50},{x:21,y:50},{x:20,y:51},{x:19,y:52},{x:17,y:54},{x:14,y:57},{x:13,y:59}]},"shv.14_GWIuG0AcQVcWv":{id:"shv.14_GWIuG0AcQVcWv",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:221,y:50},{x:215,y:47},{x:211,y:47},{x:206,y:46},{x:200,y:46},{x:195,y:45},{x:191,y:45},{x:185,y:45},{x:179,y:45},{x:173,y:46},{x:166,y:50},{x:160,y:53},{x:155,y:57},{x:150,y:60},{x:148,y:64},{x:146,y:67},{x:145,y:71},{x:144,y:76},{x:144,y:81},{x:144,y:86},{x:144,y:89},{x:145,y:92},{x:148,y:94},{x:152,y:97},{x:158,y:99},{x:165,y:100},{x:173,y:101},{x:181,y:101},{x:189,y:101},{x:197,y:99},{x:205,y:96},{x:213,y:93},{x:221,y:90},{x:228,y:87},{x:234,y:84},{x:238,y:81},{x:241,y:80},{x:244,y:78},{x:247,y:76},{x:248,y:74},{x:248,y:73},{x:248,y:72},{x:248,y:70},{x:248,y:69},{x:248,y:68},{x:248,y:67},{x:246,y:66},{x:243,y:60},{x:240,y:57},{x:238,y:55},{x:237,y:54},{x:235,y:54},{x:233,y:53},{x:229,y:52},{x:224,y:52},{x:218,y:52},{x:214,y:52},{x:210,y:52},{x:204,y:52},{x:197,y:54}]},"shv.15_IegtY8uWpenHx":{id:"shv.15_IegtY8uWpenHx",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:-137,y:13},{x:-143,y:8},{x:-144,y:8},{x:-146,y:8},{x:-148,y:7},{x:-150,y:6},{x:-152,y:6},{x:-155,y:5},{x:-158,y:4},{x:-161,y:3},{x:-165,y:2},{x:-169,y:1},{x:-173,y:1},{x:-176,y:1},{x:-180,y:1},{x:-183,y:1},{x:-186,y:1},{x:-189,y:1},{x:-192,y:1},{x:-195,y:1},{x:-196,y:1},{x:-198,y:3},{x:-200,y:5},{x:-202,y:10},{x:-204,y:15},{x:-206,y:20},{x:-207,y:24},{x:-208,y:28},{x:-209,y:31},{x:-209,y:35},{x:-209,y:38},{x:-209,y:40},{x:-209,y:43},{x:-209,y:46},{x:-207,y:49},{x:-205,y:52},{x:-204,y:56},{x:-202,y:59},{x:-200,y:63},{x:-199,y:67},{x:-197,y:70},{x:-195,y:72},{x:-194,y:74},{x:-193,y:76},{x:-190,y:77},{x:-188,y:80},{x:-186,y:82},{x:-183,y:84},{x:-179,y:87},{x:-175,y:90},{x:-171,y:93},{x:-166,y:96},{x:-160,y:99},{x:-155,y:102},{x:-149,y:105},{x:-143,y:108},{x:-137,y:110},{x:-131,y:113},{x:-125,y:116},{x:-119,y:120},{x:-112,y:123},{x:-106,y:125},{x:-100,y:127},{x:-94,y:129},{x:-88,y:132},{x:-82,y:134},{x:-76,y:135},{x:-70,y:137},{x:-64,y:139},{x:-58,y:141},{x:-52,y:142},{x:-45,y:144},{x:-38,y:145},{x:-31,y:146},{x:-23,y:147},{x:-16,y:147},{x:-8,y:147},{x:0,y:147},{x:8,y:147},{x:17,y:147},{x:25,y:147},{x:34,y:147},{x:42,y:147},{x:49,y:147},{x:56,y:146},{x:63,y:146},{x:71,y:145},{x:78,y:144},{x:85,y:143},{x:92,y:142},{x:99,y:142},{x:106,y:141},{x:113,y:140},{x:120,y:139},{x:127,y:138},{x:134,y:137},{x:141,y:137},{x:149,y:136},{x:156,y:135},{x:164,y:134},{x:172,y:132},{x:179,y:131},{x:187,y:130},{x:194,y:128},{x:201,y:126},{x:208,y:123},{x:214,y:121},{x:221,y:118},{x:226,y:114},{x:230,y:111},{x:235,y:108},{x:238,y:104},{x:241,y:99},{x:244,y:93},{x:247,y:89},{x:250,y:82},{x:252,y:75},{x:255,y:65},{x:257,y:55},{x:257,y:48},{x:257,y:45},{x:257,y:43},{x:257,y:42},{x:252,y:36},{x:249,y:32},{x:245,y:28},{x:241,y:26},{x:239,y:25},{x:235,y:24},{x:231,y:21},{x:225,y:18},{x:219,y:16},{x:215,y:13},{x:211,y:11},{x:209,y:10},{x:208,y:8},{x:208,y:7},{x:207,y:6},{x:206,y:6},{x:205,y:6},{x:204,y:6},{x:203,y:6},{x:202,y:6},{x:201,y:6},{x:199,y:6},{x:198,y:6},{x:196,y:6},{x:194,y:6},{x:191,y:5},{x:189,y:5},{x:187,y:4},{x:184,y:4},{x:180,y:3},{x:177,y:3},{x:172,y:2},{x:168,y:1},{x:164,y:1},{x:160,y:0},{x:155,y:0},{x:151,y:0},{x:147,y:-1},{x:143,y:-1},{x:139,y:-1},{x:136,y:-1},{x:132,y:-1},{x:128,y:-1},{x:123,y:-1},{x:119,y:-1},{x:114,y:-1},{x:110,y:-1},{x:106,y:-1},{x:102,y:-1},{x:99,y:0},{x:95,y:1},{x:92,y:1},{x:90,y:1},{x:89,y:1},{x:87,y:2},{x:86,y:2},{x:85,y:2},{x:84,y:2},{x:84,y:3},{x:83,y:3},{x:82,y:3},{x:82,y:4},{x:81,y:4},{x:80,y:4},{x:79,y:4},{x:78,y:4},{x:77,y:4},{x:77,y:5},{x:76,y:5},{x:75,y:5},{x:74,y:5},{x:73,y:6},{x:72,y:6},{x:70,y:6},{x:67,y:7},{x:65,y:7},{x:63,y:8},{x:61,y:8},{x:59,y:8},{x:57,y:9},{x:55,y:10},{x:53,y:10},{x:52,y:11},{x:50,y:11},{x:49,y:11},{x:48,y:11},{x:47,y:11},{x:47,y:12},{x:47,y:13}]},"shv.17_JPHh1b7aVM4a5":{id:"shv.17_JPHh1b7aVM4a5",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:-130,y:1},{x:-135,y:-3},{x:-137,y:-4},{x:-140,y:-8},{x:-143,y:-11},{x:-147,y:-13},{x:-151,y:-15},{x:-155,y:-17},{x:-160,y:-19},{x:-165,y:-21},{x:-170,y:-23},{x:-175,y:-23},{x:-179,y:-23},{x:-183,y:-23},{x:-188,y:-23},{x:-191,y:-23},{x:-194,y:-22},{x:-197,y:-21},{x:-200,y:-20},{x:-201,y:-19},{x:-202,y:-19},{x:-203,y:-19},{x:-204,y:-19},{x:-204,y:-20},{x:-204,y:-21},{x:-204,y:-25},{x:-202,y:-30},{x:-198,y:-35},{x:-194,y:-40},{x:-190,y:-43},{x:-185,y:-46},{x:-181,y:-48},{x:-176,y:-49},{x:-171,y:-50},{x:-165,y:-52},{x:-159,y:-52},{x:-154,y:-54},{x:-149,y:-54},{x:-145,y:-54},{x:-139,y:-54},{x:-134,y:-53},{x:-130,y:-50},{x:-127,y:-48},{x:-124,y:-45},{x:-121,y:-41},{x:-119,y:-37},{x:-117,y:-32},{x:-115,y:-26},{x:-113,y:-19},{x:-112,y:-12},{x:-112,y:-6},{x:-112,y:-2},{x:-112,y:0},{x:-112,y:1},{x:-112,y:2},{x:-112,y:3},{x:-111,y:3},{x:-111,y:4},{x:-111,y:5}]},"shv.19_XdsJ3W4A719pc":{id:"shv.19_XdsJ3W4A719pc",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:-31,y:2},{x:-33,y:-4},{x:-33,y:-7},{x:-34,y:-11},{x:-36,y:-14},{x:-38,y:-17},{x:-40,y:-22},{x:-43,y:-27},{x:-46,y:-32},{x:-48,y:-35},{x:-50,y:-38},{x:-52,y:-41},{x:-55,y:-44},{x:-59,y:-48},{x:-62,y:-52},{x:-66,y:-56},{x:-69,y:-58},{x:-72,y:-60},{x:-76,y:-61},{x:-79,y:-61},{x:-82,y:-61},{x:-85,y:-61},{x:-87,y:-61},{x:-88,y:-61},{x:-89,y:-61},{x:-90,y:-62},{x:-88,y:-62},{x:-87,y:-63},{x:-85,y:-63},{x:-83,y:-63},{x:-80,y:-63},{x:-76,y:-63},{x:-70,y:-63},{x:-64,y:-63},{x:-58,y:-63},{x:-52,y:-63},{x:-47,y:-62},{x:-42,y:-61},{x:-38,y:-59},{x:-34,y:-56},{x:-30,y:-53},{x:-27,y:-49},{x:-24,y:-45},{x:-21,y:-42},{x:-19,y:-39},{x:-17,y:-35},{x:-14,y:-31},{x:-10,y:-25},{x:-7,y:-19},{x:-3,y:-13},{x:0,y:-8},{x:3,y:-4},{x:5,y:-1},{x:7,y:2},{x:9,y:5},{x:12,y:9},{x:16,y:13},{x:19,y:17},{x:22,y:19},{x:24,y:21},{x:26,y:23},{x:27,y:23},{x:28,y:24},{x:28,y:25},{x:29,y:25},{x:29,y:26}]},"shv.20_QSK3n1l8MmGEZ":{id:"shv.20_QSK3n1l8MmGEZ",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:-102,y:9},{x:-100,y:8},{x:-97,y:8},{x:-93,y:8},{x:-89,y:7},{x:-86,y:6},{x:-83,y:5},{x:-79,y:4},{x:-75,y:4},{x:-71,y:4},{x:-67,y:4},{x:-63,y:4},{x:-60,y:3},{x:-58,y:3},{x:-55,y:3},{x:-52,y:3},{x:-49,y:3},{x:-47,y:3},{x:-44,y:3},{x:-43,y:3},{x:-42,y:3}]},"shv.22_I2STbWZAXgo1B":{id:"shv.22_I2STbWZAXgo1B",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:-110,y:42},{x:-115,y:40},{x:-118,y:40},{x:-122,y:40},{x:-126,y:38},{x:-130,y:36},{x:-134,y:34},{x:-138,y:32},{x:-141,y:31},{x:-144,y:30},{x:-147,y:29},{x:-151,y:28},{x:-154,y:27},{x:-158,y:26},{x:-162,y:26},{x:-165,y:26},{x:-168,y:26},{x:-170,y:27},{x:-171,y:29},{x:-172,y:32},{x:-173,y:34},{x:-174,y:37},{x:-174,y:39},{x:-174,y:41},{x:-174,y:43},{x:-174,y:45},{x:-174,y:47},{x:-172,y:49},{x:-169,y:52},{x:-165,y:56},{x:-160,y:60},{x:-155,y:64},{x:-149,y:68},{x:-143,y:72},{x:-137,y:75},{x:-132,y:78},{x:-125,y:81},{x:-119,y:83},{x:-112,y:85},{x:-107,y:86},{x:-101,y:86},{x:-96,y:86},{x:-92,y:86},{x:-88,y:84},{x:-85,y:80},{x:-83,y:77},{x:-82,y:74},{x:-82,y:72},{x:-82,y:71},{x:-82,y:69},{x:-82,y:67},{x:-83,y:63},{x:-86,y:60},{x:-87,y:57},{x:-88,y:55},{x:-90,y:51},{x:-93,y:44},{x:-96,y:37},{x:-100,y:32},{x:-102,y:29},{x:-103,y:28},{x:-105,y:28},{x:-106,y:28},{x:-107,y:28},{x:-108,y:28},{x:-108,y:29}]},"shv.23_wW18nQbpEd7gx":{id:"shv.23_wW18nQbpEd7gx",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:4,y:40},{x:-2,y:38},{x:-5,y:38},{x:-9,y:38},{x:-14,y:37},{x:-18,y:37},{x:-24,y:37},{x:-28,y:37},{x:-32,y:37},{x:-35,y:38},{x:-38,y:39},{x:-40,y:41},{x:-42,y:43},{x:-42,y:45},{x:-43,y:46},{x:-43,y:47},{x:-43,y:50},{x:-43,y:54},{x:-41,y:59},{x:-38,y:64},{x:-35,y:68},{x:-32,y:72},{x:-29,y:74},{x:-25,y:77},{x:-22,y:79},{x:-18,y:79},{x:-13,y:80},{x:-8,y:80},{x:-3,y:80},{x:3,y:80},{x:9,y:79},{x:15,y:75},{x:21,y:72},{x:26,y:69},{x:31,y:66},{x:34,y:64},{x:36,y:61},{x:38,y:59},{x:38,y:58},{x:38,y:57},{x:37,y:56},{x:36,y:56},{x:34,y:55},{x:31,y:52},{x:26,y:49},{x:21,y:45},{x:16,y:42},{x:12,y:40},{x:9,y:38},{x:6,y:36},{x:3,y:35},{x:-1,y:35},{x:-4,y:34},{x:-7,y:34},{x:-10,y:33},{x:-12,y:33},{x:-13,y:33},{x:-21,y:38}]},"shv.25_bSftSx0IJxw7H":{id:"shv.25_bSftSx0IJxw7H",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:110.49240292871617,y:19.52362771067062},{x:101.42737067012109,y:11.753600060446258},{x:100.13236606175036,y:11.753600060446258},{x:96.24735223663818,y:11.753600060446258},{x:89.77232919478455,y:10.458595452075532},{x:84.59231076130163,y:9.163590843704805},{x:75.52727850270655,y:9.163590843704805},{x:67.75725085248219,y:7.868586235334078},{x:58.6922185938871,y:7.868586235334078},{x:50.922190943662734,y:7.868586235334078},{x:43.15216329343838,y:7.868586235334078},{x:35.38213564321401,y:7.868586235334078},{x:27.612107992989653,y:7.868586235334078},{x:19.84208034276529,y:7.868586235334078},{x:13.367057300911656,y:7.868586235334078},{x:6.892034259058021,y:9.163590843704805},{x:.4170112172043865,y:9.163590843704805},{x:-6.058011824649248,y:11.753600060446258},{x:-12.533034866502883,y:14.343609277187712},{x:-17.71305329998579,y:15.63861388555844},{x:-22.893071733468698,y:19.52362771067062},{x:-29.368094775322334,y:22.113636927412074},{x:-34.54811320880524,y:24.703646144153527},{x:-41.02313625065887,y:29.883664577636434},{x:-47.49815929251251,y:33.76867840274862},{x:-51.38317311762469,y:37.653692227860795},{x:-55.268186942736875,y:40.24370144460225},{x:-56.5631915511076,y:41.53870605297298},{x:-57.858196159478325,y:42.83371066134371},{x:-59.15320076784905,y:44.128715269714434},{x:-59.15320076784905,y:46.71872448645588},{x:-60.44820537621978,y:50.603738311568065},{x:-61.74320998459051,y:55.78375674505097},{x:-63.03821459296123,y:60.96377517853388},{x:-64.33321920133196,y:67.43879822038751},{x:-64.33321920133196,y:73.91382126224116},{x:-64.33321920133196,y:80.38884430409479},{x:-64.33321920133196,y:86.86386734594842},{x:-61.74320998459051,y:92.04388577943133},{x:-59.15320076784905,y:95.92889960454352},{x:-55.268186942736875,y:99.81391342965568},{x:-51.38317311762469,y:102.40392264639715},{x:-47.49815929251251,y:106.28893647150933},{x:-42.318140859029604,y:108.87894568825078},{x:-35.843117817175965,y:111.46895490499223},{x:-29.368094775322334,y:112.76395951336296},{x:-21.598067125097973,y:115.35396873010441},{x:-15.123044083244336,y:116.64897333847514},{x:-7.353016433019975,y:116.64897333847514},{x:-.8779933911663405,y:117.94397794684586},{x:6.892034259058021,y:119.2389825552166},{x:15.95706651765311,y:120.53398716358733},{x:23.72709416787747,y:123.12399638032878},{x:34.08713103484329,y:123.12399638032878},{x:41.85715868506765,y:124.41900098869951},{x:50.922190943662734,y:125.71400559707023},{x:58.6922185938871,y:128.30401481381168},{x:67.75725085248219,y:129.5990194221824},{x:76.82228311107728,y:132.18902863892387},{x:87.1823199780431,y:133.4840332472946},{x:96.24735223663818,y:134.7790378556653},{x:106.60738910360399,y:136.07404246403604},{x:115.67242136219909,y:137.36904707240677},{x:124.73745362079417,y:138.6640516807775},{x:132.50748127101855,y:138.6640516807775},{x:140.27750892124288,y:139.95905628914824},{x:149.34254117983798,y:141.25406089751894},{x:157.11256883006234,y:142.54906550588967},{x:166.17760108865744,y:143.8440701142604},{x:175.24263334725254,y:145.13907472263114},{x:184.3076656058476,y:145.13907472263114},{x:192.07769325607197,y:146.43407933100187},{x:201.14272551466706,y:146.43407933100187},{x:210.20775777326216,y:146.43407933100187},{x:219.27279003185726,y:146.43407933100187},{x:228.33782229045232,y:146.43407933100187},{x:239.99286376578888,y:146.43407933100187},{x:250.35290063275468,y:143.8440701142604},{x:263.302946716462,y:141.25406089751894},{x:276.25299280016924,y:137.36904707240677},{x:289.2030388838765,y:133.4840332472946},{x:300.85808035921303,y:129.5990194221824},{x:312.51312183454957,y:125.71400559707023},{x:322.8731587015154,y:121.82899177195804},{x:333.2331955684812,y:117.94397794684586},{x:344.88823704381775,y:111.46895490499223},{x:355.24827391078355,y:104.9939318631386},{x:364.3133061693787,y:98.51890882128497},{x:372.083333819603,y:92.04388577943133},{x:379.8533614698274,y:86.86386734594842},{x:386.328384511681,y:80.38884430409479},{x:394.0984121619054,y:72.61881665387043},{x:401.86843981212974,y:66.1437936120168},{x:408.3434628539834,y:57.078761353421704},{x:412.22847667909554,y:50.603738311568065},{x:414.818485895837,y:46.71872448645588},{x:414.818485895837,y:44.128715269714434},{x:414.818485895837,y:42.83371066134371},{x:414.818485895837,y:41.53870605297298},{x:414.818485895837,y:40.24370144460225},{x:413.52348128746627,y:37.653692227860795},{x:410.9334720707248,y:36.35868761949007},{x:408.3434628539834,y:33.76867840274862},{x:405.75345363724193,y:29.883664577636434},{x:401.86843981212974,y:24.703646144153527},{x:397.98342598701754,y:19.52362771067062},{x:392.80340755353467,y:13.048604668816985},{x:388.9183937284225,y:9.163590843704805},{x:386.328384511681,y:6.5735816269633505},{x:382.4433706865688,y:2.68856780185117},{x:379.8533614698274,y:.098558585109716},{x:375.9683476447152,y:-2.491450631631738},{x:372.083333819603,y:-3.7864552400024647},{x:368.1983199944908,y:-6.376464456743919},{x:364.3133061693787,y:-7.671469065114645},{x:360.4282923442665,y:-8.966473673485373},{x:357.838283127525,y:-8.966473673485373},{x:352.65826469404215,y:-8.966473673485373},{x:348.77325086892995,y:-10.2614782818561},{x:343.593232435447,y:-10.2614782818561},{x:338.4132140019641,y:-10.2614782818561},{x:331.9381909601105,y:-10.2614782818561},{x:326.75817252662756,y:-10.2614782818561},{x:320.28314948477396,y:-10.2614782818561},{x:313.8081264429203,y:-10.2614782818561},{x:307.3331034010667,y:-10.2614782818561},{x:302.15308496758377,y:-10.2614782818561},{x:296.97306653410084,y:-10.2614782818561},{x:291.79304810061797,y:-10.2614782818561},{x:285.3180250587643,y:-10.2614782818561},{x:277.54799740853997,y:-10.2614782818561},{x:269.7779697583156,y:-8.966473673485373},{x:262.00794210809124,y:-7.671469065114645},{x:255.53291906623758,y:-6.376464456743919},{x:251.64790524112541,y:-5.081459848373192},{x:250.35290063275468,y:-3.7864552400024647},{x:249.05789602438395,y:-3.7864552400024647},{x:250.35290063275468,y:-2.491450631631738}]},"shv.26_FUFwushsNIoT8":{id:"shv.26_FUFwushsNIoT8",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:116.9674259705698,y:15.63861388555844},{x:120.85243979568199,y:6.5735816269633505},{x:122.14744440405272,y:2.68856780185117},{x:124.73745362079417,y:.098558585109716},{x:128.62246744590635,y:-3.7864552400024647},{x:131.21247666264782,y:-7.671469065114645},{x:135.09749048775998,y:-12.851487498597553},{x:138.98250431287218,y:-16.736501323709735},{x:144.16252274635508,y:-21.916519757192642},{x:149.34254117983798,y:-25.801533582304824},{x:153.22755500495018,y:-29.686547407417002},{x:157.11256883006234,y:-33.571561232529184},{x:160.99758265517454,y:-36.16157044927064},{x:164.8825964802867,y:-38.75157966601209},{x:168.7676103053989,y:-41.34158888275355},{x:172.65262413051107,y:-42.63659349112427},{x:176.53763795562324,y:-43.931598099495},{x:179.1276471723647,y:-43.931598099495},{x:181.71765638910617,y:-43.931598099495},{x:183.0126609974769,y:-43.931598099495},{x:184.3076656058476,y:-45.22660270786573},{x:185.60267021421834,y:-45.22660270786573},{x:188.1926794309598,y:-46.521607316236455},{x:189.48768403933053,y:-46.521607316236455},{x:190.78268864770124,y:-46.521607316236455},{x:192.07769325607197,y:-46.521607316236455},{x:193.3726978644427,y:-46.521607316236455},{x:194.66770247281343,y:-46.521607316236455},{x:195.96270708118416,y:-45.22660270786573},{x:195.96270708118416,y:-43.931598099495},{x:195.96270708118416,y:-42.63659349112427},{x:195.96270708118416,y:-40.046584274382816},{x:195.96270708118416,y:-37.456575057641366},{x:194.66770247281343,y:-32.27655662415846},{x:193.3726978644427,y:-28.391542799046277},{x:189.48768403933053,y:-21.916519757192642},{x:185.60267021421834,y:-15.441496715339007},{x:181.71765638910617,y:-8.966473673485373},{x:177.83264256399397,y:-3.7864552400024647},{x:173.9476287388818,y:1.3935631934804429},{x:171.35761952214034,y:5.278577018592624},{x:170.0626149137696,y:6.5735816269633505},{x:168.7676103053989,y:7.868586235334078},{x:168.7676103053989,y:9.163590843704805},{x:168.7676103053989,y:10.458595452075532},{x:168.7676103053989,y:11.753600060446258},{x:168.7676103053989,y:13.048604668816985}]},"shv.28_mqL5cK4iYMnLO":{id:"shv.28_mqL5cK4iYMnLO",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:241.2878683741596,y:-8.966473673485373},{x:238.69785915741815,y:-15.441496715339007},{x:238.69785915741815,y:-18.03150593208046},{x:238.69785915741815,y:-21.916519757192642},{x:241.2878683741596,y:-25.801533582304824},{x:242.58287298253032,y:-30.98155201578773},{x:245.17288219927178,y:-34.86656584089991},{x:247.76289141601325,y:-38.75157966601209},{x:251.64790524112541,y:-42.63659349112427},{x:256.8279236746083,y:-47.81661192460718},{x:264.5979513248327,y:-52.99663035809009},{x:271.0729743666863,y:-59.471653399943726},{x:277.54799740853997,y:-63.35666722505591},{x:284.0230204503936,y:-65.94667644179736},{x:290.49804349224723,y:-67.24168105016808},{x:298.26807114247157,y:-67.24168105016808},{x:306.03809879269596,y:-67.24168105016808},{x:313.8081264429203,y:-67.24168105016808},{x:321.5781540931447,y:-67.24168105016808},{x:328.0531771349983,y:-67.24168105016808},{x:333.2331955684812,y:-65.94667644179736},{x:335.8232047852227,y:-65.94667644179736},{x:337.1182093935934,y:-64.65167183342663},{x:338.4132140019641,y:-64.65167183342663},{x:335.8232047852227,y:-64.65167183342663},{x:333.2331955684812,y:-64.65167183342663},{x:325.46316791825683,y:-63.35666722505591},{x:317.6931402680325,y:-62.061662616685176},{x:311.21811722617883,y:-60.76665800831445},{x:303.4480895759545,y:-58.176648791572994},{x:294.38305731735943,y:-52.99663035809009},{x:286.61302966713504,y:-47.81661192460718},{x:277.54799740853997,y:-41.34158888275355},{x:271.0729743666863,y:-34.86656584089991},{x:265.89295593320344,y:-28.391542799046277},{x:262.00794210809124,y:-25.801533582304824},{x:260.7129374997205,y:-21.916519757192642},{x:259.4179328913498,y:-20.621515148821913},{x:258.12292828297905,y:-19.32651054045119},{x:258.12292828297905,y:-18.03150593208046},{x:258.12292828297905,y:-16.736501323709735},{x:258.12292828297905,y:-15.441496715339007},{x:258.12292828297905,y:-14.14649210696828},{x:258.12292828297905,y:-12.851487498597553},{x:258.12292828297905,y:-11.556482890226826},{x:258.12292828297905,y:-10.2614782818561},{x:258.12292828297905,y:-8.966473673485373},{x:259.4179328913498,y:-8.966473673485373},{x:259.4179328913498,y:-1.196446023261011}]},"shv.29_7s9cPPIlpJ9Np":{id:"shv.29_7s9cPPIlpJ9Np",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:188.1926794309598,y:16.933618493929167},{x:192.07769325607197,y:10.458595452075532},{x:195.96270708118416,y:10.458595452075532},{x:202.4377301230378,y:9.163590843704805},{x:210.20775777326216,y:9.163590843704805},{x:217.97778542348652,y:7.868586235334078},{x:224.45280846534015,y:6.5735816269633505},{x:230.9278315071938,y:5.278577018592624},{x:236.1078499406767,y:2.68856780185117},{x:239.99286376578888,y:2.68856780185117},{x:242.58287298253032,y:1.3935631934804429},{x:243.87787759090105,y:1.3935631934804429},{x:245.17288219927178,y:1.3935631934804429},{x:246.46788680764251,y:1.3935631934804429}]},"shv.30_gZeoEkcUkLcml":{id:"shv.30_gZeoEkcUkLcml",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:238.69785915741815,y:38.94869683623153},{x:232.22283611556452,y:41.53870605297298},{x:228.33782229045232,y:41.53870605297298},{x:225.7478130737109,y:45.42371987808516},{x:220.56779464022796,y:49.30873370319734},{x:216.6827808151158,y:54.48875213668025},{x:211.5027623816329,y:59.668770570163154},{x:206.32274394814996,y:66.1437936120168},{x:201.14272551466706,y:71.3238120454997},{x:198.5527162979256,y:76.50383047898261},{x:195.96270708118416,y:81.6838489124655},{x:194.66770247281343,y:84.27385812920697},{x:193.3726978644427,y:88.15887195431915},{x:193.3726978644427,y:89.45387656268987},{x:193.3726978644427,y:90.7488811710606},{x:193.3726978644427,y:93.33889038780205},{x:194.66770247281343,y:94.63389499617278},{x:198.5527162979256,y:95.92889960454352},{x:203.73273473140853,y:97.22390421291423},{x:208.91275316489143,y:98.51890882128497},{x:214.09277159837433,y:99.81391342965568},{x:220.56779464022796,y:99.81391342965568},{x:228.33782229045232,y:99.81391342965568},{x:237.40285454904742,y:97.22390421291423},{x:246.46788680764251,y:93.33889038780205},{x:256.8279236746083,y:88.15887195431915},{x:264.5979513248327,y:80.38884430409479},{x:272.36797897505704,y:72.61881665387043},{x:278.8430020169107,y:66.1437936120168},{x:282.72801584202284,y:60.96377517853388},{x:286.61302966713504,y:54.48875213668025},{x:287.90803427550577,y:49.30873370319734},{x:289.2030388838765,y:45.42371987808516},{x:289.2030388838765,y:44.128715269714434},{x:287.90803427550577,y:44.128715269714434},{x:285.3180250587643,y:44.128715269714434},{x:281.4330112336521,y:42.83371066134371},{x:276.25299280016924,y:42.83371066134371},{x:269.7779697583156,y:42.83371066134371},{x:262.00794210809124,y:42.83371066134371},{x:252.94290984949615,y:42.83371066134371},{x:245.17288219927178,y:42.83371066134371},{x:239.99286376578888,y:42.83371066134371},{x:237.40285454904742,y:42.83371066134371},{x:236.1078499406767,y:42.83371066134371},{x:236.1078499406767,y:44.128715269714434}]},"shv.32_Is4OGgrMoyylx":{id:"shv.32_Is4OGgrMoyylx",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:377.26335225308594,y:20.81863231904135},{x:366.90331538612014,y:19.52362771067062},{x:364.3133061693787,y:19.52362771067062},{x:359.13328773589575,y:22.113636927412074},{x:352.65826469404215,y:27.29365536089498},{x:344.88823704381775,y:35.063683011119345},{x:337.1182093935934,y:44.128715269714434},{x:330.64318635173976,y:51.8987429199388},{x:326.75817252662756,y:59.668770570163154},{x:321.5781540931447,y:66.1437936120168},{x:320.28314948477396,y:72.61881665387043},{x:317.6931402680325,y:77.79883508735334},{x:317.6931402680325,y:80.38884430409479},{x:317.6931402680325,y:82.97885352083624},{x:318.9881448764032,y:84.27385812920697},{x:321.5781540931447,y:85.56886273757769},{x:326.75817252662756,y:85.56886273757769},{x:331.9381909601105,y:85.56886273757769},{x:339.7082186103348,y:84.27385812920697},{x:347.4782462605592,y:80.38884430409479},{x:355.24827391078355,y:76.50383047898261},{x:363.01830156100795,y:71.3238120454997},{x:370.7883292112323,y:67.43879822038751},{x:375.9683476447152,y:62.25877978690461},{x:381.14836607819814,y:57.078761353421704},{x:383.73837529493954,y:51.8987429199388},{x:387.62338912005174,y:46.71872448645588},{x:390.2133983367932,y:40.24370144460225},{x:392.80340755353467,y:35.063683011119345},{x:392.80340755353467,y:31.178669186007163},{x:392.80340755353467,y:28.58865996926571},{x:392.80340755353467,y:27.29365536089498},{x:390.2133983367932,y:27.29365536089498},{x:388.9183937284225,y:27.29365536089498},{x:387.62338912005174,y:27.29365536089498},{x:386.328384511681,y:27.29365536089498},{x:386.328384511681,y:28.58865996926571},{x:386.328384511681,y:31.178669186007163}]}}},location:{keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.1_ONCgL3fjUYIryN",viewport:{pan:{x:-50.06232188421893,y:-136.2905268911798},zoom:.6855621903696436},tool:"draw"}});function On(){const[t,e]=V.exports.useState(null),n=_t(t,Dt);return console.log(n),h("div",{ref:e,className:"absolute inset-0 touch-none",children:n&&h(Ln,{size:n})})}function Ln({size:t}){const e=V.exports.useRef(null),{document:n,location:o,interaction:r,previewPosition:s,updateDocument:i,updateLocation:y,updateInteraction:x,updateUndoStack:a,onPointerDown:c,onPointerMove:l,onPointerUp:u,onPointerCancel:p,onKeyDown:f,onKeyUp:d}=Sn(()=>{{const v=sn("autosave");if(v.isOk())return O.initialize(v.value);console.error(`Error loading autosave: ${v.error}`)}return O.initialize(et())},()=>({viewport:P}));V.exports.useEffect(()=>{xn("autosave",{doc:n,location:o})},[n,o]);const w=V.exports.useCallback(v=>y((g,T)=>T.with({viewport:$(T.viewportState,v)})),[y]),P=V.exports.useMemo(()=>new on(o.viewportState,t,w),[o.viewportState,t,w]);V.exports.useEffect(()=>{const v=r.selectedTool.type;y((g,T)=>T.tool!==v?T.with({tool:v}):T)},[r.selectedTool.type,y]);const S=yt(v=>P.handleWheelEvent(v));return V.exports.useEffect(()=>{const v=Ie(e.current);return v.addEventListener("wheel",S,{passive:!1}),window.addEventListener("keydown",f),window.addEventListener("keyup",d),()=>{v.removeEventListener("wheel",S),window.removeEventListener("keydown",f),window.removeEventListener("keyup",d)}},[f,d,S]),U(Se,{children:[U("div",{className:"pointer-events-none absolute top-0",children:[Re.toDebugString(s)," |"," ",D.toDebugString(r)]}),U("div",{className:"absolute inset-0",ref:e,onPointerDown:c,onPointerMove:l,onPointerUp:u,onPointerCancel:p,children:[h("svg",{viewBox:`0 0 ${t.x} ${t.y}`,className:_("absolute top-0 left-0",D.getCanvasClassName(r)),children:h("g",{transform:P.getSceneTransform(),children:h(Pn,{document:n,previewPosition:s,interaction:r})})}),h(D.Overlay,{interaction:r,viewport:P,document:n,location:o,onUpdateInteraction:x})]}),h(dn,{selectedToolType:r.selectedTool.type,updateInteraction:x}),h(Dn,{document:n,location:o,updateDocument:i,updateLocation:y}),U("div",{className:"absolute bottom-0 left-0 flex w-full items-center justify-center gap-3 p-3",children:[h("button",{className:_("flex h-10 flex-none items-center justify-center justify-self-end rounded-full border border-stone-200 px-4 text-stone-400 shadow-md transition-transform hover:-translate-y-1"),onClick:()=>a((v,g)=>L.undo(g)),children:"undo"}),h("button",{className:_("flex h-10 flex-none items-center justify-center justify-self-end rounded-full border border-stone-200 px-4 text-stone-400 shadow-md transition-transform hover:-translate-y-1"),onClick:()=>a((v,g)=>L.redo(g)),children:"redo"}),h("button",{className:_("flex h-10 flex-none items-center justify-center justify-self-end rounded-full border border-stone-200 px-4 text-stone-400 shadow-md transition-transform hover:-translate-y-1"),onClick:()=>{const{doc:v,location:g}=et();i(()=>v,{lockstepLocation:g})},children:"reset"}),st.isOk()&&h("button",{className:_("flex h-10 flex-none items-center justify-center justify-self-end rounded-full border border-stone-200 px-4 text-stone-400 shadow-md transition-transform hover:-translate-y-1"),onClick:()=>{const{doc:v,location:g}=st.unwrap();i(()=>v,{lockstepLocation:new Ce({keyPointId:g.keyPointId,shapeId:g.shapeId})})},children:"example"})]})]})}const Mn=Ie(document.getElementById("root"));Vt(Mn).render(h(On,{}));
