!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=t.parcelRequire0561;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},t.parcelRequire0561=i),i.register("i9QUB",(function(t,n){e(t.exports,"default",(function(){return s}));var r=i("eUMMJ"),a=i("diH60"),s=function(){"use strict";function e(t,n,i){var s=void 0===i?1:i;r.classCallCheck(this,e),this._children=[],this._isPlaying=!1,this.frameHandle=null,this.lastElapsedTime=null,this.systemsByClass=new Map,this._tick=function(e){e*=1;var t=this.lastElapsedTime;if(null!==t){var n=e-t;this.isPlaying&&(this.update(n),this.draw(e))}this.lastElapsedTime=e,this.frameHandle=window.requestAnimationFrame(this._tick)}.bind(this),this.canvas=document.createElement("canvas"),this.canvas.width=t*s,this.canvas.height=n*s,this.canvas.style.width="".concat(t,"px"),this.canvas.style.height="".concat(n,"px");var o=this.canvas.getContext("2d");a.assert(o,"ctx"),this.ctx=o,this._scaleFactor=1*s,this._setupVisiblityChange()}return r.createClass(e,[{key:"width",get:function(){return this.canvas.width/this._scaleFactor}},{key:"height",get:function(){return this.canvas.height/this._scaleFactor}},{key:"scaleFactor",get:function(){return this._scaleFactor}},{key:"isPlaying",get:function(){return null!==this.frameHandle&&this._isPlaying},set:function(e){a.assert(null!==this.frameHandle,"cannot set isPlaying without calling start"),this._isPlaying=e}},{key:"children",get:function(){return this._children}},{key:"appendTo",value:function(e){e.appendChild(this.canvas)}},{key:"hasSystem",value:function(e){return this.systemsByClass.has(e)}},{key:"getSystem",value:function(e){var t=this.systemsByClass.get(e);return a.assert(t,"system, ".concat(e.systemName," not found")),a.assert(t instanceof e,"system is wrong instance type"),t}},{key:"addSystem",value:function(e){a.assert(!this.hasSystem(e.constructor),"only one system of each type allowed"),this.systemsByClass.set(e.constructor,e),e.afterAddToScene(this)}},{key:"removeSystem",value:function(e){this.getSystem(e).beforeRemoveFromScene(this),this.systemsByClass.delete(e)}},{key:"addChild",value:function(e){this._children.push(e),e.onAddedToScene(this)}},{key:"addChildBefore",value:function(e,t){var n=this._children.indexOf(e);a.assert(-1!==n,"target child must be present"),this.addChildAtIndex(n,t)}},{key:"addChildAfter",value:function(e,t){var n=this._children.indexOf(e);a.assert(-1!==n,"target child must be present"),this.addChildAtIndex(n+1,t)}},{key:"addChildAtIndex",value:function(e,t){this._children.splice(e,0,t),t.onAddedToScene(this)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return-1!==t&&(this.removeChildAtIndex(t),!0)}},{key:"removeChildAtIndex",value:function(e){var t=this._children[e];return this._children.splice(e,1),t.onRemovedFromScene(),t}},{key:"update",value:function(e){for(var t=0;t<1;t++){var n=!0,r=!1,i=void 0;try{for(var a,s=this.systemsByClass.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){a.value.beforeUpdate(e)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}this._children.forEach((function(t){return t.update(e)}));var o=!0,l=!1,c=void 0;try{for(var u,h=this.systemsByClass.values()[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){u.value.afterUpdate(e)}}catch(e){l=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}}}},{key:"draw",value:function(e){this.ctx.save(),this.ctx.scale(this._scaleFactor,this._scaleFactor),this.ctx.clearRect(0,0,this.width,this.height);var t=!0,n=!1,r=void 0;try{for(var i,a=this.systemsByClass.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.beforeDraw(this.ctx,e)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this._children.sort((function(e,t){return e.getSortOrder()-t.getSortOrder()})).forEach(function(t){return t.draw(this.ctx,e)}.bind(this));var s=!0,o=!1,l=void 0;try{for(var c,u=this.systemsByClass.values()[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){c.value.afterDraw(this.ctx,e)}}catch(e){o=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(o)throw l}}this.ctx.restore()}},{key:"start",value:function(){this._isPlaying=!0,this.frameHandle=window.requestAnimationFrame(this._tick)}},{key:"stop",value:function(){null!==this.frameHandle&&(window.cancelAnimationFrame(this.frameHandle),this.frameHandle=null),this._isPlaying=!1,this.lastElapsedTime=null}},{key:"_setupVisiblityChange",value:function(){var e=!1;document.addEventListener("visibilitychange",function(){document.hidden&&this.isPlaying&&(e=!0,this.stop()),e&&!document.hidden&&(e=!1,this.start())}.bind(this))}}]),e}()})),i.register("diH60",(function(t,n){function r(e){throw new Error(e)}function i(e,t){e||r(t||"Assertion Error")}e(t.exports,"assert",(function(){return i})),e(t.exports,"fail",(function(){return r}))})),i.register("ej7qu",(function(t,n){e(t.exports,"default",(function(){return l}));var r=i("eUMMJ"),a=i("bApi3"),s=i("diH60"),o=i("8JKq7"),l=function(e){"use strict";function t(){var e;return r.classCallCheck(this,t),(e=r.possibleConstructorReturn(this,r.getPrototypeOf(t).apply(this,arguments))).componentInstances=new Map,e}return r.inherits(t,e),r.createClass(t,[{key:"addComponent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];s.assert(!this.componentInstances.has(e),"component instance ".concat(e.name," already exists"));var a=r.construct(e,[this].concat(r.toConsumableArray(n)));return this.componentInstances.set(e,a),a}},{key:"hasComponent",value:function(e){return this.componentInstances.has(e)}},{key:"getComponent",value:function(e){var t=this.componentInstances.get(e);return s.assert(t,"no instance for ".concat(e.name," exists")),s.assert(t instanceof e,"wrong instance type"),t}},{key:"removeComponent",value:function(e){var t=this.getComponent(e);return this.componentInstances.delete(e),t.onRemove(),t}},{key:"draw",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=this.componentInstances.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){a.value.beforeDraw(e,t)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var o=!0,l=!1,c=void 0;try{for(var u,h=this.componentInstances.values()[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){u.value.draw(e,t)}}catch(e){l=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}var d=!0,f=!1,y=void 0;try{for(var v,m=this.componentInstances.values()[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){v.value.afterDraw(e,t)}}catch(e){f=!0,y=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw y}}}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.componentInstances.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.beforeUpdate(e)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var s=!0,o=!1,l=void 0;try{for(var c,u=this.componentInstances.values()[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){c.value.update(e)}}catch(e){o=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(o)throw l}}var h=!0,d=!1,f=void 0;try{for(var y,v=this.componentInstances.values()[Symbol.iterator]();!(h=(y=v.next()).done);h=!0){y.value.afterUpdate(e)}}catch(e){d=!0,f=e}finally{try{h||null==v.return||v.return()}finally{if(d)throw f}}}},{key:"onAddedToScene",value:function(e){r.get(r.getPrototypeOf(t.prototype),"onAddedToScene",this).call(this,e);var n=!0,i=!1,a=void 0;try{for(var s,o=this.componentInstances.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){s.value.onAddedToScene(e)}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"onRemovedFromScene",value:function(){var e=this.getScene();r.get(r.getPrototypeOf(t.prototype),"onRemovedFromScene",this).call(this);var n=!0,i=!1,a=void 0;try{for(var s,o=this.componentInstances.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){s.value.onRemovedFromScene(e)}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"getSortOrder",value:function(){return this.hasComponent(o.default)?this.getComponent(o.default).getSortOrder():r.get(r.getPrototypeOf(t.prototype),"getSortOrder",this).call(this)}}]),t}(a.default)})),i.register("bApi3",(function(t,n){e(t.exports,"default",(function(){return o}));var r=i("eUMMJ"),a=i("diH60"),s={},o=function(){"use strict";function e(){var t;r.classCallCheck(this,e),this.id=(t=this.constructor.name,s[t]||(s[t]=0),"".concat(t,"@").concat(s[t]++)),this.scene=null}return r.createClass(e,[{key:"hasScene",value:function(){return null!==this.scene}},{key:"getScene",value:function(){return a.assert(this.scene,"scene must be present"),this.scene}},{key:"draw",value:function(e,t){}},{key:"update",value:function(e){}},{key:"addTo",value:function(e){return e.addChild(this),this}},{key:"onAddedToScene",value:function(e){this.scene=e}},{key:"onRemovedFromScene",value:function(){this.scene=null}},{key:"getSortOrder",value:function(){return 0}}]),e}()})),i.register("8JKq7",(function(t,n){e(t.exports,"default",(function(){return a}));var r=i("eUMMJ"),a=function(e){"use strict";function t(e,n){var i;return r.classCallCheck(this,t),(i=r.possibleConstructorReturn(this,r.getPrototypeOf(t).call(this,e))).getSortOrderFn=n,i}return r.inherits(t,e),r.createClass(t,[{key:"getSortOrder",value:function(){return this.getSortOrderFn(this.entity)}}]),t}(i("eCbAo").default)})),i.register("eCbAo",(function(t,n){e(t.exports,"default",(function(){return a}));var r=i("eUMMJ"),a=function(){"use strict";function e(t){r.classCallCheck(this,e),this.entity=t}return r.createClass(e,[{key:"onRemove",value:function(){}},{key:"onAddedToScene",value:function(e){}},{key:"onRemovedFromScene",value:function(e){}},{key:"beforeUpdate",value:function(e){}},{key:"update",value:function(e){}},{key:"afterUpdate",value:function(e){}},{key:"beforeDraw",value:function(e,t){}},{key:"draw",value:function(e,t){}},{key:"afterDraw",value:function(e,t){}},{key:"getScene",value:function(){return this.entity.getScene()}}]),e}()}))}();
//# sourceMappingURL=index.a90f15d5.js.map
