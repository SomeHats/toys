import{f as v,a as p}from"./chunk_assert.pxkjFBOg.js";import{y as g,z as w,k as z,O as x,R as S,h as $,e as R,n as T,d as E,m as j,E as A}from"./chunk_utils.BtQBvwlT.js";const o={ok:u=>new U(u),error:u=>new P(u),collect:u=>{const r=[];for(const t of u)if(t.ok)r.push(t.value);else return t;return o.ok(r)},collectObject:u=>{const r={};for(const[t,e]of g(u))if(e.ok)r[t]=e.value;else return e;return o.ok(r)},fromFn:u=>{try{return o.ok(u())}catch(r){return o.error(r)}},fromPromise:u=>u.then(o.ok).catch(o.error),fromAsyncFn:async u=>{try{return o.ok(await u())}catch(r){return o.error(r)}}};class O{constructor(){}}class U extends O{constructor(r){super(),this.value=r,this.ok=!0}unwrap(){return this.value}unwrapError(r){v(`${r??"expected error"}: ${String(this.value)}`)}map(r){return o.ok(r(this.value))}mapErr(r){return this}andThen(r){return r(this.value)}}class P extends O{constructor(r){super(),this.error=r,this.ok=!1}unwrap(r){if(this.error instanceof Error)throw this.error;v(`${r??"expected value"}: ${String(this.error)}`)}unwrapError(r){return this.error}map(r){return this}mapErr(r){return o.error(r(this.error))}andThen(r){return this}}class l{constructor(r,t=[]){this.message=r,this.path=t}formatPath(){if(!this.path.length)return null;let r="";for(const t of this.path)typeof t=="number"?r+=`.${t}`:t.startsWith("(")?r.endsWith(")")?r=`${r.slice(0,-1)}, ${t.slice(1)}`:r+=t:r+=`.${t}`;return r}toString(){const r=this.formatPath(),t=this.message.split(`
`).map((e,n)=>n===0?e:`  ${e}`).join(`
`);return r?`At ${r}: ${t}`:t}}function m(u,...r){return new l(u.message,[...r,...u.path])}function f(u){if(u===null)return"null";if(Array.isArray(u))return"an array";const r=typeof u;switch(r){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${r}`;case"object":return`an ${r}`;case"undefined":return"undefined";default:R(r)}}const h=class h{constructor(r,t,e){this.parse=r,this._validate=t,this.serialize=e}validate(r){const t=this._validate(r);return t.ok&&p(Object.is(t.value,r),"Assertion Error: Object.is(result.value, input)"),t}transform(r,t,e){return new h(n=>this.parse(n).andThen(r),n=>this.validate(n).andThen(t),n=>this.serialize(e(n)))}instance(r,t,e){return this.transform(t,n=>n instanceof r?o.ok(n):o.error(new l(`Expected instance of ${r.name}, got ${f(n)}`)),e)}nullable(){return new h(r=>r==null?o.ok(null):this.parse(r),r=>r===null?o.ok(null):this.validate(r),r=>r===null?null:this.serialize(r))}optional(){return new h(r=>r==null?o.ok(void 0):this.parse(r),r=>r===void 0?o.ok(void 0):this.validate(r),r=>{if(r!=null)return this.serialize(r)})}parseUnwrap(r){return this.parse(r).unwrap()}validateUnwrap(r){return this.validate(r).unwrap()}asValidator(){return{validate:r=>this.validateUnwrap(r)}}static typeof(r){const t=e=>typeof e===r?o.ok(e):o.error(new l(`Expected ${r}, got ${f(e)}`,[]));return new h(t,t,w)}static value(r){return new q(r)}static valueUnion(...r){const t=e=>r.includes(e)?o.ok(e):o.error(new l(`Expected one of ${r.join(" or ")}, got ${f(e)}`));return new h(t,t,w)}static arrayOf(r){return new h(t=>Array.isArray(t)?o.collect(t.map((e,n)=>r.parse(e).mapErr(s=>m(s,n)))):o.error(new l(`Expected an array, got ${f(t)}`,[])),t=>{if(!Array.isArray(t))return o.error(new l(`Expected an array, got ${f(t)}`,[]));for(let e=0;e<t.length;e++){const n=t[e],s=r.validate(n);if(!s.ok)return s.mapErr(i=>m(i,e))}return o.ok(t)},t=>t.map(e=>r.serialize(e)))}static object(r){return new J(r)}static objectMap(r,t){return new h(e=>typeof e!="object"||e===null?o.error(new l(`Expected object, got ${f(e)}`,[])):o.collect(z(e).map(n=>r.parse(n).andThen(s=>t.parse(x(e,s)).map(i=>[s,i])).mapErr(s=>m(s,n)))).map(n=>Object.fromEntries(n)),e=>{if(typeof e!="object"||e===null)return o.error(new l(`Expected object, got ${f(e)}`,[]));for(const[n,s]of g(e)){const i=r.validate(n);if(!i.ok)return i.mapErr(d=>m(d,n));const c=t.validate(s);if(!c.ok)return c.mapErr(d=>m(d,n))}return o.ok(e)},e=>{const n={};for(const[s,i]of g(e)){if(i===void 0)continue;const c=r.serialize(s);p(typeof c=="string"||typeof c=="number",'Assertion Error: typeof serializedKey === "string" || typeof serializedKey === "number"'),n[c]=t.serialize(i)}return n})}static enum(r){const t=new Set(Array.isArray(r)?r:S(r)),e=n=>{if(t.has(n))return o.ok(n);{const s=typeof n=="string"?`"${n}"`:typeof n=="boolean"||typeof n=="number"?String(n):f(n),i=Array.from(t,c=>typeof c=="string"?`"${c}"`:String(c)).join(" or ");return o.error(new l(`Expected ${i}, got ${s}`))}};return new h(e,e,w)}static union(r,t){return new C(r,t)}static indexedUnion(r,t){return new F(r,t)}static cannotValidate(r){return t=>{v(`Cannot validate ${r}, only parse/serialize available.`)}}};h.unknown=new h(r=>o.ok(r),r=>o.ok(r),w),h.never=new h(()=>o.error(new l("Cannot parse never schema")),()=>o.error(new l("Cannot validate never schema")),()=>{v("Cannot serialize never schema")}),h.string=h.typeof("string"),h.number=h.typeof("number"),h.bigint=h.typeof("bigint"),h.boolean=h.typeof("boolean"),h.null=new h(r=>r==null?o.ok(null):o.error(new l(`Expected null or undefined, got ${f(r)}`)),r=>r===null?o.ok(null):o.error(new l(`Expected null, got ${f(r)}`)),()=>null);let y=h;class q extends y{constructor(r){const t=e=>e===r?o.ok(r):o.error(new l(`Expected ${typeof r=="string"?`"${r}"`:String(r)}, got ${f(e)}`));super(t,t,w),this.value=r}}class J extends y{constructor(r){super(t=>typeof t!="object"||t===null?o.error(new l(`Expected object, got ${f(t)}`,[])):o.collect(g(this.config).map(([e,n])=>n.parse(x(t,e)).map(s=>[e,s]).mapErr(s=>m(s,e)))).map(e=>Object.fromEntries(e)),t=>{if(typeof t!="object"||t===null)return o.error(new l(`Expected object, got ${f(t)}`,[]));const e=new Set(z(t));for(const[n,s]of g(this.config)){e.delete(n);const i=x(t,n),c=s.validate(i);if(!c.ok)return c.mapErr(d=>m(d,n))}return e.size?o.error(new l(`Unknown properties: ${Array.from(e).map(n=>JSON.stringify(n)).join(", ")}`)):o.ok(t)},t=>{const e={};for(const[n,s]of g(this.config))e[n]=s.serialize(x(t,n));return e}),this.config=r}indexed(r){return new N(this,r)}}class N extends y{constructor(r,t){const e=[];for(const[n,s]of g(t))p(e[s]===void 0,`Duplicate index ${s} for keys "${n}" & "${e[s]}"`),e[s]=n;for(let n=0;n<e.length;n++)e[n]??(e[n]=void 0);super(n=>typeof n!="object"||n===null?o.error(new l(`Expected an object or an array, got ${f(n)}`)):Array.isArray(n)?o.collect(g(r.config).map(([s,i])=>{const c=t[s];return i.parse(n[c]).map(d=>[s,d]).mapErr(d=>m(d,s,`(${c})`))})).map(s=>Object.fromEntries(s)):this.objectSchema.parse(n),n=>this.objectSchema.validate(n),n=>{const s=r.serialize(n);return p(typeof s=="object"&&s!==null,'Assertion Error: typeof serialized === "object" && serialized !== null'),this.keyByIndex.map(i=>i===void 0?null:x(s,i))}),this.objectSchema=r,this.indexByKey=t,this.keyByIndex=e}}class C extends y{constructor(r,t){const e=n=>{if(typeof n!="object"||n===null)return o.error(new l(`Expected an object, got ${f(n)}`,[]));const s=x(n,r);if(typeof s!="string")return o.error(new l(`Expected a string for key "${r}", got ${f(s)}`,[]));const i=$(t,s)?t[s]:void 0;return i===void 0?o.error(new l(`Expected one of ${Object.keys(this.config).map(c=>JSON.stringify(c)).join(" or ")}, got ${f(s)}`,[r])):o.ok({schema:i,variant:s})};super(n=>{const s=e(n);if(!s.ok)return s;const{schema:i,variant:c}=s.value;return i.parse(n).mapErr(d=>m(d,`(${r} = ${c})`))},n=>{const s=e(n);if(!s.ok)return s;const{schema:i,variant:c}=s.value;return i.validate(n).mapErr(d=>m(d,`(${r} = ${c})`))},n=>{const s=n[r],i=$(t,s)?this.config[s]:null;return p(i,`schema type ${String(s)} must exist`),i.serialize(n)}),this.key=r,this.config=t}}class F extends y{constructor(r,t){for(const[e,n]of g(t))p(n.keyByIndex[0]===r,`Variant ${e} must have ${r} at index 0`);super(e=>{if(typeof e!="object"||e===null)return o.error(new l(`Expected an object or an array, got ${f(e)}`,[]));const n=Array.isArray(e);let s=Array.isArray(e)?e[0]:x(e,r);if(typeof s=="number"&&(s=String(s)),typeof s!="string")return o.error(new l(`Expected a string, got ${f(s)}`,[n?0:r]));const i=$(t,s)?t[s]:void 0;return i===void 0?o.error(new l(`Expected one of ${Object.keys(this.config).map(c=>JSON.stringify(c)).join(" or ")}, got ${f(s)}`,[n?0:r])):i.parse(e).mapErr(c=>m(c,`(${r} = ${String(s)})`))},e=>{if(typeof e!="object"||e===null)return o.error(new l(`Expected an object, got ${f(e)}`,[]));const n=x(e,r);if(typeof n!="string")return o.error(new l(`Expected a string for key "${r}", got ${f(n)}`,[]));const s=$(t,n)?t[n]:void 0;return s===void 0?o.error(new l(`Expected one of ${Object.keys(this.config).map(i=>JSON.stringify(i)).join(" or ")}, got ${f(n)}`,[r])):s.validate(e).mapErr(i=>m(i,`(${r} = ${String(n)})`))},e=>{const n=e[r],s=$(t,n)?this.config[n]:null;return p(s,"Assertion Error: schema"),s.serialize(e)}),this.key=r,this.config=t}}const a=class a{constructor(r,t){this.x=r,this.y=t}static fromArgs(r){if(r.length===1)return a.from(r[0]);{const[t,e]=r;return new a(t,e)}}static fromPolar(r,t){return new a(t*Math.cos(r),t*Math.sin(r))}static average(r){return r.reduce((e,n)=>e.add(n),a.ZERO).div(r.length)}static from(r){return r instanceof a?r:Array.isArray(r)?new a(r[0],r[1]):(p("x"in r&&"y"in r,'Assertion Error: "x" in vectorIsh && "y" in vectorIsh'),new a(r.x,r.y))}static fromEvent({clientX:r,clientY:t}){return new a(r,t)}toString(r){const t=r==null?this.x:this.x.toFixed(r),e=r==null?this.y:this.y.toFixed(r);return`Vector2(${t}, ${e})`}toJson(){return{x:this.x,y:this.y}}magnitudeSquared(){return this.x*this.x+this.y*this.y}magnitude(){return Math.sqrt(this.magnitudeSquared())}angle(){return Math.atan2(this.y,this.x)}isInPolygon(r){const{x:t,y:e}=this;let n=!1;for(let s=0,i=r.length-1;s<r.length;i=s++){const{x:c,y:d}=r[s],{x:M,y:b}=r[i];d>e!=b>e&&t<(M-c)*(e-d)/(b-d)+c&&(n=!n)}return n}equals(...r){const t=a.fromArgs(r);return this===t||this.x===t.x&&this.y===t.y}distanceTo(...r){const t=a.fromArgs(r);return Math.hypot(this.x-t.x,this.y-t.y)}distanceToSquared(...r){const t=a.fromArgs(r),e=this.x-t.x,n=this.y-t.y;return e*e+n*n}angleTo(...r){return a.fromArgs(r).sub(this).angle()}angleBetween(...r){const t=a.fromArgs(r);return T(Math.atan2(t.y,t.x)-Math.atan2(this.y,this.x))}dot(...r){const t=a.fromArgs(r);return this.x*t.x+this.y*t.y}div(r){return new a(this.x/r,this.y/r)}scale(r){return new a(this.x*r,this.y*r)}mul(...r){const t=a.fromArgs(r);return new a(this.x*t.x,this.y*t.y)}negate(){return this.scale(-1)}add(...r){const t=a.fromArgs(r);return new a(this.x+t.x,this.y+t.y)}sub(...r){const t=a.fromArgs(r);return new a(this.x-t.x,this.y-t.y)}floor(){return new a(Math.floor(this.x),Math.floor(this.y))}ceil(){return new a(Math.ceil(this.x),Math.ceil(this.y))}round(){return new a(Math.round(this.x),Math.round(this.y))}withMagnitude(r){return this.scale(r/this.magnitude())}normalize(){return this.withMagnitude(1)}withAngle(r){return a.fromPolar(r,this.magnitude())}rotate(r){return this.withAngle(this.angle()+r)}rotateAround(r,t){r=a.from(r);const e=Math.sin(t),n=Math.cos(t),s=this.x-r.x,i=this.y-r.y,c=s*n-i*e,d=s*e+i*n;return new a(c+r.x,d+r.y)}lerp(r,t){return r=a.from(r),new a(E(this.x,r.x,t),E(this.y,r.y,t))}moveToward(r,t){const e=a.from(r).sub(this).normalize();return this.add(e.scale(t))}perpendicular(){return new a(this.y,-this.x)}project(r,t){return a.from(r).scale(t).add(this)}mapRange(r,t){return new a(j(r.left,r.right,t.left,t.right,this.x),j(r.top,r.bottom,t.top,t.bottom,this.y))}clamp(r){return new a(A(r.left,r.right,this.x),A(r.top,r.bottom,this.y))}};a.schema=y.object({x:y.number,y:y.number}).indexed({x:0,y:1}).instance(a,({x:r,y:t})=>o.ok(new a(r,t)),({x:r,y:t})=>({x:r,y:t})),a.ZERO=new a(0,0),a.UNIT=new a(1,1),a.X=new a(1,0),a.Y=new a(0,1);let k=a;export{o as R,y as S,k as V,l as a};
