{"mappings":"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","sources":["src/lib/KeyCode.tsx","src/lib/ButtonMapping.tsx","src/lib/scene/SceneSystem.ts","src/platformer/platformer-main.tsx"],"sourcesContent":["export enum KeyCode {\n  THAT_KEY_HAS_NO_KEYCODE = 0,\n  BREAK = 3,\n  BACKSPACE_DELETE = 8,\n  TAB = 9,\n  CLEAR = 12,\n  ENTER = 13,\n  SHIFT = 16,\n  CTRL = 17,\n  ALT = 18,\n  PAUSE_BREAK = 19,\n  CAPS_LOCK = 20,\n  ESCAPE = 27,\n  SPACE = 32,\n  PAGE_UP = 33,\n  PAGE_DOWN = 34,\n  END = 35,\n  HOME = 36,\n  LEFT_ARROW = 37,\n  UP_ARROW = 38,\n  RIGHT_ARROW = 39,\n  DOWN_ARROW = 40,\n  SELECT = 41,\n  PRINT = 42,\n  EXECUTE = 43,\n  PRINT_SCREEN = 44,\n  INSERT = 45,\n  DELETE = 46,\n  HELP = 47,\n  DIGIT_0 = 48,\n  DIGIT_1 = 49,\n  DIGIT_2 = 50,\n  DIGIT_3 = 51,\n  DIGIT_4 = 52,\n  DIGIT_5 = 53,\n  DIGIT_6 = 54,\n  DIGIT_7 = 55,\n  DIGIT_8 = 56,\n  DIGIT_9 = 57,\n  COLON = 58,\n  LESS_THAN = 60,\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n  NUMPAD_0 = 96,\n  NUMPAD_1 = 97,\n  NUMPAD_2 = 98,\n  NUMPAD_3 = 99,\n  NUMPAD_4 = 100,\n  NUMPAD_5 = 101,\n  NUMPAD_6 = 102,\n  NUMPAD_7 = 103,\n  NUMPAD_8 = 104,\n  NUMPAD_9 = 105,\n  NUMPAD_MULTIPLY = 106,\n  NUMPAD_ADD = 107,\n  NUMPAD_PERIOD = 108,\n  NUMPAD_SUBTRACT = 109,\n  F1 = 112,\n  F2 = 113,\n  F3 = 114,\n  F4 = 115,\n  F5 = 116,\n  F6 = 117,\n  F7 = 118,\n  F8 = 119,\n  F9 = 120,\n  F10 = 121,\n  F11 = 122,\n  F12 = 123,\n  F13 = 124,\n  F14 = 125,\n  F15 = 126,\n  F16 = 127,\n  F17 = 128,\n  F18 = 129,\n  F19 = 130,\n  F20 = 131,\n  F21 = 132,\n  F22 = 133,\n  F23 = 134,\n  F24 = 135,\n  F25 = 136,\n  F26 = 137,\n  F27 = 138,\n  F28 = 139,\n  F29 = 140,\n  F30 = 141,\n  F31 = 142,\n  F32 = 143,\n  NUM_LOCK = 144,\n  SCROLL_LOCK = 145,\n  AIRPLANE_MODE = 151,\n  PAGE_BACKWARD = 166,\n  PAGE_FORWARD = 167,\n  HOME_KEY = 172,\n  SEMI_COLON = 186,\n  EQUAL_SIGN = 187,\n  COMMA = 188,\n  DASH = 189,\n  PERIOD = 190,\n  FORWARD_SLASH = 191,\n  GRAVE_ACCENT = 192,\n  OPEN_BRACKET = 219,\n  BACK_SLASH = 220,\n  CLOSE_BRACKET = 221,\n  SINGLE_QUOTE = 222,\n}\n","import { Key } from 'readline';\nimport { AnimationActionLoopStyles } from 'three';\nimport { assert } from './assert';\nimport EventEmitter, { Unsubscribe } from './EventEmitter';\nimport { KeyCode } from './KeyCode';\nimport { entries } from './utils';\n\ntype ActionInfo = {\n  downEvent: EventEmitter<void>;\n  upEvent: EventEmitter<void>;\n  isDown: boolean;\n};\n\nexport class ButtonMapping<Actions extends string> {\n  private readonly keyCodeToAction: ReadonlyMap<KeyCode, Actions>;\n  private readonly actionInfo: ReadonlyMap<Actions, ActionInfo>;\n\n  constructor(actionMappings: Record<Actions, Array<KeyCode>>) {\n    const keyCodeToAction = new Map<KeyCode, Actions>();\n    const actionInfo = new Map<Actions, ActionInfo>();\n\n    for (const [action, keyCodes] of entries(actionMappings)) {\n      for (const keyCode of keyCodes) {\n        keyCodeToAction.set(keyCode, action);\n      }\n      actionInfo.set(action, {\n        downEvent: new EventEmitter(),\n        upEvent: new EventEmitter(),\n        isDown: false,\n      });\n    }\n\n    this.keyCodeToAction = keyCodeToAction;\n    this.actionInfo = actionInfo;\n\n    document.addEventListener('keydown', (event) => {\n      const actionInfo = this.getActionInfoForKeyCodeIfExists(event.keyCode);\n      if (!actionInfo) {\n        return;\n      }\n\n      actionInfo.isDown = true;\n      actionInfo.downEvent.emit();\n    });\n    document.addEventListener('keyup', (event) => {\n      const actionInfo = this.getActionInfoForKeyCodeIfExists(event.keyCode);\n      if (!actionInfo) {\n        return;\n      }\n\n      actionInfo.isDown = false;\n      actionInfo.upEvent.emit();\n    });\n  }\n\n  isDown(action: Actions): boolean {\n    return this.getActionInfo(action).isDown;\n  }\n\n  onDown(action: Actions, cb: () => void): Unsubscribe {\n    return this.getActionInfo(action).downEvent.listen(cb);\n  }\n\n  onUp(action: Actions, cb: () => void): Unsubscribe {\n    return this.getActionInfo(action).upEvent.listen(cb);\n  }\n\n  private getActionInfoForKeyCodeIfExists(keyCode: number): ActionInfo | null {\n    const action = this.keyCodeToAction.get(keyCode);\n    if (!action) {\n      return null;\n    }\n    return this.getActionInfo(action);\n  }\n\n  private getActionInfo(action: Actions): ActionInfo {\n    const actionInfo = this.actionInfo.get(action);\n    assert(actionInfo);\n    return actionInfo;\n  }\n}\n","// @flow\nimport { assert } from '../assert';\nimport Scene from './Scene';\n\nconst DEFAULT_NAME = '$$AbstractSceneSystem$$';\n\nexport default abstract class SceneSystem {\n  static systemName = DEFAULT_NAME;\n  private scene: Scene | null = null;\n\n  constructor() {\n    assert(\n      this.constructor !== SceneSystem,\n      'SceneSystem is an abstract class that must be extended',\n    );\n    assert(\n      (this.constructor as any).systemName !== DEFAULT_NAME,\n      'classes extending SceneSystem must override SceneSystem.systemName',\n    );\n  }\n\n  getScene(): Scene {\n    assert(this.scene, 'scene is required');\n    return this.scene;\n  }\n\n  afterAddToScene(scene: Scene) {\n    this.scene = scene;\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  beforeRemoveFromScene(scene: Scene) {\n    this.scene = null;\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  beforeUpdate(delta: number) {}\n\n  // eslint-disable-next-line no-unused-vars\n  afterUpdate(delta: number) {}\n\n  // eslint-disable-next-line no-unused-vars\n  beforeDraw(ctx: CanvasRenderingContext2D, time: number) {}\n\n  // eslint-disable-next-line no-unused-vars\n  afterDraw(ctx: CanvasRenderingContext2D, time: number) {}\n}\n","import { ButtonMapping } from '../lib/ButtonMapping';\nimport { DebugDraw, StrokeAndFillOptions } from '../lib/DebugDraw';\nimport AABB from '../lib/geom/AABB';\nimport Vector2 from '../lib/geom/Vector2';\nimport { KeyCode } from '../lib/KeyCode';\nimport Component from '../lib/scene/Component';\nimport Entity from '../lib/scene/Entity';\nimport Scene from '../lib/scene/Scene';\nimport SceneSystem from '../lib/scene/SceneSystem';\n\nclass DebugDrawSystem extends SceneSystem {\n  static systemName = 'DebugDragSystem';\n\n  debugDraw!: DebugDraw;\n\n  afterAddToScene(scene: Scene) {\n    super.afterAddToScene(scene);\n    this.debugDraw = new DebugDraw(scene.ctx);\n  }\n}\n\nclass AABBDrawSystem extends SceneSystem {\n  static systemName = 'AABBDebugDrawSystem';\n\n  debugDraw!: DebugDraw;\n\n  afterAddToScene(scene: Scene) {\n    super.afterAddToScene(scene);\n    this.debugDraw = new DebugDraw(scene.ctx);\n  }\n\n  afterDraw() {}\n}\n\nclass AABBComponent extends Component {\n  public value: AABB;\n\n  constructor(entity: Entity, value: AABB) {\n    super(entity);\n    this.value = value;\n  }\n\n  setOrigin(origin: Vector2) {\n    this.value = new AABB(origin, this.value.size);\n  }\n\n  beforeDraw(ctx: CanvasRenderingContext2D, time: number) {\n    ctx.save();\n    ctx.translate(this.value.left, this.value.top);\n  }\n  afterDraw(ctx: CanvasRenderingContext2D, time: number) {\n    ctx.restore();\n  }\n}\n\nclass AABBRenderer extends Component {\n  constructor(entity: Entity, public opts: StrokeAndFillOptions) {\n    super(entity);\n  }\n\n  getAABB(): AABB {\n    return this.entity.getComponent(AABBComponent).value;\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    this.getScene()\n      .getSystem(DebugDrawSystem)\n      .debugDraw.aabb(new AABB(Vector2.ZERO, this.getAABB().size), this.opts);\n  }\n}\n\nclass PlayerController extends Component {\n  constructor(\n    entity: Entity,\n    public readonly moveSpeed: number,\n    public readonly controls: ButtonMapping<'left' | 'right' | 'jump' | 'down'>,\n  ) {\n    super(entity);\n  }\n\n  update(delta: number) {\n    const aabbComponent = this.entity.getComponent(AABBComponent);\n    let origin = aabbComponent.value.origin;\n    if (this.controls.isDown('left')) {\n      origin = origin.sub(new Vector2(this.moveSpeed * delta, 0));\n    }\n    if (this.controls.isDown('right')) {\n      origin = origin.add(new Vector2(this.moveSpeed * delta, 0));\n    }\n\n    if (this.controls.isDown('jump')) {\n      origin = origin.sub(new Vector2(0, this.moveSpeed * delta));\n    }\n    if (this.controls.isDown('down')) {\n      origin = origin.add(new Vector2(0, this.moveSpeed * delta));\n    }\n    aabbComponent.setOrigin(origin);\n  }\n}\n\nconst scene = new Scene(800, 600, window.devicePixelRatio);\nscene.addSystem(new DebugDrawSystem());\n\nconst player = new Entity();\nplayer.addComponent(\n  AABBComponent,\n  new AABB(new Vector2(200, 200), new Vector2(20, 30)),\n);\nplayer.addComponent(AABBRenderer, {\n  fill: 'lime',\n  stroke: 'black',\n  strokeWidth: 1,\n});\nplayer.addComponent(\n  PlayerController,\n  0.4,\n  new ButtonMapping({\n    left: [KeyCode.A, KeyCode.LEFT_ARROW],\n    right: [KeyCode.D, KeyCode.RIGHT_ARROW],\n    jump: [KeyCode.W, KeyCode.UP_ARROW, KeyCode.SPACE],\n    down: [KeyCode.S],\n  }),\n);\nscene.addChild(player);\n\nscene.appendTo(document.getElementById('root')!);\nscene.start();\n\nconsole.log(scene);\n"],"names":["KeyCode","$441398e76e87eecb$export$9b6ec47c4d160fc9","actionMappings","keyCodeToAction","Map","actionInfo1","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","$8qLe2","entries","Symbol","iterator","next","done","_value","$8TSCy","slicedToArray","value","action","keyCodes","_iteratorNormalCompletion1","_didIteratorError1","_iteratorError1","_step1","_iterator1","keyCode","set","err","return","downEvent","$9gByv","default","upEvent","isDown","this","actionInfo","document","addEventListener","event","_this","getActionInfoForKeyCodeIfExists","emit","_this1","key","getActionInfo","cb","listen","get","$8OvEy","assert","$908942f9f93959de$export$e9e0d96f49f57c33","$e9fa0217768ee50a$var$DEFAULT_NAME","$e9fa0217768ee50a$export$2e2bcd8739ae039","scene","constructor","systemName","delta","ctx","time","$0073f50a4ed22d3e$var$DebugDrawSystem","SceneSystem","apply","arguments","prototype","call","debugDraw","$aCcLp","DebugDraw","$0073f50a4ed22d3e$var$AABBDrawSystem","$0073f50a4ed22d3e$var$AABBComponent","Component","entity","origin","$71uov","size","save","translate","left","top","restore","$3Nswo","$0073f50a4ed22d3e$var$AABBRenderer","opts","getComponent","getScene","getSystem","aabb","$39Hjj","ZERO","getAABB","$0073f50a4ed22d3e$var$PlayerController","moveSpeed","controls","aabbComponent","sub","add","setOrigin","$0073f50a4ed22d3e$var$scene","$dLeLC","window","devicePixelRatio","addSystem","$0073f50a4ed22d3e$var$player","$bADSp","addComponent","fill","stroke","strokeWidth","A","LEFT_ARROW","right","D","RIGHT_ARROW","jump","W","UP_ARROW","SPACE","down","S","addChild","appendTo","getElementById","start","console","log"],"version":3,"file":"index.971cd3af.js.map"}