var En=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var F=(t,e,n)=>(En(t,e,"read from private field"),n?n.call(t):e.get(t)),ge=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},we=(t,e,n,r)=>(En(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);import{t as be,s as jr,O as Qt,k as Kr,h as Sn,g as Kn,a as M,P as Ie,b as Z,l as Wn,f as Ye,Q as In,o as en,R as _e,F as Wr,H as Gn,E as Ft,c as U,y as qn,m as Gr,e as qr,S as Yr,T as Jr}from"./chunk_assert.b5856491.js";/* empty css                       */import{a as Zr,r as d,R as T,b as rt}from"./chunk_index.2e60a4fd.js";import{e as Rt,u as Xr,a as Yn,b as Qr,f as Vt,d as Ue,g as $e,m as ei,s as ti,c as ni}from"./chunk_theme.64eb2fee.js";import{b as ri,R as Xe,P as ii,d as oi,c as ve,e as si,a as ai,f as It,V as L,g as li,h as ui,p as ci,i as di}from"./chunk_Vector2.70a1782d.js";import{A as yi}from"./chunk_AABB.9bb52956.js";import{E as Cn}from"./chunk_EventEmitter.a49c476b.js";import{a as _,c as j,j as p,F as X}from"./chunk_jsx-runtime.d8530191.js";import"./chunk__commonjsHelpers.e5e952e9.js";const tn=300,xi=30,pi=500,Je={size:16,streamline:.5,smoothing:.5,thinning:.5,simulatePressure:!0,easing:t=>t,start:{},end:{},last:!1},hi="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split("");class ft{constructor(e,n=16){this.randomLength=n,this.debugIdCounter=0,this.prefix=e,this.Id=`${e}.SAMPLE`;const r=new RegExp(`^${this.prefix}\\.([a-zA-Z0-9_]+)$`);this.parse=ri(oi,i=>r.test(i)?Xe.ok(i):Xe.error(new ii(`Expected ${this.prefix}.*, got ${i}`,[])))}generate(){const e=be(this.randomLength,()=>jr(hi)).join("");return`${this.prefix}.${e}`}}const Ke=new ft("key"),fi=ve({id:Ke.parse,position:si(L.parse)}),We=new ft("shp"),vi=ve({id:We.parse}),nn=new ft("shv"),mi=ve({id:nn.parse,keyPointId:Ke.parse,shapeId:We.parse,rawPoints:ai(L.parse)}),Jn=new ft("doc"),Zn=ve({id:Jn.parse,keyPoints:It(Ke.parse,fi),shapes:It(We.parse,vi),shapeVersions:It(nn.parse,mi)});function gi(){return{id:Jn.generate(),keyPoints:{},shapes:{},shapeVersions:{}}}class ne{static fromArray(e){return new ne(Qt(e.map(n=>[n.id,n])))}constructor(e){this.data=e}count(){return Kr(this.data).length}has(e){return Sn(this.data,e)}getIfExists(e){return Kn(this.data,e)}get(e){const n=this.getIfExists(e);return M(n!=null,`Item with id ${e} not found`),n}insert(e){return new ne({...this.data,[e.id]:e})}update(e,n){const r=this.get(e),i=Ie(r,n);return M(r.id===i.id,"Assertion Error: before.id === after.id"),this.insert(i)}delete(e){const{[e]:n,...r}=this.data;return new ne(r)}*[Symbol.iterator](){for(const e in this.data)Sn(this.data,e)&&(yield Z(this.data[e]))}toJSON(){return this.data}}var ye,Te,Ve;const pt=class{constructor(e,n,r,i){ge(this,ye,void 0);ge(this,Te,void 0);ge(this,Ve,void 0);this.index=e,we(this,ye,n),we(this,Te,r),we(this,Ve,i)}static build(e,n,r,i){const o=new Map;for(const s of e){const a=n(s);M(!o.has(a),"Assertion Error: !index.has(key)"),o.set(a,r(s))}return new pt(o,n,r,i)}withIndex(e){return new pt(e,F(this,ye),F(this,Te),F(this,Ve))}lookup(e){return this.index.get(F(this,Ve).call(this,e))}insert(e){const n=F(this,ye).call(this,e);M(!this.index.has(n),`key ${n} already exists in index`);const r=new Map(this.index);return r.set(n,F(this,Te).call(this,e)),this.withIndex(r)}remove(e){const n=F(this,ye).call(this,e);M(this.index.has(n),`key ${n} does not exist in index`);const r=new Map(this.index);return r.delete(n),this.withIndex(r)}update(e){const n=F(this,ye).call(this,e);M(this.index.has(n),`key ${n} does not exist in index`);const r=new Map(this.index);return r.set(n,F(this,Te).call(this,e)),this.withIndex(r)}toJSON(){return Qt(this.index)}};let Bt=pt;ye=new WeakMap,Te=new WeakMap,Ve=new WeakMap;const wi=new Set;var Ne,De,Be;const ht=class{constructor(e,n,r,i){ge(this,Ne,void 0);ge(this,De,void 0);ge(this,Be,void 0);this.index=e,we(this,Ne,n),we(this,De,r),we(this,Be,i)}static build(e,n,r,i){const o=new Map;for(const s of e){const a=n(s);let l=o.get(a);l||(l=new Set,o.set(a,l)),l.add(r(s))}return new ht(o,n,r,i)}withIndex(e){return new ht(e,F(this,Ne),F(this,De),F(this,Be))}lookup(e){var n;return(n=this.index.get(F(this,Be).call(this,e)))!=null?n:wi}insert(e){const n=F(this,Ne).call(this,e),r=F(this,De).call(this,e),i=this.index.get(n);let o;i?(M(!i.has(r),"already exists"),o=new Set(i)):o=new Set,o.add(r);const s=new Map(this.index);return s.set(n,o),this.withIndex(s)}remove(e){const n=F(this,Ne).call(this,e),r=F(this,De).call(this,e),i=this.index.get(n);M(i&&i.has(r),"value does not exist"),new Set(i).delete(r);const s=new Map(this.index);return s.delete(n),this.withIndex(s)}update(e,n){return this.remove(e).insert(n)}toJSON(){return Qt(this.index)}};let st=ht;Ne=new WeakMap,De=new WeakMap,Be=new WeakMap;const{min:Me,PI:ba}=Math,kn=.275;function Xn(t,e={}){const{size:n=16,smoothing:r=.5,thinning:i=.5,simulatePressure:o=!0,easing:s=v=>v,start:a={},end:l={}}=e,{easing:u=v=>v*(2-v)}=a,{easing:c=v=>--v*v*v+1}=l;if(t.length===0||n<=0)return[];const y=t[t.length-1].runningLength,h=a.taper===!1?0:a.taper===!0?Math.max(n,y):a.taper,m=l.taper===!1?0:l.taper===!0?Math.max(n,y):l.taper,x=Math.pow(n*r,2),f=[];let g=t.slice(0,10).reduce((v,E)=>{let I=E.pressure;if(o){const N=Me(1,E.distance/n),C=Me(1,1-N);I=Me(1,v+(C-v)*(N*kn))}return(v+I)/2},t[0].pressure),P=Ln(n,i,t[t.length-1].pressure,s),b=t[0].point,S=b;for(let v=0;v<t.length;v++){let{pressure:E}=t[v];const{point:I,distance:N,runningLength:C}=t[v];if(v<t.length-1&&y-C<3)continue;if(i){if(o){const D=Me(1,N/n),V=Me(1,1-D);E=Me(1,g+(V-g)*(D*kn))}P=Ln(n,i,E,s)}else P=n/2;const w=C<h?u(C/h):1,k=y-C<m?c((y-C)/m):1;if(P=Math.max(.01,P*Math.min(w,k)),v===t.length-1){f.push({center:I,radius:P});continue}S=I,(v<=1||b.distanceToSq(S)>x)&&(f.push({center:I,radius:P}),b=S),g=E}return f}function Qn(t,e={}){var h,m;const{streamline:n=.5,size:r=16,last:i=!1}=e;if(t.length===0)return[];const o=.15+(1-n)*.85;let s=t.map(x=>({point:L.fromVectorLike(x),pressure:x.pressure}));if(s.length===2){const x=s[1];s=s.slice(0,-1);for(let f=1;f<5;f++)s.push({point:s[0].point.lerp(x.point,f/4),pressure:x.pressure})}s.length===1&&s.push({point:s[0].point.add(L.UNIT),pressure:s[0].pressure});const a=[{point:s[0].point,pressure:s[0].pressure!=null&&s[0].pressure>=0?s[0].pressure:.25,vector:L.UNIT,distance:0,runningLength:0}];let l=!1,u=0,c=a[0];const y=s.length-1;for(let x=1;x<s.length;x++){const f=s[x],g=i&&x===y?f.point:c.point.lerp(f.point,o);if(c.point.equals(g))continue;const P=g.distanceTo(c.point);if(u+=P,x<y&&!l){if(u<r)continue;l=!0}c={point:g,pressure:f.pressure!=null&&f.pressure>=0?f.pressure:.5,vector:c.point.sub(g).normalize(),distance:P,runningLength:u},a.push(c)}return a[0].vector=(m=(h=a[1])==null?void 0:h.vector)!=null?m:L.ZERO,a}function Ln(t,e,n,r=i=>i){return t*r(.5-e*(.5-n))}function at(t){if(!t.length)return"";const e=["M",t[0].x,t[0].y,"Q"];for(let n=0;n<t.length;n++){const r=t[n],i=t[(n+1)%t.length],o=r.add(i).scale(.5);e.push(r.x,r.y,o.x,o.y)}return e.push("Z"),e.join(" ")}function er(t,e){const n=[t[0]];if(t.length===0)return[];let r=e,i=t[0],o=t[0].center;for(let s=1;s<t.length;s++){const a=t[s],l=t[Math.min(s+1,t.length-1)],u=a.center.add(l.center).scale(.5),c=a.center.distanceTo(i.center),y=o,h=a.center,m=u;let x=0;for(;c-x>=r;){const f=(r+x)/c;n.push({center:y.lerp(h,f).lerp(h.lerp(m,f),f),radius:Wn(i.radius,a.radius,f)}),x+=r,r=e}r-=c-x,i=a,o=u}return n.push(t[t.length-1]),n}function Ct(t){var o,s;const e=Array.from(t);if(e.length===0)return{versions:new ne({})};const n=[];let r=0;for(const a of e){const l=Qn(a.rawPoints),u=(s=(o=l[l.length-1])==null?void 0:o.runningLength)!=null?s:0;n.push({id:a.id,strokePoints:l,length:u}),u>r&&(r=u)}const i=Math.floor(r/Je.size);return{versions:ne.fromArray(n.map(({strokePoints:a,length:l,id:u})=>({id:u,length:l,normalizedCenterPoints:er(Xn(a,Je),l/i)})))}}function me(){}me.prototype={diff:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.callback;typeof r=="function"&&(i=r,r={}),this.options=r;var o=this;function s(f){return i?(setTimeout(function(){i(void 0,f)},0),!0):f}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var a=n.length,l=e.length,u=1,c=a+l;r.maxEditLength&&(c=Math.min(c,r.maxEditLength));var y=[{newPos:-1,components:[]}],h=this.extractCommon(y[0],n,e,0);if(y[0].newPos+1>=a&&h+1>=l)return s([{value:this.join(n),count:n.length}]);function m(){for(var f=-1*u;f<=u;f+=2){var g=void 0,P=y[f-1],b=y[f+1],S=(b?b.newPos:0)-f;P&&(y[f-1]=void 0);var v=P&&P.newPos+1<a,E=b&&0<=S&&S<l;if(!v&&!E){y[f]=void 0;continue}if(!v||E&&P.newPos<b.newPos?(g=bi(b),o.pushComponent(g.components,void 0,!0)):(g=P,g.newPos++,o.pushComponent(g.components,!0,void 0)),S=o.extractCommon(g,n,e,f),g.newPos+1>=a&&S+1>=l)return s(Pi(o,g.components,n,e,o.useLongestToken));y[f]=g}u++}if(i)(function f(){setTimeout(function(){if(u>c)return i();m()||f()},0)})();else for(;u<=c;){var x=m();if(x)return x}},pushComponent:function(e,n,r){var i=e[e.length-1];i&&i.added===n&&i.removed===r?e[e.length-1]={count:i.count+1,added:n,removed:r}:e.push({count:1,added:n,removed:r})},extractCommon:function(e,n,r,i){for(var o=n.length,s=r.length,a=e.newPos,l=a-i,u=0;a+1<o&&l+1<s&&this.equals(n[a+1],r[l+1]);)a++,l++,u++;return u&&e.components.push({count:u}),e.newPos=a,l},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function Pi(t,e,n,r,i){for(var o=0,s=e.length,a=0,l=0;o<s;o++){var u=e[o];if(u.removed){if(u.value=t.join(r.slice(l,l+u.count)),l+=u.count,o&&e[o-1].added){var y=e[o-1];e[o-1]=e[o],e[o]=y}}else{if(!u.added&&i){var c=n.slice(a,a+u.count);c=c.map(function(m,x){var f=r[l+x];return f.length>m.length?f:m}),u.value=t.join(c)}else u.value=t.join(n.slice(a,a+u.count));a+=u.count,u.added||(l+=u.count)}}var h=e[s-1];return s>1&&typeof h.value=="string"&&(h.added||h.removed)&&t.equals("",h.value)&&(e[s-2].value+=h.value,e.pop()),e}function bi(t){return{newPos:t.newPos,components:t.components.slice(0)}}var Tn=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Nn=/\S/,tr=new me;tr.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Nn.test(t)&&!Nn.test(e)};tr.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<e.length-1;n++)!e[n+1]&&e[n+2]&&Tn.test(e[n])&&Tn.test(e[n+2])&&(e[n]+=e[n+2],e.splice(n+1,2),n--);return e};var nr=new me;nr.tokenize=function(t){var e=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};var Ei=new me;Ei.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Si=new me;Si.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function ot(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ot=function(e){return typeof e}:ot=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(t)}var Ii=Object.prototype.toString,He=new me;He.useLongestToken=!0;He.tokenize=nr.tokenize;He.castInput=function(t){var e=this.options,n=e.undefinedReplacement,r=e.stringifyReplacer,i=r===void 0?function(o,s){return typeof s>"u"?n:s}:r;return typeof t=="string"?t:JSON.stringify(Ut(t,null,null,i),i,"  ")};He.equals=function(t,e){return me.prototype.equals.call(He,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function Ci(t,e,n){return He.diff(t,e,n)}function Ut(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var s;if(Ii.call(t)==="[object Array]"){for(e.push(t),s=new Array(t.length),n.push(s),o=0;o<t.length;o+=1)s[o]=Ut(t[o],e,n,r,i);return e.pop(),n.pop(),s}if(t&&t.toJSON&&(t=t.toJSON()),ot(t)==="object"&&t!==null){e.push(t),s={},n.push(s);var a=[],l;for(l in t)t.hasOwnProperty(l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)l=a[o],s[l]=Ut(t[l],e,n,r,l);e.pop(),n.pop()}else s=t;return s}var Ht=new me;Ht.tokenize=function(t){return t.slice()};Ht.join=Ht.removeEmpty=function(t){return t};class Q{constructor(e,n=0,r=!0){if(this.data=e,this.version=n,!r)return;const i=this.serialize(),o=Q.deserialize(i,this.version);if(!Rt(this,o)){console.log({actual:this,expected:o});const s=JSON.stringify(this,null,2),a=JSON.stringify(o,null,2);for(const l of Ci(s,a))console.log("CHANGE",l);Ye(`Mismatch after update:
Actual:
${JSON.stringify(this,null,2)}

Expected:
${JSON.stringify(o,null,2)}`)}}static create(){return Q.deserialize(gi())}static deserialize(e,n=0){const r=new ne(e.shapeVersions);return new Q({id:e.id,keyPoints:new ne(e.keyPoints),shapes:new ne(e.shapes),shapeVersions:r,shapeVersionLookup:Bt.build(r,i=>`${i.shapeId}/${i.keyPointId}`,i=>i.id,([i,o])=>`${i}/${o}`),shapeVersionIdsByShape:st.build(r,i=>i.shapeId,i=>i.id,In),shapeVersionIdsByKeyPoint:st.build(r,i=>i.keyPointId,i=>i.id,In),normalizedShapeVersions:Ct(Array.from(r)).versions},n,!1)}with(e){return new Q({...this.data,...e},this.version+1)}serialize(){return{id:this.data.id,keyPoints:this.data.keyPoints.data,shapes:this.data.shapes.data,shapeVersions:this.data.shapeVersions.data}}get shapes(){return this.data.shapes}get keyPoints(){return this.data.keyPoints}get shapeVersions(){return this.data.shapeVersions}getShapeVersion(e,n){const r=this.data.shapeVersionLookup.lookup([n,e]);return r?this.shapeVersions.get(r):null}getNormalizedCenterPointsForShapeVersion(e){return this.data.normalizedShapeVersions.get(e).normalizedCenterPoints}*iterateShapeVersionsForShape(e){for(const n of this.data.shapeVersionIdsByShape.lookup(e))yield this.shapeVersions.get(n)}addShape(e){console.log("doc.addShape",e);const n=this.shapes.insert({id:e});return this.with({shapes:n})}addKeyPoint(e,n){console.log("doc.addKeyPoint",e);const r=this.keyPoints.insert({id:e,position:n});return this.with({keyPoints:r})}updateKeyPoint(e,n){return this.with({keyPoints:this.keyPoints.update(e,n)})}replacePointsForVersion(e,n,r){const i=this.getShapeVersion(e,n);if(i){const a=this.shapeVersions.insert({...i,rawPoints:r});return this.with({shapeVersions:a,normalizedShapeVersions:Ct(a).versions})}const o={id:nn.generate(),keyPointId:e,shapeId:n,rawPoints:r},s=this.shapeVersions.insert(o);return this.with({shapeVersions:s,normalizedShapeVersions:Ct(s).versions,shapeVersionLookup:this.data.shapeVersionLookup.insert(o),shapeVersionIdsByShape:this.data.shapeVersionIdsByShape.insert(o),shapeVersionIdsByKeyPoint:this.data.shapeVersionIdsByKeyPoint.insert(o)})}}var A=(t=>(t.Draw="draw",t.Rig="rig",t.Play="play",t))(A||{});const ki=li(A);let ee=null,Re=null;function Li(){if(!Re)return;const t=Re;Re=null,Zr.exports.unstable_batchedUpdates(()=>{for(const e of t)e.emit()})}function Ti(){M(ee===null,"Assertion Error: pendingSyncInvalidations === null"),ee=new Set}function rr(){M(ee,"Assertion Error: pendingSyncInvalidations");const t=ee;ee=null;for(const e of t)e.emit();ee&&rr()}function Ni(){return!!ee}let Di=0;function Oi(t){return`unknown ${t} ${Di++}`}class ir{constructor(e,n){this.eagerInvalidation=new Cn,this.batchedInvalidation=new Cn,this.debugName=e!=null?e:Oi(n)}getDebugName(){return this.debugName}addEagerListener(e){return this.eagerInvalidation.listen(e)}addBatchListener(e){return this.batchedInvalidation.listen(e)}invalidate(){ee?ee.add(this.eagerInvalidation):this.eagerInvalidation.emit(),Re||(Re=new Set,queueMicrotask(Li)),Re.add(this.batchedInvalidation)}listenerCount(){return this.eagerInvalidation.listenerCount()+this.batchedInvalidation.listenerCount()}hasListeners(){return this.eagerInvalidation.hasListeners()||this.batchedInvalidation.hasListeners()}}let Ge=0;function Mi(){Ge++}let $=null;function Ai(t,e,n){return $||Ti(),$={shouldTrack:!0,previousDependencies:t,nextDependencies:new Map,previous:$,invalidateListener:e,shouldListen:n},$}function $i(t){if(M($===t,"Assertion Error: computationContext === context"),$=$.previous,t.shouldTrack&&t.previousDependencies)for(const[e,{unsubscribe:n}]of t.previousDependencies)t.nextDependencies.has(e)||n==null||n();return t.nextDependencies}function Dn(){Ni()&&!$&&rr()}function or(t){var e,n,r;if(M($,"cannot call .live() outside of a live context"),$.shouldTrack&&!$.nextDependencies.has(t)){const i=$.shouldListen?(r=(n=(e=$.previousDependencies)==null?void 0:e.get(t))==null?void 0:n.unsubscribe)!=null?r:t.addEagerInvalidateListener($.invalidateListener):null,o=t.getOnce();$.nextDependencies.set(t,{value:o,unsubscribe:i})}}function zi(t,e){for(const[n,{value:r}]of t)if(!Object.is(n.getOnce(),r))return!0;return!1}function Qe(t){const e={shouldTrack:!1,previous:$};$=e;const n=t();return M($===e,"Assertion Error: computationContext === nonTracking"),$=e.previous,n}class sr{constructor(e,n,r){this.compute=e,this._isValid=!1,this.validForGlobalVersion=-1,this.dependencies=null,this.isComputing=!1,this.completion=null,this.invalidate=()=>{M(!this.isComputing,"cannot write whilst computing dependant live computation"),this._isValid&&(this._isValid=!1,this.invalidation.invalidate())},this.invalidation=new ir(n,r)}getDebugName(){return this.invalidation.getDebugName()}computeIfNeeded(){if(this.isValid())return Z(this.completion);if(this.dependencies&&!zi(this.dependencies,this.getDebugName()))return this.makeValidAt(Ge),Z(this.completion);const e=Ge,n=Ai(this.dependencies,this.invalidate,this.invalidation.hasListeners());this.isComputing=!0;let r;try{this.completion=Xe.ok(this.compute()),r=!0}catch(i){this.completion=Xe.error(i),r=!1}return this.isComputing=!1,this.dependencies=$i(n),r?(this.makeValidAt(e),Dn(),this.computeIfNeeded()):Dn(),this.completion}isValid(){return this.invalidation.hasListeners()?this._isValid:this.validForGlobalVersion===Ge}makeValidAt(e){this._isValid=Ge===e,this.validForGlobalVersion=e}addEagerInvalidateListener(e){const n=this.invalidation.hasListeners(),r=this.invalidation.addEagerListener(e);return n||this.subscribeToDependencies(),()=>{r(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}addBatchInvalidateListener(e){const n=this.invalidation.hasListeners(),r=this.invalidation.addBatchListener(e);return n||this.subscribeToDependencies(),()=>{r(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}subscribeToDependencies(){if(this.isValid()&&this.dependencies)for(const[e,n]of this.dependencies)n.unsubscribe=e.addEagerInvalidateListener(this.invalidate);else this.computeIfNeeded()}unsubscribeFromDependencies(){var e;if(this.dependencies)for(const n of this.dependencies.values())(e=n.unsubscribe)==null||e.call(n),n.unsubscribe=null}}var Hn;const _i=(Hn=globalThis.requestIdleCallback)!=null?Hn:globalThis.requestAnimationFrame;var jn;const Fi=(jn=globalThis.cancelIdleCallback)!=null?jn:globalThis.cancelAnimationFrame;class fe{constructor(e,n,r){this.schedule=n,this.cancelScheduledCallback=null,this.unsubscribe=null,this.invalidate=()=>{this.cancelScheduledCallback=this.schedule(this.recompute)},this.recompute=()=>{this.cancelScheduledCallback=null,this.computation.computeIfNeeded()},this.computation=new sr(e,r,"LiveEffect"),this.cancelScheduledCallback=n(()=>{this.cancelScheduledCallback=null,this.unsubscribe=this.computation.addEagerInvalidateListener(this.invalidate)})}cancel(){var e,n;(e=this.cancelScheduledCallback)==null||e.call(this),(n=this.unsubscribe)==null||n.call(this)}}fe.eager=t=>(t(),en);fe.frame=t=>{const e=requestAnimationFrame(t);return()=>cancelAnimationFrame(e)};fe.idle=t=>{const e=_i(t);return()=>Fi(e)};class lt{constructor(e,n,r="LiveMemo"){this.completion=null,this.computation=new sr(e,n,r)}getDebugName(){return this.computation.getDebugName()}getOnce(){return this.completion=this.computation.computeIfNeeded(),this.completion.unwrap()}live(){return this.completion=this.computation.computeIfNeeded(),or(this),this.completion.unwrap()}addEagerInvalidateListener(e){return this.computation.addEagerInvalidateListener(e)}addBatchInvalidateListener(e){return this.computation.addBatchInvalidateListener(e)}}class xe extends lt{constructor(e,n,r){super(e,r,"LiveMemoWritable"),this.write=n}update(e,...n){this.write(e,...n)}}class K{constructor(e,n){this.pendingUpdates=null,this.isUpdating=!1,this.wasRead=!0,this.value=e,this.invalidation=new ir(n,"LiveValue")}getDebugName(){return this.invalidation.getDebugName()}markRead(){this.wasRead=!0}getOnce(){return this.markRead(),this.value}live(){return this.markRead(),or(this),this.value}update(e){if(this.isUpdating){this.pendingUpdates||(this.pendingUpdates=[]),this.pendingUpdates.push(e);return}this.isUpdating=!0;try{if(this.value=Ie(this.value,e),this.invalidate(),this.pendingUpdates)for(let n=0;n<this.pendingUpdates.length;n++)this.value=Ie(this.value,e),this.invalidate()}finally{this.pendingUpdates=null,this.isUpdating=!1}}invalidate(){this.wasRead&&(this.wasRead=!1,this.invalidation.invalidate(),Mi())}addEagerInvalidateListener(e){return this.invalidation.addEagerListener(e)}addBatchInvalidateListener(e){return this.invalidation.addBatchListener(e)}getInvalidateListenerCount(){return this.invalidation.listenerCount()}}function ie(t){const e=d.exports.useRef(!0);e.current=!0;try{const n=d.exports.useSyncExternalStore(d.exports.useCallback(r=>t.addBatchInvalidateListener(r),[t]),()=>{if(e.current)return t.getOnce();try{return t.getOnce()}catch(r){return console.groupCollapsed("[useLiveValue caught error]"),console.log(r),console.groupEnd(),{}}});return d.exports.useDebugValue(n),n}finally{e.current=!1}}function H(t,e){const r=d.exports.useMemo(()=>new lt(t,void 0),e),i=ie(r);return d.exports.useDebugValue(i),i}function ut(t,e){const n=new fe(e,t);return()=>n.cancel}const Ri=ve({pan:ui,zoom:ci}),kt={initialize:()=>({pan:L.ZERO,zoom:1}),deserialize:({pan:t,zoom:e})=>({pan:L.deserialize(t),zoom:e}),serialize:({pan:t,zoom:e})=>({pan:t.serialize(),zoom:e})};class Vi{constructor(e,n,r){this.screenSize=e,this.isSidebarOpen=n,this.state=r,this.pan=new xe(()=>this.state.live().pan,i=>this.state.update(o=>_e(o,"pan",i))),this.zoom=new xe(()=>this.state.live().zoom,i=>this.state.update(o=>_e(o,"zoom",i))),this.screenSize=e,this.isSidebarOpen=n}screenSizeWithSidebarOpenLive(){return this.screenSize.live().sub(new L(tn,0))}canvasScreenSizeLive(){return this.isSidebarOpen.live()?this.screenSizeWithSidebarOpenLive():this.screenSize.live()}handleWheelEvent(e){e.preventDefault(),e.stopImmediatePropagation();const{deltaX:n,deltaY:r,ctrlKey:i}=e;this.state.update(({pan:o,zoom:s})=>{if(i){const a=L.fromEvent(e),l=Math.exp(-r/100)*s;return{pan:a.add(o).scale(l/s).sub(a),zoom:l}}else return{pan:o.add(new L(n,r)),zoom:s}})}originLive(){const{pan:e,zoom:n}=this.state.live();return e.sub(this.canvasScreenSizeLive().scale(.5*n))}visibleSceneBoundsLive(){return new yi(this.originLive(),this.canvasScreenSizeLive())}screenToSceneLive(e){return e.add(this.originLive()).scale(1/this.state.live().zoom)}sceneToScreenLive(e){return e.scale(this.state.live().zoom).sub(this.originLive())}eventSceneCoords(e){return Qe(()=>this.screenToSceneLive(L.fromEvent(e)))}getSceneTransformLive(){const e=this.originLive(),n=this.state.live().zoom;return`translate(${-e.x}px, ${-e.y}px) scale(${n}) `}}const Bi=ve({keyPointId:Ke.parse,shapeId:We.parse,viewport:Ri,mode:ki}),vt={initialize:(t,e)=>({keyPointId:t,shapeId:e,mode:A.Draw,viewport:kt.initialize()}),deserialize:t=>({...t,viewport:kt.deserialize(t.viewport)}),serialize:t=>({...t,viewport:kt.serialize(t.viewport)})};class Ui{constructor(e){this.state=e,this.keyPointId=new xe(()=>this.state.live().keyPointId,n=>this.state.update(r=>_e(r,"keyPointId",n))),this.shapeId=new xe(()=>this.state.live().shapeId,n=>this.state.update(r=>_e(r,"shapeId",n))),this.mode=new xe(()=>this.state.live().mode,n=>this.state.update(r=>_e(r,"mode",n))),this.viewportState=new xe(()=>this.state.live().viewport,n=>this.state.update(r=>_e(r,"viewport",n)))}}const ar=ve({document:Zn,location:Bi});function lr(t){return{document:t.document.serialize(),location:vt.serialize(t.location)}}function Hi(t){return{document:Q.deserialize(t.document),location:vt.deserialize(t.location)}}function ji(t){return Ft(`splatapus.${t}`)?ar(Ft(`splatapus.${t}`)).mapErr(n=>n.toString()).map(n=>Hi(n)):Xe.error("No saved data found")}function Ki(t,e){window.splatSerializedDoc=e,Gn(`splatapus.${t}`,lr(e))}const Wi=Wr(pi,Ki);function ur(t,e){const n=[...t.keyPoints][0].id,r=[...t.shapes][0].id;return vt.initialize(n,r)}function cr(t){const e=Ke.generate(),n=We.generate(),r=Q.create().addKeyPoint(e,L.ZERO).addShape(n).replacePointsForVersion(e,n,[]);return{document:r,location:ur(r)}}const dr={[A.Draw]:{gradient500:"from-fuchsia-500 to-violet-500",border500:"border-purple-500",ring500:"ring-purple-500"},[A.Rig]:{gradient500:"from-cyan-500 to-blue-500",border500:"border-sky-500",ring500:"ring-sky-500"},[A.Play]:{gradient500:"from-lime-500 to-emerald-500",border500:"border-green-500",ring500:"ring-green-500"}};function Gi(t){const e=H(()=>t.interaction.activeMode.live().type,[t]);return dr[e]}function On(t,e){!t||(typeof t=="function"?t(e):t.current=e)}function qi(t,e){return d.exports.useCallback(n=>{On(t,n),On(e,n)},[t,e])}let Yi=1;class Ji{constructor(){this.activeAnimations=new K({},"vfx.activeAnimations")}triggerAnimation(e){this.activeAnimations.update(n=>({...n,[e]:Yi++}))}getActiveAnimationIdLive(e){var n;return(n=Kn(this.activeAnimations.live(),e))!=null?n:null}acknowledgeAnimation(e,n){this.activeAnimations.update(r=>{const{[e]:i,...o}=r;return i!==n?r:o})}}function jt(t,e,n){const r=d.exports.useRef(null),i=H(()=>t.getActiveAnimationIdLive(e),[e,t]),o=Xr(n);return d.exports.useEffect(()=>{const s=r.current;if(!s||!i)return;const a=o(),l=s.animate(a.keyFrames,a);return l.addEventListener("finish",()=>{t.acknowledgeAnimation(e,i)}),l.play(),()=>{l.cancel()}},[i,o,e,t]),r}function yr(t,e=1/0){var r;const n=(r=Yn(t,Qr))!=null?r:L.ZERO;return d.exports.useMemo(()=>{if(!n)return"none";const i=Math.min(n.x*.5,n.y*.5,e);return`path('${[`M 0,${i}`,`Q 0,0 ${i},0`,`T ${n.x-i},0`,`Q ${n.x},0 ${n.x},${i}`,`T ${n.x},${n.y-i}`,`Q ${n.x},${n.y} ${n.x-i},${n.y}`,`T ${i},${n.y}`,`Q 0,${n.y} 0,${n.y-i}`,"Z"].join(" ")}')`},[n,e])}const oe=d.exports.forwardRef(function({children:e,className:n,iconLeft:r,iconRight:i,...o},s){return _(xr,{className:j(n,"justify-center gap-2 px-4 py-1"),ref:s,...o,children:[r,p(Zi,{children:e}),i]})});function Zi({children:t}){return p("span",{className:"inline-block transition-transform duration-200 ease-out-back-md group-hover:scale-110 group-active:scale-95",children:t})}const xr=d.exports.forwardRef(function({className:e,style:n,...r},i){const[o,s]=d.exports.useState(null),a=yr(o);return p("button",{ref:qi(s,i),className:j("group inline-flex items-center rounded text-center font-bold tracking-wide text-stone-400 hover:bg-stone-300/25 hover:text-stone-500 focus:outline-none focus-visible:text-stone-600",e),style:{...n,clipPath:a},...r})});function Xi({children:t,actionName:e,vfx:n,...r}){const i=jt(n,e,()=>({keyFrames:{transform:["scale(1)","scale(0.8)","scale(1)"]},duration:300,easing:Vt.outBackMd}));return p(oe,{...r,children:p("span",{className:"inline-block",ref:i,children:t})})}const Qi=T.memo(function({splatapus:e}){return _(X,{children:[p(Lt,{modeType:A.Draw,splatapus:e,children:"draw"}),p(Lt,{modeType:A.Rig,splatapus:e,children:"rig"}),p(Lt,{modeType:A.Play,splatapus:e,children:"play"})]})}),Lt=function({modeType:e,splatapus:n,children:r}){const o=H(()=>n.interaction.activeMode.live().type,[n.interaction])===e;return p(Xi,{actionName:e,vfx:n.vfx,onClick:()=>{n.vfx.triggerAnimation(e),n.interaction.requestSetActiveMode(e)},className:j(o&&`pointer-events-none bg-gradient-to-br ${dr[e].gradient500} !text-white`),disabled:o,children:r})};class Ze{static distance(e,n){let r=0;for(let i=0;i<e.length;i++)r+=Math.pow(e[i]-n[i],2);return Math.sqrt(r)}static kernel(e,n){const r=Ze.distance(e,n);return r===0?0:Math.pow(r,2)*Math.log(r)}constructor(e,n){e.length===0&&Ye("bad centers array :/"),e.every(u=>u.length===e[0].length)||Ye("centers must have same dimensions :/"),this.centers=e;const r=n.slice(),i=[],o=[];for(let u=0;u<e.length;u++){const c=[],y=[1];for(let h=0;h<e[u].length;h++)y.push(e[u][h]);for(let h=0;h<e.length;h++)c.push(Ze.kernel(e[u],e[h]));o.push(y),i.push(c.concat(y))}const a=R.transpose(o).map(u=>{for(let c=u.length;c<i[0].length;c++)u.push(0);return u});for(let u=0;u<a.length;u++)i.push(a[u]),r.push(0);const l=this.solve(r,i);l||Ye("rbf failed to compile with given centers./nCenters must be unique :/"),this.ws=l}solve(e,n){const r=R.inverse(n);return r?R.multiplyVector(r,e):null}getValue(e){M(this.ws,"Assertion Error: this.ws");let n=0,r=0;for(r=0;r<this.centers.length;r++)n+=Number(this.ws[r])*Ze.kernel(e,this.centers[r]);for(n+=Number(this.ws[this.centers.length]),r=0;r<e.length;r++)n+=e[r]*Number(this.ws[this.centers.length+(r+1)]);return n}}const R={create(t){return t.map(e=>e.slice())},fromVector(t){return t.map(e=>[e])},identity(t){return be(t,e=>be(t,n=>e===n?1:0))},col(t,e){return t.map(n=>n[e-1])},clone(t){return t.slice()},canMultiplyFromLeft(t,e){return t[0].length===e.length},multiplyMatrix(t,e){if(!R.canMultiplyFromLeft(t,e))return null;const n=t[0].length;return be(t.length,r=>be(e[0].length,i=>{let o=0;for(let s=0;s<n;s++)o+=t[r][s]*e[s][i];return o}))},multiplyVector(t,e){return R.multiplyMatrix(t,R.fromVector(e))},transpose(t){return be(t[0].length,e=>be(t.length,n=>t[n][e]))},isSquare(t){return t.length===t[0].length},toRightTriangular(t){const e=R.clone(t),n=t.length,r=t[0].length;for(let i=0;i<n;i++){if(e[i][i]===0){for(let o=i+1;o<n;o++)if(e[o][i]!==0){const s=[];for(let a=0;a<r;a++)s.push(e[i][a]+e[o][a]);e[i]=s;break}}if(e[i][i]!==0)for(let o=i+1;o<n;o++){const s=e[o][i]/e[i][i],a=[];for(let l=0;l<r;l++)a.push(l<=i?0:e[o][l]-e[i][l]*s);e[o]=a}}return e},determinant(t){if(!R.isSquare(t))return null;const e=R.toRightTriangular(t);let n=e[0][0];for(let r=1;r<e.length;r++)n=n*e[r][r];return n},isSingular(t){return R.isSquare(t)&&R.determinant(t)===0},augment(t,e){const n=R.clone(t),r=n[0].length;M(n.length===e.length,"Assertion Error: result.length === other.length");for(let i=0;i<n.length;i++)for(let o=0;o<e[0].length;o++)n[i][r+o]=e[i][o];return n},inverse(t){if(!R.isSquare(t)||R.isSingular(t))return null;const e=t.length,n=[],r=R.toRightTriangular(R.augment(t,R.identity(e))),i=r[0].length;let o=t.length;for(;o--;){const s=[];n[o]=[];const a=r[o][o];for(let u=0;u<i;u++){const c=r[o][u]/a;s.push(c),u>=e&&n[o].push(c)}r[o]=s;let l=o;for(;l--;){const u=[];for(let c=0;c<i;c++)u.push(r[l][c]-r[o][c]*r[l][o]);r[l]=u}}return n}};class eo{interpolate(e){Ye("cannot interpolate none")}}class to{constructor(e){this.value=e}interpolate(e){return this.value}}class no{constructor(e,n,r,i){this.centerA=e,this.centerB=n,this.valueA=r,this.valueB=i}interpolate(e){const n=this.centerB.sub(this.centerA),i=e.sub(this.centerA).dot(n)/n.dot(n);return Wn(this.valueA,this.valueB,i)}}class ro extends Ze{constructor(e,n){super(e.map(({x:r,y:i})=>[r,i]),n)}interpolate(e){return this.getValue([e.x,e.y])}}class Tt{constructor(e,n){switch(M(e.length===n.length,"Assertion Error: centers.length === values.length"),e.length){case 0:this.interpolator=new eo;break;case 1:this.interpolator=new to(n[0]);break;case 2:this.interpolator=new no(e[0],e[1],n[0],n[1]);break;default:this.interpolator=new ro(e,n)}}interpolate(e){return this.interpolator.interpolate(e)}}class io{constructor(){this.cache=new Map}getCenterPointsAtPosition(e,n,r){switch(r.type){case"keyPointId":{const i=e.getShapeVersion(r.keyPointId,n);if(!i){const o=e.keyPoints.get(r.keyPointId);return o.position?this.getCenterPointsAtInterpolatedPosition(e,n,o.position):null}return e.getNormalizedCenterPointsForShapeVersion(i.id)}case"interpolated":return this.getCenterPointsAtInterpolatedPosition(e,n,r.scenePosition);default:U(r)}}getCenterPointsAtInterpolatedPosition(e,n,r){var u;const i=e.shapes.get(n),o=new Set(e.iterateShapeVersionsForShape(n));if(!o.size)return null;const s=new Set;for(const c of o)s.add(e.keyPoints.get(c.keyPointId));const a=this.getCacheEntry(i,o,s);let l;return a?l=a.interpolators:(l=this.calculateInterpolators(e,o),this.cache.set(i,{versions:o,keyPoints:s,interpolators:l})),(u=l==null?void 0:l.map(({x:c,y,r:h})=>({center:new L(c.interpolate(r),y.interpolate(r)),radius:h.interpolate(r)})))!=null?u:null}calculateInterpolators(e,n){console.time("calculatInterpolators");const r=qn(Array.from(n,a=>{const l=e.keyPoints.get(a.keyPointId);return l.position?{normalizedCenterPoints:e.getNormalizedCenterPointsForShapeVersion(a.id),version:a,keyPointPosition:l.position}:null}));if(!r.length)return null;const i=r.map(({keyPointPosition:a})=>a),o=Math.min(...r.map(({normalizedCenterPoints:a})=>a.length));console.log({minLength:o,allNormalizedPoints:r});const s=[];for(let a=0;a<o;a++){const l=r.map(({normalizedCenterPoints:y})=>y[a].center.x),u=r.map(({normalizedCenterPoints:y})=>y[a].center.y),c=r.map(({normalizedCenterPoints:y})=>y[a].radius);s.push({x:new Tt(i,l),y:new Tt(i,u),r:new Tt(i,c)})}return console.timeEnd("calculatInterpolators"),s}getCacheEntry(e,n,r){const i=this.cache.get(e);if(!i||n.size!==i.versions.size||r.size!==i.keyPoints.size)return null;for(const o of n)if(!i.versions.has(o))return null;for(const o of r)if(!i.keyPoints.has(o))return null;return i}}const pr=new io;function ct(t){const e=[],n=[];if(t.length===0)return[];if(t.length===1){const y=[];for(let h=0;h<12;h++)y.push(t[0].center.add(L.fromPolar(h*Math.PI/6,t[0].radius)));return y}const r=t[0],o=t[1].center.sub(r.center).normalize(),s=o.perpendicular().scale(r.radius);e.push(r.center.sub(o.scale(r.radius))),e.push(r.center.sub(s)),n.push(r.center.add(s));for(let y=1;y<t.length-1;y++){const h=t[y-1],m=t[y],g=t[y+1].center.sub(h.center).normalize().perpendicular().scale(m.radius);e.push(m.center.sub(g)),n.push(m.center.add(g))}const a=t[t.length-2],l=t[t.length-1],u=l.center.sub(a.center).normalize(),c=u.perpendicular().scale(l.radius);return e.push(l.center.sub(c)),e.push(l.center.add(u.scale(l.radius))),n.push(l.center.add(c)),e.concat(n.reverse())}function oo(t){return at(ct(t))}const hr=typeof window>"u"||typeof document>"u";let se=hr?d.exports.useEffect:d.exports.useLayoutEffect;function re(t){let e=d.exports.useRef(t);return se(()=>{e.current=t},[t]),e}function so(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function mt(){let t=[],e=[],n={enqueue(r){e.push(r)},addEventListener(r,i,o,s){return r.addEventListener(i,o,s),n.add(()=>r.removeEventListener(i,o,s))},requestAnimationFrame(...r){let i=requestAnimationFrame(...r);return n.add(()=>cancelAnimationFrame(i))},nextFrame(...r){return n.requestAnimationFrame(()=>n.requestAnimationFrame(...r))},setTimeout(...r){let i=setTimeout(...r);return n.add(()=>clearTimeout(i))},microTask(...r){let i={current:!0};return so(()=>{i.current&&r[0]()}),n.add(()=>{i.current=!1})},add(r){return t.push(r),()=>{let i=t.indexOf(r);if(i>=0){let[o]=t.splice(i,1);o()}}},dispose(){for(let r of t.splice(0))r()},async workQueue(){for(let r of e.splice(0))await r()}};return n}function fr(){let[t]=d.exports.useState(mt);return d.exports.useEffect(()=>()=>t.dispose(),[t]),t}let O=function(t){let e=re(t);return T.useCallback((...n)=>e.current(...n),[e])},Nt={serverHandoffComplete:!1};function rn(){let[t,e]=d.exports.useState(Nt.serverHandoffComplete);return d.exports.useEffect(()=>{t!==!0&&e(!0)},[t]),d.exports.useEffect(()=>{Nt.serverHandoffComplete===!1&&(Nt.serverHandoffComplete=!0)},[]),t}var Mn;let ao=0;function An(){return++ao}let ae=(Mn=T.useId)!=null?Mn:function(){let t=rn(),[e,n]=T.useState(t?An:null);return se(()=>{e===null&&n(An())},[e]),e!=null?""+e:void 0};function z(t,e,...n){if(t in e){let i=e[t];return typeof i=="function"?i(...n):i}let r=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,z),r}function on(t){return hr?null:t instanceof Node?t.ownerDocument:t!=null&&t.hasOwnProperty("current")&&t.current instanceof Node?t.current.ownerDocument:document}let Kt=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var Ce=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t))(Ce||{}),lo=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(lo||{}),uo=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(uo||{});function vr(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Kt))}var sn=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(sn||{});function mr(t,e=0){var n;return t===((n=on(t))==null?void 0:n.body)?!1:z(e,{[0](){return t.matches(Kt)},[1](){let r=t;for(;r!==null;){if(r.matches(Kt))return!0;r=r.parentElement}return!1}})}let co=["textarea","input"].join(",");function yo(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,co))!=null?n:!1}function xo(t,e=n=>n){return t.slice().sort((n,r)=>{let i=e(n),o=e(r);if(i===null||o===null)return 0;let s=i.compareDocumentPosition(o);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Fe(t,e,n=!0,r=null){let i=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,o=Array.isArray(t)?n?xo(t):t:vr(t);r=r!=null?r:i.activeElement;let s=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),a=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(r))-1;if(e&4)return Math.max(0,o.indexOf(r))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=e&32?{preventScroll:!0}:{},u=0,c=o.length,y;do{if(u>=c||u+c<=0)return 0;let h=a+u;if(e&16)h=(h+c)%c;else{if(h<0)return 3;if(h>=c)return 1}y=o[h],y==null||y.focus(l),u+=s}while(y!==i.activeElement);return e&6&&yo(y)&&y.select(),y.hasAttribute("tabindex")||y.setAttribute("tabindex","0"),2}function Dt(t,e,n){let r=re(e);d.exports.useEffect(()=>{function i(o){r.current(o)}return document.addEventListener(t,i,n),()=>document.removeEventListener(t,i,n)},[t,n])}function po(t,e,n=!0){let r=d.exports.useRef(!1);d.exports.useEffect(()=>{requestAnimationFrame(()=>{r.current=n})},[n]);function i(s,a){if(!r.current||s.defaultPrevented)return;let l=function c(y){return typeof y=="function"?c(y()):Array.isArray(y)||y instanceof Set?y:[y]}(t),u=a(s);if(u!==null&&!!u.ownerDocument.documentElement.contains(u)){for(let c of l){if(c===null)continue;let y=c instanceof HTMLElement?c:c.current;if(y!=null&&y.contains(u))return}return!mr(u,sn.Loose)&&u.tabIndex!==-1&&s.preventDefault(),e(s,u)}}let o=d.exports.useRef(null);Dt("mousedown",s=>{r.current&&(o.current=s.target)},!0),Dt("click",s=>{!o.current||(i(s,()=>o.current),o.current=null)},!0),Dt("blur",s=>i(s,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function $n(t){var e;if(t.type)return t.type;let n=(e=t.as)!=null?e:"button";if(typeof n=="string"&&n.toLowerCase()==="button")return"button"}function gr(t,e){let[n,r]=d.exports.useState(()=>$n(t));return se(()=>{r($n(t))},[t.type,t.as]),se(()=>{n||!e.current||e.current instanceof HTMLButtonElement&&!e.current.hasAttribute("type")&&r("button")},[n,e]),n}let wr=Symbol();function ho(t,e=!0){return Object.assign(t,{[wr]:e})}function Y(...t){let e=d.exports.useRef(t);d.exports.useEffect(()=>{e.current=t},[t]);let n=O(r=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(r):i.current=r)});return t.every(r=>r==null||(r==null?void 0:r[wr]))?void 0:n}var je=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(je||{}),te=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(te||{});function G({ourProps:t,theirProps:e,slot:n,defaultTag:r,features:i,visible:o=!0,name:s}){let a=Pr(e,t);if(o)return it(a,n,r,s);let l=i!=null?i:0;if(l&2){let{static:u=!1,...c}=a;if(u)return it(c,n,r,s)}if(l&1){let{unmount:u=!0,...c}=a;return z(u?0:1,{[0](){return null},[1](){return it({...c,hidden:!0,style:{display:"none"}},n,r,s)}})}return it(a,n,r,s)}function it(t,e={},n,r){let{as:i=n,children:o,refName:s="ref",...a}=Ot(t,["unmount","static"]),l=t.ref!==void 0?{[s]:t.ref}:{},u=typeof o=="function"?o(e):o;a.className&&typeof a.className=="function"&&(a.className=a.className(e));let c={};if(e){let y=!1,h=[];for(let[m,x]of Object.entries(e))typeof x=="boolean"&&(y=!0),x===!0&&h.push(m);y&&(c["data-headlessui-state"]=h.join(" "))}if(i===d.exports.Fragment&&Object.keys(Wt(a)).length>0){if(!d.exports.isValidElement(u)||Array.isArray(u)&&u.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(a).map(y=>`  - ${y}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(y=>`  - ${y}`).join(`
`)].join(`
`));return d.exports.cloneElement(u,Object.assign({},Pr(u.props,Wt(Ot(a,["ref"]))),c,l,fo(u.ref,l.ref)))}return d.exports.createElement(i,Object.assign({},Ot(a,["ref"]),i!==d.exports.Fragment&&l,i!==d.exports.Fragment&&c),u)}function fo(...t){return{ref:t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}}function Pr(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(n[i]!=null||(n[i]=[]),n[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(n).map(r=>[r,void 0])));for(let r in n)Object.assign(e,{[r](i,...o){let s=n[r];for(let a of s){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;a(i,...o)}}});return e}function q(t){var e;return Object.assign(d.exports.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Wt(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Ot(t,e=[]){let n=Object.assign({},t);for(let r of e)r in n&&delete n[r];return n}function an(t){let e=t.parentElement,n=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(n=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&vo(n)?!1:r}function vo(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}function mo(t){var e;let n=(e=t==null?void 0:t.form)!=null?e:t.closest("form");if(n){for(let r of n.elements)if(r.tagName==="INPUT"&&r.type==="submit"||r.tagName==="BUTTON"&&r.type==="submit"||r.nodeName==="INPUT"&&r.type==="image"){r.click();return}}}let go="div";var et=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(et||{});let dt=q(function(t,e){let{features:n=1,...r}=t,i={ref:e,"aria-hidden":(n&2)===2?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return G({ourProps:i,theirProps:r,slot:{},defaultTag:go,name:"Hidden"})}),ln=d.exports.createContext(null);ln.displayName="OpenClosedContext";var le=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(le||{});function gt(){return d.exports.useContext(ln)}function br({value:t,children:e}){return T.createElement(ln.Provider,{value:t},e)}var J=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(J||{});function wo(t,e,n){let[r,i]=d.exports.useState(n),o=t!==void 0;return[o?t:r,O(s=>(o||i(s),e==null?void 0:e(s)))]}function Po(t,e,n){let r=re(e);d.exports.useEffect(()=>{function i(o){r.current(o)}return window.addEventListener(t,i,n),()=>window.removeEventListener(t,i,n)},[t,n])}var ke=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(ke||{});function Er(){let t=d.exports.useRef(0);return Po("keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function Sr(){let t=d.exports.useRef(!1);return se(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function un(...t){return d.exports.useMemo(()=>on(...t),[...t])}function bo(t,e,n,r){let i=re(n);d.exports.useEffect(()=>{t=t!=null?t:window;function o(s){i.current(s)}return t.addEventListener(e,o,r),()=>t.removeEventListener(e,o,r)},[t,e,r])}let Ir=d.exports.createContext(null);function Cr(){let t=d.exports.useContext(Ir);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Cr),e}return t}function Eo(){let[t,e]=d.exports.useState([]);return[t.length>0?t.join(" "):void 0,d.exports.useMemo(()=>function(n){let r=O(o=>(e(s=>[...s,o]),()=>e(s=>{let a=s.slice(),l=a.indexOf(o);return l!==-1&&a.splice(l,1),a}))),i=d.exports.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props}),[r,n.slot,n.name,n.props]);return T.createElement(Ir.Provider,{value:i},n.children)},[e])]}let So="p",Io=q(function(t,e){let n=Cr(),r=`headlessui-description-${ae()}`,i=Y(e);se(()=>n.register(r),[r,n.register]);let o=t,s={ref:i,...n.props,id:r};return G({ourProps:s,theirProps:o,slot:n.slot||{},defaultTag:So,name:n.name||"Description"})});var Co=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Co||{}),ko=(t=>(t[t.TogglePopover=0]="TogglePopover",t[t.ClosePopover=1]="ClosePopover",t[t.SetButton=2]="SetButton",t[t.SetButtonId=3]="SetButtonId",t[t.SetPanel=4]="SetPanel",t[t.SetPanelId=5]="SetPanelId",t))(ko||{});let Lo={[0]:t=>({...t,popoverState:z(t.popoverState,{[0]:1,[1]:0})}),[1](t){return t.popoverState===1?t:{...t,popoverState:1}},[2](t,e){return t.button===e.button?t:{...t,button:e.button}},[3](t,e){return t.buttonId===e.buttonId?t:{...t,buttonId:e.buttonId}},[4](t,e){return t.panel===e.panel?t:{...t,panel:e.panel}},[5](t,e){return t.panelId===e.panelId?t:{...t,panelId:e.panelId}}},cn=d.exports.createContext(null);cn.displayName="PopoverContext";function wt(t){let e=d.exports.useContext(cn);if(e===null){let n=new Error(`<${t} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,wt),n}return e}let dn=d.exports.createContext(null);dn.displayName="PopoverAPIContext";function yn(t){let e=d.exports.useContext(dn);if(e===null){let n=new Error(`<${t} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,yn),n}return e}let xn=d.exports.createContext(null);xn.displayName="PopoverGroupContext";function kr(){return d.exports.useContext(xn)}let pn=d.exports.createContext(null);pn.displayName="PopoverPanelContext";function To(){return d.exports.useContext(pn)}function No(t,e){return z(e.type,Lo,t,e)}let Do="div",Oo=q(function(t,e){var n;let r=`headlessui-popover-button-${ae()}`,i=`headlessui-popover-panel-${ae()}`,o=d.exports.useRef(null),s=Y(e,ho(w=>{o.current=w})),a=d.exports.useReducer(No,{popoverState:1,button:null,buttonId:r,panel:null,panelId:i,beforePanelSentinel:d.exports.createRef(),afterPanelSentinel:d.exports.createRef()}),[{popoverState:l,button:u,panel:c,beforePanelSentinel:y,afterPanelSentinel:h},m]=a,x=un((n=o.current)!=null?n:u);d.exports.useEffect(()=>m({type:3,buttonId:r}),[r,m]),d.exports.useEffect(()=>m({type:5,panelId:i}),[i,m]);let f=d.exports.useMemo(()=>{if(!u||!c)return!1;for(let w of document.querySelectorAll("body > *"))if(Number(w==null?void 0:w.contains(u))^Number(w==null?void 0:w.contains(c)))return!0;return!1},[u,c]),g=d.exports.useMemo(()=>({buttonId:r,panelId:i,close:()=>m({type:1})}),[r,i,m]),P=kr(),b=P==null?void 0:P.registerPopover,S=O(()=>{var w;return(w=P==null?void 0:P.isFocusWithinPopoverGroup())!=null?w:(x==null?void 0:x.activeElement)&&((u==null?void 0:u.contains(x.activeElement))||(c==null?void 0:c.contains(x.activeElement)))});d.exports.useEffect(()=>b==null?void 0:b(g),[b,g]),bo(x==null?void 0:x.defaultView,"focus",w=>{var k,D,V,B;l===0&&(S()||!u||!c||(D=(k=y.current)==null?void 0:k.contains)!=null&&D.call(k,w.target)||(B=(V=h.current)==null?void 0:V.contains)!=null&&B.call(V,w.target)||m({type:1}))},!0),po([u,c],(w,k)=>{m({type:1}),mr(k,sn.Loose)||(w.preventDefault(),u==null||u.focus())},l===0);let v=O(w=>{m({type:1});let k=(()=>w?w instanceof HTMLElement?w:"current"in w&&w.current instanceof HTMLElement?w.current:u:u)();k==null||k.focus()}),E=d.exports.useMemo(()=>({close:v,isPortalled:f}),[v,f]),I=d.exports.useMemo(()=>({open:l===0,close:v}),[l,v]),N=t,C={ref:s};return T.createElement(cn.Provider,{value:a},T.createElement(dn.Provider,{value:E},T.createElement(br,{value:z(l,{[0]:le.Open,[1]:le.Closed})},G({ourProps:C,theirProps:N,slot:I,defaultTag:Do,name:"Popover"}))))}),Mo="button",Ao=q(function(t,e){let[n,r]=wt("Popover.Button"),{isPortalled:i}=yn("Popover.Button"),o=d.exports.useRef(null),s=`headlessui-focus-sentinel-${ae()}`,a=kr(),l=a==null?void 0:a.closeOthers,u=To(),c=u===null?!1:u===n.panelId,y=Y(o,e,c?null:w=>r({type:2,button:w})),h=Y(o,e),m=un(o),x=O(w=>{var k,D,V;if(c){if(n.popoverState===1)return;switch(w.key){case J.Space:case J.Enter:w.preventDefault(),(D=(k=w.target).click)==null||D.call(k),r({type:1}),(V=n.button)==null||V.focus();break}}else switch(w.key){case J.Space:case J.Enter:w.preventDefault(),w.stopPropagation(),n.popoverState===1&&(l==null||l(n.buttonId)),r({type:0});break;case J.Escape:if(n.popoverState!==0)return l==null?void 0:l(n.buttonId);if(!o.current||(m==null?void 0:m.activeElement)&&!o.current.contains(m.activeElement))return;w.preventDefault(),w.stopPropagation(),r({type:1});break}}),f=O(w=>{c||w.key===J.Space&&w.preventDefault()}),g=O(w=>{var k,D;an(w.currentTarget)||t.disabled||(c?(r({type:1}),(k=n.button)==null||k.focus()):(w.preventDefault(),w.stopPropagation(),n.popoverState===1&&(l==null||l(n.buttonId)),r({type:0}),(D=n.button)==null||D.focus()))}),P=O(w=>{w.preventDefault(),w.stopPropagation()}),b=n.popoverState===0,S=d.exports.useMemo(()=>({open:b}),[b]),v=gr(t,o),E=t,I=c?{ref:h,type:v,onKeyDown:x,onClick:g}:{ref:y,id:n.buttonId,type:v,"aria-expanded":t.disabled?void 0:n.popoverState===0,"aria-controls":n.panel?n.panelId:void 0,onKeyDown:x,onKeyUp:f,onClick:g,onMouseDown:P},N=Er(),C=O(()=>{let w=n.panel;if(!w)return;function k(){z(N.current,{[ke.Forwards]:()=>Fe(w,Ce.First),[ke.Backwards]:()=>Fe(w,Ce.Last)})}k()});return _(X,{children:[G({ourProps:I,theirProps:E,slot:S,defaultTag:Mo,name:"Popover.Button"}),b&&!c&&i&&p(dt,{id:s,features:et.Focusable,as:"button",type:"button",onFocus:C})]})}),$o="div",zo=je.RenderStrategy|je.Static,_o=q(function(t,e){let[{popoverState:n},r]=wt("Popover.Overlay"),i=Y(e),o=`headlessui-popover-overlay-${ae()}`,s=gt(),a=(()=>s!==null?s===le.Open:n===0)(),l=O(c=>{if(an(c.currentTarget))return c.preventDefault();r({type:1})}),u=d.exports.useMemo(()=>({open:n===0}),[n]);return G({ourProps:{ref:i,id:o,"aria-hidden":!0,onClick:l},theirProps:t,slot:u,defaultTag:$o,features:zo,visible:a,name:"Popover.Overlay"})}),Fo="div",Ro=je.RenderStrategy|je.Static,Vo=q(function(t,e){let{focus:n=!1,...r}=t,[i,o]=wt("Popover.Panel"),{close:s,isPortalled:a}=yn("Popover.Panel"),l=`headlessui-focus-sentinel-before-${ae()}`,u=`headlessui-focus-sentinel-after-${ae()}`,c=d.exports.useRef(null),y=Y(c,e,E=>{o({type:4,panel:E})}),h=un(c),m=gt(),x=(()=>m!==null?m===le.Open:i.popoverState===0)(),f=O(E=>{var I;switch(E.key){case J.Escape:if(i.popoverState!==0||!c.current||(h==null?void 0:h.activeElement)&&!c.current.contains(h.activeElement))return;E.preventDefault(),E.stopPropagation(),o({type:1}),(I=i.button)==null||I.focus();break}});d.exports.useEffect(()=>{var E;t.static||i.popoverState===1&&((E=t.unmount)!=null?E:!0)&&o({type:4,panel:null})},[i.popoverState,t.unmount,t.static,o]),d.exports.useEffect(()=>{if(!n||i.popoverState!==0||!c.current)return;let E=h==null?void 0:h.activeElement;c.current.contains(E)||Fe(c.current,Ce.First)},[n,c,i.popoverState]);let g=d.exports.useMemo(()=>({open:i.popoverState===0,close:s}),[i,s]),P={ref:y,id:i.panelId,onKeyDown:f,onBlur:n&&i.popoverState===0?E=>{var I,N,C,w,k;let D=E.relatedTarget;!D||!c.current||(I=c.current)!=null&&I.contains(D)||(o({type:1}),(((C=(N=i.beforePanelSentinel.current)==null?void 0:N.contains)==null?void 0:C.call(N,D))||((k=(w=i.afterPanelSentinel.current)==null?void 0:w.contains)==null?void 0:k.call(w,D)))&&D.focus({preventScroll:!0}))}:void 0,tabIndex:-1},b=Er(),S=O(()=>{let E=c.current;if(!E)return;function I(){z(b.current,{[ke.Forwards]:()=>{Fe(E,Ce.First)},[ke.Backwards]:()=>{var N;(N=i.button)==null||N.focus({preventScroll:!0})}})}I()}),v=O(()=>{let E=c.current;if(!E)return;function I(){z(b.current,{[ke.Forwards]:()=>{var N,C,w;if(!i.button)return;let k=vr(),D=k.indexOf(i.button),V=k.slice(0,D+1),B=[...k.slice(D+1),...V];for(let Oe of B.slice())if(((C=(N=Oe==null?void 0:Oe.id)==null?void 0:N.startsWith)==null?void 0:C.call(N,"headlessui-focus-sentinel-"))||((w=i.panel)==null?void 0:w.contains(Oe))){let tt=B.indexOf(Oe);tt!==-1&&B.splice(tt,1)}Fe(B,Ce.First,!1)},[ke.Backwards]:()=>Fe(E,Ce.Last)})}I()});return T.createElement(pn.Provider,{value:i.panelId},x&&a&&p(dt,{id:l,ref:i.beforePanelSentinel,features:et.Focusable,as:"button",type:"button",onFocus:S}),G({ourProps:P,theirProps:r,slot:g,defaultTag:Fo,features:Ro,visible:x,name:"Popover.Panel"}),x&&a&&p(dt,{id:u,ref:i.afterPanelSentinel,features:et.Focusable,as:"button",type:"button",onFocus:v}))}),Bo="div",Uo=q(function(t,e){let n=d.exports.useRef(null),r=Y(n,e),[i,o]=d.exports.useState([]),s=O(x=>{o(f=>{let g=f.indexOf(x);if(g!==-1){let P=f.slice();return P.splice(g,1),P}return f})}),a=O(x=>(o(f=>[...f,x]),()=>s(x))),l=O(()=>{var x;let f=on(n);if(!f)return!1;let g=f.activeElement;return(x=n.current)!=null&&x.contains(g)?!0:i.some(P=>{var b,S;return((b=f.getElementById(P.buttonId))==null?void 0:b.contains(g))||((S=f.getElementById(P.panelId))==null?void 0:S.contains(g))})}),u=O(x=>{for(let f of i)f.buttonId!==x&&f.close()}),c=d.exports.useMemo(()=>({registerPopover:a,unregisterPopover:s,isFocusWithinPopoverGroup:l,closeOthers:u}),[a,s,l,u]),y=d.exports.useMemo(()=>({}),[]),h=t,m={ref:r};return T.createElement(xn.Provider,{value:c},G({ourProps:m,theirProps:h,slot:y,defaultTag:Bo,name:"Popover.Group"}))}),Mt=Object.assign(Oo,{Button:Ao,Overlay:_o,Panel:Vo,Group:Uo}),Lr=d.exports.createContext(null);function Tr(){let t=d.exports.useContext(Lr);if(t===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Tr),e}return t}function Ho(){let[t,e]=d.exports.useState([]);return[t.length>0?t.join(" "):void 0,d.exports.useMemo(()=>function(n){let r=O(o=>(e(s=>[...s,o]),()=>e(s=>{let a=s.slice(),l=a.indexOf(o);return l!==-1&&a.splice(l,1),a}))),i=d.exports.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props}),[r,n.slot,n.name,n.props]);return T.createElement(Lr.Provider,{value:i},n.children)},[e])]}let jo="label",Ko=q(function(t,e){let{passive:n=!1,...r}=t,i=Tr(),o=`headlessui-label-${ae()}`,s=Y(e);se(()=>i.register(o),[o,i.register]);let a={ref:s,...i.props,id:o};return n&&("onClick"in a&&delete a.onClick,"onClick"in r&&delete r.onClick),G({ourProps:a,theirProps:r,slot:i.slot||{},defaultTag:jo,name:i.name||"Label"})}),hn=d.exports.createContext(null);hn.displayName="GroupContext";let Wo=d.exports.Fragment;function Go(t){let[e,n]=d.exports.useState(null),[r,i]=Ho(),[o,s]=Eo(),a=d.exports.useMemo(()=>({switch:e,setSwitch:n,labelledby:r,describedby:o}),[e,n,r,o]),l={},u=t;return T.createElement(s,{name:"Switch.Description"},T.createElement(i,{name:"Switch.Label",props:{onClick(){!e||(e.click(),e.focus({preventScroll:!0}))}}},T.createElement(hn.Provider,{value:a},G({ourProps:l,theirProps:u,defaultTag:Wo,name:"Switch.Group"}))))}let qo="button",Yo=q(function(t,e){let{checked:n,defaultChecked:r=!1,onChange:i,name:o,value:s,...a}=t,l=`headlessui-switch-${ae()}`,u=d.exports.useContext(hn),c=d.exports.useRef(null),y=Y(c,e,u===null?null:u.setSwitch),[h,m]=wo(n,i,r),x=O(()=>m==null?void 0:m(!h)),f=O(v=>{if(an(v.currentTarget))return v.preventDefault();v.preventDefault(),x()}),g=O(v=>{v.key===J.Space?(v.preventDefault(),x()):v.key===J.Enter&&mo(v.currentTarget)}),P=O(v=>v.preventDefault()),b=d.exports.useMemo(()=>({checked:h}),[h]),S={id:l,ref:y,role:"switch",type:gr(t,c),tabIndex:0,"aria-checked":h,"aria-labelledby":u==null?void 0:u.labelledby,"aria-describedby":u==null?void 0:u.describedby,onClick:f,onKeyUp:g,onKeyPress:P};return _(X,{children:[o!=null&&h&&T.createElement(dt,{features:et.Hidden,...Wt({as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:h,name:o,value:s})}),G({ourProps:S,theirProps:a,slot:b,defaultTag:qo,name:"Switch"})]})}),Jo=Object.assign(Yo,{Group:Go,Label:Ko,Description:Io});function Zo(t){let e={called:!1};return(...n)=>{if(!e.called)return e.called=!0,t(...n)}}function At(t,...e){t&&e.length>0&&t.classList.add(...e)}function $t(t,...e){t&&e.length>0&&t.classList.remove(...e)}var Gt=(t=>(t.Ended="ended",t.Cancelled="cancelled",t))(Gt||{});function Xo(t,e){let n=mt();if(!t)return n.dispose;let{transitionDuration:r,transitionDelay:i}=getComputedStyle(t),[o,s]=[r,i].map(a=>{let[l=0]=a.split(",").filter(Boolean).map(u=>u.includes("ms")?parseFloat(u):parseFloat(u)*1e3).sort((u,c)=>c-u);return l});if(o+s!==0){let a=[];a.push(n.addEventListener(t,"transitionrun",l=>{l.target===l.currentTarget&&(a.splice(0).forEach(u=>u()),a.push(n.addEventListener(t,"transitionend",u=>{u.target===u.currentTarget&&(e("ended"),a.splice(0).forEach(c=>c()))}),n.addEventListener(t,"transitioncancel",u=>{u.target===u.currentTarget&&(e("cancelled"),a.splice(0).forEach(c=>c()))})))}))}else e("ended");return n.add(()=>e("cancelled")),n.dispose}function Qo(t,e,n,r){let i=n?"enter":"leave",o=mt(),s=r!==void 0?Zo(r):()=>{};i==="enter"&&(t.removeAttribute("hidden"),t.style.display="");let a=z(i,{enter:()=>e.enter,leave:()=>e.leave}),l=z(i,{enter:()=>e.enterTo,leave:()=>e.leaveTo}),u=z(i,{enter:()=>e.enterFrom,leave:()=>e.leaveFrom});return $t(t,...e.enter,...e.enterTo,...e.enterFrom,...e.leave,...e.leaveFrom,...e.leaveTo,...e.entered),At(t,...a,...u),o.nextFrame(()=>{$t(t,...u),At(t,...l),Xo(t,c=>(c==="ended"&&($t(t,...a),At(t,...e.entered)),s(c)))}),o.dispose}function es({container:t,direction:e,classes:n,onStart:r,onStop:i}){let o=Sr(),s=fr(),a=re(e);se(()=>{let l=mt();s.add(l.dispose);let u=t.current;if(!!u&&a.current!=="idle"&&!!o.current)return l.dispose(),r.current(a.current),l.add(Qo(u,n.current,a.current==="enter",c=>{l.dispose(),z(c,{[Gt.Ended](){i.current(a.current)},[Gt.Cancelled]:()=>{}})})),l.dispose},[e])}function Pe(t=""){return t.split(" ").filter(e=>e.trim().length>1)}let Pt=d.exports.createContext(null);Pt.displayName="TransitionContext";var ts=(t=>(t.Visible="visible",t.Hidden="hidden",t))(ts||{});function ns(){let t=d.exports.useContext(Pt);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function rs(){let t=d.exports.useContext(bt);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let bt=d.exports.createContext(null);bt.displayName="NestingContext";function Et(t){return"children"in t?Et(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function Nr(t,e){let n=re(t),r=d.exports.useRef([]),i=Sr(),o=fr(),s=O((m,x=te.Hidden)=>{let f=r.current.findIndex(({el:g})=>g===m);f!==-1&&(z(x,{[te.Unmount](){r.current.splice(f,1)},[te.Hidden](){r.current[f].state="hidden"}}),o.microTask(()=>{var g;!Et(r)&&i.current&&((g=n.current)==null||g.call(n))}))}),a=O(m=>{let x=r.current.find(({el:f})=>f===m);return x?x.state!=="visible"&&(x.state="visible"):r.current.push({el:m,state:"visible"}),()=>s(m,te.Unmount)}),l=d.exports.useRef([]),u=d.exports.useRef(Promise.resolve()),c=d.exports.useRef({enter:[],leave:[],idle:[]}),y=O((m,x,f)=>{l.current.splice(0),e&&(e.chains.current[x]=e.chains.current[x].filter(([g])=>g!==m)),e==null||e.chains.current[x].push([m,new Promise(g=>{l.current.push(g)})]),e==null||e.chains.current[x].push([m,new Promise(g=>{Promise.all(c.current[x].map(([P,b])=>b)).then(()=>g())})]),x==="enter"?u.current=u.current.then(()=>e==null?void 0:e.wait.current).then(()=>f(x)):f(x)}),h=O((m,x,f)=>{Promise.all(c.current[x].splice(0).map(([g,P])=>P)).then(()=>{var g;(g=l.current.shift())==null||g()}).then(()=>f(x))});return d.exports.useMemo(()=>({children:r,register:a,unregister:s,onStart:y,onStop:h,wait:u,chains:c}),[a,s,r,y,h,c,u])}function is(){}let os=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function zn(t){var e;let n={};for(let r of os)n[r]=(e=t[r])!=null?e:is;return n}function ss(t){let e=d.exports.useRef(zn(t));return d.exports.useEffect(()=>{e.current=zn(t)},[t]),e}let as="div",Dr=je.RenderStrategy,Or=q(function(t,e){let{beforeEnter:n,afterEnter:r,beforeLeave:i,afterLeave:o,enter:s,enterFrom:a,enterTo:l,entered:u,leave:c,leaveFrom:y,leaveTo:h,...m}=t,x=d.exports.useRef(null),f=Y(x,e),g=m.unmount?te.Unmount:te.Hidden,{show:P,appear:b,initial:S}=ns(),[v,E]=d.exports.useState(P?"visible":"hidden"),I=rs(),{register:N,unregister:C}=I,w=d.exports.useRef(null);d.exports.useEffect(()=>N(x),[N,x]),d.exports.useEffect(()=>{if(g===te.Hidden&&!!x.current){if(P&&v!=="visible"){E("visible");return}return z(v,{hidden:()=>C(x),visible:()=>N(x)})}},[v,x,N,C,P,g]);let k=re({enter:Pe(s),enterFrom:Pe(a),enterTo:Pe(l),entered:Pe(u),leave:Pe(c),leaveFrom:Pe(y),leaveTo:Pe(h)}),D=ss({beforeEnter:n,afterEnter:r,beforeLeave:i,afterLeave:o}),V=rn();d.exports.useEffect(()=>{if(V&&v==="visible"&&x.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[x,v,V]);let B=S&&!b,Oe=(()=>!V||B||w.current===P?"idle":P?"enter":"leave")(),tt=O(ce=>z(ce,{enter:()=>D.current.beforeEnter(),leave:()=>D.current.beforeLeave(),idle:()=>{}})),Br=O(ce=>z(ce,{enter:()=>D.current.afterEnter(),leave:()=>D.current.afterLeave(),idle:()=>{}})),nt=Nr(()=>{E("hidden"),C(x)},I);es({container:x,classes:k,direction:Oe,onStart:re(ce=>{nt.onStart(x,ce,tt)}),onStop:re(ce=>{nt.onStop(x,ce,Br),ce==="leave"&&!Et(nt)&&(E("hidden"),C(x))})}),d.exports.useEffect(()=>{!B||(g===te.Hidden?w.current=null:w.current=P)},[P,B,v]);let Ur=m,Hr={ref:f};return p(bt.Provider,{value:nt,children:p(br,{value:z(v,{visible:le.Open,hidden:le.Closed}),children:G({ourProps:Hr,theirProps:Ur,defaultTag:as,features:Dr,visible:v==="visible",name:"Transition.Child"})})})}),qt=q(function(t,e){let{show:n,appear:r=!1,unmount:i,...o}=t,s=d.exports.useRef(null),a=Y(s,e);rn();let l=gt();if(n===void 0&&l!==null&&(n=z(l,{[le.Open]:!0,[le.Closed]:!1})),![!0,!1].includes(n))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,c]=d.exports.useState(n?"visible":"hidden"),y=Nr(()=>{c("hidden")}),[h,m]=d.exports.useState(!0),x=d.exports.useRef([n]);se(()=>{h!==!1&&x.current[x.current.length-1]!==n&&(x.current.push(n),m(!1))},[x,n]);let f=d.exports.useMemo(()=>({show:n,appear:r,initial:h}),[n,r,h]);d.exports.useEffect(()=>{if(n)c("visible");else if(!Et(y))c("hidden");else{let P=s.current;if(!P)return;let b=P.getBoundingClientRect();b.x===0&&b.y===0&&b.width===0&&b.height===0&&c("hidden")}},[n,y]);let g={unmount:i};return p(bt.Provider,{value:y,children:p(Pt.Provider,{value:f,children:G({ourProps:{...g,as:d.exports.Fragment,children:T.createElement(Or,{ref:a,...g,...o})},theirProps:{},defaultTag:d.exports.Fragment,features:Dr,visible:u==="visible",name:"Transition"})})})}),ls=q(function(t,e){let n=d.exports.useContext(Pt)!==null,r=gt()!==null;return p(X,{children:!n&&r?T.createElement(qt,{ref:e,...t}):T.createElement(Or,{ref:e,...t})})}),pe=Object.assign(qt,{Child:ls,Root:qt});const Mr="splatapus.debugSettings",us=ve({shouldShowPoints:di}),cs={shouldShowPoints:!1};function ds(){const t=ie(yt),[e,n]=d.exports.useState(null),r=yr(e,16);return _(Mt,{className:"pointer-events-auto relative px-3 py-2 opacity-0 hover:opacity-100 ui-open:opacity-100",children:[p(Mt.Button,{as:oe,children:"!"}),p(pe,{className:"absolute bottom-12 right-3 origin-bottom-right",enter:"transition duration-200 ease-out-back",enterFrom:"opacity-0 scale-75",enterTo:"opacity-100",leave:"transition duration-300 ease-in-back",leaveFrom:"opacity-100",leaveTo:"opacity-0 scale-75",children:p(Mt.Panel,{ref:n,className:j("flex  w-60 flex-col gap-3 bg-stone-100 p-3"),style:{clipPath:r},children:p(ys,{label:"Show points",value:t.shouldShowPoints,onChange:i=>yt.update({...t,shouldShowPoints:i})})})})]})}function ys({label:t,value:e,onChange:n}){return _(Jo,{checked:e,onChange:n,as:xr,className:"justify-between py-1 pl-3 pr-1",children:[p("span",{children:t}),p("div",{className:"relative inline-flex h-6 w-10 rounded-full bg-stone-200 transition ui-checked:bg-green-400",children:p("div",{className:"absolute top-[2px] left-[2px] h-5 w-5 rounded-full bg-white transition ui-checked:translate-x-4"})})]})}function xs(){const t=Ft(Mr);try{return us(JSON.parse(t)).unwrap()}catch{return cs}}const yt=new K(xs(),"debugSettings");ut(fe.idle,()=>{Gn(Mr,JSON.stringify(yt.live()))});function ps(t){return ie(yt)[t]}const hs=T.memo(function({shapeId:e,splatapus:n}){const r=ps("shouldShowPoints"),i=H(()=>{if(n.location.shapeId.live()===e){const l=n.interaction.activeMode.live();switch(l.type){case A.Draw:{const u=l.previewPoints.live();return u.length?er(Xn(Qn(u,Je),Je),Je.size):null}case A.Rig:case A.Play:return null;default:throw U(l)}}return null},[n,e]),o=H(()=>{const l=n.document.live(),u=n.previewPosition.live(),c=pr.getCenterPointsAtPosition(l,e,u);if(c)return c;const y=n.keyPointIdHistory.live();for(let h=y.length-1;h>=0;h--){const m=l.getShapeVersion(y[h],e);if(m)return l.getNormalizedCenterPointsForShapeVersion(m.id)}return null},[e,n]),s=H(()=>n.location.shapeId.live()===e,[n,e]),a=i||o;return _(X,{children:[o&&p("path",{d:at(ct(o)),className:j(i?"fill-stone-300":s?"fill-stone-800":"fill-stone-600")}),i&&p("path",{d:at(ct(i)),className:j(s?"fill-stone-800":"fill-stone-600")}),r&&a&&a.map((l,u)=>p("circle",{cx:l.center.x,cy:l.center.y,r:l.radius,className:"fill-transparent stroke-cyan-400"},u))]})});function fs(t){const e=d.exports.useRef(t);return d.exports.useEffect(()=>{e.current=t},[t]),e.current}const vs=T.memo(function({splatapus:e}){const n=H(()=>e.interaction.getCanvasClassNameLive(),[e]),r=ie(e.viewport.isSidebarOpen),i=ie(e.viewport.screenSize),o=H(()=>e.viewport.getSceneTransformLive(),[e]),s=fs(r),[a,l]=d.exports.useState(!1);return d.exports.useLayoutEffect(()=>{l(!0);const u=setTimeout(()=>l(!1),400);return()=>clearTimeout(u)},[r]),p("svg",{viewBox:`0 0 ${i.x} ${i.y}`,className:j("absolute top-0 left-0",n),children:p("g",{style:{transform:o},className:j((a||r!==s)&&"transition-transform"),children:p(ms,{splatapus:e})})})}),ms=T.memo(function({splatapus:e}){return p(X,{children:Array.from(H(()=>e.document.live().shapes,[e]),n=>p(hs,{shapeId:n.id,splatapus:e},n.id))})});class gs{constructor(){this.state={type:"idle"}}onPointerDown(e){const{event:n,splatapus:r}=e;switch(this.state.type){case"idle":return this.state={type:"oneFingerDown",pointerA:{id:n.pointerId,startScreenPosition:L.fromEvent(n),currentScreenPosition:L.fromEvent(n),startEvent:n}},e;case"oneFingerDown":return this.state={type:"bothFingersDown",pointerA:this.state.pointerA,pointerB:{id:n.pointerId,startScreenPosition:L.fromEvent(n),currentScreenPosition:L.fromEvent(n),startEvent:n},initialViewportState:r.viewport.state.getOnce()},{splatapus:r,eventType:"cancel",event:this.state.pointerA.startEvent};case"bothFingersDown":return e;default:throw U(this.state)}}onPointerMove(e){const{event:n,splatapus:r}=e;switch(this.state.type){case"idle":return e;case"oneFingerDown":return this.state.pointerA.id===n.pointerId&&(this.state.pointerA.currentScreenPosition=L.fromEvent(n)),e;case"bothFingersDown":if(n.pointerId===this.state.pointerA.id||n.pointerId===this.state.pointerB.id){const i=n.pointerId===this.state.pointerA.id?L.fromEvent(n):this.state.pointerA.currentScreenPosition,o=n.pointerId===this.state.pointerB.id?L.fromEvent(n):this.state.pointerB.currentScreenPosition,s=this.state.pointerA.startScreenPosition.distanceTo(this.state.pointerB.startScreenPosition),l=i.distanceTo(o)/s,u=this.state.pointerA.startScreenPosition.lerp(this.state.pointerB.startScreenPosition,.5),c=i.lerp(o,.5),y=u.add(this.state.initialViewportState.pan).scale(l).sub(c);return r.viewport.state.update({zoom:this.state.initialViewportState.zoom*l,pan:y}),this.state.pointerA.currentScreenPosition=i,this.state.pointerB.currentScreenPosition=o,null}return e;default:throw U(this.state)}}onPointerUp(e){const{event:n}=e;switch(this.state.type){case"idle":return e;case"oneFingerDown":return n.pointerId===this.state.pointerA.id&&(this.state={type:"idle"}),e;case"bothFingersDown":return n.pointerId===this.state.pointerA.id||n.pointerId===this.state.pointerB.id?(this.state={type:"idle"},null):e;default:throw U(this.state)}}onPointerCancel(e){return this.onPointerUp(e)}}const ws=10,Ps=en,Ar=()=>null;class bs{constructor({onTap:e=Ps,onDragStart:n=Ar}){this.state={type:"idle"},this.lastEvent=null,this.onTap=e,this.onDragStart=n}isGestureInProgress(){return this.state.type!=="idle"}onPointerDown(e,...n){var r,i;switch(this.lastEvent=e,this.state.type){case"idle":{const o=this.onDragStart(e,...n);if(!o)return;(r=o.couldBeTap)==null||r?this.state={type:"dragUnconfirmed",pointerId:e.pointerId,startPosition:L.fromEvent(e),dragHandler:o,args:n}:(this.state={type:"dragConfirmed",pointerId:e.pointerId,dragHandler:o},(i=o.onConfirm)==null||i.call(o,e));return}case"dragUnconfirmed":case"dragConfirmed":return;default:U(this.state)}}onPointerMove(e){var n,r;switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onMove(e),this.state.startPosition.distanceTo(L.fromEvent(e))>=ws&&((r=(n=this.state.dragHandler).onConfirm)==null||r.call(n,e),this.state={type:"dragConfirmed",pointerId:this.state.pointerId,dragHandler:this.state.dragHandler});return;case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onMove(e);return;default:U(this.state)}}onPointerUp(e){switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onCancel(e),this.onTap(e,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onEnd(e),this.state={type:"idle"};return;default:U(this.state)}}onPointerCancel(e){switch(this.lastEvent=e,this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":if(this.state.pointerId!==e.pointerId)return;this.state.dragHandler.onCancel(e),this.state={type:"idle"};return;default:U(this.state)}}cancel(){switch(this.state.type){case"idle":return;case"dragUnconfirmed":case"dragConfirmed":this.state.dragHandler.onCancel(Z(this.lastEvent)),this.state={type:"idle"};return;default:U(this.state)}}end(){const e=Z(this.lastEvent);switch(this.state.type){case"idle":return;case"dragUnconfirmed":this.state.dragHandler.onCancel(e),this.onTap(e,...this.state.args),this.state={type:"idle"};return;case"dragConfirmed":this.state.dragHandler.onEnd(e),this.state={type:"idle"};return;default:U(this.state)}}}function Es(t,e){switch(e.eventType){case"down":return t.onPointerDown(e);case"move":return t.onPointerMove(e);case"up":return t.onPointerUp(e);case"cancel":return t.onPointerCancel(e);default:U(e.eventType)}}class fn{constructor({onTap:e,onDragStart:n}){this.isDragging=new K(!1,"Gesture.isDragging"),this.isDragConfirmed=new K(!1,"Gesture.isDragConfirmed");const r=n!=null?n:Ar;this.gesture=new bs({onTap:e,onDragStart:(i,o,...s)=>{const a=r(i,o,...s);return a?(this.isDragging.update(!0),{couldBeTap:a.couldBeTap,onMove:a.onMove,onEnd:l=>(this.isDragging.update(!1),this.isDragConfirmed.update(!1),a.onEnd(l)),onCancel:l=>(this.isDragging.update(!1),this.isDragConfirmed.update(!1),a.onCancel(l)),onConfirm:l=>{if(this.isDragConfirmed.update(!1),a.onConfirm)return a.onConfirm(l)}}):null}})}onPointerEvent(e,...n){switch(e.eventType){case"down":return this.gesture.onPointerDown(e.event,e.splatapus,...n);case"move":return this.gesture.onPointerMove(e.event);case"up":return this.gesture.onPointerUp(e.event);case"cancel":return this.gesture.onPointerCancel(e.event);default:U(e.eventType)}}end(){this.gesture.end()}cancel(){this.gesture.end()}}class Ss{constructor(){this.type=A.Draw,this.previewPoints=new K([],"DrawMode.previewPoints"),this.gesture=new fn({onDragStart:(e,{viewport:n,location:r,document:i})=>(this.previewPoints.update([n.eventSceneCoords(e)]),{couldBeTap:!1,onMove:o=>this.previewPoints.update(s=>[...s,n.eventSceneCoords(o)]),onEnd:o=>{const s=this.previewPoints.getOnce();this.previewPoints.update([]),i.update(a=>a.replacePointsForVersion(r.keyPointId.getOnce(),r.shapeId.getOnce(),s))},onCancel:()=>{this.previewPoints.update([])}})})}isIdleLive(){return!this.gesture.isDragging.live()}toDebugStringLive(){return Ue("draw",this.isIdleLive()?{_:"idle"}:{_:"drawing",points:this.previewPoints.live().length})}onPointerEvent(e){this.gesture.onPointerEvent(e)}getPreviewPositionLive(){return null}renderOverlay(){return null}}const Yt={interpolated:t=>({type:"interpolated",scenePosition:t}),keyPointId:t=>({type:"keyPointId",keyPointId:t}),toDebugString:t=>{switch(t.type){case"interpolated":return Ue(t.type,{_:t.scenePosition.toString(2)});case"keyPointId":return Ue(t.type,{_:t.keyPointId});default:U(t)}}};function $r({splatapus:t,keyPointId:e,width:n,height:r,className:i}){const s=H(()=>{const b=t.document.live();return qn(Array.from(b.shapes,S=>{const v=pr.getCenterPointsAtPosition(b,S.id,Yt.keyPointId(e));return v?{centerPoints:v,svg:oo(v),shapeId:S.id}:null}))},[t,e]),{minX:a,minY:l,maxX:u,maxY:c}=d.exports.useMemo(()=>{let b=1/0,S=1/0,v=-1/0,E=-1/0;for(const I of s)for(const{center:N,radius:C}of I.centerPoints)b=Math.min(b,N.x-C),v=Math.max(v,N.x+C),S=Math.min(S,N.y-C),E=Math.max(E,N.y+C);return{minX:b,minY:S,maxX:v,maxY:E}},[s]);if(!s.length)return null;const y=u-a,h=c-l,m=n-4*2,x=r-4*2,f=Math.min(m/y,.8),g=Math.min(x/h,.8),P=Math.min(f,g);return p("svg",{viewBox:`0 0 ${n} ${r}`,style:{width:n,height:r},children:p("g",{transform:`translate(${4+Math.max(m-y*P,0)/2}, ${4+Math.max(x-h*P,0)/2}) scale(${P}) translate(${-a}, ${-l})`,children:s.map(({svg:b,shapeId:S})=>p("path",{d:b,className:"fill-stone-800"},S))})})}function Is(t){const e=d.exports.useRef(t);return d.exports.useEffect(()=>{t!=null&&(e.current=t)},[t]),t!=null?t:e.current}function Jt(){return Jt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jt.apply(this,arguments)}function vn(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Zt(t,e){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Zt(t,e)}function mn(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Zt(t,e)}function Cs(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function ks(t,e){t.classList?t.classList.add(e):Cs(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function _n(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Ls(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=_n(t.className,e):t.setAttribute("class",_n(t.className&&t.className.baseVal||"",e))}const Fn={disabled:!1},xt=T.createContext(null);var zr=function(e){return e.scrollTop},qe="unmounted",Ee="exited",Se="entering",ze="entered",Xt="exiting",ue=function(t){mn(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var s=i,a=s&&!s.isMounting?r.enter:r.appear,l;return o.appearStatus=null,r.in?a?(l=Ee,o.appearStatus=Se):l=ze:r.unmountOnExit||r.mountOnEnter?l=qe:l=Ee,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(i,o){var s=i.in;return s&&o.status===qe?{status:Ee}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var o=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==Se&&s!==ze&&(o=Se):(s===Se||s===ze)&&(o=Xt)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,o,s,a;return o=s=a=i,i!=null&&typeof i!="number"&&(o=i.exit,s=i.enter,a=i.appear!==void 0?i.appear:s),{exit:o,enter:s,appear:a}},n.updateStatus=function(i,o){if(i===void 0&&(i=!1),o!==null)if(this.cancelNextCallback(),o===Se){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:rt.findDOMNode(this);s&&zr(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ee&&this.setState({status:qe})},n.performEnter=function(i){var o=this,s=this.props.enter,a=this.context?this.context.isMounting:i,l=this.props.nodeRef?[a]:[rt.findDOMNode(this),a],u=l[0],c=l[1],y=this.getTimeouts(),h=a?y.appear:y.enter;if(!i&&!s||Fn.disabled){this.safeSetState({status:ze},function(){o.props.onEntered(u)});return}this.props.onEnter(u,c),this.safeSetState({status:Se},function(){o.props.onEntering(u,c),o.onTransitionEnd(h,function(){o.safeSetState({status:ze},function(){o.props.onEntered(u,c)})})})},n.performExit=function(){var i=this,o=this.props.exit,s=this.getTimeouts(),a=this.props.nodeRef?void 0:rt.findDOMNode(this);if(!o||Fn.disabled){this.safeSetState({status:Ee},function(){i.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:Xt},function(){i.props.onExiting(a),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:Ee},function(){i.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,o){o=this.setNextCallback(o),this.setState(i,o)},n.setNextCallback=function(i){var o=this,s=!0;return this.nextCallback=function(a){s&&(s=!1,o.nextCallback=null,i(a))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},n.onTransitionEnd=function(i,o){this.setNextCallback(o);var s=this.props.nodeRef?this.props.nodeRef.current:rt.findDOMNode(this),a=i==null&&!this.props.addEndListener;if(!s||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],u=l[0],c=l[1];this.props.addEndListener(u,c)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===qe)return null;var o=this.props,s=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var a=vn(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return p(xt.Provider,{value:null,children:typeof s=="function"?s(i,a):T.cloneElement(T.Children.only(s),a)})},e}(T.Component);ue.contextType=xt;ue.propTypes={};function Ae(){}ue.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Ae,onEntering:Ae,onEntered:Ae,onExit:Ae,onExiting:Ae,onExited:Ae};ue.UNMOUNTED=qe;ue.EXITED=Ee;ue.ENTERING=Se;ue.ENTERED=ze;ue.EXITING=Xt;const Ts=ue;var Ns=function(e,n){return e&&n&&n.split(" ").forEach(function(r){return ks(e,r)})},zt=function(e,n){return e&&n&&n.split(" ").forEach(function(r){return Ls(e,r)})},gn=function(t){mn(e,t);function e(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=t.call.apply(t,[this].concat(o))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(a,l){var u=r.resolveArguments(a,l),c=u[0],y=u[1];r.removeClasses(c,"exit"),r.addClass(c,y?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(a,l)},r.onEntering=function(a,l){var u=r.resolveArguments(a,l),c=u[0],y=u[1],h=y?"appear":"enter";r.addClass(c,h,"active"),r.props.onEntering&&r.props.onEntering(a,l)},r.onEntered=function(a,l){var u=r.resolveArguments(a,l),c=u[0],y=u[1],h=y?"appear":"enter";r.removeClasses(c,h),r.addClass(c,h,"done"),r.props.onEntered&&r.props.onEntered(a,l)},r.onExit=function(a){var l=r.resolveArguments(a),u=l[0];r.removeClasses(u,"appear"),r.removeClasses(u,"enter"),r.addClass(u,"exit","base"),r.props.onExit&&r.props.onExit(a)},r.onExiting=function(a){var l=r.resolveArguments(a),u=l[0];r.addClass(u,"exit","active"),r.props.onExiting&&r.props.onExiting(a)},r.onExited=function(a){var l=r.resolveArguments(a),u=l[0];r.removeClasses(u,"exit"),r.addClass(u,"exit","done"),r.props.onExited&&r.props.onExited(a)},r.resolveArguments=function(a,l){return r.props.nodeRef?[r.props.nodeRef.current,a]:[a,l]},r.getClassNames=function(a){var l=r.props.classNames,u=typeof l=="string",c=u&&l?l+"-":"",y=u?""+c+a:l[a],h=u?y+"-active":l[a+"Active"],m=u?y+"-done":l[a+"Done"];return{baseClassName:y,activeClassName:h,doneClassName:m}},r}var n=e.prototype;return n.addClass=function(i,o,s){var a=this.getClassNames(o)[s+"ClassName"],l=this.getClassNames("enter"),u=l.doneClassName;o==="appear"&&s==="done"&&u&&(a+=" "+u),s==="active"&&i&&zr(i),a&&(this.appliedClasses[o][s]=a,Ns(i,a))},n.removeClasses=function(i,o){var s=this.appliedClasses[o],a=s.base,l=s.active,u=s.done;this.appliedClasses[o]={},a&&zt(i,a),l&&zt(i,l),u&&zt(i,u)},n.render=function(){var i=this.props;i.classNames;var o=vn(i,["classNames"]);return p(Ts,{...o,onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited})},e}(T.Component);gn.defaultProps={classNames:""};gn.propTypes={};const Ds=gn;function Os(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wn(t,e){var n=function(o){return e&&d.exports.isValidElement(o)?e(o):o},r=Object.create(null);return t&&d.exports.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function Ms(t,e){t=t||{},e=e||{};function n(c){return c in e?e[c]:t[c]}var r=Object.create(null),i=[];for(var o in t)o in e?i.length&&(r[o]=i,i=[]):i.push(o);var s,a={};for(var l in e){if(r[l])for(s=0;s<r[l].length;s++){var u=r[l][s];a[r[l][s]]=n(u)}a[l]=n(l)}for(s=0;s<i.length;s++)a[i[s]]=n(i[s]);return a}function Le(t,e,n){return n[e]!=null?n[e]:t.props[e]}function As(t,e){return wn(t.children,function(n){return d.exports.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:Le(n,"appear",t),enter:Le(n,"enter",t),exit:Le(n,"exit",t)})})}function $s(t,e,n){var r=wn(t.children),i=Ms(e,r);return Object.keys(i).forEach(function(o){var s=i[o];if(!!d.exports.isValidElement(s)){var a=o in e,l=o in r,u=e[o],c=d.exports.isValidElement(u)&&!u.props.in;l&&(!a||c)?i[o]=d.exports.cloneElement(s,{onExited:n.bind(null,s),in:!0,exit:Le(s,"exit",t),enter:Le(s,"enter",t)}):!l&&a&&!c?i[o]=d.exports.cloneElement(s,{in:!1}):l&&a&&d.exports.isValidElement(u)&&(i[o]=d.exports.cloneElement(s,{onExited:n.bind(null,s),in:u.props.in,exit:Le(s,"exit",t),enter:Le(s,"enter",t)}))}}),i}var zs=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},_s={component:"div",childFactory:function(e){return e}},Pn=function(t){mn(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var s=o.handleExited.bind(Os(o));return o.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,o){var s=o.children,a=o.handleExited,l=o.firstRender;return{children:l?As(i,a):$s(i,s,a),firstRender:!1}},n.handleExited=function(i,o){var s=wn(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(o),this.mounted&&this.setState(function(a){var l=Jt({},a.children);return delete l[i.key],{children:l}}))},n.render=function(){var i=this.props,o=i.component,s=i.childFactory,a=vn(i,["component","childFactory"]),l=this.state.contextValue,u=zs(this.state.children).map(s);return delete a.appear,delete a.enter,delete a.exit,o===null?p(xt.Provider,{value:l,children:u}):p(xt.Provider,{value:l,children:p(o,{...a,children:u})})},e}(T.Component);Pn.propTypes={};Pn.defaultProps=_s;const Fs=Pn,Rs=80,Vs=64;function _r(t,e){return e.y>t.screenSize.live().y-Rs}const bn=class{constructor(){this.type=A.Rig,this.previewMovement=new K(null,"RigMode.previewMovement"),this.previewPosition=new K(null,"RigMode.previewPosition"),this.gesture=new fn({onTap:(t,{location:e},n)=>{!n||e.keyPointId.update(n.id)},onDragStart:(t,{viewport:e,document:n,location:r},i)=>{if(t.preventDefault(),!i)return this.previewPosition.update(e.eventSceneCoords(t)),{couldBeTap:!1,onMove:a=>this.previewPosition.update(e.eventSceneCoords(a)),onEnd:()=>this.previewPosition.update(null),onCancel:()=>this.previewPosition.update(null)};r.keyPointId.update(i.id);const o=e.eventSceneCoords(t),s=i.initialScenePosition;return{couldBeTap:!0,onMove:a=>{this.previewMovement.update({keyPointId:i.id,scenePosition:e.eventSceneCoords(a).sub(o).add(s)})},onEnd:a=>{const l=e.eventSceneCoords(a).sub(o).add(s),u=Qe(()=>_r(e,e.sceneToScreenLive(l)));this.previewMovement.update(null),n.update(c=>c.updateKeyPoint(i.id,y=>({...y,position:u?null:l})))},onCancel:a=>{this.previewMovement.update(null)}}}})}isIdleLive(){return!this.gesture.isDragging.live()}toDebugStringLive(){const t=this.previewMovement.live(),e=this.previewPosition.live();return Ue("rig",e?{_:"preview",position:e.toString(2)}:t?{_:"moving",keyPointId:t.keyPointId,delta:t.scenePosition.toString(2)}:{_:"idle"})}onPointerEvent(t){this.gesture.onPointerEvent(t)}getPreviewPositionLive(){return this.previewPosition.live()}renderOverlay(t){return p(bn.Overlay,{splatapus:t,mode:this})}};let St=bn;St.Overlay=function({splatapus:e,mode:n}){const{points:r,pointsInDock:i,size:o,isAnyDragging:s,maxScreenProgress:a,minScreenProgress:l}=H(()=>{const P=e.viewport.screenSizeWithSidebarOpenLive(),b=n==null?void 0:n.previewMovement.live(),S=e.location.keyPointId.live();let v=0,E=1/0,I=-1/0;return{points:Array.from(e.document.live().keyPoints,(C,w)=>{const k=(b==null?void 0:b.keyPointId)===C.id?e.viewport.sceneToScreenLive(b.scenePosition):null,D=C.position?e.viewport.sceneToScreenLive(C.position):null,V=k?_r(e.viewport,k):!C.position;let B=null;return D&&(B=D.dot(P)/P.dot(P),E=Math.min(E,B),I=Math.max(I,B)),{dockIndex:V?v++:null,keyPoint:C,overallIndex:w,isSelected:C.id===S,screenPosition:k!=null?k:D,isDragging:!!k,screenProgress:B}}),pointsInDock:v,size:P,isAnyDragging:!!b,minScreenProgress:E,maxScreenProgress:I}},[e,n]),u=!!n,[c,y]=d.exports.useState(u),h=new L(o.x/2,o.y+50),[m,x]=d.exports.useState(null),f=r.find(P=>P.dockIndex!==null&&P.keyPoint.id===m),g=Is(f);return console.log({dockedHovered:f,prevDockedHovered:g}),console.log("render"),_(X,{children:[p(pe,{show:u,className:"absolute left-0 right-0 bottom-0 z-10 h-24 bg-white/50 backdrop-blur-md ",enter:"transition duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",beforeEnter:()=>requestAnimationFrame(()=>y(!0)),beforeLeave:()=>y(!1)}),r.map(P=>p(bn.KeyPoint,{shouldShow:u,shouldShowDock:c,splatapus:e,mode:n,screenSize:o,pointsInDock:i,exitPosition:h,isAnyDragging:s,minScreenProgress:l,maxScreenProgress:a,onPointerEnter:()=>x(P.keyPoint.id),onPointerLeave:()=>x(null),...P},P.keyPoint.id)),p(pe,{show:u&&i>0,className:"duration pointer-events-none absolute bottom-2 z-10 text-center font-semibold text-stone-400",enter:"transition duration-500",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition duration-75",leaveFrom:"opacity-100",leaveTo:"opacity-0",style:{width:o.x,transitionDelay:u?`${i*30+400}ms`:"0ms"},children:"drag each key point into the canvas"}),g&&p(pe,{show:!s&&!!f,className:"pointer-events-none absolute bottom-24 z-10 -mt-16 -ml-10 h-16 w-20 origin-bottom overflow-hidden rounded border border-stone-300 bg-stone-50 shadow-md transition",enter:"ease-out",enterFrom:"translate-y-4 opacity-0 scale-75",enterTo:"translate-y-0 opacity-100 scale-100",leave:"ease-in",leaveFrom:"translate-y-0 opacity-100 scale-100",leaveTo:"translate-y-4 opacity-0 scale-75",style:{left:o.x/2,transform:`translateX(${(Z((f!=null?f:g).dockIndex)-(i-1)/2)*56}px) translateY(var(--tw-translate-y)) scale(var(--tw-scale-x), var(--tw-scale-y))`},children:p(Fs,{children:p(Ds,{timeout:300,classNames:{enter:"transition-opacity bg-stone-50 absolute",enterActive:"transition-opacity bg-stone-50 absolute",enterDone:"transition-opacity bg-stone-50 absolute",exit:"transition-opacity opacity-0 bg-stone-50 absolute",exitActive:"transition-opacity opacity-0 bg-stone-50 absolute",exitDone:"transition-opacity opacity-0 bg-stone-50 absolute"},children:p($r,{width:78,height:62,keyPointId:g.keyPoint.id,splatapus:e})},g.keyPoint.id)})})]})};St.KeyPoint=function({dockIndex:e,screenPosition:n,shouldShowDock:r,shouldShow:i,screenSize:o,pointsInDock:s,keyPoint:a,exitPosition:l,isDragging:u,mode:c,splatapus:y,isSelected:h,isAnyDragging:m,overallIndex:x,screenProgress:f,minScreenProgress:g,maxScreenProgress:P,onPointerEnter:b,onPointerLeave:S}){const[v,E]=d.exports.useState(!!c),I=e!==null;n||(M(e!==null,"Assertion Error: dockIndex !== null"),n=r?new L(o.x/2+(e-(s-1)/2)*56,o.y-Vs):l);const[N,C]=d.exports.useState(!1);return _(X,{children:[p(pe,{show:i,className:j("absolute top-0 left-0 flex cursor-move items-center justify-center",I?"-mt-7 -ml-7 h-14 w-14":"-mt-5 -ml-5 h-10 w-10 rounded-full",u?"z-20":I?"z-10":"z-[5]",!u&&(i?e!==null&&"transition duration-300 ease-out-back":e!==null&&"transition duration-200 ease-in")),enter:I?"transition-transform duration-300 ease-out-back":"transition-transform duration-200 ease-out-back",enterFrom:I?"scale-50":"scale-0",enterTo:"scale-100",leave:I?"transition-transform duration-200 ease-in":"transition-transform duration-200 ease-in-back",leaveFrom:"scale-100",leaveTo:I?"scale-50":"scale-0",afterEnter:()=>E(!0),beforeLeave:()=>E(!1),onPointerEnter:w=>{C(!0),b(w)},onPointerLeave:w=>{C(!1),S(w)},onPointerDown:w=>{!c||c.gesture.onPointerEvent({event:w,eventType:"down",splatapus:y},{id:a.id,initialScenePosition:Qe(()=>y.viewport.screenToSceneLive(Z(n)))})},style:{transform:`translate(${n.x}px, ${n.y}px) scale(var(--tw-scale-x), var(--tw-scale-y))`,transitionDelay:m?"0ms":I?`${e*25}ms`:v?"0ms":`${Gr(g,P,0,200,Z(f))}ms`},children:p("div",{className:j("flex h-6 w-6 items-center justify-center rounded-full text-xs font-bold shadow-md transition-transform duration-200 ease-out-back-md",I?"scale-150":"scale-100",h?"bg-gradient-to-br from-cyan-400 to-blue-400 text-white":"border border-stone-200 bg-white text-stone-400"),children:x+1})},a.id),p(pe,{show:N&&!I&&!m,className:"pointer-events-none absolute top-0 left-0 z-[4]",style:{transform:`translate(${n.x}px, ${n.y-24}px)`},children:p(pe.Child,{className:"-mt-16 -ml-10 h-16 w-20 origin-bottom rounded border border-stone-300 bg-stone-50 shadow-md",enter:"transition ease-out",enterFrom:"translate-y-4 opacity-0 scale-75",enterTo:"translate-y-0 opacity-100 scale-100",leave:"transition ease-in",leaveFrom:"translate-y-0 opacity-100 scale-100",leaveTo:"translate-y-4 opacity-0 scale-75",children:p($r,{width:78,height:62,keyPointId:a.id,splatapus:y})})})]})};class Bs{constructor(){this.isKeyDown=new K(!1,"QuickPan.isKeyDown"),this.gesture=new fn({onDragStart:(e,n)=>{const r=n.viewport.pan.getOnce();let i=L.fromEvent(e);return{couldBeTap:!1,onMove:o=>{const s=L.fromEvent(o),a=i.sub(s);n.viewport.pan.update(l=>l.add(a)),i=s},onEnd:en,onCancel:()=>{n.viewport.pan.update(r)}}}}),this.isDragging=this.gesture.isDragging}onKeyDown({event:e}){return $e(e," ")?(this.isKeyDown.update(!0),!0):!1}onKeyUp({event:e}){return this.isKeyDown.getOnce()&&ei(e," ")?(this.isKeyDown.update(!1),this.gesture.end(),!0):!1}getCanvasClassNameLive(){if(this.isKeyDown.live()){if(this.isDragging.live())return"cursor-grabbing"}else return null;return"cursor-grab"}onPointerEvent(e){this.gesture.onPointerEvent(e)}toDebugStringLive(){return this.isKeyDown.live()?Ue("quickPan",{dragging:this.isDragging.live()}):null}}const W={initialize:t=>({undoStates:[],redoStates:[],pendingOp:null,current:{...t,options:{}}}),canUndo:t=>t.undoStates.length>0,canRedo:t=>{var e,n;return((n=(e=t.redoStates)==null?void 0:e.length)!=null?n:0)>0},beginOperation:t=>{const e=Math.random();return M(t.pendingOp==null,"pending op already in progress"),{undoStack:{...t,pendingOp:{txId:e,initialDoc:t.current.document,initialOptions:t.current.options},current:{...t.current,options:{}}},txId:e}},updateOperation:(t,e,n)=>{var r;return M(((r=t.pendingOp)==null?void 0:r.txId)===e,"pending op mismatch"),{...t,current:{...t.current,document:Ie(t.current.document,n)}}},revertOperation:(t,e)=>{var n;return M(((n=t.pendingOp)==null?void 0:n.txId)===e,"Pending op mismatch"),{...t,pendingOp:null,current:{document:t.pendingOp.initialDoc,location:t.current.location,options:t.pendingOp.initialOptions}}},commitOperation:(t,e,n={})=>{var o;M(((o=t.pendingOp)==null?void 0:o.txId)===e,"Pending op mismatch");const r=[{document:t.pendingOp.initialDoc,location:t.current.location,options:t.pendingOp.initialOptions},...t.undoStates];for(;r.length>xi;)r.pop();const i={...t.current,options:n};return n.lockstepLocation&&(i.location=Ie(i.location,n.lockstepLocation)),{...t,current:i,pendingOp:null,undoStates:r,redoStates:null}},updateDocument:(t,e,n)=>{let r;return{undoStack:t,txId:r}=W.beginOperation(t),t=W.updateOperation(t,r,e),W.commitOperation(t,r,n)},undo:(t,e)=>{var o;if(M(t.pendingOp==null,"Pending op in progress"),t.undoStates.length==0)return t;e.triggerAnimation("undo");const[n,...r]=t.undoStates;if(!Rt(n.location,t.current.location)&&!t.current.options.lockstepLocation)return{...t,current:{...t.current,location:n.location}};const i=[t.current,...(o=t.redoStates)!=null?o:[]];return{...t,current:n,undoStates:r,redoStates:i}},redo:(t,e)=>{if(M(t.pendingOp==null,"pending op in progress"),!t.redoStates||t.redoStates.length==0)return t;e.triggerAnimation("redo");const[n,...r]=t.redoStates;if(!Rt(n.location,t.current.location)&&!n.options.lockstepLocation)return{...t,current:{...t.current,location:n.location}};const i=[t.current,...t.undoStates];return{...t,current:n.options.lockstepLocation?{...n,location:Ie(t.current.location,n.options.lockstepLocation)}:n,undoStates:i,redoStates:r.length===0?null:r}},updateLocation:(t,e)=>({...t,current:{...t.current,location:Ie(t.current.location,e)}})};class Us{constructor(){this.type=A.Play,this.previewPosition=new K(null,"PlayMode.previewPosition")}isIdleLive(){return!0}toDebugStringLive(){var e,n;return Ue("play",{_:(n=(e=this.previewPosition.live())==null?void 0:e.toString(2))!=null?n:null})}onPointerEvent({event:e,eventType:n,splatapus:r}){switch(n){case"move":case"down":e.isPrimary&&this.previewPosition.update(r.viewport.eventSceneCoords(e));return;case"cancel":case"up":return;default:U(n)}}getPreviewPositionLive(){return this.previewPosition.live()}renderOverlay(){return null}}function _t(t){switch(t){case A.Draw:return new Ss;case A.Rig:return new St;case A.Play:return new Us;default:U(t)}}const Hs={[A.Draw]:"d",[A.Rig]:"r",[A.Play]:"p"};class js{constructor(e){this.multiTouchPan=new gs,this.quickPan=new Bs,this.activeMode=new K(_t(e),"Interaction.activeMode"),this.activeMode.addBatchInvalidateListener(()=>this.activeMode.getOnce())}toDebugStringLive(){var e;return(e=this.quickPan.toDebugStringLive())!=null?e:this.activeMode.live().toDebugStringLive()}getCanvasClassNameLive(){return this.quickPan.getCanvasClassNameLive()}getPreviewPositionLive(){return this.activeMode.live().getPreviewPositionLive()}isSidebarOpenLive(){return this.activeMode.live().type!==A.Play}requestSetActiveMode(e){this.quickPan.isKeyDown.getOnce()||this.activeMode.update(n=>Qe(()=>!n.isIdleLive())?n:_t(e))}onKeyDown(e){var r;const n=this.activeMode.getOnce();if(Qe(()=>n.isIdleLive())){if(this.quickPan.onKeyDown(e)||this.quickPan.isKeyDown.getOnce())return;for(const[i,o]of qr(Hs))if($e(e.event,o)){const s=_t(i);e.splatapus.vfx.triggerAnimation(i),this.activeMode.update(s);return}if($e(e.event,{key:"z",command:!0})){e.splatapus.undoStack.update(i=>W.undo(i,e.splatapus.vfx));return}if($e(e.event,{key:"z",command:!0,shift:!0})){e.splatapus.undoStack.update(i=>W.redo(i,e.splatapus.vfx));return}}if($e(e.event,{key:"0",command:!0})){e.splatapus.viewport.pan.update(L.ZERO),e.splatapus.viewport.zoom.update(1);return}for(let i=0;i<9;i++)if($e(e.event,`${i+1}`)){const o=(r=[...e.splatapus.document.getOnce().keyPoints][i])==null?void 0:r.id;if(o){e.splatapus.location.keyPointId.update(o);return}}}onKeyUp(e){this.quickPan.onKeyUp(e)}onPointerEvent(e){const n=Es(this.multiTouchPan,e);!n||(this.quickPan.isKeyDown.getOnce()?this.quickPan.onPointerEvent(n):this.activeMode.getOnce().onPointerEvent(n))}}class Ks{constructor(e,n){this.screenSize=e,this.vfx=new Ji,this.location=new Ui(new xe(()=>this.undoStack.live().current.location,r=>this.undoStack.update(i=>W.updateLocation(i,r)),"location")),this.document=new xe(()=>this.undoStack.live().current.document,(r,i)=>this.undoStack.update(o=>W.updateDocument(o,r,i)),"document"),this.viewport=new Vi(this.screenSize,new lt(()=>this.interaction.isSidebarOpenLive(),"viewport.isSidebarOpen"),this.location.viewportState),this.onPointerDown=r=>this.onPointerEvent("down",r),this.onPointerMove=r=>this.onPointerEvent("move",r),this.onPointerUp=r=>this.onPointerEvent("up",r),this.onPointerCancel=r=>this.onPointerEvent("cancel",r),this.onWheel=r=>{this.viewport.handleWheelEvent(r)},this.onKeyDown=r=>this.interaction.onKeyDown({event:r,splatapus:this}),this.onKeyUp=r=>this.interaction.onKeyUp({event:r,splatapus:this}),this.previewPosition=new lt(()=>{const r=this.interaction.getPreviewPositionLive();return r?Yt.interpolated(r):Yt.keyPointId(this.location.keyPointId.live())},"previewPosition"),this.undoStack=new K(W.initialize(n),"undoStack"),this.interaction=new js(n.location.mode),this.keyPointIdHistory=new K(Array.from(this.document.getOnce().keyPoints,r=>r.id),"keyPointIdHistory")}onPointerEvent(e,n){this.interaction.onPointerEvent({event:n,eventType:e,splatapus:this})}}function Ws(t){const e=d.exports.useState(()=>new Ks(new K(L.ZERO,"screenSize"),t()))[0];return d.exports.useEffect(()=>{window.splatapus=e;const n=[ut(fe.eager,()=>{const r=e.interaction.activeMode.live().type;e.location.mode.live()!==r&&e.location.mode.update(r)}),ut(fe.eager,()=>{const r=e.location.keyPointId.live(),i=e.document.live();e.keyPointIdHistory.update(o=>{const s=o.filter(a=>i.keyPoints.has(a)&&a!==r);return s.length===o.length-1&&Yr(o)===r?(console.log("update keyPointIdHistory (static)"),o):(console.log("update keyPointIdHistory (changed)"),s.push(r),s)})})];return()=>{for(const r of n)r()}},[e]),e}const Gs=T.memo(function({width:e,height:n,shapeId:r,keyPointId:i,splatapus:o}){const a=H(()=>{const S=o.document.live(),v=S.getShapeVersion(i,r);return v?S.getNormalizedCenterPointsForShapeVersion(v.id):null},[i,r,o.document]);if(!a||a.length<2)return null;let l=1/0,u=1/0,c=-1/0,y=-1/0;for(const{center:S,radius:v}of a)l=Math.min(l,S.x-v),c=Math.max(c,S.x+v),u=Math.min(u,S.y-v),y=Math.max(y,S.y+v);const h=c-l,m=y-u,x=e-4*2,f=n-4*2,g=Math.min(x/h,.8),P=Math.min(f/m,.8),b=Math.min(g,P);return p("svg",{viewBox:`0 0 ${e} ${n}`,style:{width:e,height:n},children:p("g",{transform:`translate(${4+Math.max(x-h*b,0)/2}, ${4+Math.max(f-m*b,0)/2}) scale(${b}) translate(${-l}, ${-u})`,children:p("path",{d:at(ct(a)),className:"fill-stone-800"})})})}),Rn=84,Vn=80;function qs({splatapus:t}){const e=ie(t.location.keyPointId),n=ie(t.location.shapeId),r=Array.from(H(()=>t.document.live().keyPoints,[t])),i=Array.from(H(()=>t.document.live().shapes,[t])),o=Array.from(r).findIndex(l=>e===l.id),s=Array.from(i).findIndex(l=>n===l.id),a=Gi(t);return _("div",{className:"relative flex h-0 flex-auto flex-col gap-4 overflow-auto p-5 [-webkit-overflow-scrolling:touch]",children:[p("div",{className:"absolute top-5 left-5 z-0 w-20 rounded bg-stone-200 ring-2 ring-stone-200 transition-transform",style:{height:-16+Vn*i.length,transform:`translateX(${o*Rn}px)`}}),p("div",{className:"absolute top-5 z-0 h-16 rounded bg-stone-200 ring-2 ring-stone-200 transition-transform",style:{width:-4+Rn*(r.length+1),transform:`translateY(${s*Vn}px)`}}),i.map((l,u)=>p("div",{className:"relative flex w-max flex-col gap-2",children:_("div",{className:"flex gap-1",children:[r.map(c=>p("button",{className:j("overflow-none h-16 w-20 flex-none rounded border",l.id===n&&c.id===e?`${a.border500} ring-1 ${a.ring500} bg-white`:"border-stone-300 bg-white/25 hover:bg-white/50"),onClick:()=>{t.location.shapeId.update(l.id),t.location.keyPointId.update(c.id)},children:p(Gs,{width:78,height:62,keyPointId:c.id,shapeId:l.id,splatapus:t})},c.id)),p("button",{className:"h-16 w-20 flex-none rounded border border-stone-300 text-xl text-stone-400 hover:bg-white/50",onClick:()=>{const c=Ke.generate();t.document.update(y=>y.addKeyPoint(c,null),{lockstepLocation:y=>({...y,keyPointId:c,shapeId:l.id})})},children:"+"})]})},l.id)),p(oe,{className:"sticky left-0",onClick:()=>{const l=We.generate();t.document.update(u=>u.addShape(l),{lockstepLocation:u=>({...u,shapeId:l})})},children:"+ shape"})]})}const Ys={width:tn},de=20,Js=p("svg",{viewBox:`0 0 ${de} ${de}`,className:"flex-none",style:{width:de,height:de},children:p("path",{className:"fill-stone-100",d:["M 0,0",`L ${de},0`,`L ${de},${de}`,`Q ${de},0 0,0`,"Z"].join(" ")})});function Zs({topBarRight:t,topBarLeft:e,rightBar:n,bottomBarLeft:r,bottomBarRight:i,splatapus:o}){const s=ie(o.viewport.isSidebarOpen);return _("div",{className:"pointer-events-none absolute inset-0 z-20 flex flex-col items-stretch",children:[_("div",{className:"pointer-events-auto flex flex-none items-center justify-between gap-3 bg-stone-100 px-3 py-2",children:[p("h1",{className:"order-1 flex-1 font-bold tracking-wide text-stone-600",children:"splatapus"}),p("div",{className:"order-2 flex flex-1 items-center justify-center gap-2",children:e}),p("div",{className:"order-3 flex flex-1 items-center justify-end gap-2",children:t})]}),_(pe,{className:"flex flex-auto items-start justify-end",show:s,enter:"transition",enterFrom:"translate-x-80",enterTo:"translate-x-0",leave:"transition",leaveFrom:"translate-0",leaveTo:"translate-x-80",children:[Js,p("div",{className:"pointer-events-auto flex h-full flex-col bg-stone-100",style:Ys,children:n})]}),p("div",{className:"absolute bottom-0 left-0",children:r}),p("div",{className:"absolute bottom-0 right-0 transition-transform",style:{transform:`translateX(${-tn}px)`},children:i})]})}const Bn=Zn({id:"doc.0_VcKaG8h9Zf8pyG",keyPoints:{"key.0_a3vKHuIcxpHnVg":{id:"key.0_a3vKHuIcxpHnVg",position:{x:84.4612113767582,y:-310.6259226617922}},"key.1_TYmFrn9Wh1QZ3t":{id:"key.1_TYmFrn9Wh1QZ3t",position:{x:76.77421647506128,y:82.8797180046771}},"key.2_8mSx0MUXiSEjNK":{id:"key.2_8mSx0MUXiSEjNK",position:{x:-290.00197453390416,y:88.34970510918276}},"key.3_RariJQz2eTMOkJ":{id:"key.3_RariJQz2eTMOkJ",position:{x:466.25676711635367,y:91.8418718809971}}},shapes:{"shp.0_n9ry1znj34Bp1k":{id:"shp.0_n9ry1znj34Bp1k"},"shp.1_ONCgL3fjUYIryN":{id:"shp.1_ONCgL3fjUYIryN"},"shp.2_Zwa9ObnrYgWogq":{id:"shp.2_Zwa9ObnrYgWogq"},"shp.3_mUCVyzbyAGCuIa":{id:"shp.3_mUCVyzbyAGCuIa"},"shp.4_SMMSTDAbn3tdXv":{id:"shp.4_SMMSTDAbn3tdXv"},"shp.5_pFzZ21ghrzLlt1":{id:"shp.5_pFzZ21ghrzLlt1"}},shapeVersions:{"shv.0_LwpIe0fFofKDNO":{id:"shv.0_LwpIe0fFofKDNO",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:-41,y:-45},{x:-47,y:-41},{x:-49,y:-39},{x:-53,y:-34},{x:-57,y:-30},{x:-61,y:-25},{x:-64,y:-20},{x:-66,y:-16},{x:-69,y:-11},{x:-71,y:-6},{x:-73,y:-1},{x:-74,y:5},{x:-76,y:11},{x:-76,y:16},{x:-77,y:22},{x:-78,y:28},{x:-78,y:35},{x:-78,y:42},{x:-78,y:49},{x:-78,y:56},{x:-78,y:62},{x:-78,y:68},{x:-76,y:74},{x:-74,y:80},{x:-71,y:86},{x:-68,y:91},{x:-64,y:96},{x:-60,y:102},{x:-55,y:107},{x:-49,y:112},{x:-44,y:118},{x:-37,y:123},{x:-30,y:128},{x:-23,y:132},{x:-15,y:137},{x:-7,y:140},{x:2,y:144},{x:11,y:147},{x:20,y:150},{x:30,y:152},{x:39,y:152},{x:49,y:153},{x:59,y:153},{x:69,y:153},{x:78,y:153},{x:89,y:152},{x:99,y:149},{x:109,y:147},{x:120,y:143},{x:129,y:139},{x:138,y:134},{x:148,y:129},{x:156,y:123},{x:164,y:117},{x:172,y:110},{x:179,y:103},{x:187,y:96},{x:193,y:89},{x:198,y:83},{x:202,y:76},{x:206,y:69},{x:208,y:63},{x:210,y:58},{x:211,y:52},{x:212,y:46},{x:213,y:38},{x:213,y:30},{x:213,y:23},{x:213,y:17},{x:213,y:11},{x:213,y:5},{x:213,y:-3},{x:213,y:-11},{x:213,y:-18},{x:213,y:-23},{x:212,y:-28},{x:211,y:-32},{x:209,y:-36},{x:208,y:-40},{x:206,y:-42},{x:205,y:-44},{x:203,y:-46},{x:201,y:-47},{x:200,y:-48},{x:199,y:-48},{x:199,y:-50}]},"shv.1_SWgK9k5Y2kn7dj":{id:"shv.1_SWgK9k5Y2kn7dj",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:-25,y:-43},{x:-25,y:-47},{x:-25,y:-49},{x:-24,y:-56},{x:-22,y:-65},{x:-19,y:-77},{x:-16,y:-90},{x:-14,y:-101},{x:-10,y:-113},{x:-8,y:-123},{x:-4,y:-131},{x:-2,y:-139},{x:1,y:-145},{x:3,y:-149},{x:4,y:-152},{x:6,y:-154},{x:7,y:-154},{x:8,y:-154},{x:10,y:-153},{x:12,y:-151},{x:15,y:-147},{x:18,y:-142},{x:21,y:-135},{x:24,y:-127},{x:27,y:-118},{x:29,y:-108},{x:30,y:-98},{x:30,y:-88},{x:31,y:-79},{x:32,y:-72},{x:32,y:-67},{x:33,y:-64},{x:33,y:-62},{x:34,y:-62},{x:34,y:-61},{x:34,y:-60},{x:35,y:-59}]},"shv.3_3ILI63YytH2Ite":{id:"shv.3_3ILI63YytH2Ite",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:126,y:-69},{x:127,y:-75},{x:130,y:-84},{x:136,y:-96},{x:142,y:-108},{x:148,y:-118},{x:154,y:-128},{x:161,y:-137},{x:169,y:-145},{x:177,y:-152},{x:183,y:-158},{x:188,y:-162},{x:191,y:-164},{x:192,y:-164},{x:193,y:-164},{x:193,y:-163},{x:194,y:-158},{x:194,y:-152},{x:196,y:-144},{x:196,y:-135},{x:197,y:-125},{x:197,y:-114},{x:197,y:-103},{x:197,y:-92},{x:196,y:-83},{x:195,y:-74},{x:194,y:-67},{x:193,y:-62},{x:192,y:-60},{x:192,y:-58},{x:192,y:-57},{x:192,y:-55},{x:192,y:-50},{x:192,y:-48}]},"shv.4_dljDpCZ90LHjbP":{id:"shv.4_dljDpCZ90LHjbP",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:41,y:-63},{x:46,y:-66},{x:51,y:-67},{x:57,y:-69},{x:65,y:-71},{x:72,y:-72},{x:80,y:-73},{x:89,y:-74},{x:99,y:-74},{x:109,y:-74},{x:115,y:-74},{x:120,y:-74},{x:124,y:-74},{x:127,y:-74},{x:129,y:-74},{x:130,y:-73},{x:130,y:-72}]},"shv.5_g5nKgDG7juS3Au":{id:"shv.5_g5nKgDG7juS3Au",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:21,y:-10},{x:15,y:-10},{x:11,y:-10},{x:5,y:-7},{x:-2,y:-3},{x:-8,y:1},{x:-14,y:6},{x:-18,y:10},{x:-22,y:14},{x:-25,y:19},{x:-27,y:24},{x:-29,y:30},{x:-30,y:38},{x:-30,y:44},{x:-30,y:48},{x:-29,y:52},{x:-26,y:55},{x:-22,y:59},{x:-17,y:62},{x:-10,y:65},{x:-3,y:66},{x:4,y:67},{x:11,y:67},{x:17,y:67},{x:22,y:64},{x:26,y:59},{x:29,y:53},{x:32,y:47},{x:33,y:44},{x:33,y:41},{x:33,y:40},{x:33,y:39},{x:33,y:36},{x:33,y:22},{x:33,y:16},{x:33,y:13},{x:33,y:11},{x:32,y:10},{x:31,y:9},{x:29,y:8},{x:27,y:8},{x:25,y:7},{x:24,y:6},{x:23,y:6},{x:22,y:6},{x:22,y:5},{x:21,y:4},{x:20,y:4},{x:20,y:3},{x:19,y:3},{x:18,y:3},{x:17,y:3}]},"shv.6_fOyfl45j6IoVJD":{id:"shv.6_fOyfl45j6IoVJD",keyPointId:"key.0_a3vKHuIcxpHnVg",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:151,y:-26},{x:145,y:-27},{x:138,y:-26},{x:127,y:-21},{x:116,y:-14},{x:106,y:-6},{x:98,y:3},{x:91,y:11},{x:87,y:20},{x:84,y:30},{x:83,y:39},{x:83,y:47},{x:86,y:53},{x:92,y:57},{x:100,y:59},{x:110,y:60},{x:121,y:60},{x:133,y:59},{x:144,y:56},{x:154,y:51},{x:163,y:45},{x:172,y:37},{x:177,y:30},{x:180,y:24},{x:182,y:18},{x:184,y:11},{x:184,y:4},{x:184,y:-6},{x:180,y:-13},{x:176,y:-19},{x:171,y:-23},{x:166,y:-25},{x:161,y:-27},{x:155,y:-27},{x:148,y:-27},{x:141,y:-27},{x:135,y:-26},{x:129,y:-23},{x:123,y:-18}]},"shv.7_MNXQuLFOxPhQSP":{id:"shv.7_MNXQuLFOxPhQSP",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:-35,y:25},{x:-41,y:26},{x:-44,y:26},{x:-48,y:26},{x:-53,y:27},{x:-57,y:29},{x:-62,y:30},{x:-67,y:33},{x:-72,y:35},{x:-77,y:38},{x:-83,y:42},{x:-88,y:46},{x:-92,y:50},{x:-97,y:55},{x:-101,y:62},{x:-105,y:68},{x:-108,y:75},{x:-111,y:81},{x:-113,y:87},{x:-114,y:92},{x:-114,y:96},{x:-114,y:101},{x:-114,y:104},{x:-113,y:108},{x:-111,y:111},{x:-108,y:115},{x:-105,y:118},{x:-101,y:121},{x:-98,y:123},{x:-94,y:126},{x:-90,y:128},{x:-85,y:130},{x:-80,y:132},{x:-74,y:133},{x:-69,y:135},{x:-62,y:137},{x:-56,y:138},{x:-49,y:139},{x:-43,y:140},{x:-36,y:140},{x:-30,y:140},{x:-24,y:140},{x:-18,y:140},{x:-12,y:140},{x:-7,y:140},{x:-1,y:141},{x:4,y:142},{x:9,y:142},{x:14,y:143},{x:21,y:144},{x:27,y:145},{x:33,y:147},{x:40,y:147},{x:46,y:148},{x:52,y:148},{x:58,y:148},{x:64,y:148},{x:70,y:148},{x:77,y:149},{x:83,y:149},{x:89,y:149},{x:95,y:149},{x:101,y:149},{x:107,y:149},{x:114,y:149},{x:121,y:149},{x:128,y:149},{x:136,y:149},{x:144,y:148},{x:151,y:147},{x:158,y:147},{x:165,y:145},{x:172,y:144},{x:179,y:144},{x:186,y:143},{x:193,y:142},{x:200,y:140},{x:206,y:139},{x:213,y:137},{x:220,y:134},{x:225,y:132},{x:231,y:130},{x:237,y:127},{x:242,y:123},{x:249,y:119},{x:255,y:113},{x:262,y:108},{x:266,y:103},{x:270,y:99},{x:274,y:95},{x:276,y:92},{x:278,y:89},{x:279,y:86},{x:280,y:83},{x:281,y:80},{x:281,y:77},{x:281,y:75},{x:281,y:74},{x:281,y:72},{x:280,y:69},{x:279,y:65},{x:277,y:60},{x:275,y:56},{x:274,y:53},{x:272,y:50},{x:270,y:47},{x:267,y:43},{x:265,y:39},{x:262,y:35},{x:259,y:30},{x:256,y:27},{x:252,y:23},{x:250,y:21},{x:246,y:18},{x:242,y:16},{x:239,y:14},{x:235,y:11},{x:230,y:10},{x:227,y:8},{x:223,y:8},{x:221,y:7},{x:217,y:7},{x:213,y:6},{x:210,y:6},{x:206,y:6},{x:204,y:6},{x:202,y:6},{x:201,y:6},{x:200,y:6},{x:200,y:5}]},"shv.8_dqc9S1VROeclkw":{id:"shv.8_dqc9S1VROeclkw",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:-20,y:20},{x:-23,y:16},{x:-23,y:13},{x:-25,y:10},{x:-26,y:7},{x:-29,y:4},{x:-32,y:1},{x:-35,y:-1},{x:-38,y:-4},{x:-39,y:-5},{x:-41,y:-6},{x:-43,y:-6},{x:-46,y:-8},{x:-49,y:-9},{x:-53,y:-9},{x:-56,y:-10},{x:-58,y:-10},{x:-59,y:-10},{x:-61,y:-11},{x:-62,y:-11},{x:-63,y:-11},{x:-64,y:-11},{x:-64,y:-12},{x:-64,y:-13},{x:-64,y:-14},{x:-64,y:-15},{x:-64,y:-16},{x:-63,y:-17},{x:-62,y:-18},{x:-61,y:-20},{x:-59,y:-22},{x:-56,y:-24},{x:-54,y:-26},{x:-52,y:-28},{x:-49,y:-29},{x:-46,y:-31},{x:-43,y:-32},{x:-39,y:-33},{x:-36,y:-33},{x:-32,y:-33},{x:-28,y:-33},{x:-24,y:-33},{x:-19,y:-33},{x:-15,y:-32},{x:-12,y:-31},{x:-9,y:-29},{x:-7,y:-28},{x:-5,y:-26},{x:-3,y:-24},{x:-2,y:-22},{x:0,y:-20},{x:2,y:-18},{x:3,y:-14},{x:5,y:-11},{x:7,y:-8},{x:7,y:-6},{x:9,y:-4},{x:9,y:-3},{x:11,y:-1},{x:12,y:0},{x:14,y:2},{x:15,y:4},{x:16,y:6},{x:16,y:8},{x:17,y:8},{x:17,y:9},{x:18,y:10},{x:18,y:11},{x:19,y:11},{x:19,y:12},{x:19,y:13},{x:19,y:14},{x:19,y:15},{x:20,y:16},{x:21,y:17}]},"shv.9_wkf9c4ZDBAwLRf":{id:"shv.9_wkf9c4ZDBAwLRf",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:152,y:-11},{x:156,y:-17},{x:158,y:-21},{x:162,y:-25},{x:167,y:-31},{x:174,y:-36},{x:181,y:-42},{x:189,y:-48},{x:196,y:-54},{x:204,y:-59},{x:212,y:-62},{x:220,y:-63},{x:228,y:-63},{x:236,y:-63},{x:245,y:-63},{x:252,y:-63},{x:257,y:-62},{x:259,y:-61},{x:261,y:-60},{x:262,y:-60},{x:263,y:-59},{x:263,y:-58},{x:263,y:-57},{x:260,y:-55},{x:255,y:-52},{x:250,y:-48},{x:243,y:-43},{x:237,y:-38},{x:230,y:-33},{x:225,y:-27},{x:218,y:-20},{x:213,y:-13},{x:208,y:-6},{x:206,y:-2},{x:204,y:0},{x:204,y:1},{x:204,y:2}]},"shv.10_QVHVJVxyuxdpD":{id:"shv.10_QVHVJVxyuxdpD",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:31,y:17},{x:33,y:16},{x:36,y:16},{x:47,y:11},{x:58,y:6},{x:72,y:1},{x:84,y:-1},{x:99,y:-4},{x:113,y:-6},{x:124,y:-6},{x:134,y:-7},{x:141,y:-8},{x:147,y:-8},{x:152,y:-8},{x:154,y:-8},{x:155,y:-7},{x:155,y:-6},{x:155,y:-4}]},"shv.12_5jxllLtpm93b7":{id:"shv.12_5jxllLtpm93b7",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:19,y:55},{x:12,y:55},{x:9,y:55},{x:4,y:55},{x:-1,y:56},{x:-6,y:57},{x:-10,y:57},{x:-15,y:58},{x:-20,y:59},{x:-26,y:60},{x:-32,y:63},{x:-37,y:65},{x:-43,y:68},{x:-47,y:71},{x:-52,y:74},{x:-54,y:77},{x:-57,y:81},{x:-59,y:86},{x:-61,y:90},{x:-62,y:95},{x:-62,y:98},{x:-62,y:101},{x:-62,y:103},{x:-61,y:105},{x:-56,y:107},{x:-51,y:108},{x:-44,y:110},{x:-37,y:110},{x:-30,y:110},{x:-24,y:110},{x:-17,y:108},{x:-9,y:106},{x:-3,y:103},{x:4,y:100},{x:10,y:97},{x:16,y:94},{x:21,y:91},{x:25,y:88},{x:30,y:84},{x:33,y:81},{x:36,y:77},{x:37,y:75},{x:38,y:73},{x:38,y:72},{x:38,y:71},{x:38,y:70},{x:38,y:69},{x:37,y:69},{x:36,y:67},{x:35,y:66},{x:34,y:65},{x:32,y:61},{x:29,y:54},{x:26,y:51},{x:25,y:50},{x:24,y:50},{x:23,y:50},{x:22,y:50},{x:21,y:50},{x:20,y:51},{x:19,y:52},{x:17,y:54},{x:14,y:57},{x:13,y:59}]},"shv.14_GWIuG0AcQVcWv":{id:"shv.14_GWIuG0AcQVcWv",keyPointId:"key.1_TYmFrn9Wh1QZ3t",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:221,y:50},{x:215,y:47},{x:211,y:47},{x:206,y:46},{x:200,y:46},{x:195,y:45},{x:191,y:45},{x:185,y:45},{x:179,y:45},{x:173,y:46},{x:166,y:50},{x:160,y:53},{x:155,y:57},{x:150,y:60},{x:148,y:64},{x:146,y:67},{x:145,y:71},{x:144,y:76},{x:144,y:81},{x:144,y:86},{x:144,y:89},{x:145,y:92},{x:148,y:94},{x:152,y:97},{x:158,y:99},{x:165,y:100},{x:173,y:101},{x:181,y:101},{x:189,y:101},{x:197,y:99},{x:205,y:96},{x:213,y:93},{x:221,y:90},{x:228,y:87},{x:234,y:84},{x:238,y:81},{x:241,y:80},{x:244,y:78},{x:247,y:76},{x:248,y:74},{x:248,y:73},{x:248,y:72},{x:248,y:70},{x:248,y:69},{x:248,y:68},{x:248,y:67},{x:246,y:66},{x:243,y:60},{x:240,y:57},{x:238,y:55},{x:237,y:54},{x:235,y:54},{x:233,y:53},{x:229,y:52},{x:224,y:52},{x:218,y:52},{x:214,y:52},{x:210,y:52},{x:204,y:52},{x:197,y:54}]},"shv.15_IegtY8uWpenHx":{id:"shv.15_IegtY8uWpenHx",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:-137,y:13},{x:-143,y:8},{x:-144,y:8},{x:-146,y:8},{x:-148,y:7},{x:-150,y:6},{x:-152,y:6},{x:-155,y:5},{x:-158,y:4},{x:-161,y:3},{x:-165,y:2},{x:-169,y:1},{x:-173,y:1},{x:-176,y:1},{x:-180,y:1},{x:-183,y:1},{x:-186,y:1},{x:-189,y:1},{x:-192,y:1},{x:-195,y:1},{x:-196,y:1},{x:-198,y:3},{x:-200,y:5},{x:-202,y:10},{x:-204,y:15},{x:-206,y:20},{x:-207,y:24},{x:-208,y:28},{x:-209,y:31},{x:-209,y:35},{x:-209,y:38},{x:-209,y:40},{x:-209,y:43},{x:-209,y:46},{x:-207,y:49},{x:-205,y:52},{x:-204,y:56},{x:-202,y:59},{x:-200,y:63},{x:-199,y:67},{x:-197,y:70},{x:-195,y:72},{x:-194,y:74},{x:-193,y:76},{x:-190,y:77},{x:-188,y:80},{x:-186,y:82},{x:-183,y:84},{x:-179,y:87},{x:-175,y:90},{x:-171,y:93},{x:-166,y:96},{x:-160,y:99},{x:-155,y:102},{x:-149,y:105},{x:-143,y:108},{x:-137,y:110},{x:-131,y:113},{x:-125,y:116},{x:-119,y:120},{x:-112,y:123},{x:-106,y:125},{x:-100,y:127},{x:-94,y:129},{x:-88,y:132},{x:-82,y:134},{x:-76,y:135},{x:-70,y:137},{x:-64,y:139},{x:-58,y:141},{x:-52,y:142},{x:-45,y:144},{x:-38,y:145},{x:-31,y:146},{x:-23,y:147},{x:-16,y:147},{x:-8,y:147},{x:0,y:147},{x:8,y:147},{x:17,y:147},{x:25,y:147},{x:34,y:147},{x:42,y:147},{x:49,y:147},{x:56,y:146},{x:63,y:146},{x:71,y:145},{x:78,y:144},{x:85,y:143},{x:92,y:142},{x:99,y:142},{x:106,y:141},{x:113,y:140},{x:120,y:139},{x:127,y:138},{x:134,y:137},{x:141,y:137},{x:149,y:136},{x:156,y:135},{x:164,y:134},{x:172,y:132},{x:179,y:131},{x:187,y:130},{x:194,y:128},{x:201,y:126},{x:208,y:123},{x:214,y:121},{x:221,y:118},{x:226,y:114},{x:230,y:111},{x:235,y:108},{x:238,y:104},{x:241,y:99},{x:244,y:93},{x:247,y:89},{x:250,y:82},{x:252,y:75},{x:255,y:65},{x:257,y:55},{x:257,y:48},{x:257,y:45},{x:257,y:43},{x:257,y:42},{x:252,y:36},{x:249,y:32},{x:245,y:28},{x:241,y:26},{x:239,y:25},{x:235,y:24},{x:231,y:21},{x:225,y:18},{x:219,y:16},{x:215,y:13},{x:211,y:11},{x:209,y:10},{x:208,y:8},{x:208,y:7},{x:207,y:6},{x:206,y:6},{x:205,y:6},{x:204,y:6},{x:203,y:6},{x:202,y:6},{x:201,y:6},{x:199,y:6},{x:198,y:6},{x:196,y:6},{x:194,y:6},{x:191,y:5},{x:189,y:5},{x:187,y:4},{x:184,y:4},{x:180,y:3},{x:177,y:3},{x:172,y:2},{x:168,y:1},{x:164,y:1},{x:160,y:0},{x:155,y:0},{x:151,y:0},{x:147,y:-1},{x:143,y:-1},{x:139,y:-1},{x:136,y:-1},{x:132,y:-1},{x:128,y:-1},{x:123,y:-1},{x:119,y:-1},{x:114,y:-1},{x:110,y:-1},{x:106,y:-1},{x:102,y:-1},{x:99,y:0},{x:95,y:1},{x:92,y:1},{x:90,y:1},{x:89,y:1},{x:87,y:2},{x:86,y:2},{x:85,y:2},{x:84,y:2},{x:84,y:3},{x:83,y:3},{x:82,y:3},{x:82,y:4},{x:81,y:4},{x:80,y:4},{x:79,y:4},{x:78,y:4},{x:77,y:4},{x:77,y:5},{x:76,y:5},{x:75,y:5},{x:74,y:5},{x:73,y:6},{x:72,y:6},{x:70,y:6},{x:67,y:7},{x:65,y:7},{x:63,y:8},{x:61,y:8},{x:59,y:8},{x:57,y:9},{x:55,y:10},{x:53,y:10},{x:52,y:11},{x:50,y:11},{x:49,y:11},{x:48,y:11},{x:47,y:11},{x:47,y:12},{x:47,y:13}]},"shv.17_JPHh1b7aVM4a5":{id:"shv.17_JPHh1b7aVM4a5",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:-130,y:1},{x:-135,y:-3},{x:-137,y:-4},{x:-140,y:-8},{x:-143,y:-11},{x:-147,y:-13},{x:-151,y:-15},{x:-155,y:-17},{x:-160,y:-19},{x:-165,y:-21},{x:-170,y:-23},{x:-175,y:-23},{x:-179,y:-23},{x:-183,y:-23},{x:-188,y:-23},{x:-191,y:-23},{x:-194,y:-22},{x:-197,y:-21},{x:-200,y:-20},{x:-201,y:-19},{x:-202,y:-19},{x:-203,y:-19},{x:-204,y:-19},{x:-204,y:-20},{x:-204,y:-21},{x:-204,y:-25},{x:-202,y:-30},{x:-198,y:-35},{x:-194,y:-40},{x:-190,y:-43},{x:-185,y:-46},{x:-181,y:-48},{x:-176,y:-49},{x:-171,y:-50},{x:-165,y:-52},{x:-159,y:-52},{x:-154,y:-54},{x:-149,y:-54},{x:-145,y:-54},{x:-139,y:-54},{x:-134,y:-53},{x:-130,y:-50},{x:-127,y:-48},{x:-124,y:-45},{x:-121,y:-41},{x:-119,y:-37},{x:-117,y:-32},{x:-115,y:-26},{x:-113,y:-19},{x:-112,y:-12},{x:-112,y:-6},{x:-112,y:-2},{x:-112,y:0},{x:-112,y:1},{x:-112,y:2},{x:-112,y:3},{x:-111,y:3},{x:-111,y:4},{x:-111,y:5}]},"shv.19_XdsJ3W4A719pc":{id:"shv.19_XdsJ3W4A719pc",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:-31,y:2},{x:-33,y:-4},{x:-33,y:-7},{x:-34,y:-11},{x:-36,y:-14},{x:-38,y:-17},{x:-40,y:-22},{x:-43,y:-27},{x:-46,y:-32},{x:-48,y:-35},{x:-50,y:-38},{x:-52,y:-41},{x:-55,y:-44},{x:-59,y:-48},{x:-62,y:-52},{x:-66,y:-56},{x:-69,y:-58},{x:-72,y:-60},{x:-76,y:-61},{x:-79,y:-61},{x:-82,y:-61},{x:-85,y:-61},{x:-87,y:-61},{x:-88,y:-61},{x:-89,y:-61},{x:-90,y:-62},{x:-88,y:-62},{x:-87,y:-63},{x:-85,y:-63},{x:-83,y:-63},{x:-80,y:-63},{x:-76,y:-63},{x:-70,y:-63},{x:-64,y:-63},{x:-58,y:-63},{x:-52,y:-63},{x:-47,y:-62},{x:-42,y:-61},{x:-38,y:-59},{x:-34,y:-56},{x:-30,y:-53},{x:-27,y:-49},{x:-24,y:-45},{x:-21,y:-42},{x:-19,y:-39},{x:-17,y:-35},{x:-14,y:-31},{x:-10,y:-25},{x:-7,y:-19},{x:-3,y:-13},{x:0,y:-8},{x:3,y:-4},{x:5,y:-1},{x:7,y:2},{x:9,y:5},{x:12,y:9},{x:16,y:13},{x:19,y:17},{x:22,y:19},{x:24,y:21},{x:26,y:23},{x:27,y:23},{x:28,y:24},{x:28,y:25},{x:29,y:25},{x:29,y:26}]},"shv.20_QSK3n1l8MmGEZ":{id:"shv.20_QSK3n1l8MmGEZ",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:-102,y:9},{x:-100,y:8},{x:-97,y:8},{x:-93,y:8},{x:-89,y:7},{x:-86,y:6},{x:-83,y:5},{x:-79,y:4},{x:-75,y:4},{x:-71,y:4},{x:-67,y:4},{x:-63,y:4},{x:-60,y:3},{x:-58,y:3},{x:-55,y:3},{x:-52,y:3},{x:-49,y:3},{x:-47,y:3},{x:-44,y:3},{x:-43,y:3},{x:-42,y:3}]},"shv.22_I2STbWZAXgo1B":{id:"shv.22_I2STbWZAXgo1B",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:-110,y:42},{x:-115,y:40},{x:-118,y:40},{x:-122,y:40},{x:-126,y:38},{x:-130,y:36},{x:-134,y:34},{x:-138,y:32},{x:-141,y:31},{x:-144,y:30},{x:-147,y:29},{x:-151,y:28},{x:-154,y:27},{x:-158,y:26},{x:-162,y:26},{x:-165,y:26},{x:-168,y:26},{x:-170,y:27},{x:-171,y:29},{x:-172,y:32},{x:-173,y:34},{x:-174,y:37},{x:-174,y:39},{x:-174,y:41},{x:-174,y:43},{x:-174,y:45},{x:-174,y:47},{x:-172,y:49},{x:-169,y:52},{x:-165,y:56},{x:-160,y:60},{x:-155,y:64},{x:-149,y:68},{x:-143,y:72},{x:-137,y:75},{x:-132,y:78},{x:-125,y:81},{x:-119,y:83},{x:-112,y:85},{x:-107,y:86},{x:-101,y:86},{x:-96,y:86},{x:-92,y:86},{x:-88,y:84},{x:-85,y:80},{x:-83,y:77},{x:-82,y:74},{x:-82,y:72},{x:-82,y:71},{x:-82,y:69},{x:-82,y:67},{x:-83,y:63},{x:-86,y:60},{x:-87,y:57},{x:-88,y:55},{x:-90,y:51},{x:-93,y:44},{x:-96,y:37},{x:-100,y:32},{x:-102,y:29},{x:-103,y:28},{x:-105,y:28},{x:-106,y:28},{x:-107,y:28},{x:-108,y:28},{x:-108,y:29}]},"shv.23_wW18nQbpEd7gx":{id:"shv.23_wW18nQbpEd7gx",keyPointId:"key.2_8mSx0MUXiSEjNK",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:4,y:40},{x:-2,y:38},{x:-5,y:38},{x:-9,y:38},{x:-14,y:37},{x:-18,y:37},{x:-24,y:37},{x:-28,y:37},{x:-32,y:37},{x:-35,y:38},{x:-38,y:39},{x:-40,y:41},{x:-42,y:43},{x:-42,y:45},{x:-43,y:46},{x:-43,y:47},{x:-43,y:50},{x:-43,y:54},{x:-41,y:59},{x:-38,y:64},{x:-35,y:68},{x:-32,y:72},{x:-29,y:74},{x:-25,y:77},{x:-22,y:79},{x:-18,y:79},{x:-13,y:80},{x:-8,y:80},{x:-3,y:80},{x:3,y:80},{x:9,y:79},{x:15,y:75},{x:21,y:72},{x:26,y:69},{x:31,y:66},{x:34,y:64},{x:36,y:61},{x:38,y:59},{x:38,y:58},{x:38,y:57},{x:37,y:56},{x:36,y:56},{x:34,y:55},{x:31,y:52},{x:26,y:49},{x:21,y:45},{x:16,y:42},{x:12,y:40},{x:9,y:38},{x:6,y:36},{x:3,y:35},{x:-1,y:35},{x:-4,y:34},{x:-7,y:34},{x:-10,y:33},{x:-12,y:33},{x:-13,y:33},{x:-21,y:38}]},"shv.25_bSftSx0IJxw7H":{id:"shv.25_bSftSx0IJxw7H",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.0_n9ry1znj34Bp1k",rawPoints:[{x:110.49240292871617,y:19.52362771067062},{x:101.42737067012109,y:11.753600060446258},{x:100.13236606175036,y:11.753600060446258},{x:96.24735223663818,y:11.753600060446258},{x:89.77232919478455,y:10.458595452075532},{x:84.59231076130163,y:9.163590843704805},{x:75.52727850270655,y:9.163590843704805},{x:67.75725085248219,y:7.868586235334078},{x:58.6922185938871,y:7.868586235334078},{x:50.922190943662734,y:7.868586235334078},{x:43.15216329343838,y:7.868586235334078},{x:35.38213564321401,y:7.868586235334078},{x:27.612107992989653,y:7.868586235334078},{x:19.84208034276529,y:7.868586235334078},{x:13.367057300911656,y:7.868586235334078},{x:6.892034259058021,y:9.163590843704805},{x:.4170112172043865,y:9.163590843704805},{x:-6.058011824649248,y:11.753600060446258},{x:-12.533034866502883,y:14.343609277187712},{x:-17.71305329998579,y:15.63861388555844},{x:-22.893071733468698,y:19.52362771067062},{x:-29.368094775322334,y:22.113636927412074},{x:-34.54811320880524,y:24.703646144153527},{x:-41.02313625065887,y:29.883664577636434},{x:-47.49815929251251,y:33.76867840274862},{x:-51.38317311762469,y:37.653692227860795},{x:-55.268186942736875,y:40.24370144460225},{x:-56.5631915511076,y:41.53870605297298},{x:-57.858196159478325,y:42.83371066134371},{x:-59.15320076784905,y:44.128715269714434},{x:-59.15320076784905,y:46.71872448645588},{x:-60.44820537621978,y:50.603738311568065},{x:-61.74320998459051,y:55.78375674505097},{x:-63.03821459296123,y:60.96377517853388},{x:-64.33321920133196,y:67.43879822038751},{x:-64.33321920133196,y:73.91382126224116},{x:-64.33321920133196,y:80.38884430409479},{x:-64.33321920133196,y:86.86386734594842},{x:-61.74320998459051,y:92.04388577943133},{x:-59.15320076784905,y:95.92889960454352},{x:-55.268186942736875,y:99.81391342965568},{x:-51.38317311762469,y:102.40392264639715},{x:-47.49815929251251,y:106.28893647150933},{x:-42.318140859029604,y:108.87894568825078},{x:-35.843117817175965,y:111.46895490499223},{x:-29.368094775322334,y:112.76395951336296},{x:-21.598067125097973,y:115.35396873010441},{x:-15.123044083244336,y:116.64897333847514},{x:-7.353016433019975,y:116.64897333847514},{x:-.8779933911663405,y:117.94397794684586},{x:6.892034259058021,y:119.2389825552166},{x:15.95706651765311,y:120.53398716358733},{x:23.72709416787747,y:123.12399638032878},{x:34.08713103484329,y:123.12399638032878},{x:41.85715868506765,y:124.41900098869951},{x:50.922190943662734,y:125.71400559707023},{x:58.6922185938871,y:128.30401481381168},{x:67.75725085248219,y:129.5990194221824},{x:76.82228311107728,y:132.18902863892387},{x:87.1823199780431,y:133.4840332472946},{x:96.24735223663818,y:134.7790378556653},{x:106.60738910360399,y:136.07404246403604},{x:115.67242136219909,y:137.36904707240677},{x:124.73745362079417,y:138.6640516807775},{x:132.50748127101855,y:138.6640516807775},{x:140.27750892124288,y:139.95905628914824},{x:149.34254117983798,y:141.25406089751894},{x:157.11256883006234,y:142.54906550588967},{x:166.17760108865744,y:143.8440701142604},{x:175.24263334725254,y:145.13907472263114},{x:184.3076656058476,y:145.13907472263114},{x:192.07769325607197,y:146.43407933100187},{x:201.14272551466706,y:146.43407933100187},{x:210.20775777326216,y:146.43407933100187},{x:219.27279003185726,y:146.43407933100187},{x:228.33782229045232,y:146.43407933100187},{x:239.99286376578888,y:146.43407933100187},{x:250.35290063275468,y:143.8440701142604},{x:263.302946716462,y:141.25406089751894},{x:276.25299280016924,y:137.36904707240677},{x:289.2030388838765,y:133.4840332472946},{x:300.85808035921303,y:129.5990194221824},{x:312.51312183454957,y:125.71400559707023},{x:322.8731587015154,y:121.82899177195804},{x:333.2331955684812,y:117.94397794684586},{x:344.88823704381775,y:111.46895490499223},{x:355.24827391078355,y:104.9939318631386},{x:364.3133061693787,y:98.51890882128497},{x:372.083333819603,y:92.04388577943133},{x:379.8533614698274,y:86.86386734594842},{x:386.328384511681,y:80.38884430409479},{x:394.0984121619054,y:72.61881665387043},{x:401.86843981212974,y:66.1437936120168},{x:408.3434628539834,y:57.078761353421704},{x:412.22847667909554,y:50.603738311568065},{x:414.818485895837,y:46.71872448645588},{x:414.818485895837,y:44.128715269714434},{x:414.818485895837,y:42.83371066134371},{x:414.818485895837,y:41.53870605297298},{x:414.818485895837,y:40.24370144460225},{x:413.52348128746627,y:37.653692227860795},{x:410.9334720707248,y:36.35868761949007},{x:408.3434628539834,y:33.76867840274862},{x:405.75345363724193,y:29.883664577636434},{x:401.86843981212974,y:24.703646144153527},{x:397.98342598701754,y:19.52362771067062},{x:392.80340755353467,y:13.048604668816985},{x:388.9183937284225,y:9.163590843704805},{x:386.328384511681,y:6.5735816269633505},{x:382.4433706865688,y:2.68856780185117},{x:379.8533614698274,y:.098558585109716},{x:375.9683476447152,y:-2.491450631631738},{x:372.083333819603,y:-3.7864552400024647},{x:368.1983199944908,y:-6.376464456743919},{x:364.3133061693787,y:-7.671469065114645},{x:360.4282923442665,y:-8.966473673485373},{x:357.838283127525,y:-8.966473673485373},{x:352.65826469404215,y:-8.966473673485373},{x:348.77325086892995,y:-10.2614782818561},{x:343.593232435447,y:-10.2614782818561},{x:338.4132140019641,y:-10.2614782818561},{x:331.9381909601105,y:-10.2614782818561},{x:326.75817252662756,y:-10.2614782818561},{x:320.28314948477396,y:-10.2614782818561},{x:313.8081264429203,y:-10.2614782818561},{x:307.3331034010667,y:-10.2614782818561},{x:302.15308496758377,y:-10.2614782818561},{x:296.97306653410084,y:-10.2614782818561},{x:291.79304810061797,y:-10.2614782818561},{x:285.3180250587643,y:-10.2614782818561},{x:277.54799740853997,y:-10.2614782818561},{x:269.7779697583156,y:-8.966473673485373},{x:262.00794210809124,y:-7.671469065114645},{x:255.53291906623758,y:-6.376464456743919},{x:251.64790524112541,y:-5.081459848373192},{x:250.35290063275468,y:-3.7864552400024647},{x:249.05789602438395,y:-3.7864552400024647},{x:250.35290063275468,y:-2.491450631631738}]},"shv.26_FUFwushsNIoT8":{id:"shv.26_FUFwushsNIoT8",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.1_ONCgL3fjUYIryN",rawPoints:[{x:116.9674259705698,y:15.63861388555844},{x:120.85243979568199,y:6.5735816269633505},{x:122.14744440405272,y:2.68856780185117},{x:124.73745362079417,y:.098558585109716},{x:128.62246744590635,y:-3.7864552400024647},{x:131.21247666264782,y:-7.671469065114645},{x:135.09749048775998,y:-12.851487498597553},{x:138.98250431287218,y:-16.736501323709735},{x:144.16252274635508,y:-21.916519757192642},{x:149.34254117983798,y:-25.801533582304824},{x:153.22755500495018,y:-29.686547407417002},{x:157.11256883006234,y:-33.571561232529184},{x:160.99758265517454,y:-36.16157044927064},{x:164.8825964802867,y:-38.75157966601209},{x:168.7676103053989,y:-41.34158888275355},{x:172.65262413051107,y:-42.63659349112427},{x:176.53763795562324,y:-43.931598099495},{x:179.1276471723647,y:-43.931598099495},{x:181.71765638910617,y:-43.931598099495},{x:183.0126609974769,y:-43.931598099495},{x:184.3076656058476,y:-45.22660270786573},{x:185.60267021421834,y:-45.22660270786573},{x:188.1926794309598,y:-46.521607316236455},{x:189.48768403933053,y:-46.521607316236455},{x:190.78268864770124,y:-46.521607316236455},{x:192.07769325607197,y:-46.521607316236455},{x:193.3726978644427,y:-46.521607316236455},{x:194.66770247281343,y:-46.521607316236455},{x:195.96270708118416,y:-45.22660270786573},{x:195.96270708118416,y:-43.931598099495},{x:195.96270708118416,y:-42.63659349112427},{x:195.96270708118416,y:-40.046584274382816},{x:195.96270708118416,y:-37.456575057641366},{x:194.66770247281343,y:-32.27655662415846},{x:193.3726978644427,y:-28.391542799046277},{x:189.48768403933053,y:-21.916519757192642},{x:185.60267021421834,y:-15.441496715339007},{x:181.71765638910617,y:-8.966473673485373},{x:177.83264256399397,y:-3.7864552400024647},{x:173.9476287388818,y:1.3935631934804429},{x:171.35761952214034,y:5.278577018592624},{x:170.0626149137696,y:6.5735816269633505},{x:168.7676103053989,y:7.868586235334078},{x:168.7676103053989,y:9.163590843704805},{x:168.7676103053989,y:10.458595452075532},{x:168.7676103053989,y:11.753600060446258},{x:168.7676103053989,y:13.048604668816985}]},"shv.28_mqL5cK4iYMnLO":{id:"shv.28_mqL5cK4iYMnLO",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.2_Zwa9ObnrYgWogq",rawPoints:[{x:241.2878683741596,y:-8.966473673485373},{x:238.69785915741815,y:-15.441496715339007},{x:238.69785915741815,y:-18.03150593208046},{x:238.69785915741815,y:-21.916519757192642},{x:241.2878683741596,y:-25.801533582304824},{x:242.58287298253032,y:-30.98155201578773},{x:245.17288219927178,y:-34.86656584089991},{x:247.76289141601325,y:-38.75157966601209},{x:251.64790524112541,y:-42.63659349112427},{x:256.8279236746083,y:-47.81661192460718},{x:264.5979513248327,y:-52.99663035809009},{x:271.0729743666863,y:-59.471653399943726},{x:277.54799740853997,y:-63.35666722505591},{x:284.0230204503936,y:-65.94667644179736},{x:290.49804349224723,y:-67.24168105016808},{x:298.26807114247157,y:-67.24168105016808},{x:306.03809879269596,y:-67.24168105016808},{x:313.8081264429203,y:-67.24168105016808},{x:321.5781540931447,y:-67.24168105016808},{x:328.0531771349983,y:-67.24168105016808},{x:333.2331955684812,y:-65.94667644179736},{x:335.8232047852227,y:-65.94667644179736},{x:337.1182093935934,y:-64.65167183342663},{x:338.4132140019641,y:-64.65167183342663},{x:335.8232047852227,y:-64.65167183342663},{x:333.2331955684812,y:-64.65167183342663},{x:325.46316791825683,y:-63.35666722505591},{x:317.6931402680325,y:-62.061662616685176},{x:311.21811722617883,y:-60.76665800831445},{x:303.4480895759545,y:-58.176648791572994},{x:294.38305731735943,y:-52.99663035809009},{x:286.61302966713504,y:-47.81661192460718},{x:277.54799740853997,y:-41.34158888275355},{x:271.0729743666863,y:-34.86656584089991},{x:265.89295593320344,y:-28.391542799046277},{x:262.00794210809124,y:-25.801533582304824},{x:260.7129374997205,y:-21.916519757192642},{x:259.4179328913498,y:-20.621515148821913},{x:258.12292828297905,y:-19.32651054045119},{x:258.12292828297905,y:-18.03150593208046},{x:258.12292828297905,y:-16.736501323709735},{x:258.12292828297905,y:-15.441496715339007},{x:258.12292828297905,y:-14.14649210696828},{x:258.12292828297905,y:-12.851487498597553},{x:258.12292828297905,y:-11.556482890226826},{x:258.12292828297905,y:-10.2614782818561},{x:258.12292828297905,y:-8.966473673485373},{x:259.4179328913498,y:-8.966473673485373},{x:259.4179328913498,y:-1.196446023261011}]},"shv.29_7s9cPPIlpJ9Np":{id:"shv.29_7s9cPPIlpJ9Np",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.3_mUCVyzbyAGCuIa",rawPoints:[{x:188.1926794309598,y:16.933618493929167},{x:192.07769325607197,y:10.458595452075532},{x:195.96270708118416,y:10.458595452075532},{x:202.4377301230378,y:9.163590843704805},{x:210.20775777326216,y:9.163590843704805},{x:217.97778542348652,y:7.868586235334078},{x:224.45280846534015,y:6.5735816269633505},{x:230.9278315071938,y:5.278577018592624},{x:236.1078499406767,y:2.68856780185117},{x:239.99286376578888,y:2.68856780185117},{x:242.58287298253032,y:1.3935631934804429},{x:243.87787759090105,y:1.3935631934804429},{x:245.17288219927178,y:1.3935631934804429},{x:246.46788680764251,y:1.3935631934804429}]},"shv.30_gZeoEkcUkLcml":{id:"shv.30_gZeoEkcUkLcml",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.4_SMMSTDAbn3tdXv",rawPoints:[{x:238.69785915741815,y:38.94869683623153},{x:232.22283611556452,y:41.53870605297298},{x:228.33782229045232,y:41.53870605297298},{x:225.7478130737109,y:45.42371987808516},{x:220.56779464022796,y:49.30873370319734},{x:216.6827808151158,y:54.48875213668025},{x:211.5027623816329,y:59.668770570163154},{x:206.32274394814996,y:66.1437936120168},{x:201.14272551466706,y:71.3238120454997},{x:198.5527162979256,y:76.50383047898261},{x:195.96270708118416,y:81.6838489124655},{x:194.66770247281343,y:84.27385812920697},{x:193.3726978644427,y:88.15887195431915},{x:193.3726978644427,y:89.45387656268987},{x:193.3726978644427,y:90.7488811710606},{x:193.3726978644427,y:93.33889038780205},{x:194.66770247281343,y:94.63389499617278},{x:198.5527162979256,y:95.92889960454352},{x:203.73273473140853,y:97.22390421291423},{x:208.91275316489143,y:98.51890882128497},{x:214.09277159837433,y:99.81391342965568},{x:220.56779464022796,y:99.81391342965568},{x:228.33782229045232,y:99.81391342965568},{x:237.40285454904742,y:97.22390421291423},{x:246.46788680764251,y:93.33889038780205},{x:256.8279236746083,y:88.15887195431915},{x:264.5979513248327,y:80.38884430409479},{x:272.36797897505704,y:72.61881665387043},{x:278.8430020169107,y:66.1437936120168},{x:282.72801584202284,y:60.96377517853388},{x:286.61302966713504,y:54.48875213668025},{x:287.90803427550577,y:49.30873370319734},{x:289.2030388838765,y:45.42371987808516},{x:289.2030388838765,y:44.128715269714434},{x:287.90803427550577,y:44.128715269714434},{x:285.3180250587643,y:44.128715269714434},{x:281.4330112336521,y:42.83371066134371},{x:276.25299280016924,y:42.83371066134371},{x:269.7779697583156,y:42.83371066134371},{x:262.00794210809124,y:42.83371066134371},{x:252.94290984949615,y:42.83371066134371},{x:245.17288219927178,y:42.83371066134371},{x:239.99286376578888,y:42.83371066134371},{x:237.40285454904742,y:42.83371066134371},{x:236.1078499406767,y:42.83371066134371},{x:236.1078499406767,y:44.128715269714434}]},"shv.32_Is4OGgrMoyylx":{id:"shv.32_Is4OGgrMoyylx",keyPointId:"key.3_RariJQz2eTMOkJ",shapeId:"shp.5_pFzZ21ghrzLlt1",rawPoints:[{x:377.26335225308594,y:20.81863231904135},{x:366.90331538612014,y:19.52362771067062},{x:364.3133061693787,y:19.52362771067062},{x:359.13328773589575,y:22.113636927412074},{x:352.65826469404215,y:27.29365536089498},{x:344.88823704381775,y:35.063683011119345},{x:337.1182093935934,y:44.128715269714434},{x:330.64318635173976,y:51.8987429199388},{x:326.75817252662756,y:59.668770570163154},{x:321.5781540931447,y:66.1437936120168},{x:320.28314948477396,y:72.61881665387043},{x:317.6931402680325,y:77.79883508735334},{x:317.6931402680325,y:80.38884430409479},{x:317.6931402680325,y:82.97885352083624},{x:318.9881448764032,y:84.27385812920697},{x:321.5781540931447,y:85.56886273757769},{x:326.75817252662756,y:85.56886273757769},{x:331.9381909601105,y:85.56886273757769},{x:339.7082186103348,y:84.27385812920697},{x:347.4782462605592,y:80.38884430409479},{x:355.24827391078355,y:76.50383047898261},{x:363.01830156100795,y:71.3238120454997},{x:370.7883292112323,y:67.43879822038751},{x:375.9683476447152,y:62.25877978690461},{x:381.14836607819814,y:57.078761353421704},{x:383.73837529493954,y:51.8987429199388},{x:387.62338912005174,y:46.71872448645588},{x:390.2133983367932,y:40.24370144460225},{x:392.80340755353467,y:35.063683011119345},{x:392.80340755353467,y:31.178669186007163},{x:392.80340755353467,y:28.58865996926571},{x:392.80340755353467,y:27.29365536089498},{x:390.2133983367932,y:27.29365536089498},{x:388.9183937284225,y:27.29365536089498},{x:387.62338912005174,y:27.29365536089498},{x:386.328384511681,y:27.29365536089498},{x:386.328384511681,y:28.58865996926571},{x:386.328384511681,y:31.178669186007163}]}}});function Xs({splatapus:t}){return _(X,{children:[p(ea,{splatapus:t}),p(Qs,{splatapus:t}),p(na,{splatapus:t}),p(ta,{splatapus:t})]})}function Qs({splatapus:t}){return p(oe,{onClick:()=>{const e=encodeURIComponent(JSON.stringify(lr({document:t.document.getOnce(),location:t.location.state.getOnce()}))),n=window.document.createElement("a");n.setAttribute("href",`data:text/json;charset=utf-8,${e}`),n.setAttribute("download","splatapus.json"),n.click()},children:"export"})}function ea({splatapus:t}){return p(oe,{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",n=>{var o;const r=(o=e.files)==null?void 0:o.item(0);if(!r)return;const i=new FileReader;i.addEventListener("load",()=>{const s=i.result;if(!s){alert("could not read file :(");return}M(typeof s=="string",'Assertion Error: typeof result === "string"');try{const a=ar(JSON.parse(s));if(a.isError()){alert(`cannot read splat doc: ${a.error.message}`);return}const l=a.value;t.document.update(()=>Q.deserialize(l.document),{lockstepLocation:u=>vt.deserialize(l.location)})}catch(a){alert(`could not parse json: ${Jr(a)}`)}}),i.readAsText(r)}),e.click()},children:"import"})}function ta({splatapus:t}){return p(oe,{onClick:()=>{const{document:e,location:n}=cr(L.UNIT);t.document.update(()=>e,{lockstepLocation:n})},children:"reset"})}function na({splatapus:t}){return Bn.isOk()?p(oe,{onClick:()=>{const e=Bn.unwrap(),n=Q.deserialize(e);t.document.update(()=>n,{lockstepLocation:ur(n,L.UNIT)})},children:"example"}):null}var Fr={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Un=T.createContext&&T.createContext(Fr),he=globalThis&&globalThis.__assign||function(){return he=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},he.apply(this,arguments)},ra=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function Rr(t){return t&&t.map(function(e,n){return T.createElement(e.tag,he({key:n},e.attr),Rr(e.child))})}function Vr(t){return function(e){return p(ia,{...he({attr:he({},t.attr)},e),children:Rr(t.child)})}}function ia(t){var e=function(n){var r=t.attr,i=t.size,o=t.title,s=ra(t,["attr","size","title"]),a=i||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),_("svg",{...he({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:he(he({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),children:[o&&p("title",{children:o}),t.children]})};return Un!==void 0?p(Un.Consumer,{children:function(n){return e(n)}}):e(Fr)}function oa(t){return Vr({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556 4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504 119.034 504 8.001 392.967 8 256.002 7.999 119.193 119.646 7.755 256.455 8z"}}]})(t)}function sa(t){return Vr({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M255.545 8c-66.269.119-126.438 26.233-170.86 68.685L48.971 40.971C33.851 25.851 8 36.559 8 57.941V192c0 13.255 10.745 24 24 24h134.059c21.382 0 32.09-25.851 16.971-40.971l-41.75-41.75c30.864-28.899 70.801-44.907 113.23-45.273 92.398-.798 170.283 73.977 169.484 169.442C423.236 348.009 349.816 424 256 424c-41.127 0-79.997-14.678-110.63-41.556-4.743-4.161-11.906-3.908-16.368.553L89.34 422.659c-4.872 4.872-4.631 12.815.482 17.433C133.798 479.813 192.074 504 256 504c136.966 0 247.999-111.033 248-247.998C504.001 119.193 392.354 7.755 255.545 8z"}}]})(t)}function aa({splatapus:t}){const e=H(()=>W.canUndo(t.undoStack.live()),[t]),n=H(()=>W.canRedo(t.undoStack.live()),[t]),r=jt(t.vfx,"undo",()=>({keyFrames:{transform:["rotate(0)","rotate(-360deg)"]},duration:300,easing:Vt.DEFAULT})),i=jt(t.vfx,"redo",()=>({keyFrames:{transform:["rotate(0)","rotate(360deg)"]},duration:300,easing:Vt.DEFAULT}));return _("div",{className:"pointer-events-auto pb-2 pl-3",children:[p(oe,{disabled:!e,className:j("transition-all duration-300",e?"pointer-events-auto ease-out-back":n?"pointer-events-none opacity-50":"pointer-events-none scale-0 opacity-0 ease-in-back"),onClick:()=>t.undoStack.update(o=>W.undo(o,t.vfx)),iconLeft:p("div",{className:"mt-[2px] h-3 w-3 transition-transform duration-300 ease-in-out",ref:r,children:p(sa,{size:12})}),children:"undo"}),p(oe,{disabled:!n,className:j("transition-all duration-300",n?"pointer-events-auto ease-out-back-md":"scale-0 opacity-0 ease-in-back-md"),onClick:()=>t.undoStack.update(o=>W.redo(o,t.vfx)),iconRight:p("div",{className:"mt-[2px] h-3 w-3 transition-transform duration-300 ease-in-out",ref:i,children:p(oa,{size:12})}),children:"redo"})]})}function la(){L.UNIT;{const t=ji("autosave");if(t.isOk())return t.value;console.error(`Error loading autosave: ${t.error}`)}return cr()}function ua(){const[t,e]=d.exports.useState(null),n=Ws(la),r=Yn(t,i=>{const o=ti(i);return n.screenSize.update(o),o});return p("div",{ref:e,className:"absolute inset-0 touch-none overflow-hidden",children:r&&p(ca,{splatapus:n})})}function ca({splatapus:t}){const e=d.exports.useRef(null);d.exports.useEffect(()=>{const r=Z(e.current);return r.addEventListener("wheel",t.onWheel,{passive:!1}),window.addEventListener("keydown",t.onKeyDown),window.addEventListener("keyup",t.onKeyUp),()=>{r.removeEventListener("wheel",t.onWheel),window.removeEventListener("keydown",t.onKeyDown),window.removeEventListener("keyup",t.onKeyUp)}},[t]),d.exports.useEffect(()=>ut(fe.idle,()=>{Wi("autosave",{document:t.document.live(),location:t.location.state.live()})}),[t]);const n=ie(t.interaction.activeMode);return _(X,{children:[_("div",{className:"absolute inset-0",ref:e,onPointerDown:t.onPointerDown,onPointerMove:t.onPointerMove,onPointerUp:t.onPointerUp,onPointerCancel:t.onPointerCancel,children:[p(vs,{splatapus:t}),p(St.Overlay,{splatapus:t,mode:n.type===A.Rig?n:null})]}),p(Zs,{topBarLeft:p(Qi,{splatapus:t}),topBarRight:p(Xs,{splatapus:t}),rightBar:p(qs,{splatapus:t}),bottomBarLeft:p(aa,{splatapus:t}),bottomBarRight:p(ds,{}),splatapus:t}),!1]})}const da=Z(document.getElementById("root"));ni(da).render(p(T.StrictMode,{children:p(ua,{})}));
