{"version":3,"sources":["lib/utils.ts","lib/geom/Vector2.ts","lib/DebugCanvas.ts","resources/canvas.ts","lib/createTriangleGrid.ts","lib/geom/AABB.ts","lib/QuadTree.ts","resources/resources-main.ts"],"names":[],"mappings":"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","file":"resources-main.ada03dd8.js","sourceRoot":"../src","sourcesContent":["export function times<T>(n: number, fn: (idx: number) => T): Array<T> {\n  const result = [];\n  for (let i = 0; i < n; i++) {\n    result.push(fn(i));\n  }\n  return result;\n}\n\nexport function lerp(a: number, b: number, n: number): number {\n  return (b - a) * n + a;\n}\n\nexport function invLerp(a: number, b: number, n: number): number {\n  return (n - a) / (b - a);\n}\n\nexport function constrain(min: number, max: number, n: number): number {\n  return Math.min(max, Math.max(min, n));\n}\n\nexport function constrainWrapped(min: number, max: number, n: number): number {\n  const size = max - min;\n  n = n - min;\n  while (n < 0) {\n    n += size;\n  }\n  n = n % size;\n  return min + n;\n}\n\nexport function mapRange(\n  a1: number,\n  b1: number,\n  a2: number,\n  b2: number,\n  n: number,\n): number {\n  return lerp(a2, b2, invLerp(a1, b1, n));\n}\n\nexport function random(a: number, b?: number) {\n  if (typeof b === 'number') {\n    return lerp(a, b, Math.random());\n  }\n  return lerp(0, a, Math.random());\n}\n\nexport function randomInt(a: number, b?: number) {\n  return Math.floor(random(a, b));\n}\n\nexport function varyAbsolute(base: number, amount: number): number {\n  return random(base - amount, base + amount);\n}\n\nexport function varyRelative(base: number, amount: number): number {\n  return varyAbsolute(base, base * amount);\n}\n\nexport function sample<T>(arr: ReadonlyArray<T>): T {\n  return arr[Math.floor(random(arr.length))];\n}\n\nexport function flatten<T>(arr: ReadonlyArray<ReadonlyArray<T>>): Array<T> {\n  return arr.reduce<Array<T>>((a, b) => a.concat(b), []);\n}\n\nexport function uniq<T>(arr: T[]): Array<T> {\n  return Array.from(new Set(arr));\n}\n\nexport function intersection<T>(a1: T[], a2: T[]): T[] {\n  const a1Items = new Set(a1);\n  const result = new Set<T>();\n  for (const item of a2) {\n    if (a1Items.has(item)) {\n      result.add(item);\n    }\n  }\n  return Array.from(result);\n}\n\nexport function groupBy<T, Key>(\n  items: ReadonlyArray<T>,\n  getKey: (item: T) => Key,\n): Map<Key, Array<T>> {\n  const groups = new Map<Key, T[]>();\n  for (const item of items) {\n    const key = getKey(item);\n    const existing = groups.get(key);\n    if (existing) {\n      existing.push(item);\n    } else {\n      groups.set(key, [item]);\n    }\n  }\n\n  return groups;\n}\n\nexport function sortBy<T, Key extends number | string>(\n  items: ReadonlyArray<T>,\n  getKey: (item: T) => Key,\n): Array<T> {\n  return items.slice().sort((a, b) => (getKey(a) < getKey(b) ? -1 : 1));\n}\n\nexport function partition<T>(\n  items: ReadonlyArray<T>,\n  condition: (item: T) => boolean,\n): [T[], T[]] {\n  const pass = [];\n  const fail = [];\n  for (const item of items) {\n    if (condition(item)) {\n      pass.push(item);\n    } else {\n      fail.push(item);\n    }\n  }\n  return [pass, fail];\n}\n\nexport function randomColor(): string {\n  return `rgb(${Math.floor(random(256))},${Math.floor(\n    random(256),\n  )},${Math.floor(random(256))})`;\n}\n\nexport function removeFromArray<T>(array: Array<T>, item: T) {\n  const idx = array.indexOf(item);\n  if (idx !== -1) {\n    array.splice(idx, 1);\n  }\n}\n\nexport function frame(): Promise<number> {\n  return new Promise((resolve) => {\n    window.requestAnimationFrame((time) => resolve(time));\n  });\n}\n\nexport function wait(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(() => resolve(), ms));\n}\n\nexport async function frameLoop(\n  cb: (time: number, cancel: () => void) => void,\n) {\n  let shouldCancel = false;\n  const cancel = () => {\n    shouldCancel = true;\n  };\n  while (true) {\n    cb(await frame(), cancel);\n    if (shouldCancel) {\n      return;\n    }\n  }\n}\n\nexport function fromEntries<K extends PropertyKey, V>(\n  entries: ReadonlyArray<[K, V]>,\n): Record<K, V> {\n  const result = {} as Record<K, V>;\n  for (const [key, value] of entries) {\n    result[key] = value;\n  }\n  return result;\n}\n\nexport function compact<T>(arr: ReadonlyArray<T>): Array<NonNullable<T>> {\n  return arr.filter(\n    (item): item is NonNullable<T> => item !== null && item !== undefined,\n  );\n}\n\nexport function normalizeAngle(angle: number): number {\n  return constrainWrapped(-Math.PI, Math.PI, angle);\n}\n\nexport function clamp(min: number, max: number, n: number): number {\n  return Math.max(min, Math.min(max, n));\n}\n\nexport function shuffle<T>(arr: ReadonlyArray<T>): Array<T> {\n  const newArr = arr.slice();\n  for (let i = newArr.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [newArr[i], newArr[j]] = [newArr[j], newArr[i]];\n  }\n  return newArr;\n}\n\nexport function getId(prefix = ''): string {\n  return `${prefix}${Math.random().toString(36).slice(1)}`;\n}\n\nexport function getLocalStorageItem(\n  key: string,\n  fallback: unknown = null,\n): unknown {\n  try {\n    // Get from local storage by key\n    const item = window.localStorage.getItem(key);\n    // Parse stored json or if none return initialValue\n    return item ? JSON.parse(item) : fallback;\n  } catch (error) {\n    // If error also return initialValue\n    console.log(error);\n    return fallback;\n  }\n}\n\nexport function setLocalStorageItem(key: string, value: unknown) {\n  window.localStorage.setItem(key, JSON.stringify(value));\n}\n\nexport function debounce<Args extends Array<unknown>>(\n  ms: number,\n  fn: (...args: Args) => void,\n): (...args: Args) => void {\n  let timeoutHandle: number | undefined;\n\n  return (...args: Args) => {\n    clearTimeout(timeoutHandle);\n    timeoutHandle = setTimeout(() => fn(...args), ms);\n  };\n}\n","import { normalizeAngle, lerp } from '../utils';\n\nexport default class Vector2 {\n  static readonly ZERO = new Vector2(0, 0);\n\n  static fromPolar(angle: number, radius: number) {\n    return new Vector2(radius * Math.cos(angle), radius * Math.sin(angle));\n  }\n\n  static average(points: ReadonlyArray<Vector2>): Vector2 {\n    const sum = points.reduce((memo, p) => memo.add(p), Vector2.ZERO);\n    return sum.div(points.length);\n  }\n\n  constructor(public readonly x: number, public readonly y: number) {}\n\n  toString(): string {\n    return `Vector2(${this.x}, ${this.y})`;\n  }\n\n  get magnitudeSquared(): number {\n    return this.x * this.x + this.y * this.y;\n  }\n\n  get magnitude(): number {\n    return Math.sqrt(this.magnitudeSquared);\n  }\n\n  get angle(): number {\n    return Math.atan2(this.y, this.x);\n  }\n\n  isInPolygon(polygon: ReadonlyArray<Vector2>): boolean {\n    // ray-casting algorithm based on\n    // http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n\n    const { x, y } = this;\n\n    let isInside = false;\n    for (\n      let currentIdx = 0, previousIdx = polygon.length - 1;\n      currentIdx < polygon.length;\n      previousIdx = currentIdx++\n    ) {\n      const { x: currentX, y: currentY } = polygon[currentIdx];\n      const { x: previousX, y: previousY } = polygon[previousIdx];\n      const doesIntersect =\n        currentY > y != previousY > y &&\n        x <\n          ((previousX - currentX) * (y - currentY)) / (previousY - currentY) +\n            currentX;\n\n      if (doesIntersect) {\n        isInside = !isInside;\n      }\n    }\n\n    return isInside;\n  }\n\n  equals(other: Vector2) {\n    return this === other || (this.x === other.x && this.y === other.y);\n  }\n\n  distanceTo({ x, y }: Vector2): number {\n    const dx = x - this.x;\n    const dy = y - this.y;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  angleTo(other: Vector2): number {\n    return other.sub(this).angle;\n  }\n\n  angleBetween(other: Vector2): number {\n    return normalizeAngle(\n      Math.atan2(other.y, other.x) - Math.atan2(this.y, this.x),\n    );\n  }\n\n  dot(other: Vector2): number {\n    return this.x * other.x + this.y * other.y;\n  }\n\n  div(scale: number): Vector2 {\n    return new Vector2(this.x / scale, this.y / scale);\n  }\n\n  scale(scale: number): Vector2 {\n    return new Vector2(this.x * scale, this.y * scale);\n  }\n\n  negate(): Vector2 {\n    return this.scale(-1);\n  }\n\n  add({ x, y }: Vector2): Vector2 {\n    return new Vector2(this.x + x, this.y + y);\n  }\n\n  sub({ x, y }: Vector2): Vector2 {\n    return new Vector2(this.x - x, this.y - y);\n  }\n\n  floor(): Vector2 {\n    return new Vector2(Math.floor(this.x), Math.floor(this.y));\n  }\n\n  ceil(): Vector2 {\n    return new Vector2(Math.ceil(this.x), Math.ceil(this.y));\n  }\n\n  round(): Vector2 {\n    return new Vector2(Math.round(this.x), Math.round(this.y));\n  }\n\n  withMagnitude(newMagnitude: number): Vector2 {\n    return Vector2.fromPolar(this.angle, newMagnitude);\n  }\n\n  withAngle(newAngle: number): Vector2 {\n    return Vector2.fromPolar(newAngle, this.magnitude);\n  }\n\n  rotate(byAngle: number): Vector2 {\n    return this.withAngle(this.angle + byAngle);\n  }\n\n  lerp(other: Vector2, n: number): Vector2 {\n    return new Vector2(lerp(this.x, other.x, n), lerp(this.y, other.y, n));\n  }\n}\n","import Vector2 from './geom/Vector2';\n\nconst DEFAULT_DEBUG_COLOR = 'magenta';\nconst LABEL_OFFSET = new Vector2(5, 0);\nconst DEBUG_POINT_SIZE = 3;\nconst HAIRLINE = 0.5;\nconst DEBUG_ARROW_ANGLE = Math.PI * 0.75;\nconst DEBUG_ARROW_SIZE = 5;\n\ntype StrokeOptions = {\n  strokeWidth?: number;\n  stroke?: string;\n  strokeCap?: 'butt' | 'round' | 'square';\n  strokeDash?: number[];\n  strokeDashOffset?: number;\n  strokeJoin?: 'bevel' | 'round' | 'miter';\n};\n\ntype FillOptions = {\n  fill?: string;\n};\n\ntype DebugOptions = {\n  color?: string;\n  label?: string;\n};\n\ntype StrokeAndFillOptions = StrokeOptions & FillOptions;\n\nexport class DebugDraw {\n  constructor(private readonly ctx: CanvasRenderingContext2D) {}\n\n  public clear(fill?: string) {\n    if (!fill) {\n      this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n    }\n\n    this.applyFillOptions({ fill });\n    this.ctx.fillRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n  }\n\n  public beginPath() {\n    this.ctx.beginPath();\n  }\n\n  public moveTo({ x, y }: Vector2) {\n    this.ctx.moveTo(x, y);\n  }\n\n  public lineTo({ x, y }: Vector2) {\n    this.ctx.lineTo(x, y);\n  }\n\n  public arc(\n    { x, y }: Vector2,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise?: boolean,\n  ) {\n    this.ctx.arc(x, y, radius, startAngle, endAngle, anticlockwise);\n  }\n\n  public arcTo(p1: Vector2, p2: Vector2, radius: number) {\n    this.ctx.arcTo(p1.x, p1.y, p2.x, p2.y, radius);\n  }\n\n  public applyStrokeOptions({\n    strokeWidth = 1,\n    stroke = undefined,\n    strokeCap = 'butt',\n    strokeDash = [],\n    strokeDashOffset = 0,\n    strokeJoin = 'round',\n  }: StrokeOptions) {\n    if (stroke) {\n      this.ctx.lineWidth = strokeWidth;\n      this.ctx.strokeStyle = stroke;\n      this.ctx.lineCap = strokeCap;\n      this.ctx.setLineDash(strokeDash);\n      this.ctx.lineDashOffset = strokeDashOffset;\n      this.ctx.lineJoin = strokeJoin;\n    }\n  }\n\n  public stroke(options: StrokeOptions) {\n    if (options.stroke) {\n      this.applyStrokeOptions(options);\n      this.ctx.stroke();\n    }\n  }\n\n  public applyFillOptions({ fill = undefined }: FillOptions) {\n    if (fill) {\n      this.ctx.fillStyle = fill;\n    }\n  }\n\n  public fill(options: FillOptions) {\n    if (options.fill) {\n      this.applyFillOptions(options);\n      this.ctx.fill();\n    }\n  }\n\n  public applyStrokeAndFillOptions(options: StrokeAndFillOptions) {\n    this.applyFillOptions(options);\n    this.applyStrokeOptions(options);\n  }\n\n  public strokeAndFill(options: StrokeAndFillOptions) {\n    this.fill(options);\n    this.stroke(options);\n  }\n\n  public getDebugStrokeOptions(\n    color: string = DEFAULT_DEBUG_COLOR,\n  ): StrokeOptions {\n    return { stroke: color, strokeWidth: HAIRLINE };\n  }\n\n  public debugStroke(color: string = DEFAULT_DEBUG_COLOR) {\n    this.stroke(this.getDebugStrokeOptions(color));\n  }\n\n  public fillText(text: string, position: Vector2, options: FillOptions = {}) {\n    this.applyFillOptions(options);\n    this.ctx.fillText(text, position.x, position.y);\n  }\n\n  public circle(\n    center: Vector2,\n    radius: number,\n    options: StrokeAndFillOptions,\n  ) {\n    this.beginPath();\n    this.arc(center, radius, 0, 2 * Math.PI);\n    this.strokeAndFill(options);\n  }\n\n  public debugLabel(\n    label: string | undefined,\n    position: Vector2,\n    color: string,\n  ) {\n    if (label) {\n      this.applyFillOptions({ fill: color });\n      this.fillText(label, position.add(LABEL_OFFSET));\n    }\n  }\n\n  public debugPointX(\n    position: Vector2,\n    { color = DEFAULT_DEBUG_COLOR, label = undefined }: DebugOptions = {},\n  ) {\n    this.debugLabel(label, position, color);\n\n    this.beginPath();\n    this.ctx.moveTo(\n      position.x - DEBUG_POINT_SIZE,\n      position.y - DEBUG_POINT_SIZE,\n    );\n    this.ctx.lineTo(\n      position.x + DEBUG_POINT_SIZE,\n      position.y + DEBUG_POINT_SIZE,\n    );\n    this.ctx.moveTo(\n      position.x + DEBUG_POINT_SIZE,\n      position.y - DEBUG_POINT_SIZE,\n    );\n    this.ctx.lineTo(\n      position.x - DEBUG_POINT_SIZE,\n      position.y + DEBUG_POINT_SIZE,\n    );\n    this.stroke({ strokeWidth: HAIRLINE, stroke: color });\n  }\n\n  public debugPointO(\n    position: Vector2,\n    { color = DEFAULT_DEBUG_COLOR, label = undefined }: DebugOptions = {},\n  ) {\n    this.debugLabel(label, position, color);\n\n    this.circle(position, DEBUG_POINT_SIZE, {\n      strokeWidth: HAIRLINE,\n      stroke: color,\n    });\n  }\n\n  public debugArrow(\n    start: Vector2,\n    end: Vector2,\n    { color = DEFAULT_DEBUG_COLOR, label = undefined }: DebugOptions = {},\n  ) {\n    this.debugLabel(label, Vector2.average([start, end]), color);\n\n    this.ctx.beginPath();\n    this.moveTo(start);\n    this.lineTo(end);\n\n    const vector = end.sub(start);\n    const arrowLeftPoint = vector\n      .rotate(-DEBUG_ARROW_ANGLE)\n      .withMagnitude(DEBUG_ARROW_SIZE)\n      .add(end);\n    const arrowRightPoint = vector\n      .rotate(+DEBUG_ARROW_ANGLE)\n      .withMagnitude(DEBUG_ARROW_SIZE)\n      .add(end);\n\n    this.moveTo(arrowLeftPoint);\n    this.lineTo(end);\n    this.lineTo(arrowRightPoint);\n    this.stroke({ strokeWidth: HAIRLINE, stroke: color });\n  }\n\n  public debugVectorAtPoint(\n    vector: Vector2,\n    base: Vector2,\n    options?: DebugOptions,\n  ) {\n    this.debugArrow(base, base.add(vector), options);\n  }\n\n  public polygon(\n    polygon: ReadonlyArray<Vector2>,\n    options: StrokeAndFillOptions = {},\n  ) {\n    this.beginPath();\n    this.moveTo(polygon[polygon.length - 1]);\n    for (const point of polygon) {\n      this.lineTo(point);\n    }\n    this.strokeAndFill(options);\n  }\n\n  public polyLine(points: ReadonlyArray<Vector2>, options: StrokeOptions = {}) {\n    this.beginPath();\n    this.moveTo(points[0]);\n    for (let i = 1; i < points.length; i++) {\n      this.lineTo(points[i]);\n    }\n    this.stroke(options);\n  }\n\n  public debugPolygon(\n    polygon: ReadonlyArray<Vector2>,\n    { color = DEFAULT_DEBUG_COLOR, label = undefined }: DebugOptions = {},\n  ) {\n    this.debugLabel(label, polygon[0], color);\n    this.polygon(polygon, this.getDebugStrokeOptions(color));\n  }\n\n  public debugPolyLine(\n    polyLine: ReadonlyArray<Vector2>,\n    { color = DEFAULT_DEBUG_COLOR, label = undefined }: DebugOptions = {},\n  ) {\n    this.debugLabel(label, polyLine[0], color);\n    this.polyLine(polyLine, this.getDebugStrokeOptions(color));\n  }\n}\n","import { DebugDraw } from '../lib/DebugCanvas';\n\nexport const canvasEl = document.createElement('canvas');\nexport const ctx = canvasEl.getContext('2d')!;\nexport const width = document.body.clientWidth;\nexport const height = document.body.clientHeight;\nexport const scale = window.devicePixelRatio;\n\ncanvasEl.width = width * scale;\ncanvasEl.height = height * scale;\ncanvasEl.style.width = `${width}px`;\ncanvasEl.style.height = `${height}px`;\nctx.scale(scale, scale);\nexport const canvas = new DebugDraw(ctx);\ndocument.body.appendChild(canvasEl);\n","import Vector2 from '../lib/geom/Vector2';\nimport { getId, compact, intersection } from '../lib/utils';\nimport Intersection from '../network/networkNodes/Intersection';\n\ntype TriangleGeom = [Vector2, Vector2, Vector2];\ntype IntermediateTriangle = {\n  id: string;\n  points: TriangleGeom;\n};\n\nexport type TriangleNeighbour = {\n  triangle: Triangle;\n  sharedPoints: [Vector2, Vector2];\n};\nexport type Triangle = {\n  id: string;\n  center: Vector2;\n  points: TriangleGeom;\n  neighbours: TriangleNeighbour[];\n  ix: number;\n  iy: number;\n};\n\nexport default function createTriangleGrid(\n  tileSize: number,\n  width: number,\n  height: number,\n): Map<string, Triangle> {\n  const tileHeight = (tileSize * Math.sqrt(3)) / 2;\n  const points: Vector2[][] = [];\n  const trianglePoints: IntermediateTriangle[][] = [];\n  for (let iy = 0; iy * tileHeight < height + tileHeight; iy++) {\n    const pointRow: Vector2[] = [];\n    points.push(pointRow);\n    const triangleRow: IntermediateTriangle[] = [];\n    trianglePoints.push(triangleRow);\n    for (let ix = 0; ix * tileSize < width + tileSize; ix++) {\n      const xOffset = iy % 2 === 0 ? -tileSize / 2 : 0;\n      const point = new Vector2(ix * tileSize + xOffset, iy * tileHeight);\n      pointRow.push(point);\n\n      if (iy !== 0 && ix !== 0) {\n        if (iy % 2 === 0) {\n          const triangle1: IntermediateTriangle = {\n            id: getId('triangle'),\n            points: [point, points[iy][ix - 1], points[iy - 1][ix - 1]],\n          };\n          const triangle2: IntermediateTriangle = {\n            id: getId('triangle'),\n            points: [point, points[iy - 1][ix - 1], points[iy - 1][ix]],\n          };\n          triangleRow.push(triangle1, triangle2);\n        } else if (points[iy - 1][ix + 1]) {\n          const triangle1: IntermediateTriangle = {\n            id: getId('triangle'),\n            points: [point, points[iy][ix - 1], points[iy - 1][ix]],\n          };\n          const triangle2: IntermediateTriangle = {\n            id: getId('triangle'),\n            points: [point, points[iy - 1][ix + 1], points[iy - 1][ix]],\n          };\n          triangleRow.push(triangle1, triangle2);\n        }\n      }\n    }\n  }\n\n  const trianglesById = new Map<string, Triangle>();\n  for (let iy = 0; iy < trianglePoints.length; iy++) {\n    for (let ix = 0; ix < trianglePoints[iy].length; ix++) {\n      const triangle = trianglePoints[iy][ix];\n      const center = Vector2.average(triangle.points);\n\n      const neighbours = compact(\n        ix % 2 === 0\n          ? iy % 2 === 0\n            ? [\n                // 2,2\n                trianglePoints[iy]?.[ix - 1],\n                trianglePoints[iy]?.[ix + 1],\n                trianglePoints[iy + 1]?.[ix - 1],\n              ]\n            : [\n                // 2,3\n                trianglePoints[iy]?.[ix - 1],\n                trianglePoints[iy]?.[ix + 1],\n                trianglePoints[iy + 1]?.[ix + 1],\n              ]\n          : iy % 2 === 0\n          ? [\n              // 3,2\n              trianglePoints[iy]?.[ix - 1],\n              trianglePoints[iy]?.[ix + 1],\n              trianglePoints[iy - 1]?.[ix - 1],\n            ]\n          : [\n              //3,3\n              trianglePoints[iy]?.[ix - 1],\n              trianglePoints[iy]?.[ix + 1],\n              trianglePoints[iy - 1]?.[ix + 1],\n            ],\n      );\n\n      const fullTriangle = triangle as Triangle;\n      fullTriangle.center = center;\n      fullTriangle.neighbours = neighbours.map(neighbourTriangle => ({\n        triangle: neighbourTriangle,\n        sharedPoints: intersection(triangle.points, neighbourTriangle.points),\n      })) as TriangleNeighbour[];\n      fullTriangle.ix = ix;\n      fullTriangle.iy = iy;\n\n      trianglesById.set(fullTriangle.id, fullTriangle);\n    }\n  }\n\n  return trianglesById;\n}\n","import Vector2 from './Vector2';\n\nexport default class AABB {\n  static fromLeftTopRightBottom(\n    left: number,\n    top: number,\n    right: number,\n    bottom: number,\n  ): AABB {\n    return new AABB(\n      new Vector2(left, top),\n      new Vector2(right - left, bottom - top),\n    );\n  }\n\n  constructor(public readonly origin: Vector2, public readonly size: Vector2) {\n    Object.freeze(this);\n  }\n\n  contains({ x, y }: Vector2): boolean {\n    return (\n      this.left <= x && x <= this.right && this.top <= y && y <= this.bottom\n    );\n  }\n\n  intersects(other: AABB): boolean {\n    return !(\n      this.right < other.left ||\n      this.left > other.right ||\n      this.bottom < other.top ||\n      this.top > other.bottom\n    );\n  }\n\n  getCenter(): Vector2 {\n    return this.origin.add(this.size.scale(0.5));\n  }\n\n  get left(): number {\n    return this.origin.x;\n  }\n\n  get right(): number {\n    return this.origin.x + this.size.x;\n  }\n\n  get top(): number {\n    return this.origin.y;\n  }\n\n  get bottom(): number {\n    return this.origin.y + this.size.y;\n  }\n}\n","import AABB from './geom/AABB';\nimport Circle from './geom/Circle';\nimport Vector2 from './geom/Vector2';\n\ntype Subdivisions<T> = [QuadTree<T>, QuadTree<T>, QuadTree<T>, QuadTree<T>];\n\nexport default class QuadTree<T> {\n  static NODE_CAPACITY = 4;\n\n  boundary: AABB;\n  _items: (T | void)[] = [];\n  _nextItemIndex: number = 0;\n  _subdivisions: null | Subdivisions<T> = null;\n  _getPosition: (item: T) => Vector2;\n\n  constructor(boundary: AABB, getPosition: (item: T) => Vector2) {\n    this.boundary = boundary;\n    this._getPosition = getPosition;\n  }\n\n  // debugDraw(color: string) {\n  //   this.boundary.debugDraw(color);\n  //   if (this._subdivisions) {\n  //     this._subdivisions.forEach(subdivision => subdivision.debugDraw(color));\n  //   }\n  // }\n\n  insert(item: T): boolean {\n    const point = this._getPosition(item);\n    if (!this.boundary.contains(point)) return false;\n\n    if (this._nextItemIndex < QuadTree.NODE_CAPACITY) {\n      this._items[this._nextItemIndex] = item;\n      this._nextItemIndex++;\n      return true;\n    }\n\n    const subdivisions = this._getSubdivisions();\n\n    if (subdivisions[0].insert(item)) return true;\n    if (subdivisions[1].insert(item)) return true;\n    if (subdivisions[2].insert(item)) return true;\n    if (subdivisions[3].insert(item)) return true;\n\n    throw new Error('Couldnt insert item');\n  }\n\n  remove(item: T): boolean {\n    const point = this._getPosition(item);\n    if (!this.boundary.contains(point)) return false;\n\n    const index = this._items.indexOf(item);\n    if (index !== -1) {\n      this._items.splice(index, 1);\n      this._nextItemIndex--;\n      return true;\n    }\n\n    const subdivisions = this._subdivisions;\n    if (subdivisions) {\n      if (subdivisions[0].remove(item)) return true;\n      if (subdivisions[1].remove(item)) return true;\n      if (subdivisions[2].remove(item)) return true;\n      if (subdivisions[3].remove(item)) return true;\n    }\n\n    return false;\n  }\n\n  clear() {\n    for (let i = 0; i < this._nextItemIndex; i++) {\n      this._items[i] = undefined;\n      this._nextItemIndex = 0;\n    }\n\n    if (this._subdivisions) {\n      this._subdivisions.forEach(subdivision => subdivision.clear());\n    }\n  }\n\n  findItemsInRect(rect: AABB): T[] {\n    const foundItems = [] as Array<T>;\n\n    if (!this.boundary.intersects(rect)) return foundItems;\n\n    for (let i = 0; i < this._nextItemIndex; i++) {\n      const item = this._items[i];\n      if (item == null) continue;\n      const point = this._getPosition(item);\n      if (rect.contains(point)) foundItems.push(item);\n    }\n\n    const subdivisions = this._subdivisions;\n    if (!subdivisions) return foundItems;\n\n    if (subdivisions[0].boundary.intersects(rect)) {\n      foundItems.push(...subdivisions[0].findItemsInRect(rect));\n    }\n    if (subdivisions[1].boundary.intersects(rect)) {\n      foundItems.push(...subdivisions[1].findItemsInRect(rect));\n    }\n    if (subdivisions[2].boundary.intersects(rect)) {\n      foundItems.push(...subdivisions[2].findItemsInRect(rect));\n    }\n    if (subdivisions[3].boundary.intersects(rect)) {\n      foundItems.push(...subdivisions[3].findItemsInRect(rect));\n    }\n\n    return foundItems;\n  }\n\n  findItemsInCircle(circle: Circle): T[] {\n    return this.findItemsInRect(circle.getBoundingBox()).filter(item =>\n      circle.containsPoint(this._getPosition(item)),\n    );\n  }\n\n  _getSubdivisions(): Subdivisions<T> {\n    if (this._subdivisions) return this._subdivisions;\n\n    const center = this.boundary.getCenter();\n    const subdivisions: Subdivisions<T> = [\n      new QuadTree(\n        AABB.fromLeftTopRightBottom(\n          this.boundary.left,\n          this.boundary.top,\n          center.x,\n          center.y,\n        ),\n        this._getPosition,\n      ),\n      new QuadTree(\n        AABB.fromLeftTopRightBottom(\n          center.x,\n          this.boundary.top,\n          this.boundary.right,\n          center.y,\n        ),\n        this._getPosition,\n      ),\n      new QuadTree(\n        AABB.fromLeftTopRightBottom(\n          this.boundary.left,\n          center.y,\n          center.x,\n          this.boundary.bottom,\n        ),\n        this._getPosition,\n      ),\n      new QuadTree(\n        AABB.fromLeftTopRightBottom(\n          center.x,\n          center.y,\n          this.boundary.right,\n          this.boundary.bottom,\n        ),\n        this._getPosition,\n      ),\n    ];\n\n    this._subdivisions = subdivisions;\n    return subdivisions;\n  }\n}\n","import { canvas, width, height } from './canvas';\nimport createTriangleGrid, { Triangle } from '../lib/createTriangleGrid';\nimport QuadTree from '../lib/QuadTree';\nimport AABB from '../lib/geom/AABB';\nimport Vector2 from '../lib/geom/Vector2';\nimport Circle from '../lib/geom/Circle';\n\nconst TILE_SIZE = 30;\n\nconst triangles = createTriangleGrid(TILE_SIZE, width, height);\nconst triangleQuadTree = new QuadTree<Triangle>(\n  new AABB(\n    new Vector2(-TILE_SIZE, -TILE_SIZE),\n    new Vector2(width + TILE_SIZE, height + TILE_SIZE),\n  ),\n  triangle => triangle.center,\n);\nfor (const triangle of triangles.values()) {\n  triangleQuadTree.insert(triangle);\n}\n\nconst items = triangleQuadTree.findItemsInRect(\n  new AABB(new Vector2(100, 100), new Vector2(200, 200)),\n  // new Circle(width * 0.75, height * 0.35, TILE_SIZE * 8),\n);\n\nconsole.log(items);\n\nfor (const wood of items) {\n  // canvas.polygon(wood.points, {} });\n  canvas.debugPolygon(wood.points);\n}\n\n// for (const triangle of triangles.values()) {\n//   console.log(triangle);\n// }\n"]}