!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},a=t.parcelRequire0561;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var a={id:e,exports:{}};return n[e]=a,t.call(a.exports,a,a.exports),a.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){r[e]=t},t.parcelRequire0561=a),a.register("dLeLC",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("8TSCy"),s=a("8OvEy"),i=function(){"use strict";function e(t,n,a){var i=void 0===a?1:a,o=this;r.classCallCheck(this,e),this._children=[],this._isPlaying=!1,this.frameHandle=null,this.lastElapsedTime=null,this.systemsByClass=new Map,this._tick=function(e){e*=1;var t=o.lastElapsedTime;if(null!==t){var n=e-t;o.isPlaying&&(o.update(n),o.draw(e))}o.lastElapsedTime=e,o.frameHandle=window.requestAnimationFrame(o._tick)},this.canvas=document.createElement("canvas"),this.canvas.width=t*i,this.canvas.height=n*i,this.canvas.style.width="".concat(t,"px"),this.canvas.style.height="".concat(n,"px");var l=this.canvas.getContext("2d");s.assert(l,"ctx"),this.ctx=l,this._scaleFactor=1*i,this._setupVisiblityChange()}return r.createClass(e,[{key:"width",get:function(){return this.canvas.width/this._scaleFactor}},{key:"height",get:function(){return this.canvas.height/this._scaleFactor}},{key:"scaleFactor",get:function(){return this._scaleFactor}},{key:"isPlaying",get:function(){return null!==this.frameHandle&&this._isPlaying},set:function(e){s.assert(null!==this.frameHandle,"cannot set isPlaying without calling start"),this._isPlaying=e}},{key:"children",get:function(){return this._children}},{key:"appendTo",value:function(e){e.appendChild(this.canvas)}},{key:"hasSystem",value:function(e){return this.systemsByClass.has(e)}},{key:"getSystem",value:function(e){var t=this.systemsByClass.get(e);return s.assert(t,"system, ".concat(e.systemName," not found")),s.assert(t instanceof e,"system is wrong instance type"),t}},{key:"addSystem",value:function(e){s.assert(!this.hasSystem(e.constructor),"only one system of each type allowed"),this.systemsByClass.set(e.constructor,e),e.afterAddToScene(this)}},{key:"removeSystem",value:function(e){this.getSystem(e).beforeRemoveFromScene(this),this.systemsByClass.delete(e)}},{key:"addChild",value:function(e){this._children.push(e),e.onAddedToScene(this)}},{key:"addChildBefore",value:function(e,t){var n=this._children.indexOf(e);s.assert(-1!==n,"target child must be present"),this.addChildAtIndex(n,t)}},{key:"addChildAfter",value:function(e,t){var n=this._children.indexOf(e);s.assert(-1!==n,"target child must be present"),this.addChildAtIndex(n+1,t)}},{key:"addChildAtIndex",value:function(e,t){this._children.splice(e,0,t),t.onAddedToScene(this)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return-1!==t&&(this.removeChildAtIndex(t),!0)}},{key:"removeChildAtIndex",value:function(e){var t=this._children[e];return this._children.splice(e,1),t.onRemovedFromScene(),t}},{key:"update",value:function(e){for(var t=0;t<1;t++){var n=!0,r=!1,a=void 0;try{for(var s,i=this.systemsByClass.values()[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){s.value.beforeUpdate(e)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}this._children.forEach((function(t){return t.update(e)}));var o=!0,l=!1,c=void 0;try{for(var u,h=this.systemsByClass.values()[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){u.value.afterUpdate(e)}}catch(e){l=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}}}},{key:"draw",value:function(e){var t=this;this.ctx.save(),this.ctx.scale(this._scaleFactor,this._scaleFactor),this.ctx.clearRect(0,0,this.width,this.height);var n=!0,r=!1,a=void 0;try{for(var s,i=this.systemsByClass.values()[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){s.value.beforeDraw(this.ctx,e)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}this._children.sort((function(e,t){return e.getSortOrder()-t.getSortOrder()})).forEach((function(n){return n.draw(t.ctx,e)}));var o=!0,l=!1,c=void 0;try{for(var u,h=this.systemsByClass.values()[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){u.value.afterDraw(this.ctx,e)}}catch(e){l=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}this.ctx.restore()}},{key:"start",value:function(){this._isPlaying=!0,this.frameHandle=window.requestAnimationFrame(this._tick)}},{key:"stop",value:function(){null!==this.frameHandle&&(window.cancelAnimationFrame(this.frameHandle),this.frameHandle=null),this._isPlaying=!1,this.lastElapsedTime=null}},{key:"_setupVisiblityChange",value:function(){var e=this,t=!1;document.addEventListener("visibilitychange",(function(){document.hidden&&e.isPlaying&&(t=!0,e.stop()),t&&!document.hidden&&(t=!1,e.start())}))}}]),e}()})),a.register("8OvEy",(function(t,n){function r(e){throw new Error(e)}function a(e,t){e||r(t||"Assertion Error")}e(t.exports,"fail",(function(){return r})),e(t.exports,"assert",(function(){return a}))})),a.register("bADSp",(function(t,n){e(t.exports,"default",(function(){return l}));var r=a("8TSCy"),s=a("dXT6b"),i=a("8OvEy"),o=a("kqysl"),l=function(e){"use strict";function t(){var e;return r.classCallCheck(this,t),(e=r.possibleConstructorReturn(this,r.getPrototypeOf(t).apply(this,arguments))).componentInstances=new Map,e}return r.inherits(t,e),r.createClass(t,[{key:"addComponent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];i.assert(!this.componentInstances.has(e),"component instance ".concat(e.name," already exists"));var s=r.construct(e,[this].concat(r.toConsumableArray(n)));return this.componentInstances.set(e,s),s}},{key:"hasComponent",value:function(e){return this.componentInstances.has(e)}},{key:"getComponent",value:function(e){var t=this.componentInstances.get(e);return i.assert(t,"no instance for ".concat(e.name," exists")),i.assert(t instanceof e,"wrong instance type"),t}},{key:"removeComponent",value:function(e){var t=this.getComponent(e);return this.componentInstances.delete(e),t.onRemove(),t}},{key:"draw",value:function(e,t){var n=!0,r=!1,a=void 0;try{for(var s,i=this.componentInstances.values()[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){s.value.beforeDraw(e,t)}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}var o=!0,l=!1,c=void 0;try{for(var u,h=this.componentInstances.values()[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){u.value.draw(e,t)}}catch(e){l=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(l)throw c}}var d=!0,f=!1,y=void 0;try{for(var v,m=this.componentInstances.values()[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){v.value.afterDraw(e,t)}}catch(e){f=!0,y=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw y}}}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,s=this.componentInstances.values()[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){a.value.beforeUpdate(e)}}catch(e){n=!0,r=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}var i=!0,o=!1,l=void 0;try{for(var c,u=this.componentInstances.values()[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){c.value.update(e)}}catch(e){o=!0,l=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw l}}var h=!0,d=!1,f=void 0;try{for(var y,v=this.componentInstances.values()[Symbol.iterator]();!(h=(y=v.next()).done);h=!0){y.value.afterUpdate(e)}}catch(e){d=!0,f=e}finally{try{h||null==v.return||v.return()}finally{if(d)throw f}}}},{key:"onAddedToScene",value:function(e){r.get(r.getPrototypeOf(t.prototype),"onAddedToScene",this).call(this,e);var n=!0,a=!1,s=void 0;try{for(var i,o=this.componentInstances.values()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){i.value.onAddedToScene(e)}}catch(e){a=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}}},{key:"onRemovedFromScene",value:function(){var e=this.getScene();r.get(r.getPrototypeOf(t.prototype),"onRemovedFromScene",this).call(this);var n=!0,a=!1,s=void 0;try{for(var i,o=this.componentInstances.values()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){i.value.onRemovedFromScene(e)}}catch(e){a=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}}},{key:"getSortOrder",value:function(){return this.hasComponent(o.default)?this.getComponent(o.default).getSortOrder():r.get(r.getPrototypeOf(t.prototype),"getSortOrder",this).call(this)}}]),t}(s.default)})),a.register("dXT6b",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("8TSCy"),s=a("8OvEy"),i={},o=function(){"use strict";function e(){var t;r.classCallCheck(this,e),this.id=(t=this.constructor.name,i[t]||(i[t]=0),"".concat(t,"@").concat(i[t]++)),this.scene=null}return r.createClass(e,[{key:"hasScene",value:function(){return null!==this.scene}},{key:"getScene",value:function(){return s.assert(this.scene,"scene must be present"),this.scene}},{key:"draw",value:function(e,t){}},{key:"update",value:function(e){}},{key:"addTo",value:function(e){return e.addChild(this),this}},{key:"onAddedToScene",value:function(e){this.scene=e}},{key:"onRemovedFromScene",value:function(){this.scene=null}},{key:"getSortOrder",value:function(){return 0}}]),e}()})),a.register("kqysl",(function(t,n){e(t.exports,"default",(function(){return s}));var r=a("8TSCy"),s=function(e){"use strict";function t(e,n){var a;return r.classCallCheck(this,t),(a=r.possibleConstructorReturn(this,r.getPrototypeOf(t).call(this,e))).getSortOrderFn=n,a}return r.inherits(t,e),r.createClass(t,[{key:"getSortOrder",value:function(){return this.getSortOrderFn(this.entity)}}]),t}(a("3Nswo").default)})),a.register("3Nswo",(function(t,n){e(t.exports,"default",(function(){return s}));var r=a("8TSCy"),s=function(){"use strict";function e(t){r.classCallCheck(this,e),this.entity=t}return r.createClass(e,[{key:"onRemove",value:function(){}},{key:"onAddedToScene",value:function(e){}},{key:"onRemovedFromScene",value:function(e){}},{key:"beforeUpdate",value:function(e){}},{key:"update",value:function(e){}},{key:"afterUpdate",value:function(e){}},{key:"beforeDraw",value:function(e,t){}},{key:"draw",value:function(e,t){}},{key:"afterDraw",value:function(e,t){}},{key:"getScene",value:function(){return this.entity.getScene()}}]),e}()}))}();
//# sourceMappingURL=index.88fdd217.js.map
