import{b as g,H as _,a as S,M as U}from"./chunk_utils.f92ef315.js";function n(t){return WebGL2RenderingContext[t]}var f=(t=>(t.Fragment="FRAGMENT_SHADER",t.Vertex="VERTEX_SHADER",t))(f||{}),L=(t=>(t.StaticDraw="STATIC_DRAW",t.DynamicDraw="DYNAMIC_DRAW",t.StreamDraw="STREAM_DRAW",t.StaticRead="STATIC_READ",t.DynamicRead="DYNAMIC_READ",t.StreamRead="STREAM_READ",t.StaticCopy="STATIC_COPY",t.DynamicCopy="DYNAMIC_COPY",t.StreamCopy="STREAM_COPY",t))(L||{}),N=(t=>(t.Byte="BYTE",t.UnsignedByte="UNSIGNED_BYTE",t.Short="SHORT",t.UnsignedShort="UNSIGNED_SHORT",t.Float="FLOAT",t.HalfFloat="HALF_FLOAT",t))(N||{}),T=(t=>(t.Rgb="RGB",t.Rgba="RGBA",t.LuminanceAlpha="LUMINANCE_ALPHA",t.Luminance="LUMINANCE",t.Alpha="ALPHA",t.Red="RED",t.RedInteger="RED_INTEGER",t.Rg="RG",t.RgInteger="RG_INTEGER",t.RgbInteger="RGB_INTEGER",t.RgbaInteger="RGBA_INTEGER",t))(T||{}),p=(t=>(t.UnsignedByte="UNSIGNED_BYTE",t.UnsignedShort565="UNSIGNED_SHORT_5_6_5",t.UnsignedShort4444="UNSIGNED_SHORT_4_4_4_4",t.UnsignedShort5551="UNSIGNED_SHORT_5_5_5_1",t.HalfFloat="HALF_FLOAT",t.Float="FLOAT",t.UnsignedInt10f11f11fRev="UNSIGNED_INT_10F_11F_11F_REV",t.UnsignedInt2101010Rev="UNSIGNED_INT_2_10_10_10_REV",t))(p||{}),b=(t=>(t.Rgb="RGB",t.Rgba="RGBA",t.LuminanceAlpha="LUMINANCE_ALPHA",t.Luminance="LUMINANCE",t.Alpha="ALPHA",t.R8="R8",t.R16f="R16F",t.R32f="R32F",t.R8ui="R8UI",t.Rg8="RG8",t.Rg16f="RG16F",t.Rg32f="RG32F",t.Rg8ui="RG8UI",t.Rgb8="RGB8",t.Srgb8="SRGB8",t.Rgb565="RGB565",t.R11fG11fB10f="R11F_G11F_B10F",t.Rgb9E5="RGB9_E5",t.Rgb16f="RGB16F",t.Rgb32f="RGB32F",t.Rgb8ui="RGB8UI",t.Rgba8="RGBA8",t.Srgb8Alpha8="SRGB8_ALPHA8",t.Rgb5A1="RGB5_A1",t.Rgb10A2="RGB10_A2",t.Rgba4="RGBA4",t.Rgba16f="RGBA16F",t.Rgba32f="RGBA32F",t.Rgba8ui="RGBA8UI",t))(b||{}),u=(t=>(t.Linear="LINEAR",t.Nearest="NEAREST",t.NearestMipmapNearest="NEAREST_MIPMAP_NEAREST",t.LinearMipmapNearest="LINEAR_MIPMAP_NEAREST",t.NearestMipmapLinear="NEAREST_MIPMAP_LINEAR",t.LinearMipmapLinear="LINEAR_MIPMAP_LINEAR",t))(u||{}),E=(t=>(t.Repeat="REPEAT",t.ClampToEdge="CLAMP_TO_EDGE",t.MirroredRepeat="MIRRORED_REPEAT",t))(E||{}),D=(t=>(t.Blend="BLEND",t.CullFace="CULL_FACE",t.DepthTest="DEPTH_TEST",t.Dither="DITHER",t.PolygonOffsetFill="POLYGON_OFFSET_FILL",t.SampleAlphaToCoverage="SAMPLE_ALPHA_TO_COVERAGE",t.SampleCoverage="SAMPLE_COVERAGE",t.ScissorTest="SCISSOR_TEST",t.StencilTest="STENCIL_TEST",t.RasterizerDiscard="RASTERIZER_DISCARD",t))(D||{});class m{constructor(e,r){this.gl=e,this.buffer=r}bufferData(e,r){const{gl:s}=this.gl;s.bindBuffer(s.ARRAY_BUFFER,this.buffer),s.bufferData(s.ARRAY_BUFFER,e,n(r))}}class h{constructor(e,r,s,i){this.gl=e,this.name=r,this.location=s,this._value=i}get value(){return typeof this._value=="function"?this._value():this._value}set value(e){this._value=e}}class v extends h{apply(){this.gl.gl.uniform2f(this.location,this.value.x,this.value.y)}}class B extends h{apply(){this.gl.gl.uniform3f(this.location,this.value.x,this.value.y,this.value.z)}}class M extends h{apply(){this.gl.gl.uniform4f(this.location,...this.value)}}class I extends h{apply(){this.gl.gl.uniformMatrix3fv(this.location,!1,new Float32Array(this.value.data))}}class y extends h{apply(){this.gl.gl.uniformMatrix4fv(this.location,!1,new Float32Array(this.value.data))}}class w extends h{apply(){this.gl.gl.uniform1f(this.location,this.value)}}class P extends h{apply(){this.gl.gl.uniform1ui(this.location,this.value?1:0)}}class C extends h{apply(){this.gl.gl.uniform1i(this.location,this.value.textureUnit)}}class O extends h{apply(){this.gl.gl.uniform1i(this.location,this.value)}}class V extends m{constructor(e,r,s){super(e,s),this.vertexArray=r}bindVao(){const{gl:e}=this.gl;e.bindVertexArray(this.vertexArray)}}class H{constructor(e,r,s){this.vertexShader=r,this.fragmentShader=s,this.uniforms=[],this.gl=e;const{gl:i}=e,a=g(i.createProgram(),"Assertion Error: gl.createProgram()");if(i.attachShader(a,r.shader),i.attachShader(a,s.shader),i.linkProgram(a),!i.getProgramParameter(a,i.LINK_STATUS)){const o=`Failed to link shaders: ${i.getProgramInfoLog(a)}`;i.deleteProgram(a),_(o)}this.program=a}createAndBindVertexArrayObject({name:e,size:r,type:s,normalize:i=!1,stride:a=0,offset:c=0}){const{gl:o}=this.gl,R=this.gl.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,R);const d=this.gl.createVertexArray();o.bindVertexArray(d);const l=o.getAttribLocation(this.program,e);return o.enableVertexAttribArray(l),o.vertexAttribPointer(l,r,n(s),i,a,c),new V(this.gl,d,R)}createAndBindVertexAttribute({name:e,size:r,type:s,normalize:i=!1,stride:a=0,offset:c=0}){const{gl:o}=this.gl,R=this.gl.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,R);const d=o.getAttribLocation(this.program,e);return o.enableVertexAttribArray(d),o.vertexAttribPointer(d,r,n(s),i,a,c),new m(this.gl,R)}getUniformLocation(e){return g(this.gl.gl.getUniformLocation(this.program,e),`uniform ${e} does not exist`)}addUniform(e,r,s){const i=new e(this.gl,r,this.getUniformLocation(r),s);return this.uniforms.push(i),i}uniformVector2(e,r){return this.addUniform(v,e,r)}uniformVector3(e,r){return this.addUniform(B,e,r)}uniformVector4(e,r){return this.addUniform(M,e,r)}uniformMatrix3(e,r){return this.addUniform(I,e,r)}uniformMatrix4(e,r){return this.addUniform(y,e,r)}uniformFloat(e,r){return this.addUniform(w,e,r)}uniformBool(e,r){return this.addUniform(P,e,r)}uniformTexture2d(e,r){return this.addUniform(C,e,r)}uniformEnum(e,r){return this.addUniform(O,e,r)}use(){this.gl.gl.useProgram(this.program);for(const e of this.uniforms)e.apply()}}class F{constructor(e,r,s){this.type=r,this.gl=e;const{gl:i}=e,a=g(i.createShader(n(r)),"Assertion Error: gl.createShader(glEnum(type))");if(i.shaderSource(a,s),i.compileShader(a),!i.getShaderParameter(a,i.COMPILE_STATUS)){const o=`Failed to compile shader: ${i.getShaderInfoLog(a)}`;i.deleteShader(a),_(o)}this.shader=a}}class x{constructor(e,r,s,i){this.gl=e,this.textureUnit=r,this.format=s,this.data=null,this.level=i??0,this.texture=g(e.gl.createTexture(),"Assertion Error: gl.gl.createTexture()")}set(e){this.data=e}bind(){const{gl:e}=this.gl;e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_2D,this.texture)}configure(e){const{gl:r}=this.gl;this.bind(),e.magFilter&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n(e.magFilter)),e.minFilter&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n(e.minFilter)),e.wrapS&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,n(e.wrapS)),e.wrapT&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,n(e.wrapT))}configureForData(){this.configure({magFilter:u.Nearest,minFilter:u.Nearest,wrapS:E.ClampToEdge,wrapT:E.ClampToEdge})}upload(){S(this.data,"data must be set on texture to upload"),this.bind(),this.gl.gl.texImage2D(WebGL2RenderingContext.TEXTURE_2D,this.level,n(this.format.internalFormat),this.data.width,this.data.height,0,n(this.format.pixelFormat),n(this.format.pixelType),this.data.data)}update(e){this.set(e),this.upload()}}const X=(t,...e)=>{let r="";for(let s=0;s<t.length;s++)r+=t[s],s<e.length&&(r+=e[s]);return r};class W{constructor(e){this.canvas=e,this.shaders=new A((s,i)=>new F(this,s,i),s=>this.gl.deleteShader(s.shader)),this.programs=new A((s,i)=>new H(this,s,i),s=>this.gl.deleteProgram(s.program)),this.buffers=new A(()=>g(this.gl.createBuffer(),"Assertion Error: this.gl.createBuffer()"),s=>this.gl.deleteBuffer(s)),this.vertexArrays=new A(()=>g(this.gl.createVertexArray(),"Assertion Error: this.gl.createVertexArray()"),s=>this.gl.deleteVertexArray(s)),this.textures=new A((s,i,a)=>new x(this,s,i,a),s=>this.gl.deleteTexture(s.texture));const r=e.getContext("webgl2");S(r,"browser does not support webgl2"),this.gl=r}destroy(){this.shaders.destroyAll(),this.programs.destroyAll(),this.buffers.destroyAll(),this.vertexArrays.destroyAll(),this.textures.destroyAll()}createProgram({vertex:e,fragment:r}){const s=this.shaders.create(f.Vertex,e),i=this.shaders.create(f.Fragment,r);return this.programs.create(s,i)}createBuffer(){return this.buffers.create()}createVertexArray(){return this.vertexArrays.create()}createTexture(e,r,s){return this.textures.create(e,r,s)}setDefaultViewport(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}clear(){const{gl:e}=this;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}enumToString(e){const r=[];for(const s in this.gl)U(this.gl,s)===e&&r.push(s);return r.length?r.join(" | "):`0x${e.toString(16)}`}drawTriangles(e,r,s){e.use(),r.bindVao(),this.gl.drawArrays(this.gl.TRIANGLES,0,s)}enable(e){this.gl.enable(n(e))}}class A{constructor(e,r){this.initializeResource=e,this.deleteResource=r,this.resources=[]}create(...e){const r=this.initializeResource(...e);return this.resources.push(r),r}destroyAll(){for(const e of this.resources)this.deleteResource(e);this.resources=[]}}export{W as G,N as a,b,p as c,T as d,L as e,D as f,X as g};
