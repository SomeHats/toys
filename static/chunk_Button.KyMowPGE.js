import{j as c}from"./chunk_client.CotzxIPX.js";import{u as B}from"./chunk_useMergedRefs.MPIvL6fk.js";import{a as S}from"./chunk_theme.DQE7OmCU.js";import{u as R,a as $,b as T}from"./chunk_useResizeObserver.DnDEPOOq.js";import{a as m,b as I}from"./chunk_assert.pxkjFBOg.js";import{E as k}from"./chunk_EventEmitter.BsO-_0un.js";import{a as M,r}from"./chunk_index.C5eOxiyT.js";import{R as x,V as j}from"./chunk_Vector2.BFoa__dl.js";import{a as F,A as y,O as U}from"./chunk_utils.CSiPn6yw.js";import{c as C}from"./chunk_index.ZX3Pv0I0.js";let o=null,h=null;function O(){if(!h)return;const i=h;h=null,M.unstable_batchedUpdates(()=>{for(const e of i)e.emit()})}function P(){m(o===null,"Assertion Error: pendingSyncInvalidations === null"),o=new Set}function w(){m(o,"Assertion Error: pendingSyncInvalidations");const i=o;o=null;for(const e of i)e.emit();o&&w()}function q(){return!!o}let G=0;function Q(i){return`unknown ${i} ${G++}`}class E{constructor(e,t){this.eagerInvalidation=new k,this.batchedInvalidation=new k,this.debugName=e??Q(t)}getDebugName(){return this.debugName}addEagerListener(e){return this.eagerInvalidation.listen(e)}addBatchListener(e){return this.batchedInvalidation.listen(e)}invalidate(){o?o.add(this.eagerInvalidation):this.eagerInvalidation.emit(),h||(h=new Set,queueMicrotask(O)),h.add(this.batchedInvalidation)}listenerCount(){return this.eagerInvalidation.listenerCount()+this.batchedInvalidation.listenerCount()}hasListeners(){return this.eagerInvalidation.hasListeners()||this.batchedInvalidation.hasListeners()}}let p=0;function z(){p++}let a=null;function W(i,e,t){return a||P(),a={shouldTrack:!0,previousDependencies:i,nextDependencies:new Map,previous:a,invalidateListener:e,shouldListen:t},a}function _(i){if(m(a===i,"Assertion Error: computationContext === context"),a=a.previous,i.shouldTrack&&i.previousDependencies)for(const[e,{unsubscribe:t}]of i.previousDependencies)i.nextDependencies.has(e)||t==null||t();return i.nextDependencies}function A(){q()&&!a&&w()}function V(i){var e,t;if(m(a,"cannot call .live() outside of a live context"),a.shouldTrack&&!a.nextDependencies.has(i)){const n=a.shouldListen?((t=(e=a.previousDependencies)==null?void 0:e.get(i))==null?void 0:t.unsubscribe)??i.addEagerInvalidateListener(a.invalidateListener):null,s=i.getOnce();a.nextDependencies.set(i,{value:s,unsubscribe:n})}}function Z(i,e){for(const[t,{value:n}]of i)if(!Object.is(t.getOnce(),n))return!0;return!1}function ve(i){const e={shouldTrack:!1,previous:a};a=e;const t=i();return m(a===e,"Assertion Error: computationContext === nonTracking"),a=e.previous,t}class D{constructor(e,t,n){this.compute=e,this._isValid=!1,this.validForGlobalVersion=-1,this.dependencies=null,this.isComputing=!1,this.completion=null,this.invalidate=()=>{m(!this.isComputing,"cannot write whilst computing dependant live computation"),this._isValid&&(this._isValid=!1,this.invalidation.invalidate())},this.invalidation=new E(t,n)}getDebugName(){return this.invalidation.getDebugName()}computeIfNeeded(){if(this.isValid())return I(this.completion,"Assertion Error: this.completion");if(this.dependencies&&!Z(this.dependencies,this.getDebugName()))return this.makeValidAt(p),I(this.completion,"Assertion Error: this.completion");const e=p,t=W(this.dependencies,this.invalidate,this.invalidation.hasListeners());this.isComputing=!0;let n;try{this.completion=x.ok(this.compute()),n=!0}catch(s){this.completion=x.error(s),n=!1}return this.isComputing=!1,this.dependencies=_(t),n?(this.makeValidAt(e),A(),this.computeIfNeeded()):A(),this.completion}isValid(){return this.invalidation.hasListeners()?this._isValid:this.validForGlobalVersion===p}makeValidAt(e){this._isValid=p===e,this.validForGlobalVersion=e}addEagerInvalidateListener(e){const t=this.invalidation.hasListeners(),n=this.invalidation.addEagerListener(e);return t||this.subscribeToDependencies(),()=>{n(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}addBatchInvalidateListener(e){const t=this.invalidation.hasListeners(),n=this.invalidation.addBatchListener(e);return t||this.subscribeToDependencies(),()=>{n(),this.invalidation.hasListeners()||this.unsubscribeFromDependencies()}}subscribeToDependencies(){if(this.isValid()&&this.dependencies)for(const[e,t]of this.dependencies)t.unsubscribe=e.addEagerInvalidateListener(this.invalidate);else this.computeIfNeeded()}unsubscribeFromDependencies(){var e;if(this.dependencies)for(const t of this.dependencies.values())(e=t.unsubscribe)==null||e.call(t),t.unsubscribe=null}}const H=globalThis.requestIdleCallback??globalThis.requestAnimationFrame,J=globalThis.cancelIdleCallback??globalThis.cancelAnimationFrame,f=class f{constructor(e,t,n){this.schedule=t,this.cancelScheduledCallback=null,this.unsubscribe=null,this.invalidate=()=>{this.cancelScheduledCallback=this.schedule(this.recompute)},this.recompute=()=>{this.cancelScheduledCallback=null,this.computation.computeIfNeeded()},this.computation=new D(e,n,"LiveEffect"),this.cancelScheduledCallback=t(()=>{this.cancelScheduledCallback=null,this.unsubscribe=this.computation.addEagerInvalidateListener(this.invalidate)})}cancel(){var e,t;(e=this.cancelScheduledCallback)==null||e.call(this),(t=this.unsubscribe)==null||t.call(this)}};f.eager=e=>(e(),F),f.frame=e=>{const t=requestAnimationFrame(e);return()=>cancelAnimationFrame(t)},f.idle=e=>{const t=H(e);return()=>J(t)};let g=f;class N{constructor(e,t,n="LiveMemo"){this.completion=null,this.computation=new D(e,t,n)}getDebugName(){return this.computation.getDebugName()}getOnce(){return this.completion=this.computation.computeIfNeeded(),this.completion.unwrap()}live(){return this.completion=this.computation.computeIfNeeded(),V(this),this.completion.unwrap()}addEagerInvalidateListener(e){return this.computation.addEagerInvalidateListener(e)}addBatchInvalidateListener(e){return this.computation.addBatchInvalidateListener(e)}}class ge extends N{constructor(e,t,n){super(e,n,"LiveMemoWritable"),this.write=t}update(e,...t){this.write(e,...t)}}class K{constructor(e,t){this.pendingUpdates=null,this.isUpdating=!1,this.wasRead=!0,this.value=e,this.invalidation=new E(t,"LiveValue")}getDebugName(){return this.invalidation.getDebugName()}markRead(){this.wasRead=!0}getOnce(){return this.markRead(),this.value}live(){return this.markRead(),V(this),this.value}update(e){if(this.isUpdating){this.pendingUpdates??(this.pendingUpdates=[]),this.pendingUpdates.push(e);return}this.isUpdating=!0;try{if(this.value=y(this.value,e),this.invalidate(),this.pendingUpdates)for(let t=0;t<this.pendingUpdates.length;t++)this.value=y(this.value,e),this.invalidate()}finally{this.pendingUpdates=null,this.isUpdating=!1}}invalidate(){this.wasRead&&(this.wasRead=!1,this.invalidation.invalidate(),z())}addEagerInvalidateListener(e){return this.invalidation.addEagerListener(e)}addBatchInvalidateListener(e){return this.invalidation.addBatchListener(e)}getInvalidateListenerCount(){return this.invalidation.listenerCount()}}function X(i){const e=r.useRef(!0);e.current=!0;try{const t=r.useSyncExternalStore(r.useCallback(n=>i.addBatchInvalidateListener(n),[i]),()=>{if(e.current)return i.getOnce();try{return i.getOnce()}catch(n){return console.groupCollapsed("[useLiveValue caught error]"),console.log(n),console.groupEnd(),{}}});return r.useDebugValue(t),t}finally{e.current=!1}}function Y(i,e){const n=r.useMemo(()=>new N(i,void 0),e),s=X(n);return r.useDebugValue(s),s}function be(i,e){const t=new g(e,i);return()=>t.cancel()}let ee=1;class Le{constructor(){this.activeAnimations=new K({},"vfx.activeAnimations")}triggerAnimation(e){this.activeAnimations.update(t=>({...t,[e]:ee++}))}getActiveAnimationIdLive(e){return U(this.activeAnimations.live(),e)??null}acknowledgeAnimation(e,t){this.activeAnimations.update(n=>{const{[e]:s,...l}=n;return s!==t?n:l})}}function te(i,e,t){const n=r.useRef(null),s=Y(()=>i.getActiveAnimationIdLive(e),[e,i]),l=R(t);return r.useEffect(()=>{const u=n.current;if(!u||!s)return;const v=l(),d=u.animate(v.keyFrames,v);return d.addEventListener("finish",()=>{i.acknowledgeAnimation(e,s)}),d.play(),()=>{d.cancel()}},[s,l,e,i]),n}function ie(i,e=1/0){const t=$(i,T)??j.ZERO;return r.useMemo(()=>{if(!t)return"none";const n=Math.min(t.x*.5,t.y*.5,e);return`path('${[`M 0,${n}`,`Q 0,0 ${n},0`,`T ${t.x-n},0`,`Q ${t.x},0 ${t.x},${n}`,`T ${t.x},${t.y-n}`,`Q ${t.x},${t.y} ${t.x-n},${t.y}`,`T ${n},${t.y}`,`Q 0,${t.y} 0,${t.y-n}`,"Z"].join(" ")}')`},[t,e])}const ne=r.forwardRef(function({children:e,className:t,iconLeft:n,iconRight:s,...l},u){return c.jsxs(ae,{className:C(t,"justify-center gap-2 px-4 py-1"),ref:u,...l,children:[n,c.jsx(se,{children:e}),s]})});function se({children:i}){return c.jsx("span",{className:"inline-block transition-transform duration-200 ease-out-back-md group-hover:scale-110 group-active:scale-95",children:i})}const ae=r.forwardRef(function({className:e,style:t,...n},s){const[l,u]=r.useState(null),v=ie(l),d=B(u,s),b=C("group inline-flex items-center rounded text-center font-bold tracking-wide text-stone-400 hover:bg-stone-300/25 hover:text-stone-500 focus:outline-none focus-visible:text-stone-600",e),L={...t,clipPath:v};return n.href?c.jsx("a",{ref:d,className:b,style:L,...n}):c.jsx("button",{ref:d,className:b,style:L,...n})});function Ie({children:i,actionName:e,vfx:t,...n}){const s=te(t,e,()=>({keyFrames:{transform:["scale(1)","scale(0.8)","scale(1)"]},duration:300,easing:S.outBackMd}));return c.jsx(ne,{...n,children:c.jsx("span",{className:"inline-block",ref:s,children:i})})}export{Ie as A,ne as B,K as L,ae as P,Le as V,g as a,ie as b,Y as c,ve as d,ge as e,N as f,te as g,be as r,X as u};
