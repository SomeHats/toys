import{b as y,a as C}from"./assert.8e182e5c.js";import{D as P}from"./DebugDraw.4d6413b5.js";import{V as k}from"./Vector2.1dd7230e.js";import{f as S,s as b,r as I,t as N,q as G,u as L}from"./utils.7cc05280.js";import{c as W}from"./createTriangleGrid.25efe050.js";import{C as c}from"./index.509b8e21.js";const g=document.createElement("canvas"),D=y(g.getContext("2d")),m=document.body.clientWidth,p=document.body.clientHeight,d=window.devicePixelRatio;g.width=m*d;g.height=p*d;g.style.width=`${m}px`;g.style.height=`${p}px`;D.scale(d,d);const i=new P(D);document.body.appendChild(g);const q=new c("#E2ECC9"),A=[new c("#C33C54"),new c("#bfb915"),new c("#96ba3b"),new c("#39847f"),new c("#12416b")],h=50,l=Math.PI*h/6,B=W(h,m,p),v=()=>{const e=N(G(2,6),()=>b(A).string());if(L(e).length===1)return v();let s=0;return{palette:e,current:()=>e[s%e.length],next:()=>(s++,e[s%e.length]),reset:(n=0)=>{s=n}}};function w(e,s){const n=e.neighbours.find(t=>t.triangle===s);return C(n,"must be a neighbour"),n.sharedPoints}const f=new Set,x=()=>{const e=[],s=v();let n=[...B.values()];for(let t=0;t<2;t++){const a=n.filter(r=>!f.has(r));if(!a.length)break;const o=b(a);e.push(o),f.add(o),n=o.neighbours.map(r=>r.triangle)}return{triangles:e,palette:s,speed:I(.06,.12),offset:0,base:0,length:e.length,isDead:!1}},u=[];for(let e=0;e<10;e++)u.push(x());S(()=>{i.clear(q.string());for(const e of u){if(e.offset+=e.speed,e.offset>1){if(e.offset--,e.base++,!e.isDead){const o=e.triangles[0].neighbours.filter(r=>!f.has(r.triangle));if(o.length){const r=b(o).triangle;f.add(r),e.triangles.unshift(r),e.base--,e.length++}else e.isDead=!0,u.push(x())}const t=e.triangles[e.triangles.length-e.base];t&&(f.delete(t),e.length--)}const{triangles:s,palette:n}=e;n.reset(e.base);for(let t=0;t<e.length;t++){const a=s[t],o=s[t-1],r=s[t+1],T=n.current(),E=n.next();if(i.beginPath(),o)r?(i.moveTo(k.average(w(a,o))),i.arcTo(a.center,r.center,h/2-.5)):(C(o),i.moveTo(k.average(w(a,o))),i.lineTo(a.center));else continue;t===1&&!e.isDead||i.stroke({strokeWidth:h/2,stroke:T,strokeCap:"round",strokeDash:[l,l],strokeDashOffset:e.offset*l}),t===e.length-1&&e.isDead||i.stroke({strokeWidth:h/2,stroke:E,strokeCap:"round",strokeDash:[l,l],strokeDashOffset:e.offset*l-l})}}});
