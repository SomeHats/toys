import{b as N,f as pe,a as z,g as ze,c as T,d as F,t as Oe,r as C,s as V,i as ke,j as v}from"../chunks/chunk_assert.132f6b36.js";/* empty css                               */import{u as U,e as O,t as w,m as Fe,d as H,c as Ve,a as He,s as Xe}from"../chunks/chunk_theme.ab8349b3.js";import{r as p}from"../chunks/chunk_index.8cb7377b.js";import{V as I}from"../chunks/chunk_Vector2.44438dce.js";import{D as Ye}from"../chunks/chunk_DebugDraw.4b9e3e4f.js";import{j as l,F as Re,a as A,c as je}from"../chunks/chunk_jsx-runtime.e6b2899b.js";import{C as te}from"../chunks/chunk_index.9d850002.js";import{d as ve,e as Ee,R as _e,C as ye,r as We,n as q,h as $e}from"../chunks/chunk_color.0fee8ab4.js";import"../chunks/chunk__commonjsHelpers.fbcca4d8.js";function _(e){return WebGL2RenderingContext[e]}var re=(e=>(e.Fragment="FRAGMENT_SHADER",e.Vertex="VERTEX_SHADER",e))(re||{}),xe=(e=>(e.StaticDraw="STATIC_DRAW",e.DynamicDraw="DYNAMIC_DRAW",e.StreamDraw="STREAM_DRAW",e.StaticRead="STATIC_READ",e.DynamicRead="DYNAMIC_READ",e.StreamRead="STREAM_READ",e.StaticCopy="STATIC_COPY",e.DynamicCopy="DYNAMIC_COPY",e.StreamCopy="STREAM_COPY",e))(xe||{}),Ae=(e=>(e.Byte="BYTE",e.UnsignedByte="UNSIGNED_BYTE",e.Short="SHORT",e.UnsignedShort="UNSIGNED_SHORT",e.Float="FLOAT",e.HalfFloat="HALF_FLOAT",e))(Ae||{}),Se=(e=>(e.Rgb="RGB",e.Rgba="RGBA",e.LuminanceAlpha="LUMINANCE_ALPHA",e.Luminance="LUMINANCE",e.Alpha="ALPHA",e.Red="RED",e.RedInteger="RED_INTEGER",e.Rg="RG",e.RgInteger="RG_INTEGER",e.RgbInteger="RGB_INTEGER",e.RgbaInteger="RGBA_INTEGER",e))(Se||{}),we=(e=>(e.UnsignedByte="UNSIGNED_BYTE",e.UnsignedShort565="UNSIGNED_SHORT_5_6_5",e.UnsignedShort4444="UNSIGNED_SHORT_4_4_4_4",e.UnsignedShort5551="UNSIGNED_SHORT_5_5_5_1",e.HalfFloat="HALF_FLOAT",e.Float="FLOAT",e.UnsignedInt10f11f11fRev="UNSIGNED_INT_10F_11F_11F_REV",e.UnsignedInt2101010Rev="UNSIGNED_INT_2_10_10_10_REV",e))(we||{}),Ce=(e=>(e.Rgb="RGB",e.Rgba="RGBA",e.LuminanceAlpha="LUMINANCE_ALPHA",e.Luminance="LUMINANCE",e.Alpha="ALPHA",e.R8="R8",e.R16f="R16F",e.R32f="R32F",e.R8ui="R8UI",e.Rg8="RG8",e.Rg16f="RG16F",e.Rg32f="RG32F",e.Rg8ui="RG8UI",e.Rgb8="RGB8",e.Srgb8="SRGB8",e.Rgb565="RGB565",e.R11fG11fB10f="R11F_G11F_B10F",e.Rgb9E5="RGB9_E5",e.Rgb16f="RGB16F",e.Rgb32f="RGB32F",e.Rgb8ui="RGB8UI",e.Rgba8="RGBA8",e.Srgb8Alpha8="SRGB8_ALPHA8",e.Rgb5A1="RGB5_A1",e.Rgb10A2="RGB10_A2",e.Rgba4="RGBA4",e.Rgba16f="RGBA16F",e.Rgba32f="RGBA32F",e.Rgba8ui="RGBA8UI",e))(Ce||{}),oe=(e=>(e.Linear="LINEAR",e.Nearest="NEAREST",e.NearestMipmapNearest="NEAREST_MIPMAP_NEAREST",e.LinearMipmapNearest="LINEAR_MIPMAP_NEAREST",e.NearestMipmapLinear="NEAREST_MIPMAP_LINEAR",e.LinearMipmapLinear="LINEAR_MIPMAP_LINEAR",e))(oe||{}),ne=(e=>(e.Repeat="REPEAT",e.ClampToEdge="CLAMP_TO_EDGE",e.MirroredRepeat="MIRRORED_REPEAT",e))(ne||{});class k{constructor(t,r,o,n){this.gl=t,this.name=r,this.location=o,this.value=n}}class Ke extends k{apply(){this.gl.gl.uniform2f(this.location,this.value.x,this.value.y)}}class Ze extends k{apply(){this.gl.gl.uniform1f(this.location,this.value)}}class qe extends k{apply(){this.gl.gl.uniform1ui(this.location,this.value?1:0)}}class Je extends k{apply(){this.gl.gl.uniform1i(this.location,this.value.textureUnit)}}class Qe extends k{apply(){this.gl.gl.uniform1i(this.location,this.value)}}class Ge{constructor(t,r,o){this.gl=t,this.vertexArray=r,this.buffer=o}bufferData(t,r){const{gl:o}=this.gl;o.bindBuffer(o.ARRAY_BUFFER,this.buffer),o.bufferData(o.ARRAY_BUFFER,t,_(r))}bindVao(){const{gl:t}=this.gl;t.bindVertexArray(this.vertexArray)}}class et{constructor(t,r,o){this.vertexShader=r,this.fragmentShader=o,this.uniforms=[],this.gl=t;const{gl:n}=t,i=N(n.createProgram());if(n.attachShader(i,r.shader),n.attachShader(i,o.shader),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS)){const a=`Failed to link shaders: ${n.getProgramInfoLog(i)}`;n.deleteProgram(i),pe(a)}this.program=i}createAndBindVertexArray({name:t,size:r,type:o,normalize:n=!1,stride:i=0,offset:d=0}){const{gl:a}=this.gl,b=this.gl.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);const h=this.gl.createVertexArray();a.bindVertexArray(h);const c=a.getAttribLocation(this.program,t);return a.enableVertexAttribArray(c),a.vertexAttribPointer(c,r,_(o),n,i,d),new Ge(this.gl,h,b)}getUniformLocation(t){return N(this.gl.gl.getUniformLocation(this.program,t),`uniform ${t} does not exist`)}addUniform(t,r,o){const n=new t(this.gl,r,this.getUniformLocation(r),o);return this.uniforms.push(n),n}uniformVector2(t,r){return this.addUniform(Ke,t,r)}uniformFloat(t,r){return this.addUniform(Ze,t,r)}uniformBool(t,r){return this.addUniform(qe,t,r)}uniformTexture2d(t,r){return this.addUniform(Je,t,r)}uniformEnum(t,r){return this.addUniform(Qe,t,r)}use(){this.gl.gl.useProgram(this.program);for(const t of this.uniforms)t.apply()}}class tt{constructor(t,r,o){this.type=r,this.gl=t;const{gl:n}=t,i=N(n.createShader(_(r)));if(n.shaderSource(i,o),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){const a=`Failed to compile shader: ${n.getShaderInfoLog(i)}`;n.deleteShader(i),pe(a)}this.shader=i}}class rt{constructor(t,r,o,n){this.gl=t,this.textureUnit=r,this.format=o,this.data=null,this.level=n!=null?n:0,this.texture=N(t.gl.createTexture())}set(t){this.data=t}bind(){const{gl:t}=this.gl;t.activeTexture(t.TEXTURE0+this.textureUnit),t.bindTexture(t.TEXTURE_2D,this.texture)}configure(t){const{gl:r}=this.gl;this.bind(),t.magFilter&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,_(t.magFilter)),t.minFilter&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,_(t.minFilter)),t.wrapS&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,_(t.wrapS)),t.wrapT&&r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,_(t.wrapT))}configureForData(){this.configure({magFilter:oe.Nearest,minFilter:oe.Nearest,wrapS:ne.ClampToEdge,wrapT:ne.ClampToEdge})}upload(){z(this.data,"data must be set on texture to upload"),this.bind(),this.gl.gl.texImage2D(WebGL2RenderingContext.TEXTURE_2D,this.level,_(this.format.internalFormat),this.data.width,this.data.height,0,_(this.format.pixelFormat),_(this.format.pixelType),this.data.data)}update(t){this.set(t),this.upload()}}class ot{constructor(t){this.canvas=t,this.shaders=new B((o,n)=>new tt(this,o,n),o=>this.gl.deleteShader(o.shader)),this.programs=new B((o,n)=>new et(this,o,n),o=>this.gl.deleteProgram(o.program)),this.buffers=new B(()=>N(this.gl.createBuffer()),o=>this.gl.deleteBuffer(o)),this.vertexArrays=new B(()=>N(this.gl.createVertexArray()),o=>this.gl.deleteVertexArray(o)),this.textures=new B((o,n,i)=>new rt(this,o,n,i),o=>this.gl.deleteTexture(o.texture));const r=t.getContext("webgl2");z(r,"browser does not support webgl2"),this.gl=r}destory(){this.shaders.destroyAll(),this.programs.destroyAll(),this.buffers.destroyAll(),this.vertexArrays.destroyAll(),this.textures.destroyAll()}createShader(t,r){return this.shaders.create(t,r)}createProgram(t,r){return this.programs.create(t,r)}createBuffer(){return this.buffers.create()}createVertexArray(){return this.vertexArrays.create()}createTexture(t,r,o){return this.textures.create(t,r,o)}setDefaultViewport(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}clear(){const{gl:t}=this;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}enumToString(t){const r=[];for(const o in this.gl)ze(this.gl,o)===t&&r.push(o);return r.length?r.join(" | "):`0x${t.toString(16)}`}}class B{constructor(t,r){this.initializeResource=t,this.deleteResource=r,this.resources=[]}create(...t){const r=this.initializeResource(...t);return this.resources.push(r),r}destroyAll(){for(const t of this.resources)this.deleteResource(t);this.resources=[]}}var nt=`#version 300 es
#define MAX_BLOBS 32
#define ENTRIES_PER_BLOB 2
#define MODE_BLUR 0
#define MODE_INSIDE 1
#define MODE_OUTSIDE 2
#define MODE_FILL 3
#define INTERPOLATE_NAIVE 0
#define INTERPOLATE_VECTOR 1
#define INTERPOLATE_MIN 2
#define PI 3.1415926538
precision highp float;uniform sampler2D u_blobs;uniform float u_smoothness;uniform float u_blurSize;uniform float u_blurSpread;uniform int u_mode;uniform bool u_darkMode;uniform int u_interpolateMode;uniform float u_hueBias;in vec2 screenPosition;out vec4 outColor;float map(float value,float min1,float max1,float min2,float max2){return min2+(value-min1)*(max2-min2)/(max1-min1);}float sdfCircle(vec2 center,float radius){return length(center-screenPosition)-radius;}float opSmoothUnion(float d1,float d2,float k){float h=clamp(0.5+0.5*(d2-d1)/k,0.0,1.0);return mix(d2,d1,h)-k*h*(1.0-h);}float xyzF(float t){return mix(pow(t,1./3.),7.787037*t+0.139731,step(t,0.00885645));}float xyzR(float t){return mix(t*t*t,0.1284185*(t-0.139731),step(t,0.20689655));}vec3 rgb2lch(in vec3 c){vec3 wref=vec3(1.0,1.0,1.0);c*=mat3(0.4124,0.3576,0.1805,0.2126,0.7152,0.0722,0.0193,0.1192,0.9505);c.x=xyzF(c.x/wref.x);c.y=xyzF(c.y/wref.y);c.z=xyzF(c.z/wref.z);vec3 lab=vec3(max(0.,116.0*c.y-16.0),500.0*(c.x-c.y),200.0*(c.y-c.z));return vec3(lab.x,length(vec2(lab.y,lab.z)),atan(lab.z,lab.y));}vec3 lch2rgb(in vec3 c){vec3 wref=vec3(1.0,1.0,1.0);c=vec3(c.x,cos(c.z)*c.y,sin(c.z)*c.y);float lg=1./116.*(c.x+16.);vec3 xyz=vec3(wref.x*xyzR(lg+0.002*c.y),wref.y*xyzR(lg),wref.z*xyzR(lg-0.005*c.z));vec3 rgb=xyz*mat3(3.2406,-1.5372,-0.4986,-0.9689,1.8758,0.0415,0.0557,-0.2040,1.0570);return rgb;}float easeInOutCubic(in float t){return t<0.5 ? 4.*t*t*t:(t-1.)*(2.*t-2.)*(2.*t-2.)+1.;}float expDropOff(in float t,in float k){return 1./((t/k)+1.);}float rotate(in float angle,in float rotation){float rotated=angle+rotation;return atan(sin(rotated),cos(rotated));}void main(){int blobCount=min(textureSize(u_blobs,0).x/ENTRIES_PER_BLOB,MAX_BLOBS);float totalStrength=0.;vec3 totalColor=vec3(0);float dist=99999.0;vec2 hueVec=vec2(0);float minHue=0.;for(int i=0;i<blobCount;i++){vec4 d1=texelFetch(u_blobs,ivec2(i*ENTRIES_PER_BLOB,0),0);vec2 center=d1.xy;float radius=d1.z;vec3 blobColor=rgb2lch(texelFetch(u_blobs,ivec2((i*ENTRIES_PER_BLOB)+1,0),0).rgb);blobColor.z=rotate(blobColor.z,radians(u_hueBias));float sd=sdfCircle(center,radius);float strength=mix(smoothstep(1.0,0.0,sd/(u_blurSize*2.)),expDropOff(sd,u_blurSize),smoothstep(0.,1.,sd/u_blurSize));strength=pow(strength,5.0);totalStrength+=strength;totalColor+=blobColor*strength;hueVec+=vec2(cos(blobColor.z),sin(blobColor.z))*strength;if(u_interpolateMode==INTERPOLATE_MIN){float a=minHue/totalStrength;float d=blobColor.z-a;d=d>radians(180.)||d<radians(-180.)? d-radians(360.)*round(d/radians(360.)): d;minHue+=(strength*d);}dist=opSmoothUnion(sd,dist,u_smoothness);}float cutoff=smoothstep(0.0,1.0,-dist);vec3 bgColor=u_darkMode ? vec3(0): vec3(1);vec3 resultColor=vec3(1,0,1);if(u_interpolateMode==INTERPOLATE_NAIVE){resultColor=totalColor/totalStrength;}else if(u_interpolateMode==INTERPOLATE_VECTOR){resultColor=vec3((totalColor/totalStrength).xy,atan(hueVec.y,hueVec.x));}else if(u_interpolateMode==INTERPOLATE_MIN){resultColor=vec3((totalColor/totalStrength).xy,minHue/totalStrength);}resultColor.z=rotate(resultColor.z,radians(-u_hueBias));resultColor=lch2rgb(resultColor);if(u_mode==MODE_BLUR){outColor=vec4(mix(bgColor,resultColor,clamp(pow(totalStrength,1.-u_blurSpread),0.,1.)),1);}else if(u_mode==MODE_INSIDE){outColor=vec4(mix(bgColor,resultColor,cutoff),1);}else if(u_mode==MODE_OUTSIDE){outColor=vec4(mix(resultColor,bgColor,cutoff),1);}else if(u_mode==MODE_FILL){outColor=vec4(resultColor,1);}}`,it=`#version 300 es
in vec2 a_position;uniform vec2 u_resolution;out vec2 screenPosition;void main(){screenPosition=a_position;vec2 zeroToOne=a_position/u_resolution;vec2 zeroToTwo=zeroToOne*2.0;vec2 clipSpace=zeroToTwo-1.0;gl_Position=vec4(clipSpace*vec2(1,-1),0,1);}`;function st(){const[e,t]=p.exports.useState([]),r=p.exports.useRef([]),o=U((b,h,c)=>{var f,g;return r.current.push({type:"range",label:b,value:h,oldValue:h,...c}),(g=(f=e.find(m=>m.type==="range"&&m.label===b&&m.oldValue===h))==null?void 0:f.value)!=null?g:h}),n=U(function(h,c,f){var g,m;return r.current.push({type:"colorPicker",label:h,value:c,options:f,oldValue:c}),(m=(g=e.find(R=>R.type==="colorPicker"&&R.label===h&&O(R.oldValue,c)))==null?void 0:g.value)!=null?m:c}),i=U(function(h,c,f){var g,m;return r.current.push({type:"segmentedControl",label:h,value:c,options:f,oldValue:c}),(m=(g=e.find(R=>R.type==="segmentedControl"&&R.label===h&&O(R.oldValue,c)))==null?void 0:g.value)!=null?m:c}),d=U((b,h)=>{var c,f;return r.current.push({type:"checkbox",label:b,value:h,oldValue:h}),(f=(c=e.find(g=>g.type==="checkbox"&&g.label===b&&g.oldValue===h))==null?void 0:c.value)!=null?f:h}),a=U(()=>{O(e,r.current)||t(r.current),r.current=[]});return{render:()=>l(at,{state:e,onChange:t}),ui:p.exports.useMemo(()=>({checkbox:d,range:o,flush:a,colorPicker:n,segmentedControl:i}),[d,n,a,o,i])}}function at({state:e,onChange:t}){return l(Re,{children:e.map((r,o)=>{switch(r.type){case"checkbox":return l(lt,{label:r.label,value:r.value,onChange:n=>t(F(e,o,{...r,value:n}))},o);case"range":return l(ct,{label:r.label,value:r.value,onChange:n=>t(F(e,o,{...r,value:n})),min:r.min,max:r.max,step:r.step},o);case"colorPicker":return l(ut,{label:r.label,value:r.value,options:r.options,onChange:n=>t(F(e,o,{...r,value:n}))},o);case"segmentedControl":return l(dt,{label:r.label,value:r.value,options:r.options,onChange:n=>t(F(e,o,{...r,value:n}))},o);default:T(r)}})})}function ct({label:e,value:t,onChange:r,min:o,max:n,step:i}){const d=p.exports.useId();return A("div",{className:"flex flex-col gap-2 p-3",children:[l("label",{htmlFor:d,children:e}),A("div",{className:"flex items-center justify-between gap-3",children:[l("input",{id:d,className:"w-2/3 flex-auto",type:"range",value:t,min:o,max:n,step:i,onChange:a=>r(a.currentTarget.valueAsNumber)}),l("span",{className:"w-1/3 flex-none text-right",children:t.toPrecision(3)})]})]})}function lt({label:e,value:t,onChange:r}){const o=p.exports.useId();return A("div",{className:"flex gap-3 p-3",children:[l("input",{id:o,type:"checkbox",onChange:n=>r(n.currentTarget.checked),checked:t}),l("label",{htmlFor:o,children:e})]})}function ut({label:e,value:t,onChange:r,options:o}){return A("div",{className:"flex-col gap-3 p-3",children:[e,l("div",{className:"flex gap-1",children:o.map((n,i)=>l("div",{style:{background:n.color},className:"flex h-6 flex-1 cursor-pointer items-center justify-center",onClick:()=>r(n.value),children:O(n.value,t)&&l("div",{className:"h-3 w-3 rounded-full border-2 border-black bg-white"})},i))})]})}function dt({label:e,value:t,onChange:r,options:o}){return A("div",{className:"flex-col gap-3 p-3",children:[e,l("div",{className:"flex gap-2",children:o.map((n,i)=>l("button",{className:je("flex h-6 flex-auto items-center justify-center rounded text-sm",O(n.value,t)?"bg-gray-600":"hover:bg-gray-800"),onClick:()=>r(n.value),children:n.label},i))})]})}const ht=Math.PI/180,ft=180/Math.PI,X=18,Ne=.96422,Ie=1,Te=.82521,Le=4/29,L=6/29,Me=3*L*L,gt=L*L*L;function De(e){if(e instanceof y)return new y(e.l,e.a,e.b,e.opacity);if(e instanceof S)return Pe(e);e instanceof _e||(e=We(e));var t=ee(e.r),r=ee(e.g),o=ee(e.b),n=J((.2225045*t+.7168786*r+.0606169*o)/Ie),i,d;return t===r&&r===o?i=d=n:(i=J((.4360747*t+.3850649*r+.1430804*o)/Ne),d=J((.0139322*t+.0971045*r+.7141733*o)/Te)),new y(116*n-16,500*(i-n),200*(n-d),e.opacity)}function bt(e,t,r,o){return arguments.length===1?De(e):new y(e,t,r,o==null?1:o)}function y(e,t,r,o){this.l=+e,this.a=+t,this.b=+r,this.opacity=+o}ve(y,bt,Ee(ye,{brighter(e){return new y(this.l+X*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new y(this.l-X*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=Ne*Q(t),e=Ie*Q(e),r=Te*Q(r),new _e(G(3.1338561*t-1.6168667*e-.4906146*r),G(-.9787684*t+1.9161415*e+.033454*r),G(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function J(e){return e>gt?Math.pow(e,1/3):e/Me+Le}function Q(e){return e>L?e*e*e:Me*(e-Le)}function G(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ee(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function mt(e){if(e instanceof S)return new S(e.h,e.c,e.l,e.opacity);if(e instanceof y||(e=De(e)),e.a===0&&e.b===0)return new S(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ft;return new S(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ie(e,t,r,o){return arguments.length===1?mt(e):new S(e,t,r,o==null?1:o)}function S(e,t,r,o){this.h=+e,this.c=+t,this.l=+r,this.opacity=+o}function Pe(e){if(isNaN(e.h))return new y(e.l,0,0,e.opacity);var t=e.h*ht;return new y(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ve(S,ie,Ee(ye,{brighter(e){return new S(this.h,this.c,this.l+X*(e==null?1:e),this.opacity)},darker(e){return new S(this.h,this.c,this.l-X*(e==null?1:e),this.opacity)},rgb(){return Pe(this).rgb()}}));function pt(e){return function(t,r){var o=e((t=ie(t)).h,(r=ie(r)).h),n=q(t.c,r.c),i=q(t.l,r.l),d=q(t.opacity,r.opacity);return function(a){return t.h=o(a),t.c=n(a),t.l=i(a),t.opacity=d(a),t+""}}}const Rt=pt($e);function vt(e,t){return e<5?te(t(5)):e<10?E(t(5),t(10),v(5,10,e)):e<20?E(t(10),t(20),v(10,20,e)):e<30?E(t(20),t(30),v(20,30,e)):e<40?E(t(30),t(40),v(30,40,e)):e<50?E(t(40),t(50),v(40,50,e)):e<60?E(t(50),t(60),v(50,60,e)):e<70?E(t(60),t(70),v(60,70,e)):e<80?E(t(70),t(80),v(70,80,e)):e<90?E(t(80),t(90),v(80,90,e)):e<100?E(t(90),"#000000",v(90,100,e)):te("#000000")}function E(e,t,r){return te(Rt(e,t)(r))}const Et=Math.floor(C(5,10)),se=[w.cyberRed,w.cyberOrange,w.cyberYellow,w.cyberGreen,w.cyberCyan,w.cyberIndigo,w.cyberPurple,w.cyberPink],_t=se.map(e=>({value:e,color:e(50)}));function yt({size:e}){const t=p.exports.useRef(null),r=p.exports.useRef(null),o=p.exports.useRef(),n=st();return p.exports.useEffect(()=>(z(t.current&&r.current),o.current=xt(t.current,r.current,n.ui),()=>{z(o.current),o.current.destroy(),o.current=void 0}),[n.ui]),p.exports.useEffect(()=>{z(o.current),o.current.setSize(e)},[e]),A(Re,{children:[A("div",{className:"absolute inset-0",onPointerMove:i=>{o.current&&o.current.onPointerMove(I.fromEvent(i))},onPointerDown:i=>{o.current&&o.current.onPointerDown(I.fromEvent(i))},onPointerUp:i=>{o.current&&o.current.onPointerUp(I.fromEvent(i))},children:[l("canvas",{ref:t,width:e.x*window.devicePixelRatio,height:e.y*window.devicePixelRatio,className:"absolute inset-0 h-full w-full"}),l("canvas",{ref:r,width:e.x*window.devicePixelRatio,height:e.y*window.devicePixelRatio,className:"absolute inset-0 h-full w-full"})]}),A("div",{className:"absolute right-0 top-0 h-full w-72 bg-gray-900",children:[A("ul",{className:"list-disc py-3 px-5 text-xs",children:[l("li",{children:"drag circles to move them"}),l("li",{children:"drag an edge to resize"}),l("li",{children:"drag in empty space for a new one"}),l("li",{children:"backspace to delete"}),l("li",{children:"refresh for something new"}),l("li",{children:"good color level for bgs in dark mode = ~80"}),l("li",{children:"good color level for bgs in light mode = ~20"})]}),n.render()]})]})}const be=[{label:"blur",value:0},{label:"fill",value:3},{label:"inside",value:1},{label:"outside",value:2}],me=[{label:"naive",value:0},{label:"vector",value:1},{label:"min",value:2}];function xt(e,t,r){let o=I.ZERO,n={type:"idle"};const i=N(t.getContext("2d")),d=new Ye(i),a=new ot(e),b=a.createShader(re.Fragment,nt),h=a.createShader(re.Vertex,it),c=a.createProgram(h,b),f=Oe(Et,u=>new ae(new I(C(200,600),C(200,600)),C(30,100),V(se))),g=c.uniformVector2("u_resolution",new I(100,100)),m=c.uniformFloat("u_smoothness",C(50,100)),R=c.uniformFloat("u_blurSize",150),ce=c.uniformFloat("u_blurSpread",.8),M=c.uniformEnum("u_mode",V(be).value),Y=c.uniformBool("u_darkMode",Math.random()<.5),j=c.uniformEnum("u_interpolateMode",V(me).value),le=c.uniformFloat("u_hueBias",C(0,360));let W=Y.value?C(50,95):C(5,50);const ue=c.createAndBindVertexArray({name:"a_position",size:2,type:Ae.Float}),$=a.createTexture(0,{internalFormat:Ce.Rgba32f,pixelType:we.Float,pixelFormat:Se.Rgba});$.configureForData(),c.uniformTexture2d("u_blobs",$);const Ue=u=>{g.value=u,a.setDefaultViewport();const s=[0,0,u.x,u.y,0,u.y,0,0,u.x,0,u.x,u.y];ue.bufferData(new Float32Array(s),xe.StaticDraw),he()},D=u=>{var s;return(s=f[u])!=null?s:null},de=()=>{switch(n.type){case"idle":case"unconfirmedCreate":case"selected":{let u=1/0,s=null,x=null;for(let P=0;P<f.length;P++){const K=f[P],Z=K.center.distanceTo(o);Z<K.radius+5&&Z<u&&(u=Z,s=K,x=P)}return[s,x]}case"moving":case"resizing":return[D(n.blobIndex),n.blobIndex];default:T(n)}},Be=()=>{switch(n.type){case"idle":case"unconfirmedCreate":return null;case"moving":case"selected":case"resizing":return D(n.blobIndex);default:T(n)}},he=()=>{Y.value=r.checkbox("dark mode",Y.value),W=r.range("color level",W,{min:5,max:100,step:1}),j.value=r.segmentedControl("interpolation",j.value,me),j.value!==1&&(le.value=r.range("hue bias",le.value,{min:0,max:360,step:1})),M.value=r.segmentedControl("mode",M.value,be),(M.value===1||M.value===2)&&(m.value=r.range("smoothness",m.value,{min:0,max:100,step:.1})),R.value=r.range("blur size",R.value,{min:0,max:200,step:.1}),M.value===0&&(ce.value=r.range("blur spread",ce.value,{min:.01,max:.99,step:.01})),a.clear(),$.update({width:f.length*2,height:1,data:new Float32Array(f.flatMap(x=>x.toArray(W)))}),c.use(),ue.bindVao(),a.gl.drawArrays(WebGL2RenderingContext.TRIANGLES,0,6),d.clear(),d.ctx.resetTransform(),d.ctx.scale(window.devicePixelRatio,window.devicePixelRatio);const[u]=de(),s=Be();u&&u!==s&&d.circle(u.center,u.radius,{stroke:"cyan",strokeWidth:1}),s&&(d.circle(s.center,s.radius,{stroke:"cyan",strokeWidth:2}),s.colorScale=r.colorPicker("color",s.colorScale,_t)),d.fillText(At(n),new I(30,40),{fill:"white"}),r.flush()};let fe=!1;ke((u,s)=>{if(fe){s();return}he()});const ge=u=>{n.type==="selected"&&Fe(u,"backspace")&&D(n.blobIndex)&&(f.splice(n.blobIndex,1),n={type:"idle"})};return window.addEventListener("keydown",ge),{setSize:Ue,destroy:()=>{a.destory(),window.removeEventListener("keydown",ge),fe=!0},onPointerMove:u=>{switch(o=u,n.type){case"idle":case"selected":break;case"moving":{const s=D(n.blobIndex);s&&(s.center=o.add(n.offset));break}case"resizing":{const s=D(n.blobIndex);s&&(s.radius=o.distanceTo(s.center));break}case"unconfirmedCreate":{const s=n.center.distanceTo(o);if(s>5){const x=f.length;f.push(new ae(n.center,s,V(se))),n={type:"resizing",blobIndex:x}}break}default:T(n)}},onPointerDown:u=>{o=u;const[s,x]=de();switch(n.type){case"idle":case"selected":{s?Math.abs(s.center.distanceTo(o)-s.radius)<5?n={type:"resizing",blobIndex:x}:n={type:"moving",offset:s.center.sub(o),blobIndex:x}:n={type:"unconfirmedCreate",center:o};break}case"moving":case"unconfirmedCreate":case"resizing":break;default:T(n)}},onPointerUp:u=>{switch(o=u,n.type){case"idle":case"selected":break;case"moving":case"resizing":n={type:"selected",blobIndex:n.blobIndex};break;case"unconfirmedCreate":n={type:"idle"};break;default:T(n)}}}}class ae{constructor(t,r,o){this.center=t,this.radius=r,this.colorScale=o}toArray(t){const r=vt(t,this.colorScale);return[this.center.x,this.center.y,this.radius,0,r.red()/255,r.green()/255,r.blue()/255,0]}toJSON(){return{center:this.center,radius:this.radius}}}ae.size=8;function At(e){switch(e.type){case"idle":return H(e.type);case"resizing":case"selected":return H(e.type,{blob:e.blobIndex});case"moving":return H(e.type,{offset:e.offset.toString(2),blob:e.blobIndex});case"unconfirmedCreate":return H(e.type,{center:e.center.toString(2)})}}Ve(N(document.getElementById("root"))).render(l(St,{}));function St(){const[e,t]=p.exports.useState(null),r=He(e,Xe);return l("div",{ref:t,className:"absolute inset-0 touch-none",children:r&&l(yt,{size:r})})}
